{"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\project\\\\web\\\\newCDRL-1\\\\backend\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\project\\\\web\\\\newCDRL-1\",\"filename\":\"D:\\\\project\\\\web\\\\newCDRL-1\\\\backend\\\\server.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\project\\\\web\\\\newCDRL-1\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.24.3:development":{"value":{"code":"const express = require('express');\nconst session = require('express-session');\nconst cors = require('cors');\nconst cookieParser = require('cookie-parser');\nconst fs = require('fs');\nconst https = require('https');\nconst cookie = require('cookie');\nconst path = require('path');\nconst databaseLib = require('./lib/mogodb_lib');\nconst {\n  blockUnwantedPaths\n} = require('./lib/function_lib');\nconst createRootRouter = require('./router/rootRouters');\nconst createLoginRouter = require('./router/loginRouters');\nconst createProfileRouter = require('./router/profileRouters');\nconst createApiRouter = require('./router/apiRouters');\nconst createDepRouter = require('./router/depRouters');\nconst createStaffRouter = require('./router/staffRouters');\nconst createTeacherRouter = require('./router/teacherRoutes');\nconst createStudentRouter = require('./router/studentRouter');\nconst MongoStore = require('connect-mongo');\nconst WebSocket = require('ws');\n\n// ----------------------------------------------------------------\ndatabaseLib.connect().then(client => {\n  const app = express();\n  const privateKey = fs.readFileSync(path.join('.certificate', 'localhost.key'), 'utf8');\n  const certificate = fs.readFileSync(path.join('.certificate', 'localhost.crt'), 'utf8');\n  const credentials = {\n    key: privateKey,\n    cert: certificate\n  };\n  // ----------------------------------------------------------------\n  const port = 443; // port la 443 khong phai 433 dau\n  const secretKey = '5gB#2L1!8*1!0)$7vF@9';\n  const authenticationKey = Buffer.from(secretKey.padEnd(32, '0'), 'utf8').toString('hex');\n  // ----------------------------------------------------------------\n  // mongodb database name\n  if (!fs.existsSync('.downloads')) {\n    // Nếu thư mục không tồn tại, tạo thư mục mới\n    fs.mkdirSync('.downloads');\n  }\n  const name_global_databases = 'global';\n  // -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n  app.use(blockUnwantedPaths);\n  app.use(express.json({\n    limit: '10mb'\n  }));\n  app.use(express.urlencoded({\n    limit: '10mb',\n    extended: true\n  }));\n  app.use(cors({\n    origin: true,\n    credentials: true\n  }));\n  app.use(cookieParser());\n  app.use(session({\n    name: 'howtosavealife?',\n    // Đặt tên mới cho Session ID\n    secret: authenticationKey,\n    resave: false,\n    saveUninitialized: false,\n    store: MongoStore.create({\n      client,\n      dbName: name_global_databases,\n      crypto: {\n        secret: authenticationKey\n      }\n    }),\n    cookie: {\n      secure: true,\n      httpOnly: true,\n      sameSite: 'strict'\n    },\n    rolling: true\n  }));\n  app.use(express.json());\n  const parentDirectory = path.dirname(__dirname);\n  app.use(express.static(parentDirectory));\n  app.set('view engine', 'ejs');\n  app.set('views', path.join(parentDirectory, 'views'));\n  const httpsServer = https.createServer(credentials, app);\n  const wss = new WebSocket.Server({\n    server: httpsServer\n  });\n  // -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n  const rootRouter = createRootRouter(client, parentDirectory);\n  const loginRouters = createLoginRouter(client);\n  const profileRouter = createProfileRouter(client);\n  const apiRouter = createApiRouter(client, wss);\n  const depRouter = createDepRouter(client);\n  const teacherRouter = createTeacherRouter(client);\n  const staffRouter = createStaffRouter(client);\n  const studentRouter = createStudentRouter(client);\n  // -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n  app.use('/', rootRouter);\n  app.use('/login', loginRouters);\n  app.use('/profile', profileRouter);\n  app.use('/api', apiRouter);\n  app.use('/doankhoa', depRouter);\n  app.use('/giaovien', teacherRouter);\n  app.use('/bancansu', staffRouter);\n  app.use('/hocsinh', studentRouter);\n\n  // Xử lý đường link không có -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n  app.get('*', async function (req, res) {\n    return res.sendStatus(404);\n  });\n  // // WEBSOCKET SPACE ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n  wss.on('connection', async (ws, req) => {\n    // Kiểm tra địa chỉ đích của kết nối WebSocket\n    if (req.url === '/howtosavealife?') {\n      // Gán id cho ws\n      if (req.headers.cookie) {\n        const cookie_seasion = cookie.parse(req.headers.cookie);\n        if ('howtosavealife?' in cookie_seasion) {\n          ws.id = cookieParser.signedCookie(cookie_seasion['howtosavealife?'], authenticationKey);\n          // Xử lý khi client gửi dữ liệu\n          ws.on('message', message => {\n            const messDecode = message.toString('utf-8');\n            if (console == 'logout') {\n              ws.close();\n            } else if (messDecode == 'ok ko e?') {\n              ws.send('Ok a');\n            } else if (messDecode.startsWith('anhiuem')) {\n              ws.actId = messDecode.slice(7);\n              ws.send('gotta!');\n            } else if (messDecode == 'clearID') {\n              delete ws.actId;\n            }\n          });\n\n          // Xử lý khi client đóng kết nối\n          ws.on('close', () => {});\n        } else {\n          ws.send('Ko a');\n          ws.close();\n        }\n      } else {\n        ws.send('Ko a');\n        ws.close();\n      }\n    } else {\n      console.log('SYSTEM | WEBSOCKET | Rejected WebSocket connection from:', ws.id);\n      ws.close();\n    }\n  });\n  // -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n  httpsServer.listen(port, () => {\n    console.log(`SYSTEM | LOG | Đang chạy server siu cấp vip pro đa vũ trụ ở https://localhost:${port}`);\n  });\n  // -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n}).catch(error => {\n  console.log('SYSTEM | LOG | Error connecting to MongoDB:', error);\n  throw error;\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInNlc3Npb24iLCJjb3JzIiwiY29va2llUGFyc2VyIiwiZnMiLCJodHRwcyIsImNvb2tpZSIsInBhdGgiLCJkYXRhYmFzZUxpYiIsImJsb2NrVW53YW50ZWRQYXRocyIsImNyZWF0ZVJvb3RSb3V0ZXIiLCJjcmVhdGVMb2dpblJvdXRlciIsImNyZWF0ZVByb2ZpbGVSb3V0ZXIiLCJjcmVhdGVBcGlSb3V0ZXIiLCJjcmVhdGVEZXBSb3V0ZXIiLCJjcmVhdGVTdGFmZlJvdXRlciIsImNyZWF0ZVRlYWNoZXJSb3V0ZXIiLCJjcmVhdGVTdHVkZW50Um91dGVyIiwiTW9uZ29TdG9yZSIsIldlYlNvY2tldCIsImNvbm5lY3QiLCJ0aGVuIiwiY2xpZW50IiwiYXBwIiwicHJpdmF0ZUtleSIsInJlYWRGaWxlU3luYyIsImpvaW4iLCJjZXJ0aWZpY2F0ZSIsImNyZWRlbnRpYWxzIiwia2V5IiwiY2VydCIsInBvcnQiLCJzZWNyZXRLZXkiLCJhdXRoZW50aWNhdGlvbktleSIsIkJ1ZmZlciIsImZyb20iLCJwYWRFbmQiLCJ0b1N0cmluZyIsImV4aXN0c1N5bmMiLCJta2RpclN5bmMiLCJuYW1lX2dsb2JhbF9kYXRhYmFzZXMiLCJ1c2UiLCJqc29uIiwibGltaXQiLCJ1cmxlbmNvZGVkIiwiZXh0ZW5kZWQiLCJvcmlnaW4iLCJuYW1lIiwic2VjcmV0IiwicmVzYXZlIiwic2F2ZVVuaW5pdGlhbGl6ZWQiLCJzdG9yZSIsImNyZWF0ZSIsImRiTmFtZSIsImNyeXB0byIsInNlY3VyZSIsImh0dHBPbmx5Iiwic2FtZVNpdGUiLCJyb2xsaW5nIiwicGFyZW50RGlyZWN0b3J5IiwiZGlybmFtZSIsIl9fZGlybmFtZSIsInN0YXRpYyIsInNldCIsImh0dHBzU2VydmVyIiwiY3JlYXRlU2VydmVyIiwid3NzIiwiU2VydmVyIiwic2VydmVyIiwicm9vdFJvdXRlciIsImxvZ2luUm91dGVycyIsInByb2ZpbGVSb3V0ZXIiLCJhcGlSb3V0ZXIiLCJkZXBSb3V0ZXIiLCJ0ZWFjaGVyUm91dGVyIiwic3RhZmZSb3V0ZXIiLCJzdHVkZW50Um91dGVyIiwiZ2V0IiwicmVxIiwicmVzIiwic2VuZFN0YXR1cyIsIm9uIiwid3MiLCJ1cmwiLCJoZWFkZXJzIiwiY29va2llX3NlYXNpb24iLCJwYXJzZSIsImlkIiwic2lnbmVkQ29va2llIiwibWVzc2FnZSIsIm1lc3NEZWNvZGUiLCJjb25zb2xlIiwiY2xvc2UiLCJzZW5kIiwic3RhcnRzV2l0aCIsImFjdElkIiwic2xpY2UiLCJsb2ciLCJsaXN0ZW4iLCJjYXRjaCIsImVycm9yIl0sInNvdXJjZVJvb3QiOiJEOlxccHJvamVjdFxcd2ViXFxuZXdDRFJMLTFcXGJhY2tlbmRcXCIsInNvdXJjZXMiOlsic2VydmVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XHJcbmNvbnN0IHNlc3Npb24gPSByZXF1aXJlKCdleHByZXNzLXNlc3Npb24nKTtcclxuY29uc3QgY29ycyA9IHJlcXVpcmUoJ2NvcnMnKTtcclxuY29uc3QgY29va2llUGFyc2VyID0gcmVxdWlyZSgnY29va2llLXBhcnNlcicpO1xyXG5jb25zdCBmcyA9IHJlcXVpcmUoJ2ZzJyk7XHJcbmNvbnN0IGh0dHBzID0gcmVxdWlyZSgnaHR0cHMnKTtcclxuY29uc3QgY29va2llID0gcmVxdWlyZSgnY29va2llJyk7XHJcbmNvbnN0IHBhdGggPSByZXF1aXJlKCdwYXRoJyk7XHJcbmNvbnN0IGRhdGFiYXNlTGliID0gcmVxdWlyZSgnLi9saWIvbW9nb2RiX2xpYicpO1xyXG5jb25zdCB7IGJsb2NrVW53YW50ZWRQYXRocyB9ID0gcmVxdWlyZSgnLi9saWIvZnVuY3Rpb25fbGliJyk7XHJcbmNvbnN0IGNyZWF0ZVJvb3RSb3V0ZXIgPSByZXF1aXJlKCcuL3JvdXRlci9yb290Um91dGVycycpO1xyXG5jb25zdCBjcmVhdGVMb2dpblJvdXRlciA9IHJlcXVpcmUoJy4vcm91dGVyL2xvZ2luUm91dGVycycpO1xyXG5jb25zdCBjcmVhdGVQcm9maWxlUm91dGVyID0gcmVxdWlyZSgnLi9yb3V0ZXIvcHJvZmlsZVJvdXRlcnMnKTtcclxuY29uc3QgY3JlYXRlQXBpUm91dGVyID0gcmVxdWlyZSgnLi9yb3V0ZXIvYXBpUm91dGVycycpO1xyXG5jb25zdCBjcmVhdGVEZXBSb3V0ZXIgPSByZXF1aXJlKCcuL3JvdXRlci9kZXBSb3V0ZXJzJyk7XHJcbmNvbnN0IGNyZWF0ZVN0YWZmUm91dGVyID0gcmVxdWlyZSgnLi9yb3V0ZXIvc3RhZmZSb3V0ZXJzJyk7XHJcbmNvbnN0IGNyZWF0ZVRlYWNoZXJSb3V0ZXIgPSByZXF1aXJlKCcuL3JvdXRlci90ZWFjaGVyUm91dGVzJyk7XHJcbmNvbnN0IGNyZWF0ZVN0dWRlbnRSb3V0ZXIgPSByZXF1aXJlKCcuL3JvdXRlci9zdHVkZW50Um91dGVyJyk7XHJcblxyXG5jb25zdCBNb25nb1N0b3JlID0gcmVxdWlyZSgnY29ubmVjdC1tb25nbycpO1xyXG5jb25zdCBXZWJTb2NrZXQgPSByZXF1aXJlKCd3cycpO1xyXG5cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5kYXRhYmFzZUxpYlxyXG4gICAgLmNvbm5lY3QoKVxyXG4gICAgLnRoZW4oKGNsaWVudCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGFwcCA9IGV4cHJlc3MoKTtcclxuICAgICAgICBjb25zdCBwcml2YXRlS2V5ID0gZnMucmVhZEZpbGVTeW5jKHBhdGguam9pbignLmNlcnRpZmljYXRlJywgJ2xvY2FsaG9zdC5rZXknKSwgJ3V0ZjgnKTtcclxuICAgICAgICBjb25zdCBjZXJ0aWZpY2F0ZSA9IGZzLnJlYWRGaWxlU3luYyhwYXRoLmpvaW4oJy5jZXJ0aWZpY2F0ZScsICdsb2NhbGhvc3QuY3J0JyksICd1dGY4Jyk7XHJcbiAgICAgICAgY29uc3QgY3JlZGVudGlhbHMgPSB7IGtleTogcHJpdmF0ZUtleSwgY2VydDogY2VydGlmaWNhdGUgfTtcclxuICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAgICAgY29uc3QgcG9ydCA9IDQ0MzsgLy8gcG9ydCBsYSA0NDMga2hvbmcgcGhhaSA0MzMgZGF1XHJcbiAgICAgICAgY29uc3Qgc2VjcmV0S2V5ID0gJzVnQiMyTDEhOCoxITApJDd2RkA5JztcclxuICAgICAgICBjb25zdCBhdXRoZW50aWNhdGlvbktleSA9IEJ1ZmZlci5mcm9tKHNlY3JldEtleS5wYWRFbmQoMzIsICcwJyksICd1dGY4JykudG9TdHJpbmcoJ2hleCcpO1xyXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgICAgICAvLyBtb25nb2RiIGRhdGFiYXNlIG5hbWVcclxuICAgICAgICBpZiAoIWZzLmV4aXN0c1N5bmMoJy5kb3dubG9hZHMnKSkge1xyXG4gICAgICAgICAgICAvLyBO4bq/dSB0aMawIG3hu6VjIGtow7RuZyB04buTbiB04bqhaSwgdOG6oW8gdGjGsCBt4bulYyBt4bubaVxyXG4gICAgICAgICAgICBmcy5ta2RpclN5bmMoJy5kb3dubG9hZHMnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgbmFtZV9nbG9iYWxfZGF0YWJhc2VzID0gJ2dsb2JhbCc7XHJcbiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgICAgICBhcHAudXNlKGJsb2NrVW53YW50ZWRQYXRocyk7XHJcbiAgICAgICAgYXBwLnVzZShleHByZXNzLmpzb24oeyBsaW1pdDogJzEwbWInIH0pKTtcclxuICAgICAgICBhcHAudXNlKGV4cHJlc3MudXJsZW5jb2RlZCh7IGxpbWl0OiAnMTBtYicsIGV4dGVuZGVkOiB0cnVlIH0pKTtcclxuICAgICAgICBhcHAudXNlKGNvcnMoeyBvcmlnaW46IHRydWUsIGNyZWRlbnRpYWxzOiB0cnVlIH0pKTtcclxuICAgICAgICBhcHAudXNlKGNvb2tpZVBhcnNlcigpKTtcclxuICAgICAgICBhcHAudXNlKFxyXG4gICAgICAgICAgICBzZXNzaW9uKHtcclxuICAgICAgICAgICAgICAgIG5hbWU6ICdob3d0b3NhdmVhbGlmZT8nLCAvLyDEkOG6t3QgdMOqbiBt4bubaSBjaG8gU2Vzc2lvbiBJRFxyXG4gICAgICAgICAgICAgICAgc2VjcmV0OiBhdXRoZW50aWNhdGlvbktleSxcclxuICAgICAgICAgICAgICAgIHJlc2F2ZTogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBzYXZlVW5pbml0aWFsaXplZDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBzdG9yZTogTW9uZ29TdG9yZS5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGNsaWVudCxcclxuICAgICAgICAgICAgICAgICAgICBkYk5hbWU6IG5hbWVfZ2xvYmFsX2RhdGFiYXNlcyxcclxuICAgICAgICAgICAgICAgICAgICBjcnlwdG86IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VjcmV0OiBhdXRoZW50aWNhdGlvbktleSxcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgICAgICBjb29raWU6IHtcclxuICAgICAgICAgICAgICAgICAgICBzZWN1cmU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgaHR0cE9ubHk6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgc2FtZVNpdGU6ICdzdHJpY3QnLFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHJvbGxpbmc6IHRydWUsXHJcbiAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICk7XHJcbiAgICAgICAgYXBwLnVzZShleHByZXNzLmpzb24oKSk7XHJcbiAgICAgICAgY29uc3QgcGFyZW50RGlyZWN0b3J5ID0gcGF0aC5kaXJuYW1lKF9fZGlybmFtZSk7XHJcbiAgICAgICAgYXBwLnVzZShleHByZXNzLnN0YXRpYyhwYXJlbnREaXJlY3RvcnkpKTtcclxuICAgICAgICBhcHAuc2V0KCd2aWV3IGVuZ2luZScsICdlanMnKTtcclxuICAgICAgICBhcHAuc2V0KCd2aWV3cycsIHBhdGguam9pbihwYXJlbnREaXJlY3RvcnksICd2aWV3cycpKTtcclxuICAgICAgICBjb25zdCBodHRwc1NlcnZlciA9IGh0dHBzLmNyZWF0ZVNlcnZlcihjcmVkZW50aWFscywgYXBwKTtcclxuICAgICAgICBjb25zdCB3c3MgPSBuZXcgV2ViU29ja2V0LlNlcnZlcih7IHNlcnZlcjogaHR0cHNTZXJ2ZXIgfSk7XHJcbiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgICAgICBjb25zdCByb290Um91dGVyID0gY3JlYXRlUm9vdFJvdXRlcihjbGllbnQsIHBhcmVudERpcmVjdG9yeSk7XHJcbiAgICAgICAgY29uc3QgbG9naW5Sb3V0ZXJzID0gY3JlYXRlTG9naW5Sb3V0ZXIoY2xpZW50KTtcclxuICAgICAgICBjb25zdCBwcm9maWxlUm91dGVyID0gY3JlYXRlUHJvZmlsZVJvdXRlcihjbGllbnQpO1xyXG4gICAgICAgIGNvbnN0IGFwaVJvdXRlciA9IGNyZWF0ZUFwaVJvdXRlcihjbGllbnQsIHdzcyk7XHJcbiAgICAgICAgY29uc3QgZGVwUm91dGVyID0gY3JlYXRlRGVwUm91dGVyKGNsaWVudCk7XHJcbiAgICAgICAgY29uc3QgdGVhY2hlclJvdXRlciA9IGNyZWF0ZVRlYWNoZXJSb3V0ZXIoY2xpZW50KTtcclxuICAgICAgICBjb25zdCBzdGFmZlJvdXRlciA9IGNyZWF0ZVN0YWZmUm91dGVyKGNsaWVudCk7XHJcbiAgICAgICAgY29uc3Qgc3R1ZGVudFJvdXRlciA9IGNyZWF0ZVN0dWRlbnRSb3V0ZXIoY2xpZW50KTtcclxuICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgICAgIGFwcC51c2UoJy8nLCByb290Um91dGVyKTtcclxuICAgICAgICBhcHAudXNlKCcvbG9naW4nLCBsb2dpblJvdXRlcnMpO1xyXG4gICAgICAgIGFwcC51c2UoJy9wcm9maWxlJywgcHJvZmlsZVJvdXRlcik7XHJcbiAgICAgICAgYXBwLnVzZSgnL2FwaScsIGFwaVJvdXRlcik7XHJcbiAgICAgICAgYXBwLnVzZSgnL2RvYW5raG9hJywgZGVwUm91dGVyKTtcclxuICAgICAgICBhcHAudXNlKCcvZ2lhb3ZpZW4nLCB0ZWFjaGVyUm91dGVyKTtcclxuICAgICAgICBhcHAudXNlKCcvYmFuY2Fuc3UnLCBzdGFmZlJvdXRlcik7XHJcbiAgICAgICAgYXBwLnVzZSgnL2hvY3NpbmgnLCBzdHVkZW50Um91dGVyKTtcclxuXHJcbiAgICAgICAgLy8gWOG7rSBsw70gxJHGsOG7nW5nIGxpbmsga2jDtG5nIGPDsyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgICAgIGFwcC5nZXQoJyonLCBhc3luYyBmdW5jdGlvbiAocmVxLCByZXMpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zZW5kU3RhdHVzKDQwNCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy8gLy8gV0VCU09DS0VUIFNQQUNFIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcbiAgICAgICAgd3NzLm9uKCdjb25uZWN0aW9uJywgYXN5bmMgKHdzLCByZXEpID0+IHtcclxuICAgICAgICAgICAgLy8gS2nhu4NtIHRyYSDEkeG7i2EgY2jhu4kgxJHDrWNoIGPhu6dhIGvhur90IG7hu5FpIFdlYlNvY2tldFxyXG4gICAgICAgICAgICBpZiAocmVxLnVybCA9PT0gJy9ob3d0b3NhdmVhbGlmZT8nKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBHw6FuIGlkIGNobyB3c1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlcS5oZWFkZXJzLmNvb2tpZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvb2tpZV9zZWFzaW9uID0gY29va2llLnBhcnNlKHJlcS5oZWFkZXJzLmNvb2tpZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCdob3d0b3NhdmVhbGlmZT8nIGluIGNvb2tpZV9zZWFzaW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdzLmlkID0gY29va2llUGFyc2VyLnNpZ25lZENvb2tpZShjb29raWVfc2Vhc2lvblsnaG93dG9zYXZlYWxpZmU/J10sIGF1dGhlbnRpY2F0aW9uS2V5KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gWOG7rSBsw70ga2hpIGNsaWVudCBn4butaSBk4buvIGxp4buHdVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB3cy5vbignbWVzc2FnZScsIChtZXNzYWdlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtZXNzRGVjb2RlID0gbWVzc2FnZS50b1N0cmluZygndXRmLTgnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb25zb2xlID09ICdsb2dvdXQnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd3MuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobWVzc0RlY29kZSA9PSAnb2sga28gZT8nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd3Muc2VuZCgnT2sgYScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChtZXNzRGVjb2RlLnN0YXJ0c1dpdGgoJ2FuaGl1ZW0nKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdzLmFjdElkID0gbWVzc0RlY29kZS5zbGljZSg3KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3cy5zZW5kKCdnb3R0YSEnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobWVzc0RlY29kZSA9PSAnY2xlYXJJRCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgd3MuYWN0SWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gWOG7rSBsw70ga2hpIGNsaWVudCDEkcOzbmcga+G6v3QgbuG7kWlcclxuICAgICAgICAgICAgICAgICAgICAgICAgd3Mub24oJ2Nsb3NlJywgKCkgPT4ge30pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdzLnNlbmQoJ0tvIGEnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd3MuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHdzLnNlbmQoJ0tvIGEnKTtcclxuICAgICAgICAgICAgICAgICAgICB3cy5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1NZU1RFTSB8IFdFQlNPQ0tFVCB8IFJlamVjdGVkIFdlYlNvY2tldCBjb25uZWN0aW9uIGZyb206Jywgd3MuaWQpO1xyXG4gICAgICAgICAgICAgICAgd3MuY2xvc2UoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAgICAgaHR0cHNTZXJ2ZXIubGlzdGVuKHBvcnQsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coYFNZU1RFTSB8IExPRyB8IMSQYW5nIGNo4bqheSBzZXJ2ZXIgc2l1IGPhuqVwIHZpcCBwcm8gxJFhIHbFqSB0cuG7pSDhu58gaHR0cHM6Ly9sb2NhbGhvc3Q6JHtwb3J0fWApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdTWVNURU0gfCBMT0cgfCBFcnJvciBjb25uZWN0aW5nIHRvIE1vbmdvREI6JywgZXJy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","map":{"version":3,"names":["express","require","session","cors","cookieParser","fs","https","cookie","path","databaseLib","blockUnwantedPaths","createRootRouter","createLoginRouter","createProfileRouter","createApiRouter","createDepRouter","createStaffRouter","createTeacherRouter","createStudentRouter","MongoStore","WebSocket","connect","then","client","app","privateKey","readFileSync","join","certificate","credentials","key","cert","port","secretKey","authenticationKey","Buffer","from","padEnd","toString","existsSync","mkdirSync","name_global_databases","use","json","limit","urlencoded","extended","origin","name","secret","resave","saveUninitialized","store","create","dbName","crypto","secure","httpOnly","sameSite","rolling","parentDirectory","dirname","__dirname","static","set","httpsServer","createServer","wss","Server","server","rootRouter","loginRouters","profileRouter","apiRouter","depRouter","teacherRouter","staffRouter","studentRouter","get","req","res","sendStatus","on","ws","url","headers","cookie_seasion","parse","id","signedCookie","message","messDecode","console","close","send","startsWith","actId","slice","log","listen","catch","error"],"sourceRoot":"D:\\project\\web\\newCDRL-1\\backend\\","sources":["server.js"],"sourcesContent":["const express = require('express');\r\nconst session = require('express-session');\r\nconst cors = require('cors');\r\nconst cookieParser = require('cookie-parser');\r\nconst fs = require('fs');\r\nconst https = require('https');\r\nconst cookie = require('cookie');\r\nconst path = require('path');\r\nconst databaseLib = require('./lib/mogodb_lib');\r\nconst { blockUnwantedPaths } = require('./lib/function_lib');\r\nconst createRootRouter = require('./router/rootRouters');\r\nconst createLoginRouter = require('./router/loginRouters');\r\nconst createProfileRouter = require('./router/profileRouters');\r\nconst createApiRouter = require('./router/apiRouters');\r\nconst createDepRouter = require('./router/depRouters');\r\nconst createStaffRouter = require('./router/staffRouters');\r\nconst createTeacherRouter = require('./router/teacherRoutes');\r\nconst createStudentRouter = require('./router/studentRouter');\r\n\r\nconst MongoStore = require('connect-mongo');\r\nconst WebSocket = require('ws');\r\n\r\n// ----------------------------------------------------------------\r\ndatabaseLib\r\n    .connect()\r\n    .then((client) => {\r\n        const app = express();\r\n        const privateKey = fs.readFileSync(path.join('.certificate', 'localhost.key'), 'utf8');\r\n        const certificate = fs.readFileSync(path.join('.certificate', 'localhost.crt'), 'utf8');\r\n        const credentials = { key: privateKey, cert: certificate };\r\n        // ----------------------------------------------------------------\r\n        const port = 443; // port la 443 khong phai 433 dau\r\n        const secretKey = '5gB#2L1!8*1!0)$7vF@9';\r\n        const authenticationKey = Buffer.from(secretKey.padEnd(32, '0'), 'utf8').toString('hex');\r\n        // ----------------------------------------------------------------\r\n        // mongodb database name\r\n        if (!fs.existsSync('.downloads')) {\r\n            // Nếu thư mục không tồn tại, tạo thư mục mới\r\n            fs.mkdirSync('.downloads');\r\n        }\r\n        const name_global_databases = 'global';\r\n        // -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n        app.use(blockUnwantedPaths);\r\n        app.use(express.json({ limit: '10mb' }));\r\n        app.use(express.urlencoded({ limit: '10mb', extended: true }));\r\n        app.use(cors({ origin: true, credentials: true }));\r\n        app.use(cookieParser());\r\n        app.use(\r\n            session({\r\n                name: 'howtosavealife?', // Đặt tên mới cho Session ID\r\n                secret: authenticationKey,\r\n                resave: false,\r\n                saveUninitialized: false,\r\n                store: MongoStore.create({\r\n                    client,\r\n                    dbName: name_global_databases,\r\n                    crypto: {\r\n                        secret: authenticationKey,\r\n                    },\r\n                }),\r\n                cookie: {\r\n                    secure: true,\r\n                    httpOnly: true,\r\n                    sameSite: 'strict',\r\n                },\r\n                rolling: true,\r\n            }),\r\n        );\r\n        app.use(express.json());\r\n        const parentDirectory = path.dirname(__dirname);\r\n        app.use(express.static(parentDirectory));\r\n        app.set('view engine', 'ejs');\r\n        app.set('views', path.join(parentDirectory, 'views'));\r\n        const httpsServer = https.createServer(credentials, app);\r\n        const wss = new WebSocket.Server({ server: httpsServer });\r\n        // -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n        const rootRouter = createRootRouter(client, parentDirectory);\r\n        const loginRouters = createLoginRouter(client);\r\n        const profileRouter = createProfileRouter(client);\r\n        const apiRouter = createApiRouter(client, wss);\r\n        const depRouter = createDepRouter(client);\r\n        const teacherRouter = createTeacherRouter(client);\r\n        const staffRouter = createStaffRouter(client);\r\n        const studentRouter = createStudentRouter(client);\r\n        // -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n        app.use('/', rootRouter);\r\n        app.use('/login', loginRouters);\r\n        app.use('/profile', profileRouter);\r\n        app.use('/api', apiRouter);\r\n        app.use('/doankhoa', depRouter);\r\n        app.use('/giaovien', teacherRouter);\r\n        app.use('/bancansu', staffRouter);\r\n        app.use('/hocsinh', studentRouter);\r\n\r\n        // Xử lý đường link không có -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n        app.get('*', async function (req, res) {\r\n            return res.sendStatus(404);\r\n        });\r\n        // // WEBSOCKET SPACE ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n        wss.on('connection', async (ws, req) => {\r\n            // Kiểm tra địa chỉ đích của kết nối WebSocket\r\n            if (req.url === '/howtosavealife?') {\r\n                // Gán id cho ws\r\n                if (req.headers.cookie) {\r\n                    const cookie_seasion = cookie.parse(req.headers.cookie);\r\n                    if ('howtosavealife?' in cookie_seasion) {\r\n                        ws.id = cookieParser.signedCookie(cookie_seasion['howtosavealife?'], authenticationKey);\r\n                        // Xử lý khi client gửi dữ liệu\r\n                        ws.on('message', (message) => {\r\n                            const messDecode = message.toString('utf-8');\r\n                            if (console == 'logout') {\r\n                                ws.close();\r\n                            } else if (messDecode == 'ok ko e?') {\r\n                                ws.send('Ok a');\r\n                            } else if (messDecode.startsWith('anhiuem')) {\r\n                                ws.actId = messDecode.slice(7);\r\n                                ws.send('gotta!');\r\n                            } else if (messDecode == 'clearID') {\r\n                                delete ws.actId;\r\n                            }\r\n                        });\r\n\r\n                        // Xử lý khi client đóng kết nối\r\n                        ws.on('close', () => {});\r\n                    } else {\r\n                        ws.send('Ko a');\r\n                        ws.close();\r\n                    }\r\n                } else {\r\n                    ws.send('Ko a');\r\n                    ws.close();\r\n                }\r\n            } else {\r\n                console.log('SYSTEM | WEBSOCKET | Rejected WebSocket connection from:', ws.id);\r\n                ws.close();\r\n            }\r\n        });\r\n        // -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n        httpsServer.listen(port, () => {\r\n            console.log(`SYSTEM | LOG | Đang chạy server siu cấp vip pro đa vũ trụ ở https://localhost:${port}`);\r\n        });\r\n        // -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n    })\r\n    .catch((error) => {\r\n        console.log('SYSTEM | LOG | Error connecting to MongoDB:', error);\r\n        throw error;\r\n    });\r\n"],"mappings":"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","ignoreList":[]}},"mtime":1705240655666},"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\project\\\\web\\\\newCDRL-1\\\\backend\\\\lib\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\project\\\\web\\\\newCDRL-1\",\"filename\":\"D:\\\\project\\\\web\\\\newCDRL-1\\\\backend\\\\lib\\\\mogodb_lib.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\project\\\\web\\\\newCDRL-1\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.24.3:development":{"value":{"code":"const {\n  ObjectId,\n  MongoClient,\n  ServerApiVersion\n} = require('mongodb');\nconst uri = 'mongodb+srv://binhminh19112003:Zr3uGIK4dCymOXON@6aesieunhan.sefjqcb.mongodb.net/?retryWrites=true&w=majority';\nconst client = new MongoClient(uri, {\n  useNewUrlParser: true,\n  useUnifiedTopology: true,\n  serverApi: {\n    version: ServerApiVersion.v1,\n    strict: true,\n    deprecationErrors: true\n  }\n});\nconst name_global_databases = 'global';\nasync function connect() {\n  try {\n    await client.connect();\n    const checkFirst = await client.db(name_global_databases).collection('user_info').findOne({\n      _id: ObjectId.createFromHexString('650985a345e2e896b37efd4f')\n    });\n    if (!checkFirst) {\n      await client.db(name_global_databases).collection('user_info').insertOne({\n        _id: ObjectId.createFromHexString('650985a345e2e896b37efd4f'),\n        first_name: 'Đặt',\n        last_name: 'Chưa',\n        avt: 'https://i.pinimg.com/236x/89/08/3b/89083bba40545a72fa15321af5fab760--chibi-girl-zero.jpg',\n        power: {\n          1: true,\n          3: true,\n          4: true,\n          999: true\n        },\n        class: [],\n        displayName: 'Chưa Đặt',\n        email: '',\n        branch: ObjectId.createFromHexString('650985a345e2e896b37efd4f')\n      });\n    }\n    const checkFirst2 = await client.db(name_global_databases).collection('branchs').findOne({\n      _id: ObjectId.createFromHexString('650985a345e2e896b37efd4f')\n    });\n    if (!checkFirst2) {\n      await client.db(name_global_databases).collection('branchs').insertOne({\n        _id: ObjectId.createFromHexString('650985a345e2e896b37efd4f'),\n        name: 'Chưa đặt',\n        dep: ObjectId.createFromHexString('650985a345e2e896b37efd4f')\n      });\n    }\n  } catch (error) {\n    console.log('SYSTEM | ERROR | Error connecting to MongoDB:', error);\n    throw error;\n  }\n  return client;\n}\nmodule.exports = {\n  connect,\n  getClient: () => client,\n  getNameGlobal: () => name_global_databases\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJPYmplY3RJZCIsIk1vbmdvQ2xpZW50IiwiU2VydmVyQXBpVmVyc2lvbiIsInJlcXVpcmUiLCJ1cmkiLCJjbGllbnQiLCJ1c2VOZXdVcmxQYXJzZXIiLCJ1c2VVbmlmaWVkVG9wb2xvZ3kiLCJzZXJ2ZXJBcGkiLCJ2ZXJzaW9uIiwidjEiLCJzdHJpY3QiLCJkZXByZWNhdGlvbkVycm9ycyIsIm5hbWVfZ2xvYmFsX2RhdGFiYXNlcyIsImNvbm5lY3QiLCJjaGVja0ZpcnN0IiwiZGIiLCJjb2xsZWN0aW9uIiwiZmluZE9uZSIsIl9pZCIsImNyZWF0ZUZyb21IZXhTdHJpbmciLCJpbnNlcnRPbmUiLCJmaXJzdF9uYW1lIiwibGFzdF9uYW1lIiwiYXZ0IiwicG93ZXIiLCJjbGFzcyIsImRpc3BsYXlOYW1lIiwiZW1haWwiLCJicmFuY2giLCJjaGVja0ZpcnN0MiIsIm5hbWUiLCJkZXAiLCJlcnJvciIsImNvbnNvbGUiLCJsb2ciLCJtb2R1bGUiLCJleHBvcnRzIiwiZ2V0Q2xpZW50IiwiZ2V0TmFtZUdsb2JhbCJdLCJzb3VyY2VSb290IjoiRDpcXHByb2plY3RcXHdlYlxcbmV3Q0RSTC0xXFxiYWNrZW5kXFxsaWJcXCIsInNvdXJjZXMiOlsibW9nb2RiX2xpYi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB7IE9iamVjdElkLCBNb25nb0NsaWVudCwgU2VydmVyQXBpVmVyc2lvbiB9ID0gcmVxdWlyZSgnbW9uZ29kYicpO1xyXG5jb25zdCB1cmkgPVxyXG4gICAgJ21vbmdvZGIrc3J2Oi8vYmluaG1pbmgxOTExMjAwMzpacjN1R0lLNGRDeW1PWE9OQDZhZXNpZXVuaGFuLnNlZmpxY2IubW9uZ29kYi5uZXQvP3JldHJ5V3JpdGVzPXRydWUmdz1tYWpvcml0eSc7XHJcbmNvbnN0IGNsaWVudCA9IG5ldyBNb25nb0NsaWVudCh1cmksIHtcclxuICAgIHVzZU5ld1VybFBhcnNlcjogdHJ1ZSxcclxuICAgIHVzZVVuaWZpZWRUb3BvbG9neTogdHJ1ZSxcclxuICAgIHNlcnZlckFwaToge1xyXG4gICAgICAgIHZlcnNpb246IFNlcnZlckFwaVZlcnNpb24udjEsXHJcbiAgICAgICAgc3RyaWN0OiB0cnVlLFxyXG4gICAgICAgIGRlcHJlY2F0aW9uRXJyb3JzOiB0cnVlLFxyXG4gICAgfSxcclxufSk7XHJcbmNvbnN0IG5hbWVfZ2xvYmFsX2RhdGFiYXNlcyA9ICdnbG9iYWwnO1xyXG5hc3luYyBmdW5jdGlvbiBjb25uZWN0KCkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBhd2FpdCBjbGllbnQuY29ubmVjdCgpO1xyXG4gICAgICAgIGNvbnN0IGNoZWNrRmlyc3QgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ3VzZXJfaW5mbycpXHJcbiAgICAgICAgICAgIC5maW5kT25lKHsgX2lkOiBPYmplY3RJZC5jcmVhdGVGcm9tSGV4U3RyaW5nKCc2NTA5ODVhMzQ1ZTJlODk2YjM3ZWZkNGYnKSB9KTtcclxuICAgICAgICBpZiAoIWNoZWNrRmlyc3QpIHtcclxuICAgICAgICAgICAgYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ3VzZXJfaW5mbycpXHJcbiAgICAgICAgICAgICAgICAuaW5zZXJ0T25lKHtcclxuICAgICAgICAgICAgICAgICAgICBfaWQ6IE9iamVjdElkLmNyZWF0ZUZyb21IZXhTdHJpbmcoJzY1MDk4NWEzNDVlMmU4OTZiMzdlZmQ0ZicpLFxyXG4gICAgICAgICAgICAgICAgICAgIGZpcnN0X25hbWU6ICfEkOG6t3QnLFxyXG4gICAgICAgICAgICAgICAgICAgIGxhc3RfbmFtZTogJ0NoxrBhJyxcclxuICAgICAgICAgICAgICAgICAgICBhdnQ6ICdodHRwczovL2kucGluaW1nLmNvbS8yMzZ4Lzg5LzA4LzNiLzg5MDgzYmJhNDA1NDVhNzJmYTE1MzIxYWY1ZmFiNzYwLS1jaGliaS1naXJsLXplcm8uanBnJyxcclxuICAgICAgICAgICAgICAgICAgICBwb3dlcjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAxOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAzOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA0OiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA5OTk6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBjbGFzczogW10sXHJcbiAgICAgICAgICAgICAgICAgICAgZGlzcGxheU5hbWU6ICdDaMawYSDEkOG6t3QnLFxyXG4gICAgICAgICAgICAgICAgICAgIGVtYWlsOiAnJyxcclxuICAgICAgICAgICAgICAgICAgICBicmFuY2g6IE9iamVjdElkLmNyZWF0ZUZyb21IZXhTdHJpbmcoJzY1MDk4NWEzNDVlMmU4OTZiMzdlZmQ0ZicpLFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGNoZWNrRmlyc3QyID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdicmFuY2hzJylcclxuICAgICAgICAgICAgLmZpbmRPbmUoeyBfaWQ6IE9iamVjdElkLmNyZWF0ZUZyb21IZXhTdHJpbmcoJzY1MDk4NWEzNDVlMmU4OTZiMzdlZmQ0ZicpIH0pO1xyXG4gICAgICAgIGlmICghY2hlY2tGaXJzdDIpIHtcclxuICAgICAgICAgICAgYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ2JyYW5jaHMnKVxyXG4gICAgICAgICAgICAgICAgLmluc2VydE9uZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgX2lkOiBPYmplY3RJZC5jcmVhdGVGcm9tSGV4U3RyaW5nKCc2NTA5ODVhMzQ1ZTJlODk2YjM3ZWZkNGYnKSxcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAnQ2jGsGEgxJHhurd0JyxcclxuICAgICAgICAgICAgICAgICAgICBkZXA6IE9iamVjdElkLmNyZWF0ZUZyb21IZXhTdHJpbmcoJzY1MDk4NWEzNDVlMmU4OTZiMzdlZmQ0ZicpLFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnU1lTVEVNIHwgRVJST1IgfCBFcnJvciBjb25uZWN0aW5nIHRvIE1vbmdvREI6JywgZXJyb3IpO1xyXG4gICAgICAgIHRocm93IGVycm9yO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGNsaWVudDtcclxufVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSB7XHJcbiAgICBjb25uZWN0LFxyXG4gICAgZ2V0Q2xpZW50OiAoKSA9PiBjbGllbnQsXHJcbiAgICBnZXROYW1lR2xvYmFsOiAoKSA9PiBuYW1lX2dsb2JhbF9kYXRhYmFzZXMsXHJcbn07XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTTtFQUFFQSxRQUFRO0VBQUVDLFdBQVc7RUFBRUM7QUFBaUIsQ0FBQyxHQUFHQyxPQUFPLENBQUMsU0FBUyxDQUFDO0FBQ3RFLE1BQU1DLEdBQUcsR0FDTCw4R0FBOEc7QUFDbEgsTUFBTUMsTUFBTSxHQUFHLElBQUlKLFdBQVcsQ0FBQ0csR0FBRyxFQUFFO0VBQ2hDRSxlQUFlLEVBQUUsSUFBSTtFQUNyQkMsa0JBQWtCLEVBQUUsSUFBSTtFQUN4QkMsU0FBUyxFQUFFO0lBQ1BDLE9BQU8sRUFBRVAsZ0JBQWdCLENBQUNRLEVBQUU7SUFDNUJDLE1BQU0sRUFBRSxJQUFJO0lBQ1pDLGlCQUFpQixFQUFFO0VBQ3ZCO0FBQ0osQ0FBQyxDQUFDO0FBQ0YsTUFBTUMscUJBQXFCLEdBQUcsUUFBUTtBQUN0QyxlQUFlQyxPQUFPQSxDQUFBLEVBQUc7RUFDckIsSUFBSTtJQUNBLE1BQU1ULE1BQU0sQ0FBQ1MsT0FBTyxDQUFDLENBQUM7SUFDdEIsTUFBTUMsVUFBVSxHQUFHLE1BQU1WLE1BQU0sQ0FDMUJXLEVBQUUsQ0FBQ0gscUJBQXFCLENBQUMsQ0FDekJJLFVBQVUsQ0FBQyxXQUFXLENBQUMsQ0FDdkJDLE9BQU8sQ0FBQztNQUFFQyxHQUFHLEVBQUVuQixRQUFRLENBQUNvQixtQkFBbUIsQ0FBQywwQkFBMEI7SUFBRSxDQUFDLENBQUM7SUFDL0UsSUFBSSxDQUFDTCxVQUFVLEVBQUU7TUFDYixNQUFNVixNQUFNLENBQ1BXLEVBQUUsQ0FBQ0gscUJBQXFCLENBQUMsQ0FDekJJLFVBQVUsQ0FBQyxXQUFXLENBQUMsQ0FDdkJJLFNBQVMsQ0FBQztRQUNQRixHQUFHLEVBQUVuQixRQUFRLENBQUNvQixtQkFBbUIsQ0FBQywwQkFBMEIsQ0FBQztRQUM3REUsVUFBVSxFQUFFLEtBQUs7UUFDakJDLFNBQVMsRUFBRSxNQUFNO1FBQ2pCQyxHQUFHLEVBQUUsMEZBQTBGO1FBQy9GQyxLQUFLLEVBQUU7VUFDSCxDQUFDLEVBQUUsSUFBSTtVQUNQLENBQUMsRUFBRSxJQUFJO1VBQ1AsQ0FBQyxFQUFFLElBQUk7VUFDUCxHQUFHLEVBQUU7UUFDVCxDQUFDO1FBQ0RDLEtBQUssRUFBRSxFQUFFO1FBQ1RDLFdBQVcsRUFBRSxVQUFVO1FBQ3ZCQyxLQUFLLEVBQUUsRUFBRTtRQUNUQyxNQUFNLEVBQUU3QixRQUFRLENBQUNvQixtQkFBbUIsQ0FBQywwQkFBMEI7TUFDbkUsQ0FBQyxDQUFDO0lBQ1Y7SUFDQSxNQUFNVSxXQUFXLEdBQUcsTUFBTXpCLE1BQU0sQ0FDM0JXLEVBQUUsQ0FBQ0gscUJBQXFCLENBQUMsQ0FDekJJLFVBQVUsQ0FBQyxTQUFTLENBQUMsQ0FDckJDLE9BQU8sQ0FBQztNQUFFQyxHQUFHLEVBQUVuQixRQUFRLENBQUNvQixtQkFBbUIsQ0FBQywwQkFBMEI7SUFBRSxDQUFDLENBQUM7SUFDL0UsSUFBSSxDQUFDVSxXQUFXLEVBQUU7TUFDZCxNQUFNekIsTUFBTSxDQUNQVyxFQUFFLENBQUNILHFCQUFxQixDQUFDLENBQ3pCSSxVQUFVLENBQUMsU0FBUyxDQUFDLENBQ3JCSSxTQUFTLENBQUM7UUFDUEYsR0FBRyxFQUFFbkIsUUFBUSxDQUFDb0IsbUJBQW1CLENBQUMsMEJBQTBCLENBQUM7UUFDN0RXLElBQUksRUFBRSxVQUFVO1FBQ2hCQyxHQUFHLEVBQUVoQyxRQUFRLENBQUNvQixtQkFBbUIsQ0FBQywwQkFBMEI7TUFDaEUsQ0FBQyxDQUFDO0lBQ1Y7RUFDSixDQUFDLENBQUMsT0FBT2EsS0FBSyxFQUFFO0lBQ1pDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLCtDQUErQyxFQUFFRixLQUFLLENBQUM7SUFDbkUsTUFBTUEsS0FBSztFQUNmO0VBQ0EsT0FBTzVCLE1BQU07QUFDakI7QUFFQStCLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHO0VBQ2J2QixPQUFPO0VBQ1B3QixTQUFTLEVBQUVBLENBQUEsS0FBTWpDLE1BQU07RUFDdkJrQyxhQUFhLEVBQUVBLENBQUEsS0FBTTFCO0FBQ3pCLENBQUMiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["ObjectId","MongoClient","ServerApiVersion","require","uri","client","useNewUrlParser","useUnifiedTopology","serverApi","version","v1","strict","deprecationErrors","name_global_databases","connect","checkFirst","db","collection","findOne","_id","createFromHexString","insertOne","first_name","last_name","avt","power","class","displayName","email","branch","checkFirst2","name","dep","error","console","log","module","exports","getClient","getNameGlobal"],"sourceRoot":"D:\\project\\web\\newCDRL-1\\backend\\lib\\","sources":["mogodb_lib.js"],"sourcesContent":["const { ObjectId, MongoClient, ServerApiVersion } = require('mongodb');\r\nconst uri =\r\n    'mongodb+srv://binhminh19112003:Zr3uGIK4dCymOXON@6aesieunhan.sefjqcb.mongodb.net/?retryWrites=true&w=majority';\r\nconst client = new MongoClient(uri, {\r\n    useNewUrlParser: true,\r\n    useUnifiedTopology: true,\r\n    serverApi: {\r\n        version: ServerApiVersion.v1,\r\n        strict: true,\r\n        deprecationErrors: true,\r\n    },\r\n});\r\nconst name_global_databases = 'global';\r\nasync function connect() {\r\n    try {\r\n        await client.connect();\r\n        const checkFirst = await client\r\n            .db(name_global_databases)\r\n            .collection('user_info')\r\n            .findOne({ _id: ObjectId.createFromHexString('650985a345e2e896b37efd4f') });\r\n        if (!checkFirst) {\r\n            await client\r\n                .db(name_global_databases)\r\n                .collection('user_info')\r\n                .insertOne({\r\n                    _id: ObjectId.createFromHexString('650985a345e2e896b37efd4f'),\r\n                    first_name: 'Đặt',\r\n                    last_name: 'Chưa',\r\n                    avt: 'https://i.pinimg.com/236x/89/08/3b/89083bba40545a72fa15321af5fab760--chibi-girl-zero.jpg',\r\n                    power: {\r\n                        1: true,\r\n                        3: true,\r\n                        4: true,\r\n                        999: true,\r\n                    },\r\n                    class: [],\r\n                    displayName: 'Chưa Đặt',\r\n                    email: '',\r\n                    branch: ObjectId.createFromHexString('650985a345e2e896b37efd4f'),\r\n                });\r\n        }\r\n        const checkFirst2 = await client\r\n            .db(name_global_databases)\r\n            .collection('branchs')\r\n            .findOne({ _id: ObjectId.createFromHexString('650985a345e2e896b37efd4f') });\r\n        if (!checkFirst2) {\r\n            await client\r\n                .db(name_global_databases)\r\n                .collection('branchs')\r\n                .insertOne({\r\n                    _id: ObjectId.createFromHexString('650985a345e2e896b37efd4f'),\r\n                    name: 'Chưa đặt',\r\n                    dep: ObjectId.createFromHexString('650985a345e2e896b37efd4f'),\r\n                });\r\n        }\r\n    } catch (error) {\r\n        console.log('SYSTEM | ERROR | Error connecting to MongoDB:', error);\r\n        throw error;\r\n    }\r\n    return client;\r\n}\r\n\r\nmodule.exports = {\r\n    connect,\r\n    getClient: () => client,\r\n    getNameGlobal: () => name_global_databases,\r\n};\r\n"],"mappings":"AAAA,MAAM;EAAEA,QAAQ;EAAEC,WAAW;EAAEC;AAAiB,CAAC,GAAGC,OAAO,CAAC,SAAS,CAAC;AACtE,MAAMC,GAAG,GACL,8GAA8G;AAClH,MAAMC,MAAM,GAAG,IAAIJ,WAAW,CAACG,GAAG,EAAE;EAChCE,eAAe,EAAE,IAAI;EACrBC,kBAAkB,EAAE,IAAI;EACxBC,SAAS,EAAE;IACPC,OAAO,EAAEP,gBAAgB,CAACQ,EAAE;IAC5BC,MAAM,EAAE,IAAI;IACZC,iBAAiB,EAAE;EACvB;AACJ,CAAC,CAAC;AACF,MAAMC,qBAAqB,GAAG,QAAQ;AACtC,eAAeC,OAAOA,CAAA,EAAG;EACrB,IAAI;IACA,MAAMT,MAAM,CAACS,OAAO,CAAC,CAAC;IACtB,MAAMC,UAAU,GAAG,MAAMV,MAAM,CAC1BW,EAAE,CAACH,qBAAqB,CAAC,CACzBI,UAAU,CAAC,WAAW,CAAC,CACvBC,OAAO,CAAC;MAAEC,GAAG,EAAEnB,QAAQ,CAACoB,mBAAmB,CAAC,0BAA0B;IAAE,CAAC,CAAC;IAC/E,IAAI,CAACL,UAAU,EAAE;MACb,MAAMV,MAAM,CACPW,EAAE,CAACH,qBAAqB,CAAC,CACzBI,UAAU,CAAC,WAAW,CAAC,CACvBI,SAAS,CAAC;QACPF,GAAG,EAAEnB,QAAQ,CAACoB,mBAAmB,CAAC,0BAA0B,CAAC;QAC7DE,UAAU,EAAE,KAAK;QACjBC,SAAS,EAAE,MAAM;QACjBC,GAAG,EAAE,0FAA0F;QAC/FC,KAAK,EAAE;UACH,CAAC,EAAE,IAAI;UACP,CAAC,EAAE,IAAI;UACP,CAAC,EAAE,IAAI;UACP,GAAG,EAAE;QACT,CAAC;QACDC,KAAK,EAAE,EAAE;QACTC,WAAW,EAAE,UAAU;QACvBC,KAAK,EAAE,EAAE;QACTC,MAAM,EAAE7B,QAAQ,CAACoB,mBAAmB,CAAC,0BAA0B;MACnE,CAAC,CAAC;IACV;IACA,MAAMU,WAAW,GAAG,MAAMzB,MAAM,CAC3BW,EAAE,CAACH,qBAAqB,CAAC,CACzBI,UAAU,CAAC,SAAS,CAAC,CACrBC,OAAO,CAAC;MAAEC,GAAG,EAAEnB,QAAQ,CAACoB,mBAAmB,CAAC,0BAA0B;IAAE,CAAC,CAAC;IAC/E,IAAI,CAACU,WAAW,EAAE;MACd,MAAMzB,MAAM,CACPW,EAAE,CAACH,qBAAqB,CAAC,CACzBI,UAAU,CAAC,SAAS,CAAC,CACrBI,SAAS,CAAC;QACPF,GAAG,EAAEnB,QAAQ,CAACoB,mBAAmB,CAAC,0BAA0B,CAAC;QAC7DW,IAAI,EAAE,UAAU;QAChBC,GAAG,EAAEhC,QAAQ,CAACoB,mBAAmB,CAAC,0BAA0B;MAChE,CAAC,CAAC;IACV;EACJ,CAAC,CAAC,OAAOa,KAAK,EAAE;IACZC,OAAO,CAACC,GAAG,CAAC,+CAA+C,EAAEF,KAAK,CAAC;IACnE,MAAMA,KAAK;EACf;EACA,OAAO5B,MAAM;AACjB;AAEA+B,MAAM,CAACC,OAAO,GAAG;EACbvB,OAAO;EACPwB,SAAS,EAAEA,CAAA,KAAMjC,MAAM;EACvBkC,aAAa,EAAEA,CAAA,KAAM1B;AACzB,CAAC","ignoreList":[]}},"mtime":1705240655663},"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\project\\\\web\\\\newCDRL-1\\\\backend\\\\lib\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\project\\\\web\\\\newCDRL-1\",\"filename\":\"D:\\\\project\\\\web\\\\newCDRL-1\\\\backend\\\\lib\\\\function_lib.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\project\\\\web\\\\newCDRL-1\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.24.3:development":{"value":{"code":"const server = require('./csdl_google_lib');\nconst nodemailer = require('nodemailer');\nconst ejs = require('ejs');\nconst fs = require('fs');\nconst {\n  getClient,\n  getNameGlobal\n} = require('./mogodb_lib');\nconst client = getClient();\nconst name_global_databases = getNameGlobal();\nconst path = require('path');\nconst archiver = require('archiver');\nconst {\n  v4: uuidv4\n} = require('uuid');\nconst PdfPrinter = require('pdfmake');\nconst util = require('util');\nconst bcrypt = require('bcrypt');\nconst saltRounds = 10;\n// ------------------------------------------------------------------------------------------------\n\n// Hàm để hash mật khẩu\nfunction hashPassword(password) {\n  return bcrypt.hashSync(password, saltRounds);\n}\n\n// Hàm để so sánh mật khẩu đã nhập với mật khẩu đã hash\nfunction comparePassword(inputPassword, hashedPassword) {\n  return bcrypt.compareSync(inputPassword, hashedPassword);\n}\nasync function sendEmail(password, email) {\n  try {\n    const transporter = nodemailer.createTransport({\n      service: 'gmail',\n      auth: {\n        user: 'nguytuan04@gmail.com',\n        pass: 'unjwfrdskgezbmym'\n      }\n    });\n    const emailTXT = fs.readFileSync(path.join('src', 'emailTemplate', 'email.txt'), 'utf8');\n    const emailHTML = fs.readFileSync(path.join('src', 'emailTemplate', 'email.ejs'), 'utf8');\n    const mailOptions = {\n      from: '\"Quản lý điểm rèn luyện\" <nguytuan04@gmail.com>',\n      to: email,\n      subject: 'Yêu cầu đặt lại mật khẩu',\n      text: emailTXT.replace('${password}', password),\n      html: ejs.render(emailHTML, {\n        password: password\n      }),\n      attachments: [{\n        filename: 'image.png',\n        path: './src/img/sv_logo_dashboard.png',\n        cid: 'fs1120020a17090af28b00b00263fc1ef1aasm843048pjb10' //same cid value as in the html img src\n      }]\n    };\n    const info = await transporter.sendMail(mailOptions);\n    // Thực hiện các hoạt động hữu ích khác sau khi gửi email thành công.\n  } catch (error) {\n    console.log('SYSTEM | SEND_EMAIL | ', error);\n  }\n}\nasync function checkIfUserLoginAPI(req, res, next) {\n  const user = req.session.user;\n  if (!user) {\n    // Cookie không tồn tại, chặn truy cập\n    return res.sendStatus(403);\n  } else {\n    next();\n  }\n}\nasync function checkIfUserLoginRoute(req, res, next) {\n  const user = req.session.user;\n  if (!user) {\n    // Cookie không tồn tại, chặn truy cập\n    return res.redirect('/login');\n  } else {\n    const hslink = ['/hocsinh/nhapdiemdanhgia'];\n    const gvlink = ['/giaovien/quanlyquyen', '/giaovien/nhapdiemdanhgia', '/giaovien/danhsachbangdiem'];\n    const stf = ['/bancansu/nhapdiemdanhgia', '/bancansu/quanlihoatdong', '/bancansu/quanlihoatdong/danhgiahoatdong', '/bancansu/danhsachbangdiem'];\n    const dep = ['/doankhoa/quanlibomon', '/doankhoa/quanlilop', '/doankhoa/danhsachbangdiem', '/doankhoa/quanlicv', '/doankhoa/quanlihoatdongkhoa', '/doankhoa/danhsachsinhvien', '/doankhoa/nhapdiemdanhgia', '/doankhoa/thoihan'];\n    const fullPath = req.baseUrl + req.path;\n    if (hslink.includes(fullPath)) {\n      if (!user.pow[0]) {\n        return res.redirect('/');\n      }\n    }\n    if (gvlink.includes(fullPath)) {\n      if (!user.pow[1] && !user.pow[4]) {\n        return res.redirect('/');\n      }\n    }\n    if (stf.includes(fullPath)) {\n      if (!user.pow[0] && (!user.pow[1] || !user.pow[3])) {\n        return res.redirect('/');\n      }\n    }\n    if (dep.includes(fullPath)) {\n      if (!user.pow[8]) {\n        return res.redirect('/');\n      }\n    }\n    if (user.pow[1] && user.pow[4] || user.pow[8]) {\n      res.locals.isnotST = true;\n    }\n    if (user.pow[0]) {\n      res.locals.iskhoa = false;\n      res.locals.isbancansu = false;\n      res.locals.isgiaovien = false;\n      res.locals.isST = true;\n    } else if (user.pow[1] && user.pow[3] && !user.pow[4]) {\n      res.locals.iskhoa = false;\n      res.locals.isbancansu = true;\n      res.locals.isgiaovien = false;\n      res.locals.isST = false;\n    } else if (user.pow[1] && user.pow[3] && user.pow[4]) {\n      res.locals.iskhoa = false;\n      res.locals.isbancansu = false;\n      res.locals.isgiaovien = true;\n      res.locals.isST = false;\n    } else if (user.pow[8]) {\n      res.locals.iskhoa = true;\n      res.locals.isbancansu = false;\n      res.locals.isgiaovien = false;\n      res.locals.isST = false;\n    }\n    if (user.first == 'new_user') {\n      return res.redirect('/login/firstlogin');\n    } else if (user.first == 'otp') {\n      return res.redirect('/login/firstlogin?tile=ok');\n    } else {\n      const user_info = await client.db(name_global_databases).collection('user_info').findOne({\n        _id: user._id\n      }, {\n        projection: {\n          _id: 0,\n          avt: 1,\n          displayName: 1\n        }\n      });\n      if (user_info) {\n        res.locals.avt = user_info.avt;\n        res.locals.displayName = user_info.displayName;\n      } else {\n        res.locals.avt = '';\n        res.locals.displayName = '';\n      }\n    }\n    next();\n  }\n}\nasync function mark(table, user, mssv, data, marker, cls) {\n  // data = {\n  //   first: [],\n  //   second: [],\n  //   third: [],\n  //   fourth: [],\n  //   fifth: [],\n  //   img_ids: {},\n  //   total: 100,\n  // }\n\n  const school_year = await client.db(name_global_databases).collection('school_year').findOne({}, {\n    projection: {\n      _id: 0,\n      year: 1,\n      start_day: 1,\n      end_day: 1\n    }\n  });\n  let today = new Date().getTime();\n  let start_day = new Date(school_year.start_day).getTime();\n  let end_day = new Date(school_year.end_day).getTime();\n  let forever_day = new Date('2003-10-18').getTime(); // special date\n\n  // check if end mark time or not\n  if (start_day <= today && (today < end_day || end_day == forever_day)) {\n    // update old table if exist or insert new table\n    let update = {\n      mssv: mssv,\n      school_year: school_year.year,\n      first: data.first,\n      second: data.second,\n      third: data.third,\n      fourth: data.fourth,\n      fifth: data.fifth,\n      [`img_ids.global`]: data.img_ids,\n      total: data.total,\n      update_date: new Date()\n    };\n\n    // if table is stf_table - mark by staff members or teacher\n    if (table == '_stf_table') {\n      update.marker = marker.last_name + ' ' + marker.first_name;\n    }\n    await client.db(user.dep).collection(cls + table).createIndex({\n      mssv: 1\n    }, {\n      name: '_mssv'\n    });\n    await client.db(user.dep).collection(cls + table).updateOne({\n      mssv: mssv,\n      school_year: school_year.year\n    }, {\n      $set: update\n    }, {\n      upsert: true\n    });\n    const updated = await updateStudentTotalScore(table, school_year.year, mssv, data.total, marker.last_name + ' ' + marker.first_name);\n    if (updated) return 0;else return 2;\n  }\n  return 1;\n}\nasync function updateStudentTotalScore(table, school_year, mssv, total, marker) {\n  let step = await client.db(name_global_databases).collection('user_info').findOne({\n    _id: mssv\n  }, {\n    projection: {\n      _id: 0,\n      total_score: 1\n    }\n  });\n  if (!step.total_score[`${school_year}`]) step = 0;else step = step.total_score[`${school_year}`].step;\n\n  // update total score list for student\n  switch (table) {\n    case '_std_table':\n      if (step <= 1) {\n        await client.db(name_global_databases).collection('user_info').updateOne({\n          _id: mssv\n        }, {\n          $set: {\n            [`total_score.${school_year}.std`]: total,\n            [`total_score.${school_year}.step`]: 1\n          }\n        }, {\n          upsert: true\n        });\n        return true;\n      }\n      return false;\n    case '_stf_table':\n      if (step <= 2) {\n        await client.db(name_global_databases).collection('user_info').updateOne({\n          _id: mssv\n        }, {\n          $set: {\n            [`total_score.${school_year}.stf`]: total,\n            [`total_score.${school_year}.marker`]: marker,\n            [`total_score.${school_year}.step`]: 2\n          }\n        }, {\n          upsert: true\n        });\n        return true;\n      }\n      return false;\n    case '_dep_table':\n      await client.db(name_global_databases).collection('user_info').updateOne({\n        _id: mssv\n      }, {\n        $set: {\n          [`total_score.${school_year}.dep`]: total,\n          [`total_score.${school_year}.step`]: 3\n        }\n      }, {\n        upsert: true\n      });\n      return true;\n  }\n}\nasync function get_full_id(directoryPath, listName, listdep) {\n  let list_id = [];\n  try {\n    // Đọc các file trong thư mục một cách đồng bộ\n    for (let i = 0; i < listName.length; i++) {\n      list_id.push(await server.uploadFileToDrive(path.join(directoryPath, listName[i]), listdep[i]));\n    }\n    return list_id;\n  } catch (err) {\n    console.log('SYSTEM | GET_ID | ERR | ', err);\n  }\n}\nconst blockUnwantedPaths = (req, res, next) => {\n  // cai díu j day @rurimeiko làm lại đi // cái block user truy cập file\n  const unwantedPaths = ['/.vscode/', '/backend/', '/node_modules/', '/views/', 'package-lock.json', 'package.json', 'README.md'];\n  for (const path of unwantedPaths) {\n    if (req.url.includes(path)) {\n      return res.status(403).send('<h1 style=\"font-size: 46px;\">cut di bn oi, <a href=\"/404\">to mo</a> </a> lam d j? </h1> \\n<img src =\"https://cdn.discordapp.com/attachments/1128270011346210826/1128288383316271204/sticker.webp\"><iframe src=\"https://giphy.com/embed/qs4ll1FSxKnNHeSmom\" width=\"480\" height=\"475\" frameBorder=\"0\" class=\"giphy-embed\" allowFullScreen></iframe><p><a href=\"https://giphy.com/gifs/DogeBONK-bonk-dobo-dogebonk-qs4ll1FSxKnNHeSmom\">via GIPHY</a></p>');\n    }\n  }\n  next();\n};\nfunction randomPassword() {\n  const upperCase = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';\n  const number = '0123456789';\n  const allChars = upperCase + number;\n  return new Promise((resolve, reject) => {\n    try {\n      let password = '';\n      password += upperCase[Math.floor(Math.random() * upperCase.length)];\n      password += number[Math.floor(Math.random() * number.length)];\n      while (password.length < 6) {\n        password += allChars[Math.floor(Math.random() * allChars.length)];\n      }\n      resolve(password);\n    } catch (error) {\n      reject(error);\n    }\n  });\n}\n\n// Function to delete the file\nfunction deleteFile(filePath) {\n  fs.unlink(filePath, err => {\n    if (err) {\n      console.log('FUNCITON | LOG | Error deleting file:', err);\n    }\n  });\n}\n\n// Function to schedule the file deletion after 12 hours\nfunction scheduleFileDeletion(filePath) {\n  const twelveHours = 12 * 60 * 60 * 1000; // Convert 12 hours to milliseconds\n\n  setTimeout(() => {\n    deleteFile(filePath);\n  }, twelveHours);\n}\n\n// Function to sort name of student in list\nfunction sortStudentName(std_list) {\n  if (std_list) {\n    std_list.sort((a, b) => {\n      if (a && b) {\n        const lastFirstNameWordA = a.first_name.split(' ').pop();\n        const lastFirstNameWordB = b.first_name.split(' ').pop();\n        const firstNameComparison = lastFirstNameWordA.localeCompare(lastFirstNameWordB, 'vi', {\n          sensitivity: 'base'\n        });\n        if (firstNameComparison !== 0) {\n          return firstNameComparison;\n        }\n        return a.last_name.localeCompare(b.last_name, 'vi', {\n          sensitivity: 'base'\n        });\n      } else {\n        return std_list;\n      }\n    });\n    return std_list;\n  } else {\n    return std_list;\n  }\n}\n\n// xoá class\nasync function deleteClassApi(data, user) {\n  for (let i = 0; i < data.rm_cls.length; i++) {\n    await client.db(name_global_databases).collection('classes').deleteMany({\n      _id: data.rm_cls[i]\n    });\n    const collections = await client.db(user.dep).listCollections().toArray();\n\n    // Lặp qua từng collection và xoá nếu tên bắt đầu bằng \"lớp\"\n    for (const collection of collections) {\n      if (collection.name.startsWith(data.rm_cls[i])) {\n        await client.db(user.dep).collection(collection.name).drop();\n      }\n    }\n    // xoá học sinh đang thuộc class bên user_info (chuyển sang ghost account)\n    await client.db(name_global_databases).collection('user_info').deleteMany({\n      class: [data.rm_cls[i]],\n      'power.0': {\n        $exists: true\n      }\n    });\n    let info_search = `student_list.${user._id}`;\n    await client.db(user.dep).collection(`${data.rm_cls[i]}_activities`).updateMany({\n      [info_search]: {\n        $exists: true\n      }\n    }, {\n      $pull: {\n        student_list: user._id,\n        ai: user._id\n      }\n    });\n    await client.db(user.dep).collection('activities').updateMany({\n      [info_search]: {\n        $exists: true\n      }\n    }, {\n      $pull: {\n        student_list: user._id,\n        ai: user._id\n      }\n    });\n    await client.db(name_global_databases).collection('activities').updateMany({\n      [info_search]: {\n        $exists: true\n      }\n    }, {\n      $pull: {\n        student_list: user._id,\n        ai: user._id\n      }\n    });\n\n    // xoa lop khoi giao vien\n    await client.db(name_global_databases).collection('user_info').updateMany({\n      _id: data.rm_ts[i],\n      'power.1': {\n        $exists: true\n      },\n      'power.4': {\n        $exists: true\n      }\n    }, {\n      $pull: {\n        class: data.rm_cls[i]\n      }\n    });\n  }\n}\n\n// Function to create id for string (get all start letter of words and cobine together)\nfunction createId(str) {\n  let arr = str.toUpperCase().trim().split(' ');\n  let id = '';\n  for (let i of arr) {\n    id += i.charAt(0);\n  }\n  return id;\n}\nasync function createPdf(path_save, scorce) {\n  function sum(arr, start, end) {\n    if (arr[0] == 'N/A') {\n      return 'N/A';\n    }\n    // Đảm bảo start và end không vượt qua giới hạn của mảng\n    if (start < 0) start = 0;\n    if (end >= arr.length) end = arr.length - 1;\n\n    // Kiểm tra nếu start lớn hơn end hoặc mảng rỗng\n    if (start > end || arr.length === 0) return 0;\n\n    // Sử dụng slice và reduce để tính tổng\n    const subArray = arr.slice(start, end + 1);\n    const total = subArray.reduce((accumulator, currentValue) => accumulator + currentValue, 0);\n    return total;\n  }\n  let name_zip;\n  let output;\n  let archive;\n  // if (scorce.length > 1) {\n  name_zip = uuidv4();\n  output = fs.createWriteStream(path.join(path_save, name_zip + '.zip'));\n  archive = archiver('zip', {\n    zlib: {\n      level: 2\n    } // Mức nén, có thể là 0-9 (9 là mức nén cao nhất)\n  });\n  if (!fs.existsSync(path.join(path_save, name_zip))) {\n    // Nếu thư mục không tồn tại, tạo thư mục mới\n    fs.mkdirSync(path.join(path_save, name_zip));\n  }\n  // }\n  const createPdfAsync = util.promisify((printer, pdfDoc, outputPath, callback) => {\n    pdfDoc.pipe(fs.createWriteStream(outputPath));\n    pdfDoc.end();\n    pdfDoc.on('end', () => {\n      callback();\n    });\n  });\n  for (let index = 0; index < scorce.length; index++) {\n    // Define font files\n    const std_score = scorce[index].std;\n    const stf_score = scorce[index].stf;\n    const dep_score = scorce[index].dep;\n    let namefile;\n    // if (scorce.length > 1) {\n    namefile = scorce[index].name + '-' + scorce[index].mssv + '.pdf';\n    // } else {\n    //   namefile = uuidv4() + \".pdf\";\n    // }\n    const fonts = {\n      Roboto: {\n        normal: 'backend/font/Roboto-Regular.ttf',\n        bold: 'backend/font/Roboto-Medium.ttf',\n        italics: 'backend/font/Roboto-Italic.ttf',\n        bolditalics: 'backend/font/Roboto-MediumItalic.ttf'\n      }\n    };\n    const printer = new PdfPrinter(fonts);\n    const docDefinition = {\n      content: [{\n        text: 'Bảng điểm cá nhân',\n        style: 'header'\n      }, {\n        columns: [{\n          text: 'Tên:',\n          bold: true\n        }, scorce[index].name]\n      }, {\n        columns: [{\n          text: 'MSSV:',\n          bold: true\n        }, scorce[index].mssv]\n      }, {\n        columns: [{\n          text: 'Lớp:',\n          bold: true\n        }, scorce[index].class]\n      }, {\n        columns: [{\n          text: 'Học kỳ:',\n          bold: true\n        }, scorce[index].year]\n      },\n      // \t\t{text: 'Defining column widths', style: 'subheader'},\n      // \t\t'Tables support the same width definitions as standard columns:',\n      {\n        style: 'tableExample',\n        table: {\n          widths: [230, '*', '*', '*', '*'],\n          body: [[{\n            text: 'Nội Dung Đánh Giá',\n            style: 'tableHeader'\n          }, {\n            text: 'Điểm Tối Đa',\n            style: 'tableHeader'\n          }, {\n            text: 'Điểm SV Tự Đánh Giá',\n            style: 'tableHeader'\n          }, {\n            text: 'Tập Thể Lớp',\n            style: 'tableHeader'\n          }, {\n            text: 'Khoa Đánh Giá',\n            style: 'tableHeader'\n          }], [{\n            text: '1. Đánh giá về ý thức học tập',\n            style: 'tableSubHeader'\n          }, '', '', '', ''], [{\n            text: 'a. Ý thức, thái độ trong học tập.\\n(Nghỉ học 1 buổi không phép trừ 1 điểm; đi muộn hoặc bỏ tiết mỗi 3 lần trừ 1 điểm)',\n            style: 'tableSubSubHeader'\n          }, {\n            text: '7 điểm',\n            style: 'tablepoint'\n          }, {\n            text: `${std_score[0]} điểm`,\n            style: 'tablepoint'\n          }, {\n            text: `${stf_score[0]} điểm`,\n            style: 'tablepoint'\n          }, {\n            text: `${dep_score[0]} điểm`,\n            style: 'tablepoint'\n          }], [{\n            text: 'b. Tham gia các câu lạc bộ học thuật; các hoạt động học thuật; hoạt động ngoại khóa; hoạt động nghiên cứu khoa học',\n            style: 'tableSubSubHeader'\n          }, {\n            text: '2 điểm',\n            style: 'tablepoint'\n          }, {\n            text: `${std_score[1]} điểm`,\n            style: 'tablepoint'\n          }, {\n            text: `${stf_score[1]} điểm`,\n            style: 'tablepoint'\n          }, {\n            text: `${dep_score[1]} điểm`,\n            style: 'tablepoint'\n          }], [{\n            text: 'c. Ý thức thực hiện tốt quy chế khi tham gia các kỳ thi, cuộc thi',\n            style: 'tableSubSubHeader'\n          }, {\n            text: '4 điểm',\n            style: 'tablepoint'\n          }, {\n            text: `${std_score[2]} điểm`,\n            style: 'tablepoint'\n          }, {\n            text: `${stf_score[2]} điểm`,\n            style: 'tablepoint'\n          }, {\n            text: `${dep_score[2]} điểm`,\n            style: 'tablepoint'\n          }], [{\n            text: '- Bị nhắc nhở khi thi, kiểm tra',\n            style: 'tableSubSubSubHeader'\n          }, {\n            text: '2 điểm',\n            style: 'tablepoint'\n          }, {\n            text: std_score[2] == 2 ? '•' : '',\n            style: 'tablepoint'\n          }, {\n            text: stf_score[2] == 2 ? '•' : '',\n            style: 'tablepoint'\n          }, {\n            text: dep_score[2] == 2 ? '•' : '',\n            style: 'tablepoint'\n          }], [{\n            text: '- Bị lập biên bản xử lý khi thi và kiểm tra',\n            style: 'tableSubSubSubHeader'\n          }, {\n            text: '0 điểm',\n            style: 'tablepoint'\n          }, {\n            text: std_score[2] == 0 ? '•' : '',\n            style: 'tablepoint'\n          }, {\n            text: stf_score[2] == 0 ? '•' : '',\n            style: 'tablepoint'\n          }, {\n            text: dep_score[2] == 0 ? '•' : '',\n            style: 'tablepoint'\n          }], [{\n            text: 'd. Có tinh thần vượt khó, phấn đấu vươn lên trong học tập',\n            style: 'tableSubSubHeader'\n          }, {\n            text: '2 điểm',\n            style: 'tablepoint'\n          }, {\n            text: `${std_score[3]} điểm`,\n            style: 'tablepoint'\n          }, {\n            text: `${stf_score[3]} điểm`,\n            style: 'tablepoint'\n          }, {\n            text: `${dep_score[3]} điểm`,\n            style: 'tablepoint'\n          }], [{\n            text: 'đ. Đạt kết quả cao trong học tập',\n            style: 'tableSubSubHeader'\n          }, {\n            text: '5 điểm',\n            style: 'tablepoint'\n          }, {\n            text: `${std_score[4]} điểm`,\n            style: 'tablepoint'\n          }, {\n            text: `${stf_score[4]} điểm`,\n            style: 'tablepoint'\n          }, {\n            text: `${dep_score[4]} điểm`,\n            style: 'tablepoint'\n          }], [{\n            text: '- Loại Trung bình: Điểm số từ 2.0 đến 2.49',\n            style: 'tableSubSubSubHeader'\n          }, {\n            text: '2 điểm',\n            style: 'tablepoint'\n          }, {\n            text: std_score[4] == 2 ? '•' : '',\n            style: 'tablepoint'\n          }, {\n            text: stf_score[4] == 2 ? '•' : '',\n            style: 'tablepoint'\n          }, {\n            text: dep_score[4] == 2 ? '•' : '',\n            style: 'tablepoint'\n          }], [{\n            text: '- Loại Khá: Điểm số từ 2.5 đến 3.19',\n            style: 'tableSubSubSubHeader'\n          }, {\n            text: '3 điểm',\n            style: 'tablepoint'\n          }, {\n            text: std_score[4] == 3 ? '•' : '',\n            style: 'tablepoint'\n          }, {\n            text: stf_score[4] == 3 ? '•' : '',\n            style: 'tablepoint'\n          }, {\n            text: dep_score[4] == 3 ? '•' : '',\n            style: 'tablepoint'\n          }], [{\n            text: '- Loại Giỏi: Điểm số từ 3.2 đến 3.59',\n            style: 'tableSubSubSubHeader'\n          }, {\n            text: '4 điểm',\n            style: 'tablepoint'\n          }, {\n            text: std_score[4] == 4 ? '•' : '',\n            style: 'tablepoint'\n          }, {\n            text: stf_score[4] == 4 ? '•' : '',\n            style: 'tablepoint'\n          }, {\n            text: dep_score[4] == 4 ? '•' : '',\n            style: 'tablepoint'\n          }], [{\n            text: '- Loại Xuất sắc: Điểm số từ 3.6 đến 4.0',\n            style: 'tableSubSubSubHeader'\n          }, {\n            text: '5 điểm',\n            style: 'tablepoint'\n          }, {\n            text: std_score[4] == 5 ? '•' : '',\n            style: 'tablepoint'\n          }, {\n            text: stf_score[4] == 5 ? '•' : '',\n            style: 'tablepoint'\n          }, {\n            text: dep_score[4] == 5 ? '•' : '',\n            style: 'tablepoint'\n          }], [{\n            text: 'Điểm tối đa nội dung 1 là',\n            style: 'tableSubHeaderTotal'\n          }, {\n            text: '20 điểm',\n            style: 'tableSubPointTotal'\n          }, {\n            text: `${sum(std_score, 0, 4)} điểm`,\n            style: 'tableSubPointTotal'\n          }, {\n            text: `${sum(stf_score, 0, 4)} điểm`,\n            style: 'tableSubPointTotal'\n          }, {\n            text: `${sum(dep_score, 0, 4)} điểm`,\n            style: 'tableSubPointTotal'\n          }], [{\n            text: '2. Đánh giá về ý thức và kết quả chấp hành nội quy, quy chế, quy định trong nhà trường',\n            style: 'tableSubHeader'\n          }, '', '', '', ''], [{\n            text: 'a. Ý thức chấp hành các văn bản chỉ đạo của ngành, của cơ quan chỉ đạo cấp trên được thực hiện trong nhà trường.',\n            style: 'tableSubSubHeader'\n          }, {\n            text: '15 điểm',\n            style: 'tablepoint'\n          }, {\n            text: `${std_score[5]} điểm`,\n            style: 'tablepoint'\n          }, {\n            text: `${stf_score[5]} điểm`,\n            style: 'tablepoint'\n          }, {\n            text: `${dep_score[5]} điểm`,\n            style: 'tablepoint'\n          }], [{\n            text: '- Bị nhắc nhở trong việc thực hiện',\n            style: 'tableSubSubSubHeader'\n          }, {\n            text: '10 điểm',\n            style: 'tablepoint'\n          }, {\n            text: std_score[5] == 10 ? '•' : '',\n            style: 'tablepoint'\n          }, {\n            text: stf_score[5] == 10 ? '•' : '',\n            style: 'tablepoint'\n          }, {\n            text: dep_score[5] == 10 ? '•' : '',\n            style: 'tablepoint'\n          }], [{\n            text: '- Bị xử lý kỷ luật từ mức khiển trách trở lên',\n            style: 'tableSubSubSubHeader'\n          }, {\n            text: '0 điểm',\n            style: 'tablepoint'\n          }, {\n            text: std_score[5] == 0 ? '•' : '',\n            style: 'tablepoint'\n          }, {\n            text: stf_score[5] == 0 ? '•' : '',\n            style: 'tablepoint'\n          }, {\n            text: dep_score[5] == 0 ? '•' : '',\n            style: 'tablepoint'\n          }], [{\n            text: 'b. Ý thức chấp hành tốt, đầy đủ các nội quy, quy chế và các quy định khác của nhà trường',\n            style: 'tableSubSubHeader'\n          }, {\n            text: '10 điểm',\n            style: 'tablepoint'\n          }, {\n            text: `${std_score[6]} điểm`,\n            style: 'tablepoint'\n          }, {\n            text: `${stf_score[6]} điểm`,\n            style: 'tablepoint'\n          }, {\n            text: `${dep_score[6]} điểm`,\n            style: 'tablepoint'\n          }], [{\n            text: '- Bị nhắc nhở trong việc thực hiện',\n            style: 'tableSubSubSubHeader'\n          }, {\n            text: '5 điểm',\n            style: 'tablepoint'\n          }, {\n            text: std_score[6] == 5 ? '•' : '',\n            style: 'tablepoint'\n          }, {\n            text: stf_score[6] == 5 ? '•' : '',\n            style: 'tablepoint'\n          }, {\n            text: dep_score[6] == 5 ? '•' : '',\n            style: 'tablepoint'\n          }], [{\n            text: '- Bị xử lý kỷ luật từ mức khiển trách trở lên',\n            style: 'tableSubSubSubHeader'\n          }, {\n            text: '0 điểm',\n            style: 'tablepoint'\n          }, {\n            text: std_score[6] == 0 ? '•' : '',\n            style: 'tablepoint'\n          }, {\n            text: stf_score[6] == 0 ? '•' : '',\n            style: 'tablepoint'\n          }, {\n            text: dep_score[6] == 0 ? '•' : '',\n            style: 'tablepoint'\n          }], [{\n            text: 'Điểm tối đa nội dung 2 là',\n            style: 'tableSubHeaderTotal'\n          }, {\n            text: '25 điểm',\n            style: 'tableSubPointTotal'\n          }, {\n            text: `${sum(std_score, 5, 6)} điểm`,\n            style: 'tableSubPointTotal'\n          }, {\n            text: `${sum(stf_score, 5, 6)} điểm`,\n            style: 'tableSubPointTotal'\n          }, {\n            text: `${sum(dep_score, 5, 6)} điểm`,\n            style: 'tableSubPointTotal'\n          }],\n          //////////////\n          [{\n            text: '3. Đánh giá về ý thức và kết quả tham gia các hoạt động chính trị, xã hội, văn hoá, văn nghệ, thể thao, phòng chống tội phạm và các tệ nạn xã hội',\n            style: 'tableSubHeader'\n          }, '', '', '', ''], [{\n            text: 'a. Tham gia tích cực các hoạt động chính trị, xã hội, văn hoá, văn nghệ, thể thao và có sự trưởng thành của bản thân qua các hoạt động rèn luyện:',\n            style: 'tableSubSubHeader'\n          }, {\n            text: '8 điểm',\n            style: 'tablepoint'\n          }, {\n            text: `${std_score[7]} điểm`,\n            style: 'tablepoint'\n          }, {\n            text: `${stf_score[7]} điểm`,\n            style: 'tablepoint'\n          }, {\n            text: `${dep_score[7]} điểm`,\n            style: 'tablepoint'\n          }], [{\n            text: '- Tích cực tham gia các hoạt động chính trị, xã hội, văn hoá, văn nghệ, thể thao',\n            style: 'tableSubSubSubHeader'\n          }, {\n            text: '5 điểm',\n            style: 'tablepoint'\n          }, {\n            text: std_score[7] == 5 ? '•' : '',\n            style: 'tablepoint'\n          }, {\n            text: stf_score[7] == 5 ? '•' : '',\n            style: 'tablepoint'\n          }, {\n            text: dep_score[7] == 5 ? '•' : '',\n            style: 'tablepoint'\n          }], [{\n            text: '- Được kết nạp Đảng hoặc đạt danh hiệu Đoàn viên ưu tú hoặc đạt giải Nhất, Nhì, Ba trong các hoạt động chính trị, văn hóa, thể thao từ cấp trường trở lên',\n            style: 'tableSubSubSubHeader'\n          }, {\n            text: '8 điểm',\n            style: 'tablepoint'\n          }, {\n            text: std_score[7] == 8 ? '•' : '',\n            style: 'tablepoint'\n          }, {\n            text: stf_score[7] == 8 ? '•' : '',\n            style: 'tablepoint'\n          }, {\n            text: dep_score[7] == 8 ? '•' : '',\n            style: 'tablepoint'\n          }], [{\n            text: 'b. Tích cực tham gia các hoạt động công ích, tình nguyện, công tác xã hội',\n            style: 'tableSubSubHeader'\n          }, {\n            text: '6 điểm',\n            style: 'tablepoint'\n          }, {\n            text: `${std_score[8]} điểm`,\n            style: 'tablepoint'\n          }, {\n            text: `${stf_score[8]} điểm`,\n            style: 'tablepoint'\n          }, {\n            text: `${dep_score[8]} điểm`,\n            style: 'tablepoint'\n          }], [{\n            text: 'c. Tham gia tuyên truyền, phòng chống tội phạm, các tệ nạn xã hội và các hoạt động khác do lớp, khoa, trường, các đoàn thể, địa phương tổ chức',\n            style: 'tableSubSubHeader'\n          }, {\n            text: '6 điểm',\n            style: 'tablepoint'\n          }, {\n            text: `${std_score[9]} điểm`,\n            style: 'tablepoint'\n          }, {\n            text: `${stf_score[9]} điểm`,\n            style: 'tablepoint'\n          }, {\n            text: `${dep_score[9]} điểm`,\n            style: 'tablepoint'\n          }], [{\n            text: 'Điểm tối đa nội dung 3 là',\n            style: 'tableSubHeaderTotal'\n          }, {\n            text: '20 điểm',\n            style: 'tableSubPointTotal'\n          }, {\n            text: `${sum(std_score, 7, 9)} điểm`,\n            style: 'tableSubPointTotal'\n          }, {\n            text: `${sum(stf_score, 7, 9)} điểm`,\n            style: 'tableSubPointTotal'\n          }, {\n            text: `${sum(dep_score, 7, 9)} điểm`,\n            style: 'tableSubPointTotal'\n          }],\n          //////////\n          [{\n            text: '4. Đánh giá về ý thức công dân trong quan hệ cộng đồng',\n            style: 'tableSubHeader'\n          }, '', '', '', ''], [{\n            text: 'a. Chấp hành và tham gia tuyên truyền các chủ trương của Đảng, chính sách, pháp luật của Nhà nước tại nơi cư trú',\n            style: 'tableSubSubHeader'\n          }, {\n            text: '10 điểm',\n            style: 'tablepoint'\n          }, {\n            text: `${std_score[10]} điểm`,\n            style: 'tablepoint'\n          }, {\n            text: `${stf_score[10]} điểm`,\n            style: 'tablepoint'\n          }, {\n            text: `${dep_score[10]} điểm`,\n            style: 'tablepoint'\n          }], [{\n            text: 'b. Được ghi nhận, biểu dương, khen thưởng về tham gia các hoạt động xã hội',\n            style: 'tableSubSubHeader'\n          }, {\n            text: '5 điểm',\n            style: 'tablepoint'\n          }, {\n            text: `${std_score[11]} điểm`,\n            style: 'tablepoint'\n          }, {\n            text: `${stf_score[11]} điểm`,\n            style: 'tablepoint'\n          }, {\n            text: `${dep_score[11]} điểm`,\n            style: 'tablepoint'\n          }], [{\n            text: 'c. Có tinh thần chia sẻ, giúp đỡ bạn bè, người thân, người có hoàn cảnh khó khăn, hoạn nạn.',\n            style: 'tableSubSubHeader'\n          }, {\n            text: '10 điểm',\n            style: 'tablepoint'\n          }, {\n            text: `${std_score[12]} điểm`,\n            style: 'tablepoint'\n          }, {\n            text: `${stf_score[12]} điểm`,\n            style: 'tablepoint'\n          }, {\n            text: `${dep_score[12]} điểm`,\n            style: 'tablepoint'\n          }], [{\n            text: 'Điểm tối đa nội dung 4 là',\n            style: 'tableSubHeaderTotal'\n          }, {\n            text: '25 điểm',\n            style: 'tableSubPointTotal'\n          }, {\n            text: `${sum(std_score, 10, 12)} điểm`,\n            style: 'tableSubPointTotal'\n          }, {\n            text: `${sum(stf_score, 10, 12)} điểm`,\n            style: 'tableSubPointTotal'\n          }, {\n            text: `${sum(dep_score, 10, 12)} điểm`,\n            style: 'tableSubPointTotal'\n          }],\n          ////////\n          [{\n            text: '5. Đánh giá về ý thức và kết quả tham gia công tác phụ trách lớp, các đoàn thể, tổ chức trong nhà trường hoặc đạt được thành tích đặc biệt trong học tập, rèn luyện của học sinh, sinh viên',\n            style: 'tableSubHeader'\n          }, '', '', '', ''], [{\n            text: 'a. Tham gia tích cực vào phong trào của Lớp, Đoàn, Hội sinh viên và các công tác đoàn thể xã hội khác',\n            style: 'tableSubSubHeader'\n          }, {\n            text: '3 điểm',\n            style: 'tablepoint'\n          }, {\n            text: `${std_score[13]} điểm`,\n            style: 'tablepoint'\n          }, {\n            text: `${stf_score[13]} điểm`,\n            style: 'tablepoint'\n          }, {\n            text: `${dep_score[13]} điểm`,\n            style: 'tablepoint'\n          }], [{\n            text: 'b. Phát huy vai trò và hoàn thành tốt nhiệm vụ người cán bộ Chi đoàn, Lớp, Câu lạc bộ, Đội tự quản',\n            style: 'tableSubSubHeader'\n          }, {\n            text: '3 điểm',\n            style: 'tablepoint'\n          }, {\n            text: `${std_score[14]} điểm`,\n            style: 'tablepoint'\n          }, {\n            text: `${stf_score[14]} điểm`,\n            style: 'tablepoint'\n          }, {\n            text: `${dep_score[14]} điểm`,\n            style: 'tablepoint'\n          }], [{\n            text: 'c. Đảm nhiệm, đóng góp có hiệu quả cho công tác Đoàn trường, Hội sinh viên, Liên chi đoàn, Đội tự quản, Câu lạc bộ',\n            style: 'tableSubSubHeader'\n          }, {\n            text: '2 điểm',\n            style: 'tablepoint'\n          }, {\n            text: `${std_score[15]} điểm`,\n            style: 'tablepoint'\n          }, {\n            text: `${stf_score[15]} điểm`,\n            style: 'tablepoint'\n          }, {\n            text: `${dep_score[15]} điểm`,\n            style: 'tablepoint'\n          }], [{\n            text: 'd. Được biểu dương, khen thưởng vì có thành tích đặc biệt trong học tập, rèn luyện và các hoạt động khác',\n            style: 'tableSubSubHeader'\n          }, {\n            text: '2 điểm',\n            style: 'tablepoint'\n          }, {\n            text: `${std_score[16]} điểm`,\n            style: 'tablepoint'\n          }, {\n            text: `${stf_score[16]} điểm`,\n            style: 'tablepoint'\n          }, {\n            text: `${dep_score[16]} điểm`,\n            style: 'tablepoint'\n          }], [{\n            text: '- Cấp khoa',\n            style: 'tableSubSubSubHeader'\n          }, {\n            text: '1 điểm',\n            style: 'tablepoint'\n          }, {\n            text: std_score[16] == 1 ? '•' : '',\n            style: 'tablepoint'\n          }, {\n            text: stf_score[16] == 1 ? '•' : '',\n            style: 'tablepoint'\n          }, {\n            text: dep_score[16] == 1 ? '•' : '',\n            style: 'tablepoint'\n          }], [{\n            text: '- Cấp trường trở lên',\n            style: 'tableSubSubSubHeader'\n          }, {\n            text: '2 điểm',\n            style: 'tablepoint'\n          }, {\n            text: std_score[16] == 2 ? '•' : '',\n            style: 'tablepoint'\n          }, {\n            text: stf_score[16] == 2 ? '•' : '',\n            style: 'tablepoint'\n          }, {\n            text: dep_score[16] == 2 ? '•' : '',\n            style: 'tablepoint'\n          }], [{\n            text: 'Điểm tối đa nội dung 5 là',\n            style: 'tableSubHeaderTotal'\n          }, {\n            text: '10 điểm',\n            style: 'tableSubPointTotal'\n          }, {\n            text: `${sum(std_score, 13, 16)} điểm`,\n            style: 'tableSubPointTotal'\n          }, {\n            text: `${sum(stf_score, 13, 16)} điểm`,\n            style: 'tableSubPointTotal'\n          }, {\n            text: `${sum(dep_score, 13, 16)} điểm`,\n            style: 'tableSubPointTotal'\n          }], [{\n            text: 'Tổng điểm tối đa',\n            style: 'tableSubHeaderTotal'\n          }, {\n            text: '100 điểm',\n            style: 'tableSubPointTotal'\n          }, {\n            text: `${std_score[17]} điểm`,\n            style: 'tableSubPointTotal'\n          }, {\n            text: `${stf_score[17]} điểm`,\n            style: 'tableSubPointTotal'\n          }, {\n            text: `${dep_score[17]} điểm`,\n            style: 'tableSubPointTotal'\n          }]]\n        },\n        layout: {\n          fillColor: function (rowIndex, node, columnIndex) {\n            if (rowIndex === 0) {\n              // Màu cho hàng đầu tiên\n              return '#9fe6ff'; // Ví dụ: Màu đỏ\n            } else {\n              // Màu cho các hàng còn lại\n              return rowIndex % 2 === 0 ? '#e6e6e6' : null;\n            }\n          }\n        }\n      }, {\n        text: 'Ký tên',\n        style: 'subheader',\n        alignment: 'right',\n        margin: [0, 0, 50, 0]\n      }],\n      styles: {\n        header: {\n          fontSize: 21,\n          bold: true,\n          margin: [0, 0, 0, 10]\n        },\n        subheader: {\n          fontSize: 16,\n          bold: true,\n          margin: [0, 10, 0, 5]\n        },\n        tableExample: {\n          margin: [0, 5, 0, 15]\n        },\n        tableHeader: {\n          bold: true,\n          fontSize: 13,\n          color: 'black',\n          alignment: 'center'\n        },\n        tableSubHeader: {\n          bold: true,\n          fontSize: 12,\n          color: 'black'\n        },\n        tableSubHeaderTotal: {\n          bold: true,\n          fontSize: 12,\n          color: 'red'\n        },\n        tableSubPointTotal: {\n          bold: true,\n          fontSize: 12,\n          color: 'red',\n          alignment: 'center'\n        },\n        tableSubSubHeader: {\n          bold: true,\n          fontSize: 11,\n          color: 'black'\n        },\n        tableSubSubSubHeader: {\n          bold: true,\n          fontSize: 10,\n          color: 'black',\n          margin: [15, 0, 0, 0]\n        },\n        tablepoint: {\n          bold: true,\n          fontSize: 11,\n          color: 'black',\n          alignment: 'center'\n        }\n      },\n      defaultStyle: {\n        // alignment: 'justify'\n      }\n    };\n    options = {};\n    const pdfDoc = printer.createPdfKitDocument(docDefinition, options);\n    // if (scorce.length > 1) {\n    await createPdfAsync(printer, pdfDoc, path.join(path_save, name_zip, namefile));\n    // } else {\n    //   await createPdfAsync(printer, pdfDoc, path.join(path_save, namefile));\n    //   return namefile;\n    // }\n  }\n  // if (scorce.length > 1) {\n  archive.pipe(output);\n  archive.directory(path.join(path_save, name_zip), false);\n  archive.finalize();\n  // }\n\n  // if (scorce.length > 1) {\n  return new Promise((resolve, reject) => {\n    output.on('close', () => {\n      // console.log(\"Nén hoàn tất, kích thước:\", archive.pointer() + \" bytes\");\n      fs.rm(path.join(path_save, name_zip), {\n        recursive: true\n      }, err => {\n        if (err) {\n          console.log('CREATE_PDF | LOG | Lỗi khi xóa thư mục:', err);\n          reject(err);\n        } else {\n          // console.log(\"Đã xóa thư mục thành công.\");\n          resolve(name_zip + '.zip');\n        }\n      });\n    });\n    archive.on('error', err => {\n      console.log('CREATE_PDF | LOG | Lỗi khi nén');\n      reject(err);\n    });\n  });\n  // }\n}\nmodule.exports = {\n  sendEmail,\n  checkIfUserLoginAPI,\n  checkIfUserLoginRoute,\n  get_full_id,\n  blockUnwantedPaths,\n  mark,\n  updateStudentTotalScore,\n  randomPassword,\n  scheduleFileDeletion,\n  sortStudentName,\n  createId,\n  deleteClassApi,\n  createPdf,\n  comparePassword,\n  hashPassword\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJzZXJ2ZXIiLCJyZXF1aXJlIiwibm9kZW1haWxlciIsImVqcyIsImZzIiwiZ2V0Q2xpZW50IiwiZ2V0TmFtZUdsb2JhbCIsImNsaWVudCIsIm5hbWVfZ2xvYmFsX2RhdGFiYXNlcyIsInBhdGgiLCJhcmNoaXZlciIsInY0IiwidXVpZHY0IiwiUGRmUHJpbnRlciIsInV0aWwiLCJiY3J5cHQiLCJzYWx0Um91bmRzIiwiaGFzaFBhc3N3b3JkIiwicGFzc3dvcmQiLCJoYXNoU3luYyIsImNvbXBhcmVQYXNzd29yZCIsImlucHV0UGFzc3dvcmQiLCJoYXNoZWRQYXNzd29yZCIsImNvbXBhcmVTeW5jIiwic2VuZEVtYWlsIiwiZW1haWwiLCJ0cmFuc3BvcnRlciIsImNyZWF0ZVRyYW5zcG9ydCIsInNlcnZpY2UiLCJhdXRoIiwidXNlciIsInBhc3MiLCJlbWFpbFRYVCIsInJlYWRGaWxlU3luYyIsImpvaW4iLCJlbWFpbEhUTUwiLCJtYWlsT3B0aW9ucyIsImZyb20iLCJ0byIsInN1YmplY3QiLCJ0ZXh0IiwicmVwbGFjZSIsImh0bWwiLCJyZW5kZXIiLCJhdHRhY2htZW50cyIsImZpbGVuYW1lIiwiY2lkIiwiaW5mbyIsInNlbmRNYWlsIiwiZXJyb3IiLCJjb25zb2xlIiwibG9nIiwiY2hlY2tJZlVzZXJMb2dpbkFQSSIsInJlcSIsInJlcyIsIm5leHQiLCJzZXNzaW9uIiwic2VuZFN0YXR1cyIsImNoZWNrSWZVc2VyTG9naW5Sb3V0ZSIsInJlZGlyZWN0IiwiaHNsaW5rIiwiZ3ZsaW5rIiwic3RmIiwiZGVwIiwiZnVsbFBhdGgiLCJiYXNlVXJsIiwiaW5jbHVkZXMiLCJwb3ciLCJsb2NhbHMiLCJpc25vdFNUIiwiaXNraG9hIiwiaXNiYW5jYW5zdSIsImlzZ2lhb3ZpZW4iLCJpc1NUIiwiZmlyc3QiLCJ1c2VyX2luZm8iLCJkYiIsImNvbGxlY3Rpb24iLCJmaW5kT25lIiwiX2lkIiwicHJvamVjdGlvbiIsImF2dCIsImRpc3BsYXlOYW1lIiwibWFyayIsInRhYmxlIiwibXNzdiIsImRhdGEiLCJtYXJrZXIiLCJjbHMiLCJzY2hvb2xfeWVhciIsInllYXIiLCJzdGFydF9kYXkiLCJlbmRfZGF5IiwidG9kYXkiLCJEYXRlIiwiZ2V0VGltZSIsImZvcmV2ZXJfZGF5IiwidXBkYXRlIiwic2Vjb25kIiwidGhpcmQiLCJmb3VydGgiLCJmaWZ0aCIsImltZ19pZHMiLCJ0b3RhbCIsInVwZGF0ZV9kYXRlIiwibGFzdF9uYW1lIiwiZmlyc3RfbmFtZSIsImNyZWF0ZUluZGV4IiwibmFtZSIsInVwZGF0ZU9uZSIsIiRzZXQiLCJ1cHNlcnQiLCJ1cGRhdGVkIiwidXBkYXRlU3R1ZGVudFRvdGFsU2NvcmUiLCJzdGVwIiwidG90YWxfc2NvcmUiLCJnZXRfZnVsbF9pZCIsImRpcmVjdG9yeVBhdGgiLCJsaXN0TmFtZSIsImxpc3RkZXAiLCJsaXN0X2lkIiwiaSIsImxlbmd0aCIsInB1c2giLCJ1cGxvYWRGaWxlVG9Ecml2ZSIsImVyciIsImJsb2NrVW53YW50ZWRQYXRocyIsInVud2FudGVkUGF0aHMiLCJ1cmwiLCJzdGF0dXMiLCJzZW5kIiwicmFuZG9tUGFzc3dvcmQiLCJ1cHBlckNhc2UiLCJudW1iZXIiLCJhbGxDaGFycyIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwiZGVsZXRlRmlsZSIsImZpbGVQYXRoIiwidW5saW5rIiwic2NoZWR1bGVGaWxlRGVsZXRpb24iLCJ0d2VsdmVIb3VycyIsInNldFRpbWVvdXQiLCJzb3J0U3R1ZGVudE5hbWUiLCJzdGRfbGlzdCIsInNvcnQiLCJhIiwiYiIsImxhc3RGaXJzdE5hbWVXb3JkQSIsInNwbGl0IiwicG9wIiwibGFzdEZpcnN0TmFtZVdvcmRCIiwiZmlyc3ROYW1lQ29tcGFyaXNvbiIsImxvY2FsZUNvbXBhcmUiLCJzZW5zaXRpdml0eSIsImRlbGV0ZUNsYXNzQXBpIiwicm1fY2xzIiwiZGVsZXRlTWFueSIsImNvbGxlY3Rpb25zIiwibGlzdENvbGxlY3Rpb25zIiwidG9BcnJheSIsInN0YXJ0c1dpdGgiLCJkcm9wIiwiY2xhc3MiLCIkZXhpc3RzIiwiaW5mb19zZWFyY2giLCJ1cGRhdGVNYW55IiwiJHB1bGwiLCJzdHVkZW50X2xpc3QiLCJhaSIsInJtX3RzIiwiY3JlYXRlSWQiLCJzdHIiLCJhcnIiLCJ0b1VwcGVyQ2FzZSIsInRyaW0iLCJpZCIsImNoYXJBdCIsImNyZWF0ZVBkZiIsInBhdGhfc2F2ZSIsInNjb3JjZSIsInN1bSIsInN0YXJ0IiwiZW5kIiwic3ViQXJyYXkiLCJzbGljZSIsInJlZHVjZSIsImFjY3VtdWxhdG9yIiwiY3VycmVudFZhbHVlIiwibmFtZV96aXAiLCJvdXRwdXQiLCJhcmNoaXZlIiwiY3JlYXRlV3JpdGVTdHJlYW0iLCJ6bGliIiwibGV2ZWwiLCJleGlzdHNTeW5jIiwibWtkaXJTeW5jIiwiY3JlYXRlUGRmQXN5bmMiLCJwcm9taXNpZnkiLCJwcmludGVyIiwicGRmRG9jIiwib3V0cHV0UGF0aCIsImNhbGxiYWNrIiwicGlwZSIsIm9uIiwiaW5kZXgiLCJzdGRfc2NvcmUiLCJzdGQiLCJzdGZfc2NvcmUiLCJkZXBfc2NvcmUiLCJuYW1lZmlsZSIsImZvbnRzIiwiUm9ib3RvIiwibm9ybWFsIiwiYm9sZCIsIml0YWxpY3MiLCJib2xkaXRhbGljcyIsImRvY0RlZmluaXRpb24iLCJjb250ZW50Iiwic3R5bGUiLCJjb2x1bW5zIiwid2lkdGhzIiwiYm9keSIsImxheW91dCIsImZpbGxDb2xvciIsInJvd0luZGV4Iiwibm9kZSIsImNvbHVtbkluZGV4IiwiYWxpZ25tZW50IiwibWFyZ2luIiwic3R5bGVzIiwiaGVhZGVyIiwiZm9udFNpemUiLCJzdWJoZWFkZXIiLCJ0YWJsZUV4YW1wbGUiLCJ0YWJsZUhlYWRlciIsImNvbG9yIiwidGFibGVTdWJIZWFkZXIiLCJ0YWJsZVN1YkhlYWRlclRvdGFsIiwidGFibGVTdWJQb2ludFRvdGFsIiwidGFibGVTdWJTdWJIZWFkZXIiLCJ0YWJsZVN1YlN1YlN1YkhlYWRlciIsInRhYmxlcG9pbnQiLCJkZWZhdWx0U3R5bGUiLCJvcHRpb25zIiwiY3JlYXRlUGRmS2l0RG9jdW1lbnQiLCJkaXJlY3RvcnkiLCJmaW5hbGl6ZSIsInJtIiwicmVjdXJzaXZlIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiRDpcXHByb2plY3RcXHdlYlxcbmV3Q0RSTC0xXFxiYWNrZW5kXFxsaWJcXCIsInNvdXJjZXMiOlsiZnVuY3Rpb25fbGliLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHNlcnZlciA9IHJlcXVpcmUoJy4vY3NkbF9nb29nbGVfbGliJyk7XHJcbmNvbnN0IG5vZGVtYWlsZXIgPSByZXF1aXJlKCdub2RlbWFpbGVyJyk7XHJcbmNvbnN0IGVqcyA9IHJlcXVpcmUoJ2VqcycpO1xyXG5jb25zdCBmcyA9IHJlcXVpcmUoJ2ZzJyk7XHJcbmNvbnN0IHsgZ2V0Q2xpZW50LCBnZXROYW1lR2xvYmFsIH0gPSByZXF1aXJlKCcuL21vZ29kYl9saWInKTtcclxuY29uc3QgY2xpZW50ID0gZ2V0Q2xpZW50KCk7XHJcbmNvbnN0IG5hbWVfZ2xvYmFsX2RhdGFiYXNlcyA9IGdldE5hbWVHbG9iYWwoKTtcclxuY29uc3QgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKTtcclxuY29uc3QgYXJjaGl2ZXIgPSByZXF1aXJlKCdhcmNoaXZlcicpO1xyXG5jb25zdCB7IHY0OiB1dWlkdjQgfSA9IHJlcXVpcmUoJ3V1aWQnKTtcclxuY29uc3QgUGRmUHJpbnRlciA9IHJlcXVpcmUoJ3BkZm1ha2UnKTtcclxuY29uc3QgdXRpbCA9IHJlcXVpcmUoJ3V0aWwnKTtcclxuXHJcbmNvbnN0IGJjcnlwdCA9IHJlcXVpcmUoJ2JjcnlwdCcpO1xyXG5jb25zdCBzYWx0Um91bmRzID0gMTA7XHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuLy8gSMOgbSDEkeG7gyBoYXNoIG3huq10IGto4bqpdVxyXG5mdW5jdGlvbiBoYXNoUGFzc3dvcmQocGFzc3dvcmQpIHtcclxuICAgIHJldHVybiBiY3J5cHQuaGFzaFN5bmMocGFzc3dvcmQsIHNhbHRSb3VuZHMpO1xyXG59XHJcblxyXG4vLyBIw6BtIMSR4buDIHNvIHPDoW5oIG3huq10IGto4bqpdSDEkcOjIG5o4bqtcCB24bubaSBt4bqtdCBraOG6qXUgxJHDoyBoYXNoXHJcbmZ1bmN0aW9uIGNvbXBhcmVQYXNzd29yZChpbnB1dFBhc3N3b3JkLCBoYXNoZWRQYXNzd29yZCkge1xyXG4gICAgcmV0dXJuIGJjcnlwdC5jb21wYXJlU3luYyhpbnB1dFBhc3N3b3JkLCBoYXNoZWRQYXNzd29yZCk7XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIHNlbmRFbWFpbChwYXNzd29yZCwgZW1haWwpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgdHJhbnNwb3J0ZXIgPSBub2RlbWFpbGVyLmNyZWF0ZVRyYW5zcG9ydCh7XHJcbiAgICAgICAgICAgIHNlcnZpY2U6ICdnbWFpbCcsXHJcbiAgICAgICAgICAgIGF1dGg6IHtcclxuICAgICAgICAgICAgICAgIHVzZXI6ICduZ3V5dHVhbjA0QGdtYWlsLmNvbScsXHJcbiAgICAgICAgICAgICAgICBwYXNzOiAndW5qd2ZyZHNrZ2V6Ym15bScsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IGVtYWlsVFhUID0gZnMucmVhZEZpbGVTeW5jKHBhdGguam9pbignc3JjJywgJ2VtYWlsVGVtcGxhdGUnLCAnZW1haWwudHh0JyksICd1dGY4Jyk7XHJcbiAgICAgICAgY29uc3QgZW1haWxIVE1MID0gZnMucmVhZEZpbGVTeW5jKHBhdGguam9pbignc3JjJywgJ2VtYWlsVGVtcGxhdGUnLCAnZW1haWwuZWpzJyksICd1dGY4Jyk7XHJcblxyXG4gICAgICAgIGNvbnN0IG1haWxPcHRpb25zID0ge1xyXG4gICAgICAgICAgICBmcm9tOiAnXCJRdeG6o24gbMO9IMSRaeG7g20gcsOobiBsdXnhu4duXCIgPG5ndXl0dWFuMDRAZ21haWwuY29tPicsXHJcbiAgICAgICAgICAgIHRvOiBlbWFpbCxcclxuICAgICAgICAgICAgc3ViamVjdDogJ1nDqnUgY+G6p3UgxJHhurd0IGzhuqFpIG3huq10IGto4bqpdScsXHJcbiAgICAgICAgICAgIHRleHQ6IGVtYWlsVFhULnJlcGxhY2UoJyR7cGFzc3dvcmR9JywgcGFzc3dvcmQpLFxyXG4gICAgICAgICAgICBodG1sOiBlanMucmVuZGVyKGVtYWlsSFRNTCwgeyBwYXNzd29yZDogcGFzc3dvcmQgfSksXHJcbiAgICAgICAgICAgIGF0dGFjaG1lbnRzOiBbXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgZmlsZW5hbWU6ICdpbWFnZS5wbmcnLFxyXG4gICAgICAgICAgICAgICAgICAgIHBhdGg6ICcuL3NyYy9pbWcvc3ZfbG9nb19kYXNoYm9hcmQucG5nJyxcclxuICAgICAgICAgICAgICAgICAgICBjaWQ6ICdmczExMjAwMjBhMTcwOTBhZjI4YjAwYjAwMjYzZmMxZWYxYWFzbTg0MzA0OHBqYjEwJywgLy9zYW1lIGNpZCB2YWx1ZSBhcyBpbiB0aGUgaHRtbCBpbWcgc3JjXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBdLFxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGNvbnN0IGluZm8gPSBhd2FpdCB0cmFuc3BvcnRlci5zZW5kTWFpbChtYWlsT3B0aW9ucyk7XHJcbiAgICAgICAgLy8gVGjhu7FjIGhp4buHbiBjw6FjIGhv4bqhdCDEkeG7mW5nIGjhu691IMOtY2gga2jDoWMgc2F1IGtoaSBn4butaSBlbWFpbCB0aMOgbmggY8O0bmcuXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdTWVNURU0gfCBTRU5EX0VNQUlMIHwgJywgZXJyb3IpO1xyXG4gICAgfVxyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBjaGVja0lmVXNlckxvZ2luQVBJKHJlcSwgcmVzLCBuZXh0KSB7XHJcbiAgICBjb25zdCB1c2VyID0gcmVxLnNlc3Npb24udXNlcjtcclxuICAgIGlmICghdXNlcikge1xyXG4gICAgICAgIC8vIENvb2tpZSBraMO0bmcgdOG7k24gdOG6oWksIGNo4bq3biB0cnV5IGPhuq1wXHJcbiAgICAgICAgcmV0dXJuIHJlcy5zZW5kU3RhdHVzKDQwMyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIG5leHQoKTtcclxuICAgIH1cclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gY2hlY2tJZlVzZXJMb2dpblJvdXRlKHJlcSwgcmVzLCBuZXh0KSB7XHJcbiAgICBjb25zdCB1c2VyID0gcmVxLnNlc3Npb24udXNlcjtcclxuICAgIGlmICghdXNlcikge1xyXG4gICAgICAgIC8vIENvb2tpZSBraMO0bmcgdOG7k24gdOG6oWksIGNo4bq3biB0cnV5IGPhuq1wXHJcbiAgICAgICAgcmV0dXJuIHJlcy5yZWRpcmVjdCgnL2xvZ2luJyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbnN0IGhzbGluayA9IFsnL2hvY3NpbmgvbmhhcGRpZW1kYW5oZ2lhJ107XHJcbiAgICAgICAgY29uc3QgZ3ZsaW5rID0gWycvZ2lhb3ZpZW4vcXVhbmx5cXV5ZW4nLCAnL2dpYW92aWVuL25oYXBkaWVtZGFuaGdpYScsICcvZ2lhb3ZpZW4vZGFuaHNhY2hiYW5nZGllbSddO1xyXG4gICAgICAgIGNvbnN0IHN0ZiA9IFtcclxuICAgICAgICAgICAgJy9iYW5jYW5zdS9uaGFwZGllbWRhbmhnaWEnLFxyXG4gICAgICAgICAgICAnL2JhbmNhbnN1L3F1YW5saWhvYXRkb25nJyxcclxuICAgICAgICAgICAgJy9iYW5jYW5zdS9xdWFubGlob2F0ZG9uZy9kYW5oZ2lhaG9hdGRvbmcnLFxyXG4gICAgICAgICAgICAnL2JhbmNhbnN1L2RhbmhzYWNoYmFuZ2RpZW0nLFxyXG4gICAgICAgIF07XHJcbiAgICAgICAgY29uc3QgZGVwID0gW1xyXG4gICAgICAgICAgICAnL2RvYW5raG9hL3F1YW5saWJvbW9uJyxcclxuICAgICAgICAgICAgJy9kb2Fua2hvYS9xdWFubGlsb3AnLFxyXG4gICAgICAgICAgICAnL2RvYW5raG9hL2RhbmhzYWNoYmFuZ2RpZW0nLFxyXG4gICAgICAgICAgICAnL2RvYW5raG9hL3F1YW5saWN2JyxcclxuICAgICAgICAgICAgJy9kb2Fua2hvYS9xdWFubGlob2F0ZG9uZ2tob2EnLFxyXG4gICAgICAgICAgICAnL2RvYW5raG9hL2RhbmhzYWNoc2luaHZpZW4nLFxyXG4gICAgICAgICAgICAnL2RvYW5raG9hL25oYXBkaWVtZGFuaGdpYScsXHJcbiAgICAgICAgICAgICcvZG9hbmtob2EvdGhvaWhhbicsXHJcbiAgICAgICAgXTtcclxuICAgICAgICBjb25zdCBmdWxsUGF0aCA9IHJlcS5iYXNlVXJsICsgcmVxLnBhdGg7XHJcbiAgICAgICAgaWYgKGhzbGluay5pbmNsdWRlcyhmdWxsUGF0aCkpIHtcclxuICAgICAgICAgICAgaWYgKCF1c2VyLnBvd1swXSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5yZWRpcmVjdCgnLycpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChndmxpbmsuaW5jbHVkZXMoZnVsbFBhdGgpKSB7XHJcbiAgICAgICAgICAgIGlmICghdXNlci5wb3dbMV0gJiYgIXVzZXIucG93WzRdKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnJlZGlyZWN0KCcvJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHN0Zi5pbmNsdWRlcyhmdWxsUGF0aCkpIHtcclxuICAgICAgICAgICAgaWYgKCF1c2VyLnBvd1swXSAmJiAoIXVzZXIucG93WzFdIHx8ICF1c2VyLnBvd1szXSkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMucmVkaXJlY3QoJy8nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZGVwLmluY2x1ZGVzKGZ1bGxQYXRoKSkge1xyXG4gICAgICAgICAgICBpZiAoIXVzZXIucG93WzhdKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnJlZGlyZWN0KCcvJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICgodXNlci5wb3dbMV0gJiYgdXNlci5wb3dbNF0pIHx8IHVzZXIucG93WzhdKSB7XHJcbiAgICAgICAgICAgIHJlcy5sb2NhbHMuaXNub3RTVCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh1c2VyLnBvd1swXSkge1xyXG4gICAgICAgICAgICByZXMubG9jYWxzLmlza2hvYSA9IGZhbHNlO1xyXG4gICAgICAgICAgICByZXMubG9jYWxzLmlzYmFuY2Fuc3UgPSBmYWxzZTtcclxuICAgICAgICAgICAgcmVzLmxvY2Fscy5pc2dpYW92aWVuID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHJlcy5sb2NhbHMuaXNTVCA9IHRydWU7XHJcbiAgICAgICAgfSBlbHNlIGlmICh1c2VyLnBvd1sxXSAmJiB1c2VyLnBvd1szXSAmJiAhdXNlci5wb3dbNF0pIHtcclxuICAgICAgICAgICAgcmVzLmxvY2Fscy5pc2tob2EgPSBmYWxzZTtcclxuICAgICAgICAgICAgcmVzLmxvY2Fscy5pc2JhbmNhbnN1ID0gdHJ1ZTtcclxuICAgICAgICAgICAgcmVzLmxvY2Fscy5pc2dpYW92aWVuID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHJlcy5sb2NhbHMuaXNTVCA9IGZhbHNlO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodXNlci5wb3dbMV0gJiYgdXNlci5wb3dbM10gJiYgdXNlci5wb3dbNF0pIHtcclxuICAgICAgICAgICAgcmVzLmxvY2Fscy5pc2tob2EgPSBmYWxzZTtcclxuICAgICAgICAgICAgcmVzLmxvY2Fscy5pc2JhbmNhbnN1ID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHJlcy5sb2NhbHMuaXNnaWFvdmllbiA9IHRydWU7XHJcbiAgICAgICAgICAgIHJlcy5sb2NhbHMuaXNTVCA9IGZhbHNlO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodXNlci5wb3dbOF0pIHtcclxuICAgICAgICAgICAgcmVzLmxvY2Fscy5pc2tob2EgPSB0cnVlO1xyXG4gICAgICAgICAgICByZXMubG9jYWxzLmlzYmFuY2Fuc3UgPSBmYWxzZTtcclxuICAgICAgICAgICAgcmVzLmxvY2Fscy5pc2dpYW92aWVuID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHJlcy5sb2NhbHMuaXNTVCA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodXNlci5maXJzdCA9PSAnbmV3X3VzZXInKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMucmVkaXJlY3QoJy9sb2dpbi9maXJzdGxvZ2luJyk7XHJcbiAgICAgICAgfSBlbHNlIGlmICh1c2VyLmZpcnN0ID09ICdvdHAnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMucmVkaXJlY3QoJy9sb2dpbi9maXJzdGxvZ2luP3RpbGU9b2snKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCB1c2VyX2luZm8gPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAuY29sbGVjdGlvbigndXNlcl9pbmZvJylcclxuICAgICAgICAgICAgICAgIC5maW5kT25lKHsgX2lkOiB1c2VyLl9pZCB9LCB7IHByb2plY3Rpb246IHsgX2lkOiAwLCBhdnQ6IDEsIGRpc3BsYXlOYW1lOiAxIH0gfSk7XHJcbiAgICAgICAgICAgIGlmICh1c2VyX2luZm8pIHtcclxuICAgICAgICAgICAgICAgIHJlcy5sb2NhbHMuYXZ0ID0gdXNlcl9pbmZvLmF2dDtcclxuICAgICAgICAgICAgICAgIHJlcy5sb2NhbHMuZGlzcGxheU5hbWUgPSB1c2VyX2luZm8uZGlzcGxheU5hbWU7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXMubG9jYWxzLmF2dCA9ICcnO1xyXG4gICAgICAgICAgICAgICAgcmVzLmxvY2Fscy5kaXNwbGF5TmFtZSA9ICcnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIG5leHQoKTtcclxuICAgIH1cclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gbWFyayh0YWJsZSwgdXNlciwgbXNzdiwgZGF0YSwgbWFya2VyLCBjbHMpIHtcclxuICAgIC8vIGRhdGEgPSB7XHJcbiAgICAvLyAgIGZpcnN0OiBbXSxcclxuICAgIC8vICAgc2Vjb25kOiBbXSxcclxuICAgIC8vICAgdGhpcmQ6IFtdLFxyXG4gICAgLy8gICBmb3VydGg6IFtdLFxyXG4gICAgLy8gICBmaWZ0aDogW10sXHJcbiAgICAvLyAgIGltZ19pZHM6IHt9LFxyXG4gICAgLy8gICB0b3RhbDogMTAwLFxyXG4gICAgLy8gfVxyXG5cclxuICAgIGNvbnN0IHNjaG9vbF95ZWFyID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAuY29sbGVjdGlvbignc2Nob29sX3llYXInKVxyXG4gICAgICAgIC5maW5kT25lKFxyXG4gICAgICAgICAgICB7fSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcHJvamVjdGlvbjoge1xyXG4gICAgICAgICAgICAgICAgICAgIF9pZDogMCxcclxuICAgICAgICAgICAgICAgICAgICB5ZWFyOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0X2RheTogMSxcclxuICAgICAgICAgICAgICAgICAgICBlbmRfZGF5OiAxLFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICApO1xyXG4gICAgbGV0IHRvZGF5ID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XHJcbiAgICBsZXQgc3RhcnRfZGF5ID0gbmV3IERhdGUoc2Nob29sX3llYXIuc3RhcnRfZGF5KS5nZXRUaW1lKCk7XHJcbiAgICBsZXQgZW5kX2RheSA9IG5ldyBEYXRlKHNjaG9vbF95ZWFyLmVuZF9kYXkpLmdldFRpbWUoKTtcclxuICAgIGxldCBmb3JldmVyX2RheSA9IG5ldyBEYXRlKCcyMDAzLTEwLTE4JykuZ2V0VGltZSgpOyAvLyBzcGVjaWFsIGRhdGVcclxuXHJcbiAgICAvLyBjaGVjayBpZiBlbmQgbWFyayB0aW1lIG9yIG5vdFxyXG4gICAgaWYgKHN0YXJ0X2RheSA8PSB0b2RheSAmJiAodG9kYXkgPCBlbmRfZGF5IHx8IGVuZF9kYXkgPT0gZm9yZXZlcl9kYXkpKSB7XHJcbiAgICAgICAgLy8gdXBkYXRlIG9sZCB0YWJsZSBpZiBleGlzdCBvciBpbnNlcnQgbmV3IHRhYmxlXHJcbiAgICAgICAgbGV0IHVwZGF0ZSA9IHtcclxuICAgICAgICAgICAgbXNzdjogbXNzdixcclxuICAgICAgICAgICAgc2Nob29sX3llYXI6IHNjaG9vbF95ZWFyLnllYXIsXHJcbiAgICAgICAgICAgIGZpcnN0OiBkYXRhLmZpcnN0LFxyXG4gICAgICAgICAgICBzZWNvbmQ6IGRhdGEuc2Vjb25kLFxyXG4gICAgICAgICAgICB0aGlyZDogZGF0YS50aGlyZCxcclxuICAgICAgICAgICAgZm91cnRoOiBkYXRhLmZvdXJ0aCxcclxuICAgICAgICAgICAgZmlmdGg6IGRhdGEuZmlmdGgsXHJcbiAgICAgICAgICAgIFtgaW1nX2lkcy5nbG9iYWxgXTogZGF0YS5pbWdfaWRzLFxyXG4gICAgICAgICAgICB0b3RhbDogZGF0YS50b3RhbCxcclxuICAgICAgICAgICAgdXBkYXRlX2RhdGU6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gaWYgdGFibGUgaXMgc3RmX3RhYmxlIC0gbWFyayBieSBzdGFmZiBtZW1iZXJzIG9yIHRlYWNoZXJcclxuICAgICAgICBpZiAodGFibGUgPT0gJ19zdGZfdGFibGUnKSB7XHJcbiAgICAgICAgICAgIHVwZGF0ZS5tYXJrZXIgPSBtYXJrZXIubGFzdF9uYW1lICsgJyAnICsgbWFya2VyLmZpcnN0X25hbWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgLmRiKHVzZXIuZGVwKVxyXG4gICAgICAgICAgICAuY29sbGVjdGlvbihjbHMgKyB0YWJsZSlcclxuICAgICAgICAgICAgLmNyZWF0ZUluZGV4KFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIG1zc3Y6IDEsXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICdfbXNzdicsXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICApO1xyXG5cclxuICAgICAgICBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgLmRiKHVzZXIuZGVwKVxyXG4gICAgICAgICAgICAuY29sbGVjdGlvbihjbHMgKyB0YWJsZSlcclxuICAgICAgICAgICAgLnVwZGF0ZU9uZShcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBtc3N2OiBtc3N2LFxyXG4gICAgICAgICAgICAgICAgICAgIHNjaG9vbF95ZWFyOiBzY2hvb2xfeWVhci55ZWFyLFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2V0OiB1cGRhdGUsXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgeyB1cHNlcnQ6IHRydWUgfSxcclxuICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgY29uc3QgdXBkYXRlZCA9IGF3YWl0IHVwZGF0ZVN0dWRlbnRUb3RhbFNjb3JlKFxyXG4gICAgICAgICAgICB0YWJsZSxcclxuICAgICAgICAgICAgc2Nob29sX3llYXIueWVhcixcclxuICAgICAgICAgICAgbXNzdixcclxuICAgICAgICAgICAgZGF0YS50b3RhbCxcclxuICAgICAgICAgICAgbWFya2VyLmxhc3RfbmFtZSArICcgJyArIG1hcmtlci5maXJzdF9uYW1lLFxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIGlmICh1cGRhdGVkKSByZXR1cm4gMDtcclxuICAgICAgICBlbHNlIHJldHVybiAyO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIDE7XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVN0dWRlbnRUb3RhbFNjb3JlKHRhYmxlLCBzY2hvb2xfeWVhciwgbXNzdiwgdG90YWwsIG1hcmtlcikge1xyXG4gICAgbGV0IHN0ZXAgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgIC5jb2xsZWN0aW9uKCd1c2VyX2luZm8nKVxyXG4gICAgICAgIC5maW5kT25lKFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBfaWQ6IG1zc3YsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHByb2plY3Rpb246IHtcclxuICAgICAgICAgICAgICAgICAgICBfaWQ6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgdG90YWxfc2NvcmU6IDEsXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICk7XHJcblxyXG4gICAgaWYgKCFzdGVwLnRvdGFsX3Njb3JlW2Ake3NjaG9vbF95ZWFyfWBdKSBzdGVwID0gMDtcclxuICAgIGVsc2Ugc3RlcCA9IHN0ZXAudG90YWxfc2NvcmVbYCR7c2Nob29sX3llYXJ9YF0uc3RlcDtcclxuXHJcbiAgICAvLyB1cGRhdGUgdG90YWwgc2NvcmUgbGlzdCBmb3Igc3R1ZGVudFxyXG4gICAgc3dpdGNoICh0YWJsZSkge1xyXG4gICAgICAgIGNhc2UgJ19zdGRfdGFibGUnOlxyXG4gICAgICAgICAgICBpZiAoc3RlcCA8PSAxKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCd1c2VyX2luZm8nKVxyXG4gICAgICAgICAgICAgICAgICAgIC51cGRhdGVPbmUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogbXNzdixcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNldDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtgdG90YWxfc2NvcmUuJHtzY2hvb2xfeWVhcn0uc3RkYF06IHRvdGFsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtgdG90YWxfc2NvcmUuJHtzY2hvb2xfeWVhcn0uc3RlcGBdOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBzZXJ0OiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgY2FzZSAnX3N0Zl90YWJsZSc6XHJcbiAgICAgICAgICAgIGlmIChzdGVwIDw9IDIpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ3VzZXJfaW5mbycpXHJcbiAgICAgICAgICAgICAgICAgICAgLnVwZGF0ZU9uZShcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2lkOiBtc3N2LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2V0OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2B0b3RhbF9zY29yZS4ke3NjaG9vbF95ZWFyfS5zdGZgXTogdG90YWwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2B0b3RhbF9zY29yZS4ke3NjaG9vbF95ZWFyfS5tYXJrZXJgXTogbWFya2VyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtgdG90YWxfc2NvcmUuJHtzY2hvb2xfeWVhcn0uc3RlcGBdOiAyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBzZXJ0OiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgY2FzZSAnX2RlcF90YWJsZSc6XHJcbiAgICAgICAgICAgIGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCd1c2VyX2luZm8nKVxyXG4gICAgICAgICAgICAgICAgLnVwZGF0ZU9uZShcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogbXNzdixcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNldDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW2B0b3RhbF9zY29yZS4ke3NjaG9vbF95ZWFyfS5kZXBgXTogdG90YWwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbYHRvdGFsX3Njb3JlLiR7c2Nob29sX3llYXJ9LnN0ZXBgXTogMyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXBzZXJ0OiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gZ2V0X2Z1bGxfaWQoZGlyZWN0b3J5UGF0aCwgbGlzdE5hbWUsIGxpc3RkZXApIHtcclxuICAgIGxldCBsaXN0X2lkID0gW107XHJcbiAgICB0cnkge1xyXG4gICAgICAgIC8vIMSQ4buNYyBjw6FjIGZpbGUgdHJvbmcgdGjGsCBt4bulYyBt4buZdCBjw6FjaCDEkeG7k25nIGLhu5lcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpc3ROYW1lLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGxpc3RfaWQucHVzaChhd2FpdCBzZXJ2ZXIudXBsb2FkRmlsZVRvRHJpdmUocGF0aC5qb2luKGRpcmVjdG9yeVBhdGgsIGxpc3ROYW1lW2ldKSwgbGlzdGRlcFtpXSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbGlzdF9pZDtcclxuICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdTWVNURU0gfCBHRVRfSUQgfCBFUlIgfCAnLCBlcnIpO1xyXG4gICAgfVxyXG59XHJcblxyXG5jb25zdCBibG9ja1Vud2FudGVkUGF0aHMgPSAocmVxLCByZXMsIG5leHQpID0+IHtcclxuICAgIC8vIGNhaSBkw611IGogZGF5IEBydXJpbWVpa28gbMOgbSBs4bqhaSDEkWkgLy8gY8OhaSBibG9jayB1c2VyIHRydXkgY+G6rXAgZmlsZVxyXG4gICAgY29uc3QgdW53YW50ZWRQYXRocyA9IFtcclxuICAgICAgICAnLy52c2NvZGUvJyxcclxuICAgICAgICAnL2JhY2tlbmQvJyxcclxuICAgICAgICAnL25vZGVfbW9kdWxlcy8nLFxyXG4gICAgICAgICcvdmlld3MvJyxcclxuICAgICAgICAncGFja2FnZS1sb2NrLmpzb24nLFxyXG4gICAgICAgICdwYWNrYWdlLmpzb24nLFxyXG4gICAgICAgICdSRUFETUUubWQnLFxyXG4gICAgXTtcclxuICAgIGZvciAoY29uc3QgcGF0aCBvZiB1bndhbnRlZFBhdGhzKSB7XHJcbiAgICAgICAgaWYgKHJlcS51cmwuaW5jbHVkZXMocGF0aCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc1xyXG4gICAgICAgICAgICAgICAgLnN0YXR1cyg0MDMpXHJcbiAgICAgICAgICAgICAgICAuc2VuZChcclxuICAgICAgICAgICAgICAgICAgICAnPGgxIHN0eWxlPVwiZm9udC1zaXplOiA0NnB4O1wiPmN1dCBkaSBibiBvaSwgPGEgaHJlZj1cIi80MDRcIj50byBtbzwvYT4gPC9hPiBsYW0gZCBqPyA8L2gxPiBcXG48aW1nIHNyYyA9XCJodHRwczovL2Nkbi5kaXNjb3JkYXBwLmNvbS9hdHRhY2htZW50cy8xMTI4MjcwMDExMzQ2MjEwODI2LzExMjgyODgzODMzMTYyNzEyMDQvc3RpY2tlci53ZWJwXCI+PGlmcmFtZSBzcmM9XCJodHRwczovL2dpcGh5LmNvbS9lbWJlZC9xczRsbDFGU3hLbk5IZVNtb21cIiB3aWR0aD1cIjQ4MFwiIGhlaWdodD1cIjQ3NVwiIGZyYW1lQm9yZGVyPVwiMFwiIGNsYXNzPVwiZ2lwaHktZW1iZWRcIiBhbGxvd0Z1bGxTY3JlZW4+PC9pZnJhbWU+PHA+PGEgaHJlZj1cImh0dHBzOi8vZ2lwaHkuY29tL2dpZnMvRG9nZUJPTkstYm9uay1kb2JvLWRvZ2Vib25rLXFzNGxsMUZTeEtuTkhlU21vbVwiPnZpYSBHSVBIWTwvYT48L3A+JyxcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgbmV4dCgpO1xyXG59O1xyXG5cclxuZnVuY3Rpb24gcmFuZG9tUGFzc3dvcmQoKSB7XHJcbiAgICBjb25zdCB1cHBlckNhc2UgPSAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVonO1xyXG4gICAgY29uc3QgbnVtYmVyID0gJzAxMjM0NTY3ODknO1xyXG4gICAgY29uc3QgYWxsQ2hhcnMgPSB1cHBlckNhc2UgKyBudW1iZXI7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBsZXQgcGFzc3dvcmQgPSAnJztcclxuICAgICAgICAgICAgcGFzc3dvcmQgKz0gdXBwZXJDYXNlW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHVwcGVyQ2FzZS5sZW5ndGgpXTtcclxuICAgICAgICAgICAgcGFzc3dvcmQgKz0gbnVtYmVyW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIG51bWJlci5sZW5ndGgpXTtcclxuXHJcbiAgICAgICAgICAgIHdoaWxlIChwYXNzd29yZC5sZW5ndGggPCA2KSB7XHJcbiAgICAgICAgICAgICAgICBwYXNzd29yZCArPSBhbGxDaGFyc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBhbGxDaGFycy5sZW5ndGgpXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXNvbHZlKHBhc3N3b3JkKTtcclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICByZWplY3QoZXJyb3IpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcblxyXG4vLyBGdW5jdGlvbiB0byBkZWxldGUgdGhlIGZpbGVcclxuZnVuY3Rpb24gZGVsZXRlRmlsZShmaWxlUGF0aCkge1xyXG4gICAgZnMudW5saW5rKGZpbGVQYXRoLCAoZXJyKSA9PiB7XHJcbiAgICAgICAgaWYgKGVycikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnRlVOQ0lUT04gfCBMT0cgfCBFcnJvciBkZWxldGluZyBmaWxlOicsIGVycik7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8vIEZ1bmN0aW9uIHRvIHNjaGVkdWxlIHRoZSBmaWxlIGRlbGV0aW9uIGFmdGVyIDEyIGhvdXJzXHJcbmZ1bmN0aW9uIHNjaGVkdWxlRmlsZURlbGV0aW9uKGZpbGVQYXRoKSB7XHJcbiAgICBjb25zdCB0d2VsdmVIb3VycyA9IDEyICogNjAgKiA2MCAqIDEwMDA7IC8vIENvbnZlcnQgMTIgaG91cnMgdG8gbWlsbGlzZWNvbmRzXHJcblxyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgZGVsZXRlRmlsZShmaWxlUGF0aCk7XHJcbiAgICB9LCB0d2VsdmVIb3Vycyk7XHJcbn1cclxuXHJcbi8vIEZ1bmN0aW9uIHRvIHNvcnQgbmFtZSBvZiBzdHVkZW50IGluIGxpc3RcclxuZnVuY3Rpb24gc29ydFN0dWRlbnROYW1lKHN0ZF9saXN0KSB7XHJcbiAgICBpZiAoc3RkX2xpc3QpIHtcclxuICAgICAgICBzdGRfbGlzdC5zb3J0KChhLCBiKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChhICYmIGIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGxhc3RGaXJzdE5hbWVXb3JkQSA9IGEuZmlyc3RfbmFtZS5zcGxpdCgnICcpLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbGFzdEZpcnN0TmFtZVdvcmRCID0gYi5maXJzdF9uYW1lLnNwbGl0KCcgJykucG9wKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgZmlyc3ROYW1lQ29tcGFyaXNvbiA9IGxhc3RGaXJzdE5hbWVXb3JkQS5sb2NhbGVDb21wYXJlKGxhc3RGaXJzdE5hbWVXb3JkQiwgJ3ZpJywge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbnNpdGl2aXR5OiAnYmFzZScsXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGlmIChmaXJzdE5hbWVDb21wYXJpc29uICE9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZpcnN0TmFtZUNvbXBhcmlzb247XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGEubGFzdF9uYW1lLmxvY2FsZUNvbXBhcmUoYi5sYXN0X25hbWUsICd2aScsIHtcclxuICAgICAgICAgICAgICAgICAgICBzZW5zaXRpdml0eTogJ2Jhc2UnLFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc3RkX2xpc3Q7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gc3RkX2xpc3Q7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBzdGRfbGlzdDtcclxuICAgIH1cclxufVxyXG5cclxuLy8geG/DoSBjbGFzc1xyXG5hc3luYyBmdW5jdGlvbiBkZWxldGVDbGFzc0FwaShkYXRhLCB1c2VyKSB7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGEucm1fY2xzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgYXdhaXQgY2xpZW50LmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcykuY29sbGVjdGlvbignY2xhc3NlcycpLmRlbGV0ZU1hbnkoeyBfaWQ6IGRhdGEucm1fY2xzW2ldIH0pO1xyXG4gICAgICAgIGNvbnN0IGNvbGxlY3Rpb25zID0gYXdhaXQgY2xpZW50LmRiKHVzZXIuZGVwKS5saXN0Q29sbGVjdGlvbnMoKS50b0FycmF5KCk7XHJcblxyXG4gICAgICAgIC8vIEzhurdwIHF1YSB04burbmcgY29sbGVjdGlvbiB2w6AgeG/DoSBu4bq/dSB0w6puIGLhuq90IMSR4bqndSBi4bqxbmcgXCJs4bubcFwiXHJcbiAgICAgICAgZm9yIChjb25zdCBjb2xsZWN0aW9uIG9mIGNvbGxlY3Rpb25zKSB7XHJcbiAgICAgICAgICAgIGlmIChjb2xsZWN0aW9uLm5hbWUuc3RhcnRzV2l0aChkYXRhLnJtX2Nsc1tpXSkpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudC5kYih1c2VyLmRlcCkuY29sbGVjdGlvbihjb2xsZWN0aW9uLm5hbWUpLmRyb3AoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyB4b8OhIGjhu41jIHNpbmggxJFhbmcgdGh14buZYyBjbGFzcyBiw6puIHVzZXJfaW5mbyAoY2h1eeG7g24gc2FuZyBnaG9zdCBhY2NvdW50KVxyXG4gICAgICAgIGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAuY29sbGVjdGlvbigndXNlcl9pbmZvJylcclxuICAgICAgICAgICAgLmRlbGV0ZU1hbnkoe1xyXG4gICAgICAgICAgICAgICAgY2xhc3M6IFtkYXRhLnJtX2Nsc1tpXV0sXHJcbiAgICAgICAgICAgICAgICAncG93ZXIuMCc6IHsgJGV4aXN0czogdHJ1ZSB9LFxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbGV0IGluZm9fc2VhcmNoID0gYHN0dWRlbnRfbGlzdC4ke3VzZXIuX2lkfWA7XHJcbiAgICAgICAgYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgIC5kYih1c2VyLmRlcClcclxuICAgICAgICAgICAgLmNvbGxlY3Rpb24oYCR7ZGF0YS5ybV9jbHNbaV19X2FjdGl2aXRpZXNgKVxyXG4gICAgICAgICAgICAudXBkYXRlTWFueShcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBbaW5mb19zZWFyY2hdOiB7ICRleGlzdHM6IHRydWUgfSxcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHB1bGw6IHsgc3R1ZGVudF9saXN0OiB1c2VyLl9pZCwgYWk6IHVzZXIuX2lkIH0sXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICApO1xyXG5cclxuICAgICAgICBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgLmRiKHVzZXIuZGVwKVxyXG4gICAgICAgICAgICAuY29sbGVjdGlvbignYWN0aXZpdGllcycpXHJcbiAgICAgICAgICAgIC51cGRhdGVNYW55KFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIFtpbmZvX3NlYXJjaF06IHsgJGV4aXN0czogdHJ1ZSB9LFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAkcHVsbDogeyBzdHVkZW50X2xpc3Q6IHVzZXIuX2lkLCBhaTogdXNlci5faWQgfSxcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgIGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAuY29sbGVjdGlvbignYWN0aXZpdGllcycpXHJcbiAgICAgICAgICAgIC51cGRhdGVNYW55KFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIFtpbmZvX3NlYXJjaF06IHsgJGV4aXN0czogdHJ1ZSB9LFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAkcHVsbDogeyBzdHVkZW50X2xpc3Q6IHVzZXIuX2lkLCBhaTogdXNlci5faWQgfSxcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgIC8vIHhvYSBsb3Aga2hvaSBnaWFvIHZpZW5cclxuICAgICAgICBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ3VzZXJfaW5mbycpXHJcbiAgICAgICAgICAgIC51cGRhdGVNYW55KFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIF9pZDogZGF0YS5ybV90c1tpXSxcclxuICAgICAgICAgICAgICAgICAgICAncG93ZXIuMSc6IHsgJGV4aXN0czogdHJ1ZSB9LFxyXG4gICAgICAgICAgICAgICAgICAgICdwb3dlci40JzogeyAkZXhpc3RzOiB0cnVlIH0sXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICRwdWxsOiB7IGNsYXNzOiBkYXRhLnJtX2Nsc1tpXSB9LFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgKTtcclxuICAgIH1cclxufVxyXG5cclxuLy8gRnVuY3Rpb24gdG8gY3JlYXRlIGlkIGZvciBzdHJpbmcgKGdldCBhbGwgc3RhcnQgbGV0dGVyIG9mIHdvcmRzIGFuZCBjb2JpbmUgdG9nZXRoZXIpXHJcbmZ1bmN0aW9uIGNyZWF0ZUlkKHN0cikge1xyXG4gICAgbGV0IGFyciA9IHN0ci50b1VwcGVyQ2FzZSgpLnRyaW0oKS5zcGxpdCgnICcpO1xyXG4gICAgbGV0IGlkID0gJyc7XHJcbiAgICBmb3IgKGxldCBpIG9mIGFycikge1xyXG4gICAgICAgIGlkICs9IGkuY2hhckF0KDApO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGlkO1xyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBjcmVhdGVQZGYocGF0aF9zYXZlLCBzY29yY2UpIHtcclxuICAgIGZ1bmN0aW9uIHN1bShhcnIsIHN0YXJ0LCBlbmQpIHtcclxuICAgICAgICBpZiAoYXJyWzBdID09ICdOL0EnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnTi9BJztcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gxJDhuqNtIGLhuqNvIHN0YXJ0IHbDoCBlbmQga2jDtG5nIHbGsOG7o3QgcXVhIGdp4bubaSBo4bqhbiBj4bunYSBt4bqjbmdcclxuICAgICAgICBpZiAoc3RhcnQgPCAwKSBzdGFydCA9IDA7XHJcbiAgICAgICAgaWYgKGVuZCA+PSBhcnIubGVuZ3RoKSBlbmQgPSBhcnIubGVuZ3RoIC0gMTtcclxuXHJcbiAgICAgICAgLy8gS2nhu4NtIHRyYSBu4bq/dSBzdGFydCBs4bubbiBoxqFuIGVuZCBob+G6t2MgbeG6o25nIHLhu5duZ1xyXG4gICAgICAgIGlmIChzdGFydCA+IGVuZCB8fCBhcnIubGVuZ3RoID09PSAwKSByZXR1cm4gMDtcclxuXHJcbiAgICAgICAgLy8gU+G7rSBk4bulbmcgc2xpY2UgdsOgIHJlZHVjZSDEkeG7gyB0w61uaCB04buVbmdcclxuICAgICAgICBjb25zdCBzdWJBcnJheSA9IGFyci5zbGljZShzdGFydCwgZW5kICsgMSk7XHJcbiAgICAgICAgY29uc3QgdG90YWwgPSBzdWJBcnJheS5yZWR1Y2UoKGFjY3VtdWxhdG9yLCBjdXJyZW50VmFsdWUpID0+IGFjY3VtdWxhdG9yICsgY3VycmVudFZhbHVlLCAwKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRvdGFsO1xyXG4gICAgfVxyXG4gICAgbGV0IG5hbWVfemlwO1xyXG4gICAgbGV0IG91dHB1dDtcclxuICAgIGxldCBhcmNoaXZlO1xyXG4gICAgLy8gaWYgKHNjb3JjZS5sZW5ndGggPiAxKSB7XHJcbiAgICBuYW1lX3ppcCA9IHV1aWR2NCgpO1xyXG4gICAgb3V0cHV0ID0gZnMuY3JlYXRlV3JpdGVTdHJlYW0ocGF0aC5qb2luKHBhdGhfc2F2ZSwgbmFtZV96aXAgKyAnLnppcCcpKTtcclxuICAgIGFyY2hpdmUgPSBhcmNoaXZlcignemlwJywge1xyXG4gICAgICAgIHpsaWI6IHsgbGV2ZWw6IDIgfSwgLy8gTeG7qWMgbsOpbiwgY8OzIHRo4buDIGzDoCAwLTkgKDkgbMOgIG3hu6ljIG7DqW4gY2FvIG5o4bqldClcclxuICAgIH0pO1xyXG4gICAgaWYgKCFmcy5leGlzdHNTeW5jKHBhdGguam9pbihwYXRoX3NhdmUsIG5hbWVfemlwKSkpIHtcclxuICAgICAgICAvLyBO4bq/dSB0aMawIG3hu6VjIGtow7RuZyB04buTbiB04bqhaSwgdOG6oW8gdGjGsCBt4bulYyBt4bubaVxyXG4gICAgICAgIGZzLm1rZGlyU3luYyhwYXRoLmpvaW4ocGF0aF9zYXZlLCBuYW1lX3ppcCkpO1xyXG4gICAgfVxyXG4gICAgLy8gfVxyXG4gICAgY29uc3QgY3JlYXRlUGRmQXN5bmMgPSB1dGlsLnByb21pc2lmeSgocHJpbnRlciwgcGRmRG9jLCBvdXRwdXRQYXRoLCBjYWxsYmFjaykgPT4ge1xyXG4gICAgICAgIHBkZkRvYy5waXBlKGZzLmNyZWF0ZVdyaXRlU3RyZWFtKG91dHB1dFBhdGgpKTtcclxuICAgICAgICBwZGZEb2MuZW5kKCk7XHJcbiAgICAgICAgcGRmRG9jLm9uKCdlbmQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNhbGxiYWNrKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBzY29yY2UubGVuZ3RoOyBpbmRleCsrKSB7XHJcbiAgICAgICAgLy8gRGVmaW5lIGZvbnQgZmlsZXNcclxuICAgICAgICBjb25zdCBzdGRfc2NvcmUgPSBzY29yY2VbaW5kZXhdLnN0ZDtcclxuICAgICAgICBjb25zdCBzdGZfc2NvcmUgPSBzY29yY2VbaW5kZXhdLnN0ZjtcclxuICAgICAgICBjb25zdCBkZXBfc2NvcmUgPSBzY29yY2VbaW5kZXhdLmRlcDtcclxuICAgICAgICBsZXQgbmFtZWZpbGU7XHJcbiAgICAgICAgLy8gaWYgKHNjb3JjZS5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAgbmFtZWZpbGUgPSBzY29yY2VbaW5kZXhdLm5hbWUgKyAnLScgKyBzY29yY2VbaW5kZXhdLm1zc3YgKyAnLnBkZic7XHJcbiAgICAgICAgLy8gfSBlbHNlIHtcclxuICAgICAgICAvLyAgIG5hbWVmaWxlID0gdXVpZHY0KCkgKyBcIi5wZGZcIjtcclxuICAgICAgICAvLyB9XHJcbiAgICAgICAgY29uc3QgZm9udHMgPSB7XHJcbiAgICAgICAgICAgIFJvYm90bzoge1xyXG4gICAgICAgICAgICAgICAgbm9ybWFsOiAnYmFja2VuZC9mb250L1JvYm90by1SZWd1bGFyLnR0ZicsXHJcbiAgICAgICAgICAgICAgICBib2xkOiAnYmFja2VuZC9mb250L1JvYm90by1NZWRpdW0udHRmJyxcclxuICAgICAgICAgICAgICAgIGl0YWxpY3M6ICdiYWNrZW5kL2ZvbnQvUm9ib3RvLUl0YWxpYy50dGYnLFxyXG4gICAgICAgICAgICAgICAgYm9sZGl0YWxpY3M6ICdiYWNrZW5kL2ZvbnQvUm9ib3RvLU1lZGl1bUl0YWxpYy50dGYnLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgY29uc3QgcHJpbnRlciA9IG5ldyBQZGZQcmludGVyKGZvbnRzKTtcclxuXHJcbiAgICAgICAgY29uc3QgZG9jRGVmaW5pdGlvbiA9IHtcclxuICAgICAgICAgICAgY29udGVudDogW1xyXG4gICAgICAgICAgICAgICAgeyB0ZXh0OiAnQuG6o25nIMSRaeG7g20gY8OhIG5ow6JuJywgc3R5bGU6ICdoZWFkZXInIH0sXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uczogW3sgdGV4dDogJ1TDqm46JywgYm9sZDogdHJ1ZSB9LCBzY29yY2VbaW5kZXhdLm5hbWVdLFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBjb2x1bW5zOiBbeyB0ZXh0OiAnTVNTVjonLCBib2xkOiB0cnVlIH0sIHNjb3JjZVtpbmRleF0ubXNzdl0sXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbnM6IFt7IHRleHQ6ICdM4bubcDonLCBib2xkOiB0cnVlIH0sIHNjb3JjZVtpbmRleF0uY2xhc3NdLFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBjb2x1bW5zOiBbeyB0ZXh0OiAnSOG7jWMga+G7szonLCBib2xkOiB0cnVlIH0sIHNjb3JjZVtpbmRleF0ueWVhcl0sXHJcbiAgICAgICAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgICAgICAgIC8vIFx0XHR7dGV4dDogJ0RlZmluaW5nIGNvbHVtbiB3aWR0aHMnLCBzdHlsZTogJ3N1YmhlYWRlcid9LFxyXG4gICAgICAgICAgICAgICAgLy8gXHRcdCdUYWJsZXMgc3VwcG9ydCB0aGUgc2FtZSB3aWR0aCBkZWZpbml0aW9ucyBhcyBzdGFuZGFyZCBjb2x1bW5zOicsXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3R5bGU6ICd0YWJsZUV4YW1wbGUnLFxyXG4gICAgICAgICAgICAgICAgICAgIHRhYmxlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoczogWzIzMCwgJyonLCAnKicsICcqJywgJyonXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYm9keTogW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogJ07hu5lpIER1bmcgxJDDoW5oIEdpw6EnLCBzdHlsZTogJ3RhYmxlSGVhZGVyJyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogJ8SQaeG7g20gVOG7kWkgxJBhJywgc3R5bGU6ICd0YWJsZUhlYWRlcicgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6ICfEkGnhu4NtIFNWIFThu7EgxJDDoW5oIEdpw6EnLCBzdHlsZTogJ3RhYmxlSGVhZGVyJyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogJ1Thuq1wIFRo4buDIEzhu5twJywgc3R5bGU6ICd0YWJsZUhlYWRlcicgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6ICdLaG9hIMSQw6FuaCBHacOhJywgc3R5bGU6ICd0YWJsZUhlYWRlcicgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbeyB0ZXh0OiAnMS4gxJDDoW5oIGdpw6EgduG7gSDDvSB0aOG7qWMgaOG7jWMgdOG6rXAnLCBzdHlsZTogJ3RhYmxlU3ViSGVhZGVyJyB9LCAnJywgJycsICcnLCAnJ10sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiAnYS4gw50gdGjhu6ljLCB0aMOhaSDEkeG7mSB0cm9uZyBo4buNYyB04bqtcC5cXG4oTmdo4buJIGjhu41jIDEgYnXhu5VpIGtow7RuZyBwaMOpcCB0cuG7qyAxIMSRaeG7g207IMSRaSBtdeG7mW4gaG/hurdjIGLhu48gdGnhur90IG3hu5dpIDMgbOG6p24gdHLhu6sgMSDEkWnhu4NtKScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlOiAndGFibGVTdWJTdWJIZWFkZXInLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiAnNyDEkWnhu4NtJywgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogYCR7c3RkX3Njb3JlWzBdfSDEkWnhu4NtYCwgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogYCR7c3RmX3Njb3JlWzBdfSDEkWnhu4NtYCwgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogYCR7ZGVwX3Njb3JlWzBdfSDEkWnhu4NtYCwgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6ICdiLiBUaGFtIGdpYSBjw6FjIGPDonUgbOG6oWMgYuG7mSBo4buNYyB0aHXhuq10OyBjw6FjIGhv4bqhdCDEkeG7mW5nIGjhu41jIHRodeG6rXQ7IGhv4bqhdCDEkeG7mW5nIG5nb+G6oWkga2jDs2E7IGhv4bqhdCDEkeG7mW5nIG5naGnDqm4gY+G7qXUga2hvYSBo4buNYycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlOiAndGFibGVTdWJTdWJIZWFkZXInLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiAnMiDEkWnhu4NtJywgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogYCR7c3RkX3Njb3JlWzFdfSDEkWnhu4NtYCwgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogYCR7c3RmX3Njb3JlWzFdfSDEkWnhu4NtYCwgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogYCR7ZGVwX3Njb3JlWzFdfSDEkWnhu4NtYCwgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6ICdjLiDDnSB0aOG7qWMgdGjhu7FjIGhp4buHbiB04buRdCBxdXkgY2jhur8ga2hpIHRoYW0gZ2lhIGPDoWMga+G7syB0aGksIGN14buZYyB0aGknLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZTogJ3RhYmxlU3ViU3ViSGVhZGVyJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogJzQgxJFp4buDbScsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IGAke3N0ZF9zY29yZVsyXX0gxJFp4buDbWAsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IGAke3N0Zl9zY29yZVsyXX0gxJFp4buDbWAsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IGAke2RlcF9zY29yZVsyXX0gxJFp4buDbWAsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiAnLSBC4buLIG5o4bqvYyBuaOG7nyBraGkgdGhpLCBraeG7g20gdHJhJywgc3R5bGU6ICd0YWJsZVN1YlN1YlN1YkhlYWRlcicgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6ICcyIMSRaeG7g20nLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiBzdGRfc2NvcmVbMl0gPT0gMiA/ICfigKInIDogJycsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IHN0Zl9zY29yZVsyXSA9PSAyID8gJ+KAoicgOiAnJywgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogZGVwX3Njb3JlWzJdID09IDIgPyAn4oCiJyA6ICcnLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogJy0gQuG7iyBs4bqtcCBiacOqbiBi4bqjbiB44butIGzDvSBraGkgdGhpIHbDoCBraeG7g20gdHJhJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU6ICd0YWJsZVN1YlN1YlN1YkhlYWRlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6ICcwIMSRaeG7g20nLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiBzdGRfc2NvcmVbMl0gPT0gMCA/ICfigKInIDogJycsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IHN0Zl9zY29yZVsyXSA9PSAwID8gJ+KAoicgOiAnJywgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogZGVwX3Njb3JlWzJdID09IDAgPyAn4oCiJyA6ICcnLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogJ2QuIEPDsyB0aW5oIHRo4bqnbiB2xrDhu6N0IGtow7MsIHBo4bqlbiDEkeG6pXUgdsawxqFuIGzDqm4gdHJvbmcgaOG7jWMgdOG6rXAnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZTogJ3RhYmxlU3ViU3ViSGVhZGVyJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogJzIgxJFp4buDbScsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IGAke3N0ZF9zY29yZVszXX0gxJFp4buDbWAsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IGAke3N0Zl9zY29yZVszXX0gxJFp4buDbWAsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IGAke2RlcF9zY29yZVszXX0gxJFp4buDbWAsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiAnxJEuIMSQ4bqhdCBr4bq/dCBxdeG6oyBjYW8gdHJvbmcgaOG7jWMgdOG6rXAnLCBzdHlsZTogJ3RhYmxlU3ViU3ViSGVhZGVyJyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogJzUgxJFp4buDbScsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IGAke3N0ZF9zY29yZVs0XX0gxJFp4buDbWAsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IGAke3N0Zl9zY29yZVs0XX0gxJFp4buDbWAsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IGAke2RlcF9zY29yZVs0XX0gxJFp4buDbWAsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogJy0gTG/huqFpIFRydW5nIGLDrG5oOiDEkGnhu4NtIHPhu5EgdOG7qyAyLjAgxJHhur9uIDIuNDknLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZTogJ3RhYmxlU3ViU3ViU3ViSGVhZGVyJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogJzIgxJFp4buDbScsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IHN0ZF9zY29yZVs0XSA9PSAyID8gJ+KAoicgOiAnJywgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogc3RmX3Njb3JlWzRdID09IDIgPyAn4oCiJyA6ICcnLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiBkZXBfc2NvcmVbNF0gPT0gMiA/ICfigKInIDogJycsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogJy0gTG/huqFpIEtow6E6IMSQaeG7g20gc+G7kSB04burIDIuNSDEkeG6v24gMy4xOScsIHN0eWxlOiAndGFibGVTdWJTdWJTdWJIZWFkZXInIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiAnMyDEkWnhu4NtJywgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogc3RkX3Njb3JlWzRdID09IDMgPyAn4oCiJyA6ICcnLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiBzdGZfc2NvcmVbNF0gPT0gMyA/ICfigKInIDogJycsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IGRlcF9zY29yZVs0XSA9PSAzID8gJ+KAoicgOiAnJywgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXSxcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiAnLSBMb+G6oWkgR2nhu49pOiDEkGnhu4NtIHPhu5EgdOG7qyAzLjIgxJHhur9uIDMuNTknLCBzdHlsZTogJ3RhYmxlU3ViU3ViU3ViSGVhZGVyJyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogJzQgxJFp4buDbScsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IHN0ZF9zY29yZVs0XSA9PSA0ID8gJ+KAoicgOiAnJywgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogc3RmX3Njb3JlWzRdID09IDQgPyAn4oCiJyA6ICcnLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiBkZXBfc2NvcmVbNF0gPT0gNCA/ICfigKInIDogJycsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiAnLSBMb+G6oWkgWHXhuqV0IHPhuq9jOiDEkGnhu4NtIHPhu5EgdOG7qyAzLjYgxJHhur9uIDQuMCcsIHN0eWxlOiAndGFibGVTdWJTdWJTdWJIZWFkZXInIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiAnNSDEkWnhu4NtJywgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogc3RkX3Njb3JlWzRdID09IDUgPyAn4oCiJyA6ICcnLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiBzdGZfc2NvcmVbNF0gPT0gNSA/ICfigKInIDogJycsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IGRlcF9zY29yZVs0XSA9PSA1ID8gJ+KAoicgOiAnJywgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6ICfEkGnhu4NtIHThu5FpIMSRYSBu4buZaSBkdW5nIDEgbMOgJywgc3R5bGU6ICd0YWJsZVN1YkhlYWRlclRvdGFsJyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogJzIwIMSRaeG7g20nLCBzdHlsZTogJ3RhYmxlU3ViUG9pbnRUb3RhbCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IGAke3N1bShzdGRfc2NvcmUsIDAsIDQpfSDEkWnhu4NtYCwgc3R5bGU6ICd0YWJsZVN1YlBvaW50VG90YWwnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiBgJHtzdW0oc3RmX3Njb3JlLCAwLCA0KX0gxJFp4buDbWAsIHN0eWxlOiAndGFibGVTdWJQb2ludFRvdGFsJyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogYCR7c3VtKGRlcF9zY29yZSwgMCwgNCl9IMSRaeG7g21gLCBzdHlsZTogJ3RhYmxlU3ViUG9pbnRUb3RhbCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiAnMi4gxJDDoW5oIGdpw6EgduG7gSDDvSB0aOG7qWMgdsOgIGvhur90IHF14bqjIGNo4bqlcCBow6BuaCBu4buZaSBxdXksIHF1eSBjaOG6vywgcXV5IMSR4buLbmggdHJvbmcgbmjDoCB0csaw4budbmcnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZTogJ3RhYmxlU3ViSGVhZGVyJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6ICdhLiDDnSB0aOG7qWMgY2jhuqVwIGjDoG5oIGPDoWMgdsSDbiBi4bqjbiBjaOG7iSDEkeG6oW8gY+G7p2EgbmfDoG5oLCBj4bunYSBjxqEgcXVhbiBjaOG7iSDEkeG6oW8gY+G6pXAgdHLDqm4gxJHGsOG7o2MgdGjhu7FjIGhp4buHbiB0cm9uZyBuaMOgIHRyxrDhu51uZy4nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZTogJ3RhYmxlU3ViU3ViSGVhZGVyJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogJzE1IMSRaeG7g20nLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiBgJHtzdGRfc2NvcmVbNV19IMSRaeG7g21gLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiBgJHtzdGZfc2NvcmVbNV19IMSRaeG7g21gLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiBgJHtkZXBfc2NvcmVbNV19IMSRaeG7g21gLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogJy0gQuG7iyBuaOG6r2Mgbmjhu58gdHJvbmcgdmnhu4djIHRo4buxYyBoaeG7h24nLCBzdHlsZTogJ3RhYmxlU3ViU3ViU3ViSGVhZGVyJyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogJzEwIMSRaeG7g20nLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiBzdGRfc2NvcmVbNV0gPT0gMTAgPyAn4oCiJyA6ICcnLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiBzdGZfc2NvcmVbNV0gPT0gMTAgPyAn4oCiJyA6ICcnLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiBkZXBfc2NvcmVbNV0gPT0gMTAgPyAn4oCiJyA6ICcnLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogJy0gQuG7iyB44butIGzDvSBr4bu3IGx14bqtdCB04burIG3hu6ljIGtoaeG7g24gdHLDoWNoIHRy4bufIGzDqm4nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZTogJ3RhYmxlU3ViU3ViU3ViSGVhZGVyJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogJzAgxJFp4buDbScsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IHN0ZF9zY29yZVs1XSA9PSAwID8gJ+KAoicgOiAnJywgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogc3RmX3Njb3JlWzVdID09IDAgPyAn4oCiJyA6ICcnLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiBkZXBfc2NvcmVbNV0gPT0gMCA/ICfigKInIDogJycsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogJ2IuIMOdIHRo4bupYyBjaOG6pXAgaMOgbmggdOG7kXQsIMSR4bqneSDEkeG7pyBjw6FjIG7hu5lpIHF1eSwgcXV5IGNo4bq/IHbDoCBjw6FjIHF1eSDEkeG7i25oIGtow6FjIGPhu6dhIG5ow6AgdHLGsOG7nW5nJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU6ICd0YWJsZVN1YlN1YkhlYWRlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6ICcxMCDEkWnhu4NtJywgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogYCR7c3RkX3Njb3JlWzZdfSDEkWnhu4NtYCwgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogYCR7c3RmX3Njb3JlWzZdfSDEkWnhu4NtYCwgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogYCR7ZGVwX3Njb3JlWzZdfSDEkWnhu4NtYCwgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6ICctIELhu4sgbmjhuq9jIG5o4bufIHRyb25nIHZp4buHYyB0aOG7sWMgaGnhu4duJywgc3R5bGU6ICd0YWJsZVN1YlN1YlN1YkhlYWRlcicgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6ICc1IMSRaeG7g20nLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiBzdGRfc2NvcmVbNl0gPT0gNSA/ICfigKInIDogJycsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IHN0Zl9zY29yZVs2XSA9PSA1ID8gJ+KAoicgOiAnJywgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogZGVwX3Njb3JlWzZdID09IDUgPyAn4oCiJyA6ICcnLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogJy0gQuG7iyB44butIGzDvSBr4bu3IGx14bqtdCB04burIG3hu6ljIGtoaeG7g24gdHLDoWNoIHRy4bufIGzDqm4nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZTogJ3RhYmxlU3ViU3ViU3ViSGVhZGVyJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogJzAgxJFp4buDbScsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IHN0ZF9zY29yZVs2XSA9PSAwID8gJ+KAoicgOiAnJywgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogc3RmX3Njb3JlWzZdID09IDAgPyAn4oCiJyA6ICcnLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiBkZXBfc2NvcmVbNl0gPT0gMCA/ICfigKInIDogJycsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiAnxJBp4buDbSB04buRaSDEkWEgbuG7mWkgZHVuZyAyIGzDoCcsIHN0eWxlOiAndGFibGVTdWJIZWFkZXJUb3RhbCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6ICcyNSDEkWnhu4NtJywgc3R5bGU6ICd0YWJsZVN1YlBvaW50VG90YWwnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiBgJHtzdW0oc3RkX3Njb3JlLCA1LCA2KX0gxJFp4buDbWAsIHN0eWxlOiAndGFibGVTdWJQb2ludFRvdGFsJyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogYCR7c3VtKHN0Zl9zY29yZSwgNSwgNil9IMSRaeG7g21gLCBzdHlsZTogJ3RhYmxlU3ViUG9pbnRUb3RhbCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IGAke3N1bShkZXBfc2NvcmUsIDUsIDYpfSDEkWnhu4NtYCwgc3R5bGU6ICd0YWJsZVN1YlBvaW50VG90YWwnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLFxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vLy8vLy8vLy8vLy8vXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiAnMy4gxJDDoW5oIGdpw6EgduG7gSDDvSB0aOG7qWMgdsOgIGvhur90IHF14bqjIHRoYW0gZ2lhIGPDoWMgaG/huqF0IMSR4buZbmcgY2jDrW5oIHRy4buLLCB4w6MgaOG7mWksIHbEg24gaG/DoSwgdsSDbiBuZ2jhu4csIHRo4buDIHRoYW8sIHBow7JuZyBjaOG7kW5nIHThu5lpIHBo4bqhbSB2w6AgY8OhYyB04buHIG7huqFuIHjDoyBo4buZaScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlOiAndGFibGVTdWJIZWFkZXInLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogJ2EuIFRoYW0gZ2lhIHTDrWNoIGPhu7FjIGPDoWMgaG/huqF0IMSR4buZbmcgY2jDrW5oIHRy4buLLCB4w6MgaOG7mWksIHbEg24gaG/DoSwgdsSDbiBuZ2jhu4csIHRo4buDIHRoYW8gdsOgIGPDsyBz4buxIHRyxrDhu59uZyB0aMOgbmggY+G7p2EgYuG6o24gdGjDom4gcXVhIGPDoWMgaG/huqF0IMSR4buZbmcgcsOobiBsdXnhu4duOicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlOiAndGFibGVTdWJTdWJIZWFkZXInLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiAnOCDEkWnhu4NtJywgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogYCR7c3RkX3Njb3JlWzddfSDEkWnhu4NtYCwgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogYCR7c3RmX3Njb3JlWzddfSDEkWnhu4NtYCwgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogYCR7ZGVwX3Njb3JlWzddfSDEkWnhu4NtYCwgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6ICctIFTDrWNoIGPhu7FjIHRoYW0gZ2lhIGPDoWMgaG/huqF0IMSR4buZbmcgY2jDrW5oIHRy4buLLCB4w6MgaOG7mWksIHbEg24gaG/DoSwgdsSDbiBuZ2jhu4csIHRo4buDIHRoYW8nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZTogJ3RhYmxlU3ViU3ViU3ViSGVhZGVyJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogJzUgxJFp4buDbScsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IHN0ZF9zY29yZVs3XSA9PSA1ID8gJ+KAoicgOiAnJywgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogc3RmX3Njb3JlWzddID09IDUgPyAn4oCiJyA6ICcnLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiBkZXBfc2NvcmVbN10gPT0gNSA/ICfigKInIDogJycsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiAnLSDEkMaw4bujYyBr4bq/dCBu4bqhcCDEkOG6o25nIGhv4bq3YyDEkeG6oXQgZGFuaCBoaeG7h3UgxJBvw6BuIHZpw6puIMawdSB0w7ogaG/hurdjIMSR4bqhdCBnaeG6o2kgTmjhuqV0LCBOaMOsLCBCYSB0cm9uZyBjw6FjIGhv4bqhdCDEkeG7mW5nIGNow61uaCB0cuG7iywgdsSDbiBow7NhLCB0aOG7gyB0aGFvIHThu6sgY+G6pXAgdHLGsOG7nW5nIHRy4bufIGzDqm4nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZTogJ3RhYmxlU3ViU3ViU3ViSGVhZGVyJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogJzggxJFp4buDbScsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IHN0ZF9zY29yZVs3XSA9PSA4ID8gJ+KAoicgOiAnJywgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogc3RmX3Njb3JlWzddID09IDggPyAn4oCiJyA6ICcnLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiBkZXBfc2NvcmVbN10gPT0gOCA/ICfigKInIDogJycsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogJ2IuIFTDrWNoIGPhu7FjIHRoYW0gZ2lhIGPDoWMgaG/huqF0IMSR4buZbmcgY8O0bmcgw61jaCwgdMOsbmggbmd1eeG7h24sIGPDtG5nIHTDoWMgeMOjIGjhu5lpJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU6ICd0YWJsZVN1YlN1YkhlYWRlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6ICc2IMSRaeG7g20nLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiBgJHtzdGRfc2NvcmVbOF19IMSRaeG7g21gLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiBgJHtzdGZfc2NvcmVbOF19IMSRaeG7g21gLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiBgJHtkZXBfc2NvcmVbOF19IMSRaeG7g21gLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogJ2MuIFRoYW0gZ2lhIHR1ecOqbiB0cnV54buBbiwgcGjDsm5nIGNo4buRbmcgdOG7mWkgcGjhuqFtLCBjw6FjIHThu4cgbuG6oW4geMOjIGjhu5lpIHbDoCBjw6FjIGhv4bqhdCDEkeG7mW5nIGtow6FjIGRvIGzhu5twLCBraG9hLCB0csaw4budbmcsIGPDoWMgxJFvw6BuIHRo4buDLCDEkeG7i2EgcGjGsMahbmcgdOG7lSBjaOG7qWMnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZTogJ3RhYmxlU3ViU3ViSGVhZGVyJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogJzYgxJFp4buDbScsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IGAke3N0ZF9zY29yZVs5XX0gxJFp4buDbWAsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IGAke3N0Zl9zY29yZVs5XX0gxJFp4buDbWAsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IGAke2RlcF9zY29yZVs5XX0gxJFp4buDbWAsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogJ8SQaeG7g20gdOG7kWkgxJFhIG7hu5lpIGR1bmcgMyBsw6AnLCBzdHlsZTogJ3RhYmxlU3ViSGVhZGVyVG90YWwnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiAnMjAgxJFp4buDbScsIHN0eWxlOiAndGFibGVTdWJQb2ludFRvdGFsJyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogYCR7c3VtKHN0ZF9zY29yZSwgNywgOSl9IMSRaeG7g21gLCBzdHlsZTogJ3RhYmxlU3ViUG9pbnRUb3RhbCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IGAke3N1bShzdGZfc2NvcmUsIDcsIDkpfSDEkWnhu4NtYCwgc3R5bGU6ICd0YWJsZVN1YlBvaW50VG90YWwnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiBgJHtzdW0oZGVwX3Njb3JlLCA3LCA5KX0gxJFp4buDbWAsIHN0eWxlOiAndGFibGVTdWJQb2ludFRvdGFsJyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vLy8vLy8vLy9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6ICc0LiDEkMOhbmggZ2nDoSB24buBIMO9IHRo4bupYyBjw7RuZyBkw6JuIHRyb25nIHF1YW4gaOG7hyBj4buZbmcgxJHhu5NuZycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlOiAndGFibGVTdWJIZWFkZXInLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogJ2EuIENo4bqlcCBow6BuaCB2w6AgdGhhbSBnaWEgdHV5w6puIHRydXnhu4FuIGPDoWMgY2jhu6cgdHLGsMahbmcgY+G7p2EgxJDhuqNuZywgY2jDrW5oIHPDoWNoLCBwaMOhcCBsdeG6rXQgY+G7p2EgTmjDoCBuxrDhu5tjIHThuqFpIG7GoWkgY8awIHRyw7onLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZTogJ3RhYmxlU3ViU3ViSGVhZGVyJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogJzEwIMSRaeG7g20nLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiBgJHtzdGRfc2NvcmVbMTBdfSDEkWnhu4NtYCwgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogYCR7c3RmX3Njb3JlWzEwXX0gxJFp4buDbWAsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IGAke2RlcF9zY29yZVsxMF19IMSRaeG7g21gLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLFxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6ICdiLiDEkMaw4bujYyBnaGkgbmjhuq1uLCBiaeG7g3UgZMawxqFuZywga2hlbiB0aMaw4bufbmcgduG7gSB0aGFtIGdpYSBjw6FjIGhv4bqhdCDEkeG7mW5nIHjDoyBo4buZaScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlOiAndGFibGVTdWJTdWJIZWFkZXInLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiAnNSDEkWnhu4NtJywgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogYCR7c3RkX3Njb3JlWzExXX0gxJFp4buDbWAsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IGAke3N0Zl9zY29yZVsxMV19IMSRaeG7g21gLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiBgJHtkZXBfc2NvcmVbMTFdfSDEkWnhu4NtYCwgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6ICdjLiBDw7MgdGluaCB0aOG6p24gY2hpYSBz4bq7LCBnacO6cCDEkeG7oSBi4bqhbiBiw6gsIG5nxrDhu51pIHRow6JuLCBuZ8aw4budaSBjw7MgaG/DoG4gY+G6o25oIGtow7Mga2jEg24sIGhv4bqhbiBu4bqhbi4nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZTogJ3RhYmxlU3ViU3ViSGVhZGVyJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogJzEwIMSRaeG7g20nLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiBgJHtzdGRfc2NvcmVbMTJdfSDEkWnhu4NtYCwgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogYCR7c3RmX3Njb3JlWzEyXX0gxJFp4buDbWAsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IGAke2RlcF9zY29yZVsxMl19IMSRaeG7g21gLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLFxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6ICfEkGnhu4NtIHThu5FpIMSRYSBu4buZaSBkdW5nIDQgbMOgJywgc3R5bGU6ICd0YWJsZVN1YkhlYWRlclRvdGFsJyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogJzI1IMSRaeG7g20nLCBzdHlsZTogJ3RhYmxlU3ViUG9pbnRUb3RhbCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IGAke3N1bShzdGRfc2NvcmUsIDEwLCAxMil9IMSRaeG7g21gLCBzdHlsZTogJ3RhYmxlU3ViUG9pbnRUb3RhbCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IGAke3N1bShzdGZfc2NvcmUsIDEwLCAxMil9IMSRaeG7g21gLCBzdHlsZTogJ3RhYmxlU3ViUG9pbnRUb3RhbCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IGAke3N1bShkZXBfc2NvcmUsIDEwLCAxMil9IMSRaeG7g21gLCBzdHlsZTogJ3RhYmxlU3ViUG9pbnRUb3RhbCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLy8vLy8vL1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogJzUuIMSQw6FuaCBnacOhIHbhu4Egw70gdGjhu6ljIHbDoCBr4bq/dCBxdeG6oyB0aGFtIGdpYSBjw7RuZyB0w6FjIHBo4bulIHRyw6FjaCBs4bubcCwgY8OhYyDEkW/DoG4gdGjhu4MsIHThu5UgY2jhu6ljIHRyb25nIG5ow6AgdHLGsOG7nW5nIGhv4bq3YyDEkeG6oXQgxJHGsOG7o2MgdGjDoG5oIHTDrWNoIMSR4bq3YyBiaeG7h3QgdHJvbmcgaOG7jWMgdOG6rXAsIHLDqG4gbHV54buHbiBj4bunYSBo4buNYyBzaW5oLCBzaW5oIHZpw6puJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU6ICd0YWJsZVN1YkhlYWRlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiAnYS4gVGhhbSBnaWEgdMOtY2ggY+G7sWMgdsOgbyBwaG9uZyB0csOgbyBj4bunYSBM4bubcCwgxJBvw6BuLCBI4buZaSBzaW5oIHZpw6puIHbDoCBjw6FjIGPDtG5nIHTDoWMgxJFvw6BuIHRo4buDIHjDoyBo4buZaSBraMOhYycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlOiAndGFibGVTdWJTdWJIZWFkZXInLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiAnMyDEkWnhu4NtJywgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogYCR7c3RkX3Njb3JlWzEzXX0gxJFp4buDbWAsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IGAke3N0Zl9zY29yZVsxM119IMSRaeG7g21gLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiBgJHtkZXBfc2NvcmVbMTNdfSDEkWnhu4NtYCwgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXSxcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiAnYi4gUGjDoXQgaHV5IHZhaSB0csOyIHbDoCBob8OgbiB0aMOgbmggdOG7kXQgbmhp4buHbSB24bulIG5nxrDhu51pIGPDoW4gYuG7mSBDaGkgxJFvw6BuLCBM4bubcCwgQ8OidSBs4bqhYyBi4buZLCDEkOG7mWkgdOG7sSBxdeG6o24nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZTogJ3RhYmxlU3ViU3ViSGVhZGVyJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogJzMgxJFp4buDbScsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IGAke3N0ZF9zY29yZVsxNF19IMSRaeG7g21gLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiBgJHtzdGZfc2NvcmVbMTRdfSDEkWnhu4NtYCwgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogYCR7ZGVwX3Njb3JlWzE0XX0gxJFp4buDbWAsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiAnYy4gxJDhuqNtIG5oaeG7h20sIMSRw7NuZyBnw7NwIGPDsyBoaeG7h3UgcXXhuqMgY2hvIGPDtG5nIHTDoWMgxJBvw6BuIHRyxrDhu51uZywgSOG7mWkgc2luaCB2acOqbiwgTGnDqm4gY2hpIMSRb8OgbiwgxJDhu5lpIHThu7EgcXXhuqNuLCBDw6J1IGzhuqFjIGLhu5knLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZTogJ3RhYmxlU3ViU3ViSGVhZGVyJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogJzIgxJFp4buDbScsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IGAke3N0ZF9zY29yZVsxNV19IMSRaeG7g21gLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiBgJHtzdGZfc2NvcmVbMTVdfSDEkWnhu4NtYCwgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogYCR7ZGVwX3Njb3JlWzE1XX0gxJFp4buDbWAsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiAnZC4gxJDGsOG7o2MgYmnhu4N1IGTGsMahbmcsIGtoZW4gdGjGsOG7n25nIHbDrCBjw7MgdGjDoG5oIHTDrWNoIMSR4bq3YyBiaeG7h3QgdHJvbmcgaOG7jWMgdOG6rXAsIHLDqG4gbHV54buHbiB2w6AgY8OhYyBob+G6oXQgxJHhu5luZyBraMOhYycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlOiAndGFibGVTdWJTdWJIZWFkZXInLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiAnMiDEkWnhu4NtJywgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogYCR7c3RkX3Njb3JlWzE2XX0gxJFp4buDbWAsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IGAke3N0Zl9zY29yZVsxNl19IMSRaeG7g21gLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiBgJHtkZXBfc2NvcmVbMTZdfSDEkWnhu4NtYCwgc3R5bGU6ICd0YWJsZXBvaW50JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXSxcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiAnLSBD4bqlcCBraG9hJywgc3R5bGU6ICd0YWJsZVN1YlN1YlN1YkhlYWRlcicgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6ICcxIMSRaeG7g20nLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiBzdGRfc2NvcmVbMTZdID09IDEgPyAn4oCiJyA6ICcnLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiBzdGZfc2NvcmVbMTZdID09IDEgPyAn4oCiJyA6ICcnLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiBkZXBfc2NvcmVbMTZdID09IDEgPyAn4oCiJyA6ICcnLCBzdHlsZTogJ3RhYmxlcG9pbnQnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogJy0gQ+G6pXAgdHLGsOG7nW5nIHRy4bufIGzDqm4nLCBzdHlsZTogJ3RhYmxlU3ViU3ViU3ViSGVhZGVyJyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogJzIgxJFp4buDbScsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IHN0ZF9zY29yZVsxNl0gPT0gMiA/ICfigKInIDogJycsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IHN0Zl9zY29yZVsxNl0gPT0gMiA/ICfigKInIDogJycsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IGRlcF9zY29yZVsxNl0gPT0gMiA/ICfigKInIDogJycsIHN0eWxlOiAndGFibGVwb2ludCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogJ8SQaeG7g20gdOG7kWkgxJFhIG7hu5lpIGR1bmcgNSBsw6AnLCBzdHlsZTogJ3RhYmxlU3ViSGVhZGVyVG90YWwnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiAnMTAgxJFp4buDbScsIHN0eWxlOiAndGFibGVTdWJQb2ludFRvdGFsJyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogYCR7c3VtKHN0ZF9zY29yZSwgMTMsIDE2KX0gxJFp4buDbWAsIHN0eWxlOiAndGFibGVTdWJQb2ludFRvdGFsJyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogYCR7c3VtKHN0Zl9zY29yZSwgMTMsIDE2KX0gxJFp4buDbWAsIHN0eWxlOiAndGFibGVTdWJQb2ludFRvdGFsJyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogYCR7c3VtKGRlcF9zY29yZSwgMTMsIDE2KX0gxJFp4buDbWAsIHN0eWxlOiAndGFibGVTdWJQb2ludFRvdGFsJyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6ICdU4buVbmcgxJFp4buDbSB04buRaSDEkWEnLCBzdHlsZTogJ3RhYmxlU3ViSGVhZGVyVG90YWwnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiAnMTAwIMSRaeG7g20nLCBzdHlsZTogJ3RhYmxlU3ViUG9pbnRUb3RhbCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IGAke3N0ZF9zY29yZVsxN119IMSRaeG7g21gLCBzdHlsZTogJ3RhYmxlU3ViUG9pbnRUb3RhbCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IGAke3N0Zl9zY29yZVsxN119IMSRaeG7g21gLCBzdHlsZTogJ3RhYmxlU3ViUG9pbnRUb3RhbCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IGAke2RlcF9zY29yZVsxN119IMSRaeG7g21gLCBzdHlsZTogJ3RhYmxlU3ViUG9pbnRUb3RhbCcgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBsYXlvdXQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZmlsbENvbG9yOiBmdW5jdGlvbiAocm93SW5kZXgsIG5vZGUsIGNvbHVtbkluZGV4KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocm93SW5kZXggPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBNw6B1IGNobyBow6BuZyDEkeG6p3UgdGnDqm5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJyM5ZmU2ZmYnOyAvLyBWw60gZOG7pTogTcOgdSDEkeG7j1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBNw6B1IGNobyBjw6FjIGjDoG5nIGPDsm4gbOG6oWlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcm93SW5kZXggJSAyID09PSAwID8gJyNlNmU2ZTYnIDogbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHsgdGV4dDogJ0vDvSB0w6puJywgc3R5bGU6ICdzdWJoZWFkZXInLCBhbGlnbm1lbnQ6ICdyaWdodCcsIG1hcmdpbjogWzAsIDAsIDUwLCAwXSB9LFxyXG4gICAgICAgICAgICBdLFxyXG4gICAgICAgICAgICBzdHlsZXM6IHtcclxuICAgICAgICAgICAgICAgIGhlYWRlcjoge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvbnRTaXplOiAyMSxcclxuICAgICAgICAgICAgICAgICAgICBib2xkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIG1hcmdpbjogWzAsIDAsIDAsIDEwXSxcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBzdWJoZWFkZXI6IHtcclxuICAgICAgICAgICAgICAgICAgICBmb250U2l6ZTogMTYsXHJcbiAgICAgICAgICAgICAgICAgICAgYm9sZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBtYXJnaW46IFswLCAxMCwgMCwgNV0sXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgdGFibGVFeGFtcGxlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWFyZ2luOiBbMCwgNSwgMCwgMTVdLFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHRhYmxlSGVhZGVyOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYm9sZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBmb250U2l6ZTogMTMsXHJcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6ICdibGFjaycsXHJcbiAgICAgICAgICAgICAgICAgICAgYWxpZ25tZW50OiAnY2VudGVyJyxcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB0YWJsZVN1YkhlYWRlcjoge1xyXG4gICAgICAgICAgICAgICAgICAgIGJvbGQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgZm9udFNpemU6IDEyLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiAnYmxhY2snLFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHRhYmxlU3ViSGVhZGVyVG90YWw6IHtcclxuICAgICAgICAgICAgICAgICAgICBib2xkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIGZvbnRTaXplOiAxMixcclxuICAgICAgICAgICAgICAgICAgICBjb2xvcjogJ3JlZCcsXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgdGFibGVTdWJQb2ludFRvdGFsOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYm9sZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBmb250U2l6ZTogMTIsXHJcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6ICdyZWQnLFxyXG4gICAgICAgICAgICAgICAgICAgIGFsaWdubWVudDogJ2NlbnRlcicsXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgdGFibGVTdWJTdWJIZWFkZXI6IHtcclxuICAgICAgICAgICAgICAgICAgICBib2xkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIGZvbnRTaXplOiAxMSxcclxuICAgICAgICAgICAgICAgICAgICBjb2xvcjogJ2JsYWNrJyxcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB0YWJsZVN1YlN1YlN1YkhlYWRlcjoge1xyXG4gICAgICAgICAgICAgICAgICAgIGJvbGQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgZm9udFNpemU6IDEwLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiAnYmxhY2snLFxyXG4gICAgICAgICAgICAgICAgICAgIG1hcmdpbjogWzE1LCAwLCAwLCAwXSxcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB0YWJsZXBvaW50OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYm9sZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBmb250U2l6ZTogMTEsXHJcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6ICdibGFjaycsXHJcbiAgICAgICAgICAgICAgICAgICAgYWxpZ25tZW50OiAnY2VudGVyJyxcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGRlZmF1bHRTdHlsZToge1xyXG4gICAgICAgICAgICAgICAgLy8gYWxpZ25tZW50OiAnanVzdGlmeSdcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICB9O1xyXG4gICAgICAgIG9wdGlvbnMgPSB7fTtcclxuXHJcbiAgICAgICAgY29uc3QgcGRmRG9jID0gcHJpbnRlci5jcmVhdGVQZGZLaXREb2N1bWVudChkb2NEZWZpbml0aW9uLCBvcHRpb25zKTtcclxuICAgICAgICAvLyBpZiAoc2NvcmNlLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICBhd2FpdCBjcmVhdGVQZGZBc3luYyhwcmludGVyLCBwZGZEb2MsIHBhdGguam9pbihwYXRoX3NhdmUsIG5hbWVfemlwLCBuYW1lZmlsZSkpO1xyXG4gICAgICAgIC8vIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gICBhd2FpdCBjcmVhdGVQZGZBc3luYyhwcmludGVyLCBwZGZEb2MsIHBhdGguam9pbihwYXRoX3NhdmUsIG5hbWVmaWxlKSk7XHJcbiAgICAgICAgLy8gICByZXR1cm4gbmFtZWZpbGU7XHJcbiAgICAgICAgLy8gfVxyXG4gICAgfVxyXG4gICAgLy8gaWYgKHNjb3JjZS5sZW5ndGggPiAxKSB7XHJcbiAgICBhcmNoaXZlLnBpcGUob3V0cHV0KTtcclxuICAgIGFyY2hpdmUuZGlyZWN0b3J5KHBhdGguam9pbihwYXRoX3NhdmUsIG5hbWVfemlwKSwgZmFsc2UpO1xyXG4gICAgYXJjaGl2ZS5maW5hbGl6ZSgpO1xyXG4gICAgLy8gfVxyXG5cclxuICAgIC8vIGlmIChzY29yY2UubGVuZ3RoID4gMSkge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICBvdXRwdXQub24oJ2Nsb3NlJywgKCkgPT4ge1xyXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcIk7DqW4gaG/DoG4gdOG6pXQsIGvDrWNoIHRoxrDhu5tjOlwiLCBhcmNoaXZlLnBvaW50ZXIoKSArIFwiIGJ5dGVzXCIpO1xyXG4gICAgICAgICAgICBmcy5ybShwYXRoLmpvaW4ocGF0aF9zYXZlLCBuYW1lX3ppcCksIHsgcmVjdXJzaXZlOiB0cnVlIH0sIChlcnIpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnQ1JFQVRFX1BERiB8IExPRyB8IEzhu5dpIGtoaSB4w7NhIHRoxrAgbeG7pWM6JywgZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCLEkMOjIHjDs2EgdGjGsCBt4bulYyB0aMOgbmggY8O0bmcuXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUobmFtZV96aXAgKyAnLnppcCcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgYXJjaGl2ZS5vbignZXJyb3InLCAoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdDUkVBVEVfUERGIHwgTE9HIHwgTOG7l2kga2hpIG7DqW4nKTtcclxuICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuICAgIC8vIH1cclxufVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSB7XHJcbiAgICBzZW5kRW1haWwsXHJcbiAgICBjaGVja0lmVXNlckxvZ2luQVBJLFxyXG4gICAgY2hlY2tJZlVzZXJMb2dpblJvdXRlLFxyXG4gICAgZ2V0X2Z1bGxfaWQsXHJcbiAgICBibG9ja1Vud2FudGVkUGF0aHMsXHJcbiAgICBtYXJrLFxyXG4gICAgdXBkYXRlU3R1ZGVudFRvdGFsU2NvcmUsXHJcbiAgICByYW5kb21QYXNzd29yZCxcclxuICAgIHNjaGVkdWxlRmlsZURlbGV0aW9uLFxyXG4gICAgc29ydFN0dWRlbnROYW1lLFxyXG4gICAgY3JlYXRlSWQsXHJcbiAgICBkZWxldGVDbGFzc0FwaSxcclxuICAgIGNyZWF0ZVBkZixcclxuICAgIGNvbXBhcmVQYXNzd29yZCxcclxuICAgIGhhc2hQYXNzd29yZCxcclxufTtcclxuIl0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxNQUFNLEdBQUdDLE9BQU8sQ0FBQyxtQkFBbUIsQ0FBQztBQUMzQyxNQUFNQyxVQUFVLEdBQUdELE9BQU8sQ0FBQyxZQUFZLENBQUM7QUFDeEMsTUFBTUUsR0FBRyxHQUFHRixPQUFPLENBQUMsS0FBSyxDQUFDO0FBQzFCLE1BQU1HLEVBQUUsR0FBR0gsT0FBTyxDQUFDLElBQUksQ0FBQztBQUN4QixNQUFNO0VBQUVJLFNBQVM7RUFBRUM7QUFBYyxDQUFDLEdBQUdMLE9BQU8sQ0FBQyxjQUFjLENBQUM7QUFDNUQsTUFBTU0sTUFBTSxHQUFHRixTQUFTLENBQUMsQ0FBQztBQUMxQixNQUFNRyxxQkFBcUIsR0FBR0YsYUFBYSxDQUFDLENBQUM7QUFDN0MsTUFBTUcsSUFBSSxHQUFHUixPQUFPLENBQUMsTUFBTSxDQUFDO0FBQzVCLE1BQU1TLFFBQVEsR0FBR1QsT0FBTyxDQUFDLFVBQVUsQ0FBQztBQUNwQyxNQUFNO0VBQUVVLEVBQUUsRUFBRUM7QUFBTyxDQUFDLEdBQUdYLE9BQU8sQ0FBQyxNQUFNLENBQUM7QUFDdEMsTUFBTVksVUFBVSxHQUFHWixPQUFPLENBQUMsU0FBUyxDQUFDO0FBQ3JDLE1BQU1hLElBQUksR0FBR2IsT0FBTyxDQUFDLE1BQU0sQ0FBQztBQUU1QixNQUFNYyxNQUFNLEdBQUdkLE9BQU8sQ0FBQyxRQUFRLENBQUM7QUFDaEMsTUFBTWUsVUFBVSxHQUFHLEVBQUU7QUFDckI7O0FBRUE7QUFDQSxTQUFTQyxZQUFZQSxDQUFDQyxRQUFRLEVBQUU7RUFDNUIsT0FBT0gsTUFBTSxDQUFDSSxRQUFRLENBQUNELFFBQVEsRUFBRUYsVUFBVSxDQUFDO0FBQ2hEOztBQUVBO0FBQ0EsU0FBU0ksZUFBZUEsQ0FBQ0MsYUFBYSxFQUFFQyxjQUFj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","map":{"version":3,"names":["server","require","nodemailer","ejs","fs","getClient","getNameGlobal","client","name_global_databases","path","archiver","v4","uuidv4","PdfPrinter","util","bcrypt","saltRounds","hashPassword","password","hashSync","comparePassword","inputPassword","hashedPassword","compareSync","sendEmail","email","transporter","createTransport","service","auth","user","pass","emailTXT","readFileSync","join","emailHTML","mailOptions","from","to","subject","text","replace","html","render","attachments","filename","cid","info","sendMail","error","console","log","checkIfUserLoginAPI","req","res","next","session","sendStatus","checkIfUserLoginRoute","redirect","hslink","gvlink","stf","dep","fullPath","baseUrl","includes","pow","locals","isnotST","iskhoa","isbancansu","isgiaovien","isST","first","user_info","db","collection","findOne","_id","projection","avt","displayName","mark","table","mssv","data","marker","cls","school_year","year","start_day","end_day","today","Date","getTime","forever_day","update","second","third","fourth","fifth","img_ids","total","update_date","last_name","first_name","createIndex","name","updateOne","$set","upsert","updated","updateStudentTotalScore","step","total_score","get_full_id","directoryPath","listName","listdep","list_id","i","length","push","uploadFileToDrive","err","blockUnwantedPaths","unwantedPaths","url","status","send","randomPassword","upperCase","number","allChars","Promise","resolve","reject","Math","floor","random","deleteFile","filePath","unlink","scheduleFileDeletion","twelveHours","setTimeout","sortStudentName","std_list","sort","a","b","lastFirstNameWordA","split","pop","lastFirstNameWordB","firstNameComparison","localeCompare","sensitivity","deleteClassApi","rm_cls","deleteMany","collections","listCollections","toArray","startsWith","drop","class","$exists","info_search","updateMany","$pull","student_list","ai","rm_ts","createId","str","arr","toUpperCase","trim","id","charAt","createPdf","path_save","scorce","sum","start","end","subArray","slice","reduce","accumulator","currentValue","name_zip","output","archive","createWriteStream","zlib","level","existsSync","mkdirSync","createPdfAsync","promisify","printer","pdfDoc","outputPath","callback","pipe","on","index","std_score","std","stf_score","dep_score","namefile","fonts","Roboto","normal","bold","italics","bolditalics","docDefinition","content","style","columns","widths","body","layout","fillColor","rowIndex","node","columnIndex","alignment","margin","styles","header","fontSize","subheader","tableExample","tableHeader","color","tableSubHeader","tableSubHeaderTotal","tableSubPointTotal","tableSubSubHeader","tableSubSubSubHeader","tablepoint","defaultStyle","options","createPdfKitDocument","directory","finalize","rm","recursive","module","exports"],"sourceRoot":"D:\\project\\web\\newCDRL-1\\backend\\lib\\","sources":["function_lib.js"],"sourcesContent":["const server = require('./csdl_google_lib');\r\nconst nodemailer = require('nodemailer');\r\nconst ejs = require('ejs');\r\nconst fs = require('fs');\r\nconst { getClient, getNameGlobal } = require('./mogodb_lib');\r\nconst client = getClient();\r\nconst name_global_databases = getNameGlobal();\r\nconst path = require('path');\r\nconst archiver = require('archiver');\r\nconst { v4: uuidv4 } = require('uuid');\r\nconst PdfPrinter = require('pdfmake');\r\nconst util = require('util');\r\n\r\nconst bcrypt = require('bcrypt');\r\nconst saltRounds = 10;\r\n// ------------------------------------------------------------------------------------------------\r\n\r\n// Hàm để hash mật khẩu\r\nfunction hashPassword(password) {\r\n    return bcrypt.hashSync(password, saltRounds);\r\n}\r\n\r\n// Hàm để so sánh mật khẩu đã nhập với mật khẩu đã hash\r\nfunction comparePassword(inputPassword, hashedPassword) {\r\n    return bcrypt.compareSync(inputPassword, hashedPassword);\r\n}\r\n\r\nasync function sendEmail(password, email) {\r\n    try {\r\n        const transporter = nodemailer.createTransport({\r\n            service: 'gmail',\r\n            auth: {\r\n                user: 'nguytuan04@gmail.com',\r\n                pass: 'unjwfrdskgezbmym',\r\n            },\r\n        });\r\n\r\n        const emailTXT = fs.readFileSync(path.join('src', 'emailTemplate', 'email.txt'), 'utf8');\r\n        const emailHTML = fs.readFileSync(path.join('src', 'emailTemplate', 'email.ejs'), 'utf8');\r\n\r\n        const mailOptions = {\r\n            from: '\"Quản lý điểm rèn luyện\" <nguytuan04@gmail.com>',\r\n            to: email,\r\n            subject: 'Yêu cầu đặt lại mật khẩu',\r\n            text: emailTXT.replace('${password}', password),\r\n            html: ejs.render(emailHTML, { password: password }),\r\n            attachments: [\r\n                {\r\n                    filename: 'image.png',\r\n                    path: './src/img/sv_logo_dashboard.png',\r\n                    cid: 'fs1120020a17090af28b00b00263fc1ef1aasm843048pjb10', //same cid value as in the html img src\r\n                },\r\n            ],\r\n        };\r\n\r\n        const info = await transporter.sendMail(mailOptions);\r\n        // Thực hiện các hoạt động hữu ích khác sau khi gửi email thành công.\r\n    } catch (error) {\r\n        console.log('SYSTEM | SEND_EMAIL | ', error);\r\n    }\r\n}\r\n\r\nasync function checkIfUserLoginAPI(req, res, next) {\r\n    const user = req.session.user;\r\n    if (!user) {\r\n        // Cookie không tồn tại, chặn truy cập\r\n        return res.sendStatus(403);\r\n    } else {\r\n        next();\r\n    }\r\n}\r\n\r\nasync function checkIfUserLoginRoute(req, res, next) {\r\n    const user = req.session.user;\r\n    if (!user) {\r\n        // Cookie không tồn tại, chặn truy cập\r\n        return res.redirect('/login');\r\n    } else {\r\n        const hslink = ['/hocsinh/nhapdiemdanhgia'];\r\n        const gvlink = ['/giaovien/quanlyquyen', '/giaovien/nhapdiemdanhgia', '/giaovien/danhsachbangdiem'];\r\n        const stf = [\r\n            '/bancansu/nhapdiemdanhgia',\r\n            '/bancansu/quanlihoatdong',\r\n            '/bancansu/quanlihoatdong/danhgiahoatdong',\r\n            '/bancansu/danhsachbangdiem',\r\n        ];\r\n        const dep = [\r\n            '/doankhoa/quanlibomon',\r\n            '/doankhoa/quanlilop',\r\n            '/doankhoa/danhsachbangdiem',\r\n            '/doankhoa/quanlicv',\r\n            '/doankhoa/quanlihoatdongkhoa',\r\n            '/doankhoa/danhsachsinhvien',\r\n            '/doankhoa/nhapdiemdanhgia',\r\n            '/doankhoa/thoihan',\r\n        ];\r\n        const fullPath = req.baseUrl + req.path;\r\n        if (hslink.includes(fullPath)) {\r\n            if (!user.pow[0]) {\r\n                return res.redirect('/');\r\n            }\r\n        }\r\n        if (gvlink.includes(fullPath)) {\r\n            if (!user.pow[1] && !user.pow[4]) {\r\n                return res.redirect('/');\r\n            }\r\n        }\r\n        if (stf.includes(fullPath)) {\r\n            if (!user.pow[0] && (!user.pow[1] || !user.pow[3])) {\r\n                return res.redirect('/');\r\n            }\r\n        }\r\n        if (dep.includes(fullPath)) {\r\n            if (!user.pow[8]) {\r\n                return res.redirect('/');\r\n            }\r\n        }\r\n\r\n        if ((user.pow[1] && user.pow[4]) || user.pow[8]) {\r\n            res.locals.isnotST = true;\r\n        }\r\n        if (user.pow[0]) {\r\n            res.locals.iskhoa = false;\r\n            res.locals.isbancansu = false;\r\n            res.locals.isgiaovien = false;\r\n            res.locals.isST = true;\r\n        } else if (user.pow[1] && user.pow[3] && !user.pow[4]) {\r\n            res.locals.iskhoa = false;\r\n            res.locals.isbancansu = true;\r\n            res.locals.isgiaovien = false;\r\n            res.locals.isST = false;\r\n        } else if (user.pow[1] && user.pow[3] && user.pow[4]) {\r\n            res.locals.iskhoa = false;\r\n            res.locals.isbancansu = false;\r\n            res.locals.isgiaovien = true;\r\n            res.locals.isST = false;\r\n        } else if (user.pow[8]) {\r\n            res.locals.iskhoa = true;\r\n            res.locals.isbancansu = false;\r\n            res.locals.isgiaovien = false;\r\n            res.locals.isST = false;\r\n        }\r\n        if (user.first == 'new_user') {\r\n            return res.redirect('/login/firstlogin');\r\n        } else if (user.first == 'otp') {\r\n            return res.redirect('/login/firstlogin?tile=ok');\r\n        } else {\r\n            const user_info = await client\r\n                .db(name_global_databases)\r\n                .collection('user_info')\r\n                .findOne({ _id: user._id }, { projection: { _id: 0, avt: 1, displayName: 1 } });\r\n            if (user_info) {\r\n                res.locals.avt = user_info.avt;\r\n                res.locals.displayName = user_info.displayName;\r\n            } else {\r\n                res.locals.avt = '';\r\n                res.locals.displayName = '';\r\n            }\r\n        }\r\n        next();\r\n    }\r\n}\r\n\r\nasync function mark(table, user, mssv, data, marker, cls) {\r\n    // data = {\r\n    //   first: [],\r\n    //   second: [],\r\n    //   third: [],\r\n    //   fourth: [],\r\n    //   fifth: [],\r\n    //   img_ids: {},\r\n    //   total: 100,\r\n    // }\r\n\r\n    const school_year = await client\r\n        .db(name_global_databases)\r\n        .collection('school_year')\r\n        .findOne(\r\n            {},\r\n            {\r\n                projection: {\r\n                    _id: 0,\r\n                    year: 1,\r\n                    start_day: 1,\r\n                    end_day: 1,\r\n                },\r\n            },\r\n        );\r\n    let today = new Date().getTime();\r\n    let start_day = new Date(school_year.start_day).getTime();\r\n    let end_day = new Date(school_year.end_day).getTime();\r\n    let forever_day = new Date('2003-10-18').getTime(); // special date\r\n\r\n    // check if end mark time or not\r\n    if (start_day <= today && (today < end_day || end_day == forever_day)) {\r\n        // update old table if exist or insert new table\r\n        let update = {\r\n            mssv: mssv,\r\n            school_year: school_year.year,\r\n            first: data.first,\r\n            second: data.second,\r\n            third: data.third,\r\n            fourth: data.fourth,\r\n            fifth: data.fifth,\r\n            [`img_ids.global`]: data.img_ids,\r\n            total: data.total,\r\n            update_date: new Date(),\r\n        };\r\n\r\n        // if table is stf_table - mark by staff members or teacher\r\n        if (table == '_stf_table') {\r\n            update.marker = marker.last_name + ' ' + marker.first_name;\r\n        }\r\n\r\n        await client\r\n            .db(user.dep)\r\n            .collection(cls + table)\r\n            .createIndex(\r\n                {\r\n                    mssv: 1,\r\n                },\r\n                {\r\n                    name: '_mssv',\r\n                },\r\n            );\r\n\r\n        await client\r\n            .db(user.dep)\r\n            .collection(cls + table)\r\n            .updateOne(\r\n                {\r\n                    mssv: mssv,\r\n                    school_year: school_year.year,\r\n                },\r\n                {\r\n                    $set: update,\r\n                },\r\n                { upsert: true },\r\n            );\r\n\r\n        const updated = await updateStudentTotalScore(\r\n            table,\r\n            school_year.year,\r\n            mssv,\r\n            data.total,\r\n            marker.last_name + ' ' + marker.first_name,\r\n        );\r\n\r\n        if (updated) return 0;\r\n        else return 2;\r\n    }\r\n    return 1;\r\n}\r\n\r\nasync function updateStudentTotalScore(table, school_year, mssv, total, marker) {\r\n    let step = await client\r\n        .db(name_global_databases)\r\n        .collection('user_info')\r\n        .findOne(\r\n            {\r\n                _id: mssv,\r\n            },\r\n            {\r\n                projection: {\r\n                    _id: 0,\r\n                    total_score: 1,\r\n                },\r\n            },\r\n        );\r\n\r\n    if (!step.total_score[`${school_year}`]) step = 0;\r\n    else step = step.total_score[`${school_year}`].step;\r\n\r\n    // update total score list for student\r\n    switch (table) {\r\n        case '_std_table':\r\n            if (step <= 1) {\r\n                await client\r\n                    .db(name_global_databases)\r\n                    .collection('user_info')\r\n                    .updateOne(\r\n                        {\r\n                            _id: mssv,\r\n                        },\r\n                        {\r\n                            $set: {\r\n                                [`total_score.${school_year}.std`]: total,\r\n                                [`total_score.${school_year}.step`]: 1,\r\n                            },\r\n                        },\r\n                        {\r\n                            upsert: true,\r\n                        },\r\n                    );\r\n                return true;\r\n            }\r\n            return false;\r\n        case '_stf_table':\r\n            if (step <= 2) {\r\n                await client\r\n                    .db(name_global_databases)\r\n                    .collection('user_info')\r\n                    .updateOne(\r\n                        {\r\n                            _id: mssv,\r\n                        },\r\n                        {\r\n                            $set: {\r\n                                [`total_score.${school_year}.stf`]: total,\r\n                                [`total_score.${school_year}.marker`]: marker,\r\n                                [`total_score.${school_year}.step`]: 2,\r\n                            },\r\n                        },\r\n                        {\r\n                            upsert: true,\r\n                        },\r\n                    );\r\n                return true;\r\n            }\r\n            return false;\r\n        case '_dep_table':\r\n            await client\r\n                .db(name_global_databases)\r\n                .collection('user_info')\r\n                .updateOne(\r\n                    {\r\n                        _id: mssv,\r\n                    },\r\n                    {\r\n                        $set: {\r\n                            [`total_score.${school_year}.dep`]: total,\r\n                            [`total_score.${school_year}.step`]: 3,\r\n                        },\r\n                    },\r\n                    {\r\n                        upsert: true,\r\n                    },\r\n                );\r\n            return true;\r\n    }\r\n}\r\n\r\nasync function get_full_id(directoryPath, listName, listdep) {\r\n    let list_id = [];\r\n    try {\r\n        // Đọc các file trong thư mục một cách đồng bộ\r\n        for (let i = 0; i < listName.length; i++) {\r\n            list_id.push(await server.uploadFileToDrive(path.join(directoryPath, listName[i]), listdep[i]));\r\n        }\r\n        return list_id;\r\n    } catch (err) {\r\n        console.log('SYSTEM | GET_ID | ERR | ', err);\r\n    }\r\n}\r\n\r\nconst blockUnwantedPaths = (req, res, next) => {\r\n    // cai díu j day @rurimeiko làm lại đi // cái block user truy cập file\r\n    const unwantedPaths = [\r\n        '/.vscode/',\r\n        '/backend/',\r\n        '/node_modules/',\r\n        '/views/',\r\n        'package-lock.json',\r\n        'package.json',\r\n        'README.md',\r\n    ];\r\n    for (const path of unwantedPaths) {\r\n        if (req.url.includes(path)) {\r\n            return res\r\n                .status(403)\r\n                .send(\r\n                    '<h1 style=\"font-size: 46px;\">cut di bn oi, <a href=\"/404\">to mo</a> </a> lam d j? </h1> \\n<img src =\"https://cdn.discordapp.com/attachments/1128270011346210826/1128288383316271204/sticker.webp\"><iframe src=\"https://giphy.com/embed/qs4ll1FSxKnNHeSmom\" width=\"480\" height=\"475\" frameBorder=\"0\" class=\"giphy-embed\" allowFullScreen></iframe><p><a href=\"https://giphy.com/gifs/DogeBONK-bonk-dobo-dogebonk-qs4ll1FSxKnNHeSmom\">via GIPHY</a></p>',\r\n                );\r\n        }\r\n    }\r\n    next();\r\n};\r\n\r\nfunction randomPassword() {\r\n    const upperCase = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';\r\n    const number = '0123456789';\r\n    const allChars = upperCase + number;\r\n\r\n    return new Promise((resolve, reject) => {\r\n        try {\r\n            let password = '';\r\n            password += upperCase[Math.floor(Math.random() * upperCase.length)];\r\n            password += number[Math.floor(Math.random() * number.length)];\r\n\r\n            while (password.length < 6) {\r\n                password += allChars[Math.floor(Math.random() * allChars.length)];\r\n            }\r\n            resolve(password);\r\n        } catch (error) {\r\n            reject(error);\r\n        }\r\n    });\r\n}\r\n\r\n// Function to delete the file\r\nfunction deleteFile(filePath) {\r\n    fs.unlink(filePath, (err) => {\r\n        if (err) {\r\n            console.log('FUNCITON | LOG | Error deleting file:', err);\r\n        }\r\n    });\r\n}\r\n\r\n// Function to schedule the file deletion after 12 hours\r\nfunction scheduleFileDeletion(filePath) {\r\n    const twelveHours = 12 * 60 * 60 * 1000; // Convert 12 hours to milliseconds\r\n\r\n    setTimeout(() => {\r\n        deleteFile(filePath);\r\n    }, twelveHours);\r\n}\r\n\r\n// Function to sort name of student in list\r\nfunction sortStudentName(std_list) {\r\n    if (std_list) {\r\n        std_list.sort((a, b) => {\r\n            if (a && b) {\r\n                const lastFirstNameWordA = a.first_name.split(' ').pop();\r\n                const lastFirstNameWordB = b.first_name.split(' ').pop();\r\n\r\n                const firstNameComparison = lastFirstNameWordA.localeCompare(lastFirstNameWordB, 'vi', {\r\n                    sensitivity: 'base',\r\n                });\r\n                if (firstNameComparison !== 0) {\r\n                    return firstNameComparison;\r\n                }\r\n\r\n                return a.last_name.localeCompare(b.last_name, 'vi', {\r\n                    sensitivity: 'base',\r\n                });\r\n            } else {\r\n                return std_list;\r\n            }\r\n        });\r\n        return std_list;\r\n    } else {\r\n        return std_list;\r\n    }\r\n}\r\n\r\n// xoá class\r\nasync function deleteClassApi(data, user) {\r\n    for (let i = 0; i < data.rm_cls.length; i++) {\r\n        await client.db(name_global_databases).collection('classes').deleteMany({ _id: data.rm_cls[i] });\r\n        const collections = await client.db(user.dep).listCollections().toArray();\r\n\r\n        // Lặp qua từng collection và xoá nếu tên bắt đầu bằng \"lớp\"\r\n        for (const collection of collections) {\r\n            if (collection.name.startsWith(data.rm_cls[i])) {\r\n                await client.db(user.dep).collection(collection.name).drop();\r\n            }\r\n        }\r\n        // xoá học sinh đang thuộc class bên user_info (chuyển sang ghost account)\r\n        await client\r\n            .db(name_global_databases)\r\n            .collection('user_info')\r\n            .deleteMany({\r\n                class: [data.rm_cls[i]],\r\n                'power.0': { $exists: true },\r\n            });\r\n\r\n        let info_search = `student_list.${user._id}`;\r\n        await client\r\n            .db(user.dep)\r\n            .collection(`${data.rm_cls[i]}_activities`)\r\n            .updateMany(\r\n                {\r\n                    [info_search]: { $exists: true },\r\n                },\r\n                {\r\n                    $pull: { student_list: user._id, ai: user._id },\r\n                },\r\n            );\r\n\r\n        await client\r\n            .db(user.dep)\r\n            .collection('activities')\r\n            .updateMany(\r\n                {\r\n                    [info_search]: { $exists: true },\r\n                },\r\n                {\r\n                    $pull: { student_list: user._id, ai: user._id },\r\n                },\r\n            );\r\n\r\n        await client\r\n            .db(name_global_databases)\r\n            .collection('activities')\r\n            .updateMany(\r\n                {\r\n                    [info_search]: { $exists: true },\r\n                },\r\n                {\r\n                    $pull: { student_list: user._id, ai: user._id },\r\n                },\r\n            );\r\n\r\n        // xoa lop khoi giao vien\r\n        await client\r\n            .db(name_global_databases)\r\n            .collection('user_info')\r\n            .updateMany(\r\n                {\r\n                    _id: data.rm_ts[i],\r\n                    'power.1': { $exists: true },\r\n                    'power.4': { $exists: true },\r\n                },\r\n                {\r\n                    $pull: { class: data.rm_cls[i] },\r\n                },\r\n            );\r\n    }\r\n}\r\n\r\n// Function to create id for string (get all start letter of words and cobine together)\r\nfunction createId(str) {\r\n    let arr = str.toUpperCase().trim().split(' ');\r\n    let id = '';\r\n    for (let i of arr) {\r\n        id += i.charAt(0);\r\n    }\r\n    return id;\r\n}\r\n\r\nasync function createPdf(path_save, scorce) {\r\n    function sum(arr, start, end) {\r\n        if (arr[0] == 'N/A') {\r\n            return 'N/A';\r\n        }\r\n        // Đảm bảo start và end không vượt qua giới hạn của mảng\r\n        if (start < 0) start = 0;\r\n        if (end >= arr.length) end = arr.length - 1;\r\n\r\n        // Kiểm tra nếu start lớn hơn end hoặc mảng rỗng\r\n        if (start > end || arr.length === 0) return 0;\r\n\r\n        // Sử dụng slice và reduce để tính tổng\r\n        const subArray = arr.slice(start, end + 1);\r\n        const total = subArray.reduce((accumulator, currentValue) => accumulator + currentValue, 0);\r\n\r\n        return total;\r\n    }\r\n    let name_zip;\r\n    let output;\r\n    let archive;\r\n    // if (scorce.length > 1) {\r\n    name_zip = uuidv4();\r\n    output = fs.createWriteStream(path.join(path_save, name_zip + '.zip'));\r\n    archive = archiver('zip', {\r\n        zlib: { level: 2 }, // Mức nén, có thể là 0-9 (9 là mức nén cao nhất)\r\n    });\r\n    if (!fs.existsSync(path.join(path_save, name_zip))) {\r\n        // Nếu thư mục không tồn tại, tạo thư mục mới\r\n        fs.mkdirSync(path.join(path_save, name_zip));\r\n    }\r\n    // }\r\n    const createPdfAsync = util.promisify((printer, pdfDoc, outputPath, callback) => {\r\n        pdfDoc.pipe(fs.createWriteStream(outputPath));\r\n        pdfDoc.end();\r\n        pdfDoc.on('end', () => {\r\n            callback();\r\n        });\r\n    });\r\n    for (let index = 0; index < scorce.length; index++) {\r\n        // Define font files\r\n        const std_score = scorce[index].std;\r\n        const stf_score = scorce[index].stf;\r\n        const dep_score = scorce[index].dep;\r\n        let namefile;\r\n        // if (scorce.length > 1) {\r\n        namefile = scorce[index].name + '-' + scorce[index].mssv + '.pdf';\r\n        // } else {\r\n        //   namefile = uuidv4() + \".pdf\";\r\n        // }\r\n        const fonts = {\r\n            Roboto: {\r\n                normal: 'backend/font/Roboto-Regular.ttf',\r\n                bold: 'backend/font/Roboto-Medium.ttf',\r\n                italics: 'backend/font/Roboto-Italic.ttf',\r\n                bolditalics: 'backend/font/Roboto-MediumItalic.ttf',\r\n            },\r\n        };\r\n        const printer = new PdfPrinter(fonts);\r\n\r\n        const docDefinition = {\r\n            content: [\r\n                { text: 'Bảng điểm cá nhân', style: 'header' },\r\n                {\r\n                    columns: [{ text: 'Tên:', bold: true }, scorce[index].name],\r\n                },\r\n                {\r\n                    columns: [{ text: 'MSSV:', bold: true }, scorce[index].mssv],\r\n                },\r\n                {\r\n                    columns: [{ text: 'Lớp:', bold: true }, scorce[index].class],\r\n                },\r\n                {\r\n                    columns: [{ text: 'Học kỳ:', bold: true }, scorce[index].year],\r\n                },\r\n\r\n                // \t\t{text: 'Defining column widths', style: 'subheader'},\r\n                // \t\t'Tables support the same width definitions as standard columns:',\r\n                {\r\n                    style: 'tableExample',\r\n                    table: {\r\n                        widths: [230, '*', '*', '*', '*'],\r\n                        body: [\r\n                            [\r\n                                { text: 'Nội Dung Đánh Giá', style: 'tableHeader' },\r\n                                { text: 'Điểm Tối Đa', style: 'tableHeader' },\r\n                                { text: 'Điểm SV Tự Đánh Giá', style: 'tableHeader' },\r\n                                { text: 'Tập Thể Lớp', style: 'tableHeader' },\r\n                                { text: 'Khoa Đánh Giá', style: 'tableHeader' },\r\n                            ],\r\n                            [{ text: '1. Đánh giá về ý thức học tập', style: 'tableSubHeader' }, '', '', '', ''],\r\n                            [\r\n                                {\r\n                                    text: 'a. Ý thức, thái độ trong học tập.\\n(Nghỉ học 1 buổi không phép trừ 1 điểm; đi muộn hoặc bỏ tiết mỗi 3 lần trừ 1 điểm)',\r\n                                    style: 'tableSubSubHeader',\r\n                                },\r\n                                { text: '7 điểm', style: 'tablepoint' },\r\n                                { text: `${std_score[0]} điểm`, style: 'tablepoint' },\r\n                                { text: `${stf_score[0]} điểm`, style: 'tablepoint' },\r\n                                { text: `${dep_score[0]} điểm`, style: 'tablepoint' },\r\n                            ],\r\n                            [\r\n                                {\r\n                                    text: 'b. Tham gia các câu lạc bộ học thuật; các hoạt động học thuật; hoạt động ngoại khóa; hoạt động nghiên cứu khoa học',\r\n                                    style: 'tableSubSubHeader',\r\n                                },\r\n                                { text: '2 điểm', style: 'tablepoint' },\r\n                                { text: `${std_score[1]} điểm`, style: 'tablepoint' },\r\n                                { text: `${stf_score[1]} điểm`, style: 'tablepoint' },\r\n                                { text: `${dep_score[1]} điểm`, style: 'tablepoint' },\r\n                            ],\r\n                            [\r\n                                {\r\n                                    text: 'c. Ý thức thực hiện tốt quy chế khi tham gia các kỳ thi, cuộc thi',\r\n                                    style: 'tableSubSubHeader',\r\n                                },\r\n                                { text: '4 điểm', style: 'tablepoint' },\r\n                                { text: `${std_score[2]} điểm`, style: 'tablepoint' },\r\n                                { text: `${stf_score[2]} điểm`, style: 'tablepoint' },\r\n                                { text: `${dep_score[2]} điểm`, style: 'tablepoint' },\r\n                            ],\r\n                            [\r\n                                { text: '- Bị nhắc nhở khi thi, kiểm tra', style: 'tableSubSubSubHeader' },\r\n                                { text: '2 điểm', style: 'tablepoint' },\r\n                                { text: std_score[2] == 2 ? '•' : '', style: 'tablepoint' },\r\n                                { text: stf_score[2] == 2 ? '•' : '', style: 'tablepoint' },\r\n                                { text: dep_score[2] == 2 ? '•' : '', style: 'tablepoint' },\r\n                            ],\r\n                            [\r\n                                {\r\n                                    text: '- Bị lập biên bản xử lý khi thi và kiểm tra',\r\n                                    style: 'tableSubSubSubHeader',\r\n                                },\r\n                                { text: '0 điểm', style: 'tablepoint' },\r\n                                { text: std_score[2] == 0 ? '•' : '', style: 'tablepoint' },\r\n                                { text: stf_score[2] == 0 ? '•' : '', style: 'tablepoint' },\r\n                                { text: dep_score[2] == 0 ? '•' : '', style: 'tablepoint' },\r\n                            ],\r\n                            [\r\n                                {\r\n                                    text: 'd. Có tinh thần vượt khó, phấn đấu vươn lên trong học tập',\r\n                                    style: 'tableSubSubHeader',\r\n                                },\r\n                                { text: '2 điểm', style: 'tablepoint' },\r\n                                { text: `${std_score[3]} điểm`, style: 'tablepoint' },\r\n                                { text: `${stf_score[3]} điểm`, style: 'tablepoint' },\r\n                                { text: `${dep_score[3]} điểm`, style: 'tablepoint' },\r\n                            ],\r\n                            [\r\n                                { text: 'đ. Đạt kết quả cao trong học tập', style: 'tableSubSubHeader' },\r\n                                { text: '5 điểm', style: 'tablepoint' },\r\n                                { text: `${std_score[4]} điểm`, style: 'tablepoint' },\r\n                                { text: `${stf_score[4]} điểm`, style: 'tablepoint' },\r\n                                { text: `${dep_score[4]} điểm`, style: 'tablepoint' },\r\n                            ],\r\n\r\n                            [\r\n                                {\r\n                                    text: '- Loại Trung bình: Điểm số từ 2.0 đến 2.49',\r\n                                    style: 'tableSubSubSubHeader',\r\n                                },\r\n                                { text: '2 điểm', style: 'tablepoint' },\r\n                                { text: std_score[4] == 2 ? '•' : '', style: 'tablepoint' },\r\n                                { text: stf_score[4] == 2 ? '•' : '', style: 'tablepoint' },\r\n                                { text: dep_score[4] == 2 ? '•' : '', style: 'tablepoint' },\r\n                            ],\r\n\r\n                            [\r\n                                { text: '- Loại Khá: Điểm số từ 2.5 đến 3.19', style: 'tableSubSubSubHeader' },\r\n                                { text: '3 điểm', style: 'tablepoint' },\r\n                                { text: std_score[4] == 3 ? '•' : '', style: 'tablepoint' },\r\n                                { text: stf_score[4] == 3 ? '•' : '', style: 'tablepoint' },\r\n                                { text: dep_score[4] == 3 ? '•' : '', style: 'tablepoint' },\r\n                            ],\r\n\r\n                            [\r\n                                { text: '- Loại Giỏi: Điểm số từ 3.2 đến 3.59', style: 'tableSubSubSubHeader' },\r\n                                { text: '4 điểm', style: 'tablepoint' },\r\n                                { text: std_score[4] == 4 ? '•' : '', style: 'tablepoint' },\r\n                                { text: stf_score[4] == 4 ? '•' : '', style: 'tablepoint' },\r\n                                { text: dep_score[4] == 4 ? '•' : '', style: 'tablepoint' },\r\n                            ],\r\n                            [\r\n                                { text: '- Loại Xuất sắc: Điểm số từ 3.6 đến 4.0', style: 'tableSubSubSubHeader' },\r\n                                { text: '5 điểm', style: 'tablepoint' },\r\n                                { text: std_score[4] == 5 ? '•' : '', style: 'tablepoint' },\r\n                                { text: stf_score[4] == 5 ? '•' : '', style: 'tablepoint' },\r\n                                { text: dep_score[4] == 5 ? '•' : '', style: 'tablepoint' },\r\n                            ],\r\n                            [\r\n                                { text: 'Điểm tối đa nội dung 1 là', style: 'tableSubHeaderTotal' },\r\n                                { text: '20 điểm', style: 'tableSubPointTotal' },\r\n                                { text: `${sum(std_score, 0, 4)} điểm`, style: 'tableSubPointTotal' },\r\n                                { text: `${sum(stf_score, 0, 4)} điểm`, style: 'tableSubPointTotal' },\r\n                                { text: `${sum(dep_score, 0, 4)} điểm`, style: 'tableSubPointTotal' },\r\n                            ],\r\n                            [\r\n                                {\r\n                                    text: '2. Đánh giá về ý thức và kết quả chấp hành nội quy, quy chế, quy định trong nhà trường',\r\n                                    style: 'tableSubHeader',\r\n                                },\r\n                                '',\r\n                                '',\r\n                                '',\r\n                                '',\r\n                            ],\r\n                            [\r\n                                {\r\n                                    text: 'a. Ý thức chấp hành các văn bản chỉ đạo của ngành, của cơ quan chỉ đạo cấp trên được thực hiện trong nhà trường.',\r\n                                    style: 'tableSubSubHeader',\r\n                                },\r\n                                { text: '15 điểm', style: 'tablepoint' },\r\n                                { text: `${std_score[5]} điểm`, style: 'tablepoint' },\r\n                                { text: `${stf_score[5]} điểm`, style: 'tablepoint' },\r\n                                { text: `${dep_score[5]} điểm`, style: 'tablepoint' },\r\n                            ],\r\n                            [\r\n                                { text: '- Bị nhắc nhở trong việc thực hiện', style: 'tableSubSubSubHeader' },\r\n                                { text: '10 điểm', style: 'tablepoint' },\r\n                                { text: std_score[5] == 10 ? '•' : '', style: 'tablepoint' },\r\n                                { text: stf_score[5] == 10 ? '•' : '', style: 'tablepoint' },\r\n                                { text: dep_score[5] == 10 ? '•' : '', style: 'tablepoint' },\r\n                            ],\r\n                            [\r\n                                {\r\n                                    text: '- Bị xử lý kỷ luật từ mức khiển trách trở lên',\r\n                                    style: 'tableSubSubSubHeader',\r\n                                },\r\n                                { text: '0 điểm', style: 'tablepoint' },\r\n                                { text: std_score[5] == 0 ? '•' : '', style: 'tablepoint' },\r\n                                { text: stf_score[5] == 0 ? '•' : '', style: 'tablepoint' },\r\n                                { text: dep_score[5] == 0 ? '•' : '', style: 'tablepoint' },\r\n                            ],\r\n\r\n                            [\r\n                                {\r\n                                    text: 'b. Ý thức chấp hành tốt, đầy đủ các nội quy, quy chế và các quy định khác của nhà trường',\r\n                                    style: 'tableSubSubHeader',\r\n                                },\r\n                                { text: '10 điểm', style: 'tablepoint' },\r\n                                { text: `${std_score[6]} điểm`, style: 'tablepoint' },\r\n                                { text: `${stf_score[6]} điểm`, style: 'tablepoint' },\r\n                                { text: `${dep_score[6]} điểm`, style: 'tablepoint' },\r\n                            ],\r\n                            [\r\n                                { text: '- Bị nhắc nhở trong việc thực hiện', style: 'tableSubSubSubHeader' },\r\n                                { text: '5 điểm', style: 'tablepoint' },\r\n                                { text: std_score[6] == 5 ? '•' : '', style: 'tablepoint' },\r\n                                { text: stf_score[6] == 5 ? '•' : '', style: 'tablepoint' },\r\n                                { text: dep_score[6] == 5 ? '•' : '', style: 'tablepoint' },\r\n                            ],\r\n                            [\r\n                                {\r\n                                    text: '- Bị xử lý kỷ luật từ mức khiển trách trở lên',\r\n                                    style: 'tableSubSubSubHeader',\r\n                                },\r\n                                { text: '0 điểm', style: 'tablepoint' },\r\n                                { text: std_score[6] == 0 ? '•' : '', style: 'tablepoint' },\r\n                                { text: stf_score[6] == 0 ? '•' : '', style: 'tablepoint' },\r\n                                { text: dep_score[6] == 0 ? '•' : '', style: 'tablepoint' },\r\n                            ],\r\n                            [\r\n                                { text: 'Điểm tối đa nội dung 2 là', style: 'tableSubHeaderTotal' },\r\n                                { text: '25 điểm', style: 'tableSubPointTotal' },\r\n                                { text: `${sum(std_score, 5, 6)} điểm`, style: 'tableSubPointTotal' },\r\n                                { text: `${sum(stf_score, 5, 6)} điểm`, style: 'tableSubPointTotal' },\r\n                                { text: `${sum(dep_score, 5, 6)} điểm`, style: 'tableSubPointTotal' },\r\n                            ],\r\n\r\n                            //////////////\r\n                            [\r\n                                {\r\n                                    text: '3. Đánh giá về ý thức và kết quả tham gia các hoạt động chính trị, xã hội, văn hoá, văn nghệ, thể thao, phòng chống tội phạm và các tệ nạn xã hội',\r\n                                    style: 'tableSubHeader',\r\n                                },\r\n                                '',\r\n                                '',\r\n                                '',\r\n                                '',\r\n                            ],\r\n                            [\r\n                                {\r\n                                    text: 'a. Tham gia tích cực các hoạt động chính trị, xã hội, văn hoá, văn nghệ, thể thao và có sự trưởng thành của bản thân qua các hoạt động rèn luyện:',\r\n                                    style: 'tableSubSubHeader',\r\n                                },\r\n                                { text: '8 điểm', style: 'tablepoint' },\r\n                                { text: `${std_score[7]} điểm`, style: 'tablepoint' },\r\n                                { text: `${stf_score[7]} điểm`, style: 'tablepoint' },\r\n                                { text: `${dep_score[7]} điểm`, style: 'tablepoint' },\r\n                            ],\r\n                            [\r\n                                {\r\n                                    text: '- Tích cực tham gia các hoạt động chính trị, xã hội, văn hoá, văn nghệ, thể thao',\r\n                                    style: 'tableSubSubSubHeader',\r\n                                },\r\n                                { text: '5 điểm', style: 'tablepoint' },\r\n                                { text: std_score[7] == 5 ? '•' : '', style: 'tablepoint' },\r\n                                { text: stf_score[7] == 5 ? '•' : '', style: 'tablepoint' },\r\n                                { text: dep_score[7] == 5 ? '•' : '', style: 'tablepoint' },\r\n                            ],\r\n                            [\r\n                                {\r\n                                    text: '- Được kết nạp Đảng hoặc đạt danh hiệu Đoàn viên ưu tú hoặc đạt giải Nhất, Nhì, Ba trong các hoạt động chính trị, văn hóa, thể thao từ cấp trường trở lên',\r\n                                    style: 'tableSubSubSubHeader',\r\n                                },\r\n                                { text: '8 điểm', style: 'tablepoint' },\r\n                                { text: std_score[7] == 8 ? '•' : '', style: 'tablepoint' },\r\n                                { text: stf_score[7] == 8 ? '•' : '', style: 'tablepoint' },\r\n                                { text: dep_score[7] == 8 ? '•' : '', style: 'tablepoint' },\r\n                            ],\r\n\r\n                            [\r\n                                {\r\n                                    text: 'b. Tích cực tham gia các hoạt động công ích, tình nguyện, công tác xã hội',\r\n                                    style: 'tableSubSubHeader',\r\n                                },\r\n                                { text: '6 điểm', style: 'tablepoint' },\r\n                                { text: `${std_score[8]} điểm`, style: 'tablepoint' },\r\n                                { text: `${stf_score[8]} điểm`, style: 'tablepoint' },\r\n                                { text: `${dep_score[8]} điểm`, style: 'tablepoint' },\r\n                            ],\r\n                            [\r\n                                {\r\n                                    text: 'c. Tham gia tuyên truyền, phòng chống tội phạm, các tệ nạn xã hội và các hoạt động khác do lớp, khoa, trường, các đoàn thể, địa phương tổ chức',\r\n                                    style: 'tableSubSubHeader',\r\n                                },\r\n                                { text: '6 điểm', style: 'tablepoint' },\r\n                                { text: `${std_score[9]} điểm`, style: 'tablepoint' },\r\n                                { text: `${stf_score[9]} điểm`, style: 'tablepoint' },\r\n                                { text: `${dep_score[9]} điểm`, style: 'tablepoint' },\r\n                            ],\r\n\r\n                            [\r\n                                { text: 'Điểm tối đa nội dung 3 là', style: 'tableSubHeaderTotal' },\r\n                                { text: '20 điểm', style: 'tableSubPointTotal' },\r\n                                { text: `${sum(std_score, 7, 9)} điểm`, style: 'tableSubPointTotal' },\r\n                                { text: `${sum(stf_score, 7, 9)} điểm`, style: 'tableSubPointTotal' },\r\n                                { text: `${sum(dep_score, 7, 9)} điểm`, style: 'tableSubPointTotal' },\r\n                            ],\r\n                            //////////\r\n                            [\r\n                                {\r\n                                    text: '4. Đánh giá về ý thức công dân trong quan hệ cộng đồng',\r\n                                    style: 'tableSubHeader',\r\n                                },\r\n                                '',\r\n                                '',\r\n                                '',\r\n                                '',\r\n                            ],\r\n                            [\r\n                                {\r\n                                    text: 'a. Chấp hành và tham gia tuyên truyền các chủ trương của Đảng, chính sách, pháp luật của Nhà nước tại nơi cư trú',\r\n                                    style: 'tableSubSubHeader',\r\n                                },\r\n                                { text: '10 điểm', style: 'tablepoint' },\r\n                                { text: `${std_score[10]} điểm`, style: 'tablepoint' },\r\n                                { text: `${stf_score[10]} điểm`, style: 'tablepoint' },\r\n                                { text: `${dep_score[10]} điểm`, style: 'tablepoint' },\r\n                            ],\r\n\r\n                            [\r\n                                {\r\n                                    text: 'b. Được ghi nhận, biểu dương, khen thưởng về tham gia các hoạt động xã hội',\r\n                                    style: 'tableSubSubHeader',\r\n                                },\r\n                                { text: '5 điểm', style: 'tablepoint' },\r\n                                { text: `${std_score[11]} điểm`, style: 'tablepoint' },\r\n                                { text: `${stf_score[11]} điểm`, style: 'tablepoint' },\r\n                                { text: `${dep_score[11]} điểm`, style: 'tablepoint' },\r\n                            ],\r\n                            [\r\n                                {\r\n                                    text: 'c. Có tinh thần chia sẻ, giúp đỡ bạn bè, người thân, người có hoàn cảnh khó khăn, hoạn nạn.',\r\n                                    style: 'tableSubSubHeader',\r\n                                },\r\n                                { text: '10 điểm', style: 'tablepoint' },\r\n                                { text: `${std_score[12]} điểm`, style: 'tablepoint' },\r\n                                { text: `${stf_score[12]} điểm`, style: 'tablepoint' },\r\n                                { text: `${dep_score[12]} điểm`, style: 'tablepoint' },\r\n                            ],\r\n\r\n                            [\r\n                                { text: 'Điểm tối đa nội dung 4 là', style: 'tableSubHeaderTotal' },\r\n                                { text: '25 điểm', style: 'tableSubPointTotal' },\r\n                                { text: `${sum(std_score, 10, 12)} điểm`, style: 'tableSubPointTotal' },\r\n                                { text: `${sum(stf_score, 10, 12)} điểm`, style: 'tableSubPointTotal' },\r\n                                { text: `${sum(dep_score, 10, 12)} điểm`, style: 'tableSubPointTotal' },\r\n                            ],\r\n                            ////////\r\n                            [\r\n                                {\r\n                                    text: '5. Đánh giá về ý thức và kết quả tham gia công tác phụ trách lớp, các đoàn thể, tổ chức trong nhà trường hoặc đạt được thành tích đặc biệt trong học tập, rèn luyện của học sinh, sinh viên',\r\n                                    style: 'tableSubHeader',\r\n                                },\r\n                                '',\r\n                                '',\r\n                                '',\r\n                                '',\r\n                            ],\r\n                            [\r\n                                {\r\n                                    text: 'a. Tham gia tích cực vào phong trào của Lớp, Đoàn, Hội sinh viên và các công tác đoàn thể xã hội khác',\r\n                                    style: 'tableSubSubHeader',\r\n                                },\r\n                                { text: '3 điểm', style: 'tablepoint' },\r\n                                { text: `${std_score[13]} điểm`, style: 'tablepoint' },\r\n                                { text: `${stf_score[13]} điểm`, style: 'tablepoint' },\r\n                                { text: `${dep_score[13]} điểm`, style: 'tablepoint' },\r\n                            ],\r\n\r\n                            [\r\n                                {\r\n                                    text: 'b. Phát huy vai trò và hoàn thành tốt nhiệm vụ người cán bộ Chi đoàn, Lớp, Câu lạc bộ, Đội tự quản',\r\n                                    style: 'tableSubSubHeader',\r\n                                },\r\n                                { text: '3 điểm', style: 'tablepoint' },\r\n                                { text: `${std_score[14]} điểm`, style: 'tablepoint' },\r\n                                { text: `${stf_score[14]} điểm`, style: 'tablepoint' },\r\n                                { text: `${dep_score[14]} điểm`, style: 'tablepoint' },\r\n                            ],\r\n                            [\r\n                                {\r\n                                    text: 'c. Đảm nhiệm, đóng góp có hiệu quả cho công tác Đoàn trường, Hội sinh viên, Liên chi đoàn, Đội tự quản, Câu lạc bộ',\r\n                                    style: 'tableSubSubHeader',\r\n                                },\r\n                                { text: '2 điểm', style: 'tablepoint' },\r\n                                { text: `${std_score[15]} điểm`, style: 'tablepoint' },\r\n                                { text: `${stf_score[15]} điểm`, style: 'tablepoint' },\r\n                                { text: `${dep_score[15]} điểm`, style: 'tablepoint' },\r\n                            ],\r\n                            [\r\n                                {\r\n                                    text: 'd. Được biểu dương, khen thưởng vì có thành tích đặc biệt trong học tập, rèn luyện và các hoạt động khác',\r\n                                    style: 'tableSubSubHeader',\r\n                                },\r\n                                { text: '2 điểm', style: 'tablepoint' },\r\n                                { text: `${std_score[16]} điểm`, style: 'tablepoint' },\r\n                                { text: `${stf_score[16]} điểm`, style: 'tablepoint' },\r\n                                { text: `${dep_score[16]} điểm`, style: 'tablepoint' },\r\n                            ],\r\n\r\n                            [\r\n                                { text: '- Cấp khoa', style: 'tableSubSubSubHeader' },\r\n                                { text: '1 điểm', style: 'tablepoint' },\r\n                                { text: std_score[16] == 1 ? '•' : '', style: 'tablepoint' },\r\n                                { text: stf_score[16] == 1 ? '•' : '', style: 'tablepoint' },\r\n                                { text: dep_score[16] == 1 ? '•' : '', style: 'tablepoint' },\r\n                            ],\r\n                            [\r\n                                { text: '- Cấp trường trở lên', style: 'tableSubSubSubHeader' },\r\n                                { text: '2 điểm', style: 'tablepoint' },\r\n                                { text: std_score[16] == 2 ? '•' : '', style: 'tablepoint' },\r\n                                { text: stf_score[16] == 2 ? '•' : '', style: 'tablepoint' },\r\n                                { text: dep_score[16] == 2 ? '•' : '', style: 'tablepoint' },\r\n                            ],\r\n\r\n                            [\r\n                                { text: 'Điểm tối đa nội dung 5 là', style: 'tableSubHeaderTotal' },\r\n                                { text: '10 điểm', style: 'tableSubPointTotal' },\r\n                                { text: `${sum(std_score, 13, 16)} điểm`, style: 'tableSubPointTotal' },\r\n                                { text: `${sum(stf_score, 13, 16)} điểm`, style: 'tableSubPointTotal' },\r\n                                { text: `${sum(dep_score, 13, 16)} điểm`, style: 'tableSubPointTotal' },\r\n                            ],\r\n                            [\r\n                                { text: 'Tổng điểm tối đa', style: 'tableSubHeaderTotal' },\r\n                                { text: '100 điểm', style: 'tableSubPointTotal' },\r\n                                { text: `${std_score[17]} điểm`, style: 'tableSubPointTotal' },\r\n                                { text: `${stf_score[17]} điểm`, style: 'tableSubPointTotal' },\r\n                                { text: `${dep_score[17]} điểm`, style: 'tableSubPointTotal' },\r\n                            ],\r\n                        ],\r\n                    },\r\n                    layout: {\r\n                        fillColor: function (rowIndex, node, columnIndex) {\r\n                            if (rowIndex === 0) {\r\n                                // Màu cho hàng đầu tiên\r\n                                return '#9fe6ff'; // Ví dụ: Màu đỏ\r\n                            } else {\r\n                                // Màu cho các hàng còn lại\r\n                                return rowIndex % 2 === 0 ? '#e6e6e6' : null;\r\n                            }\r\n                        },\r\n                    },\r\n                },\r\n                { text: 'Ký tên', style: 'subheader', alignment: 'right', margin: [0, 0, 50, 0] },\r\n            ],\r\n            styles: {\r\n                header: {\r\n                    fontSize: 21,\r\n                    bold: true,\r\n                    margin: [0, 0, 0, 10],\r\n                },\r\n                subheader: {\r\n                    fontSize: 16,\r\n                    bold: true,\r\n                    margin: [0, 10, 0, 5],\r\n                },\r\n                tableExample: {\r\n                    margin: [0, 5, 0, 15],\r\n                },\r\n                tableHeader: {\r\n                    bold: true,\r\n                    fontSize: 13,\r\n                    color: 'black',\r\n                    alignment: 'center',\r\n                },\r\n                tableSubHeader: {\r\n                    bold: true,\r\n                    fontSize: 12,\r\n                    color: 'black',\r\n                },\r\n                tableSubHeaderTotal: {\r\n                    bold: true,\r\n                    fontSize: 12,\r\n                    color: 'red',\r\n                },\r\n                tableSubPointTotal: {\r\n                    bold: true,\r\n                    fontSize: 12,\r\n                    color: 'red',\r\n                    alignment: 'center',\r\n                },\r\n                tableSubSubHeader: {\r\n                    bold: true,\r\n                    fontSize: 11,\r\n                    color: 'black',\r\n                },\r\n                tableSubSubSubHeader: {\r\n                    bold: true,\r\n                    fontSize: 10,\r\n                    color: 'black',\r\n                    margin: [15, 0, 0, 0],\r\n                },\r\n                tablepoint: {\r\n                    bold: true,\r\n                    fontSize: 11,\r\n                    color: 'black',\r\n                    alignment: 'center',\r\n                },\r\n            },\r\n            defaultStyle: {\r\n                // alignment: 'justify'\r\n            },\r\n        };\r\n        options = {};\r\n\r\n        const pdfDoc = printer.createPdfKitDocument(docDefinition, options);\r\n        // if (scorce.length > 1) {\r\n        await createPdfAsync(printer, pdfDoc, path.join(path_save, name_zip, namefile));\r\n        // } else {\r\n        //   await createPdfAsync(printer, pdfDoc, path.join(path_save, namefile));\r\n        //   return namefile;\r\n        // }\r\n    }\r\n    // if (scorce.length > 1) {\r\n    archive.pipe(output);\r\n    archive.directory(path.join(path_save, name_zip), false);\r\n    archive.finalize();\r\n    // }\r\n\r\n    // if (scorce.length > 1) {\r\n    return new Promise((resolve, reject) => {\r\n        output.on('close', () => {\r\n            // console.log(\"Nén hoàn tất, kích thước:\", archive.pointer() + \" bytes\");\r\n            fs.rm(path.join(path_save, name_zip), { recursive: true }, (err) => {\r\n                if (err) {\r\n                    console.log('CREATE_PDF | LOG | Lỗi khi xóa thư mục:', err);\r\n                    reject(err);\r\n                } else {\r\n                    // console.log(\"Đã xóa thư mục thành công.\");\r\n                    resolve(name_zip + '.zip');\r\n                }\r\n            });\r\n        });\r\n\r\n        archive.on('error', (err) => {\r\n            console.log('CREATE_PDF | LOG | Lỗi khi nén');\r\n            reject(err);\r\n        });\r\n    });\r\n    // }\r\n}\r\n\r\nmodule.exports = {\r\n    sendEmail,\r\n    checkIfUserLoginAPI,\r\n    checkIfUserLoginRoute,\r\n    get_full_id,\r\n    blockUnwantedPaths,\r\n    mark,\r\n    updateStudentTotalScore,\r\n    randomPassword,\r\n    scheduleFileDeletion,\r\n    sortStudentName,\r\n    createId,\r\n    deleteClassApi,\r\n    createPdf,\r\n    comparePassword,\r\n    hashPassword,\r\n};\r\n"],"mappings":"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","ignoreList":[]}},"mtime":1705997672441},"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\project\\\\web\\\\newCDRL-1\\\\backend\\\\lib\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\project\\\\web\\\\newCDRL-1\",\"filename\":\"D:\\\\project\\\\web\\\\newCDRL-1\\\\backend\\\\lib\\\\csdl_google_lib.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\project\\\\web\\\\newCDRL-1\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.24.3:development":{"value":{"code":"/////////////////////////this is drive....//////////////////////////////\nconst fs = require('fs');\nconst {\n  google\n} = require('googleapis');\nconst NodePersist = require('node-persist');\nconst path = require('path');\n// Load the credentials from the JSON file\nconst credentials = require('../cert/bimat.json');\n// Create a new Google Drive instance\nconst drive = google.drive('v3');\n\n// Initialize the NodePersist storage\nconst storage = NodePersist.create({\n  dir: '.credentials'\n});\n\n// Function to initialize storage asynchronously\nconst initStorage = async () => {\n  await storage.init();\n};\n\n// Authorize the client\nconst auth = new google.auth.OAuth2(credentials.web.client_id, credentials.web.client_secret, credentials.web.redirect_uris && credentials.web.redirect_uris.length > 0 ? credentials.web.redirect_uris[0] : 'http://localhost:8181');\nasync function getNewAccessTokenUsingRefreshToken(refreshToken) {\n  try {\n    auth.setCredentials({\n      refresh_token: refreshToken\n    });\n    const refreshedTokens = await auth.getAccessToken();\n    return refreshedTokens.res.data;\n  } catch (error) {\n    console.log('SYSTEM | DRIVE | Lỗi làm mới mã truy cập:', error);\n  }\n}\n// Generate an access token and refresh token if not available\nconst getAccessToken = async () => {\n  let tokens = await storage.getItem('tokens');\n  let token;\n  if (tokens) {\n    const now = new Date().getTime();\n    if (tokens.expiry_date && tokens.expiry_date > now) {\n      token = tokens.access_token;\n    } else if (tokens.refresh_token) {\n      try {\n        const new_tokens = await getNewAccessTokenUsingRefreshToken(tokens.refresh_token);\n        token = new_tokens.access_token;\n        await storage.setItem('tokens', new_tokens);\n      } catch (error) {\n        console.log('SYSTEM | DRIVE | Error refreshing access token:', error);\n      }\n    }\n  }\n  if (!token) {\n    const authUrl = auth.generateAuthUrl({\n      access_type: 'offline',\n      scope: ['https://www.googleapis.com/auth/drive']\n    });\n    console.log('SYSTEM | DRIVE | Authorize this app by visiting this URL:', authUrl);\n    const code = await getCodeFromUser();\n    tokens = await getAccessTokenFromCode(code);\n    await storage.setItem('tokens', tokens);\n  }\n  auth.setCredentials(tokens);\n};\n\n// Function to get authorization code from user\nconst getCodeFromUser = () => {\n  return new Promise(resolve => {\n    // In this example, we assume the user manually enters the code in the terminal\n    const readline = require('readline');\n    const rl = readline.createInterface({\n      input: process.stdin,\n      output: process.stdout\n    });\n    rl.question('SYSTEM | DRIVE | Enter the authorization code: ', code => {\n      rl.close();\n      resolve(decodeURIComponent(code));\n    });\n  });\n};\n\n// Function to exchange authorization code for access token\nconst getAccessTokenFromCode = code => {\n  return new Promise((resolve, reject) => {\n    auth.getToken(code, (err, token) => {\n      if (err) {\n        reject(err);\n        return;\n      }\n      resolve(token);\n    });\n  });\n};\n\n// Upload the file to Google Drive\nexports.uploadFileToDrive = async (filePath, description, id_folder = '1CyiiQwVN1_99jYcbQvy4M3JeI1m4zyKR') => {\n  await initStorage();\n  await getAccessToken();\n  const fileName = path.basename(filePath);\n  const fileMetadata = {\n    name: fileName,\n    parents: [id_folder],\n    description: description // Bổ sung mô tả vào đây\n  };\n  const media = {\n    mimeType: 'application/octet-stream',\n    body: fs.createReadStream(filePath)\n  };\n  try {\n    const res = await drive.files.create({\n      auth,\n      resource: fileMetadata,\n      media: media,\n      fields: 'id'\n    });\n    fs.unlink(filePath, err => {\n      if (err) {\n        console.log('SYSTEM | DRIVE | ERR |', err);\n        return;\n      }\n    });\n    const permission = {\n      role: 'reader',\n      // Quyền truy cập đọc\n      type: 'anyone' // Cho phép mọi người truy cập\n    };\n    await drive.permissions.create({\n      fileId: res.data.id,\n      resource: permission,\n      fields: 'id',\n      auth: auth\n    });\n    return res.data.id;\n  } catch (err) {\n    console.log('SYSTEM | DRIVE | ERR | uploading file:', err);\n  }\n};\nconst getFileName = async fileId => {\n  const drive = google.drive({\n    version: 'v3',\n    auth\n  });\n  try {\n    const response = await drive.files.get({\n      fileId,\n      fields: 'name'\n    });\n    const fileName = response.data.name;\n    return fileName;\n  } catch (error) {\n    console.log('SYSTEM | DRIVE | Error retrieving file name:', error);\n  }\n};\n\n// Download the file from Google Drive\nexports.downloadFileFromDrive = async fileId => {\n  await initStorage();\n  await getAccessToken();\n  const res = await drive.files.get({\n    fileId,\n    alt: 'media'\n  }, {\n    responseType: 'stream',\n    auth\n  });\n\n  // let fileName = await getFileName(fileId);\n  // const destFilePath = path.join(destDirectory, fileName);\n  // const destFile = fs.createWriteStream(destFilePath);\n\n  return new Promise((resolve, reject) => {\n    const chunks = [];\n    res.data.on('data', chunk => {\n      chunks.push(chunk);\n    }).on('end', () => {\n      const fileContent = Buffer.concat(chunks).toString('utf8');\n      resolve(fileContent);\n    }).on('error', err => {\n      console.log('SYSTEM | DRIVE | Error downloading file:', err);\n      reject(err);\n    });\n    // .pipe(destFile);\n  });\n};\nexports.downloadFileFromDriveforUser = async (fileId, res) => {\n  await initStorage();\n  await getAccessToken();\n  const fileStream = await drive.files.get({\n    fileId,\n    alt: 'media'\n  }, {\n    responseType: 'stream',\n    auth\n  });\n\n  // Get the file name from Google Drive API or use a fixed filename\n  let fileName = await getFileName(fileId);\n  // Set the Content-Disposition header with the desired filename\n  res.setHeader('Content-Disposition', `attachment; filename=\"${fileName}\"`);\n\n  // Pipe the file stream to the response object\n  fileStream.data.on('data', chunk => {\n    res.write(chunk);\n  }).on('end', () => {\n    res.end();\n  }).on('error', err => {\n    console.log('SYSTEM | DRIVE | Error sending file:', err);\n    res.status(500).end(); // Or handle the error in an appropriate way\n  });\n};\nexports.getDriveFileLinkAndDescription = async fileId => {\n  await initStorage();\n  await getAccessToken();\n  const fileMetadata = await drive.files.get({\n    fileId,\n    fields: 'id,description',\n    auth\n  });\n  const directLink = `https://drive.google.com/thumbnail?id=${fileMetadata.data.id}&sz=s4000`;\n  return {\n    fileDescription: fileMetadata.data.description,\n    fileLink: directLink\n  };\n};\nexports.deleteFileFromDrive = async fileId => {\n  await initStorage();\n  await getAccessToken();\n  try {\n    await drive.files.delete({\n      fileId: fileId,\n      auth: auth\n    });\n  } catch (err) {\n    console.log('SYSTEM | DRIVE | Error deleting file:', err);\n  }\n};\n// ------------------------------------------------------------------------------------------------------\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJmcyIsInJlcXVpcmUiLCJnb29nbGUiLCJOb2RlUGVyc2lzdCIsInBhdGgiLCJjcmVkZW50aWFscyIsImRyaXZlIiwic3RvcmFnZSIsImNyZWF0ZSIsImRpciIsImluaXRTdG9yYWdlIiwiaW5pdCIsImF1dGgiLCJPQXV0aDIiLCJ3ZWIiLCJjbGllbnRfaWQiLCJjbGllbnRfc2VjcmV0IiwicmVkaXJlY3RfdXJpcyIsImxlbmd0aCIsImdldE5ld0FjY2Vzc1Rva2VuVXNpbmdSZWZyZXNoVG9rZW4iLCJyZWZyZXNoVG9rZW4iLCJzZXRDcmVkZW50aWFscyIsInJlZnJlc2hfdG9rZW4iLCJyZWZyZXNoZWRUb2tlbnMiLCJnZXRBY2Nlc3NUb2tlbiIsInJlcyIsImRhdGEiLCJlcnJvciIsImNvbnNvbGUiLCJsb2ciLCJ0b2tlbnMiLCJnZXRJdGVtIiwidG9rZW4iLCJub3ciLCJEYXRlIiwiZ2V0VGltZSIsImV4cGlyeV9kYXRlIiwiYWNjZXNzX3Rva2VuIiwibmV3X3Rva2VucyIsInNldEl0ZW0iLCJhdXRoVXJsIiwiZ2VuZXJhdGVBdXRoVXJsIiwiYWNjZXNzX3R5cGUiLCJzY29wZSIsImNvZGUiLCJnZXRDb2RlRnJvbVVzZXIiLCJnZXRBY2Nlc3NUb2tlbkZyb21Db2RlIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWFkbGluZSIsInJsIiwiY3JlYXRlSW50ZXJmYWNlIiwiaW5wdXQiLCJwcm9jZXNzIiwic3RkaW4iLCJvdXRwdXQiLCJzdGRvdXQiLCJxdWVzdGlvbiIsImNsb3NlIiwiZGVjb2RlVVJJQ29tcG9uZW50IiwicmVqZWN0IiwiZ2V0VG9rZW4iLCJlcnIiLCJleHBvcnRzIiwidXBsb2FkRmlsZVRvRHJpdmUiLCJmaWxlUGF0aCIsImRlc2NyaXB0aW9uIiwiaWRfZm9sZGVyIiwiZmlsZU5hbWUiLCJiYXNlbmFtZSIsImZpbGVNZXRhZGF0YSIsIm5hbWUiLCJwYXJlbnRzIiwibWVkaWEiLCJtaW1lVHlwZSIsImJvZHkiLCJjcmVhdGVSZWFkU3RyZWFtIiwiZmlsZXMiLCJyZXNvdXJjZSIsImZpZWxkcyIsInVubGluayIsInBlcm1pc3Npb24iLCJyb2xlIiwidHlwZSIsInBlcm1pc3Npb25zIiwiZmlsZUlkIiwiaWQiLCJnZXRGaWxlTmFtZSIsInZlcnNpb24iLCJyZXNwb25zZSIsImdldCIsImRvd25sb2FkRmlsZUZyb21Ecml2ZSIsImFsdCIsInJlc3BvbnNlVHlwZSIsImNodW5rcyIsIm9uIiwiY2h1bmsiLCJwdXNoIiwiZmlsZUNvbnRlbnQiLCJCdWZmZXIiLCJjb25jYXQiLCJ0b1N0cmluZyIsImRvd25sb2FkRmlsZUZyb21Ecml2ZWZvclVzZXIiLCJmaWxlU3RyZWFtIiwic2V0SGVhZGVyIiwid3JpdGUiLCJlbmQiLCJzdGF0dXMiLCJnZXREcml2ZUZpbGVMaW5rQW5kRGVzY3JpcHRpb24iLCJkaXJlY3RMaW5rIiwiZmlsZURlc2NyaXB0aW9uIiwiZmlsZUxpbmsiLCJkZWxldGVGaWxlRnJvbURyaXZlIiwiZGVsZXRlIl0sInNvdXJjZVJvb3QiOiJEOlxccHJvamVjdFxcd2ViXFxuZXdDRFJMLTFcXGJhY2tlbmRcXGxpYlxcIiwic291cmNlcyI6WyJjc2RsX2dvb2dsZV9saWIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL3RoaXMgaXMgZHJpdmUuLi4uLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcbmNvbnN0IGZzID0gcmVxdWlyZSgnZnMnKTtcclxuY29uc3QgeyBnb29nbGUgfSA9IHJlcXVpcmUoJ2dvb2dsZWFwaXMnKTtcclxuY29uc3QgTm9kZVBlcnNpc3QgPSByZXF1aXJlKCdub2RlLXBlcnNpc3QnKTtcclxuY29uc3QgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKTtcclxuLy8gTG9hZCB0aGUgY3JlZGVudGlhbHMgZnJvbSB0aGUgSlNPTiBmaWxlXHJcbmNvbnN0IGNyZWRlbnRpYWxzID0gcmVxdWlyZSgnLi4vY2VydC9iaW1hdC5qc29uJyk7XHJcbi8vIENyZWF0ZSBhIG5ldyBHb29nbGUgRHJpdmUgaW5zdGFuY2VcclxuY29uc3QgZHJpdmUgPSBnb29nbGUuZHJpdmUoJ3YzJyk7XHJcblxyXG4vLyBJbml0aWFsaXplIHRoZSBOb2RlUGVyc2lzdCBzdG9yYWdlXHJcbmNvbnN0IHN0b3JhZ2UgPSBOb2RlUGVyc2lzdC5jcmVhdGUoe1xyXG4gICAgZGlyOiAnLmNyZWRlbnRpYWxzJyxcclxufSk7XHJcblxyXG4vLyBGdW5jdGlvbiB0byBpbml0aWFsaXplIHN0b3JhZ2UgYXN5bmNocm9ub3VzbHlcclxuY29uc3QgaW5pdFN0b3JhZ2UgPSBhc3luYyAoKSA9PiB7XHJcbiAgICBhd2FpdCBzdG9yYWdlLmluaXQoKTtcclxufTtcclxuXHJcbi8vIEF1dGhvcml6ZSB0aGUgY2xpZW50XHJcbmNvbnN0IGF1dGggPSBuZXcgZ29vZ2xlLmF1dGguT0F1dGgyKFxyXG4gICAgY3JlZGVudGlhbHMud2ViLmNsaWVudF9pZCxcclxuICAgIGNyZWRlbnRpYWxzLndlYi5jbGllbnRfc2VjcmV0LFxyXG4gICAgY3JlZGVudGlhbHMud2ViLnJlZGlyZWN0X3VyaXMgJiYgY3JlZGVudGlhbHMud2ViLnJlZGlyZWN0X3VyaXMubGVuZ3RoID4gMFxyXG4gICAgICAgID8gY3JlZGVudGlhbHMud2ViLnJlZGlyZWN0X3VyaXNbMF1cclxuICAgICAgICA6ICdodHRwOi8vbG9jYWxob3N0OjgxODEnLFxyXG4pO1xyXG5hc3luYyBmdW5jdGlvbiBnZXROZXdBY2Nlc3NUb2tlblVzaW5nUmVmcmVzaFRva2VuKHJlZnJlc2hUb2tlbikge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBhdXRoLnNldENyZWRlbnRpYWxzKHsgcmVmcmVzaF90b2tlbjogcmVmcmVzaFRva2VuIH0pO1xyXG4gICAgICAgIGNvbnN0IHJlZnJlc2hlZFRva2VucyA9IGF3YWl0IGF1dGguZ2V0QWNjZXNzVG9rZW4oKTtcclxuICAgICAgICByZXR1cm4gcmVmcmVzaGVkVG9rZW5zLnJlcy5kYXRhO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnU1lTVEVNIHwgRFJJVkUgfCBM4buXaSBsw6BtIG3hu5tpIG3DoyB0cnV5IGPhuq1wOicsIGVycm9yKTtcclxuICAgIH1cclxufVxyXG4vLyBHZW5lcmF0ZSBhbiBhY2Nlc3MgdG9rZW4gYW5kIHJlZnJlc2ggdG9rZW4gaWYgbm90IGF2YWlsYWJsZVxyXG5jb25zdCBnZXRBY2Nlc3NUb2tlbiA9IGFzeW5jICgpID0+IHtcclxuICAgIGxldCB0b2tlbnMgPSBhd2FpdCBzdG9yYWdlLmdldEl0ZW0oJ3Rva2VucycpO1xyXG4gICAgbGV0IHRva2VuO1xyXG5cclxuICAgIGlmICh0b2tlbnMpIHtcclxuICAgICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcclxuICAgICAgICBpZiAodG9rZW5zLmV4cGlyeV9kYXRlICYmIHRva2Vucy5leHBpcnlfZGF0ZSA+IG5vdykge1xyXG4gICAgICAgICAgICB0b2tlbiA9IHRva2Vucy5hY2Nlc3NfdG9rZW47XHJcbiAgICAgICAgfSBlbHNlIGlmICh0b2tlbnMucmVmcmVzaF90b2tlbikge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmV3X3Rva2VucyA9IGF3YWl0IGdldE5ld0FjY2Vzc1Rva2VuVXNpbmdSZWZyZXNoVG9rZW4odG9rZW5zLnJlZnJlc2hfdG9rZW4pO1xyXG4gICAgICAgICAgICAgICAgdG9rZW4gPSBuZXdfdG9rZW5zLmFjY2Vzc190b2tlbjtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHN0b3JhZ2Uuc2V0SXRlbSgndG9rZW5zJywgbmV3X3Rva2Vucyk7XHJcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnU1lTVEVNIHwgRFJJVkUgfCBFcnJvciByZWZyZXNoaW5nIGFjY2VzcyB0b2tlbjonLCBlcnJvcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCF0b2tlbikge1xyXG4gICAgICAgIGNvbnN0IGF1dGhVcmwgPSBhdXRoLmdlbmVyYXRlQXV0aFVybCh7XHJcbiAgICAgICAgICAgIGFjY2Vzc190eXBlOiAnb2ZmbGluZScsXHJcbiAgICAgICAgICAgIHNjb3BlOiBbJ2h0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2F1dGgvZHJpdmUnXSxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgY29uc29sZS5sb2coJ1NZU1RFTSB8IERSSVZFIHwgQXV0aG9yaXplIHRoaXMgYXBwIGJ5IHZpc2l0aW5nIHRoaXMgVVJMOicsIGF1dGhVcmwpO1xyXG5cclxuICAgICAgICBjb25zdCBjb2RlID0gYXdhaXQgZ2V0Q29kZUZyb21Vc2VyKCk7XHJcbiAgICAgICAgdG9rZW5zID0gYXdhaXQgZ2V0QWNjZXNzVG9rZW5Gcm9tQ29kZShjb2RlKTtcclxuICAgICAgICBhd2FpdCBzdG9yYWdlLnNldEl0ZW0oJ3Rva2VucycsIHRva2Vucyk7XHJcbiAgICB9XHJcblxyXG4gICAgYXV0aC5zZXRDcmVkZW50aWFscyh0b2tlbnMpO1xyXG59O1xyXG5cclxuLy8gRnVuY3Rpb24gdG8gZ2V0IGF1dGhvcml6YXRpb24gY29kZSBmcm9tIHVzZXJcclxuY29uc3QgZ2V0Q29kZUZyb21Vc2VyID0gKCkgPT4ge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XHJcbiAgICAgICAgLy8gSW4gdGhpcyBleGFtcGxlLCB3ZSBhc3N1bWUgdGhlIHVzZXIgbWFudWFsbHkgZW50ZXJzIHRoZSBjb2RlIGluIHRoZSB0ZXJtaW5hbFxyXG4gICAgICAgIGNvbnN0IHJlYWRsaW5lID0gcmVxdWlyZSgncmVhZGxpbmUnKTtcclxuICAgICAgICBjb25zdCBybCA9IHJlYWRsaW5lLmNyZWF0ZUludGVyZmFjZSh7XHJcbiAgICAgICAgICAgIGlucHV0OiBwcm9jZXNzLnN0ZGluLFxyXG4gICAgICAgICAgICBvdXRwdXQ6IHByb2Nlc3Muc3Rkb3V0LFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBybC5xdWVzdGlvbignU1lTVEVNIHwgRFJJVkUgfCBFbnRlciB0aGUgYXV0aG9yaXphdGlvbiBjb2RlOiAnLCAoY29kZSkgPT4ge1xyXG4gICAgICAgICAgICBybC5jbG9zZSgpO1xyXG4gICAgICAgICAgICByZXNvbHZlKGRlY29kZVVSSUNvbXBvbmVudChjb2RlKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbi8vIEZ1bmN0aW9uIHRvIGV4Y2hhbmdlIGF1dGhvcml6YXRpb24gY29kZSBmb3IgYWNjZXNzIHRva2VuXHJcbmNvbnN0IGdldEFjY2Vzc1Rva2VuRnJvbUNvZGUgPSAoY29kZSkgPT4ge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICBhdXRoLmdldFRva2VuKGNvZGUsIChlcnIsIHRva2VuKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChlcnIpIHtcclxuICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJlc29sdmUodG9rZW4pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG4vLyBVcGxvYWQgdGhlIGZpbGUgdG8gR29vZ2xlIERyaXZlXHJcbmV4cG9ydHMudXBsb2FkRmlsZVRvRHJpdmUgPSBhc3luYyAoZmlsZVBhdGgsIGRlc2NyaXB0aW9uLCBpZF9mb2xkZXIgPSAnMUN5aWlRd1ZOMV85OWpZY2JRdnk0TTNKZUkxbTR6eUtSJykgPT4ge1xyXG4gICAgYXdhaXQgaW5pdFN0b3JhZ2UoKTtcclxuICAgIGF3YWl0IGdldEFjY2Vzc1Rva2VuKCk7XHJcbiAgICBjb25zdCBmaWxlTmFtZSA9IHBhdGguYmFzZW5hbWUoZmlsZVBhdGgpO1xyXG4gICAgY29uc3QgZmlsZU1ldGFkYXRhID0ge1xyXG4gICAgICAgIG5hbWU6IGZpbGVOYW1lLFxyXG4gICAgICAgIHBhcmVudHM6IFtpZF9mb2xkZXJdLFxyXG4gICAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbiwgLy8gQuG7lSBzdW5nIG3DtCB04bqjIHbDoG8gxJHDonlcclxuICAgIH07XHJcblxyXG4gICAgY29uc3QgbWVkaWEgPSB7XHJcbiAgICAgICAgbWltZVR5cGU6ICdhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0nLFxyXG4gICAgICAgIGJvZHk6IGZzLmNyZWF0ZVJlYWRTdHJlYW0oZmlsZVBhdGgpLFxyXG4gICAgfTtcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGRyaXZlLmZpbGVzLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgIGF1dGgsXHJcbiAgICAgICAgICAgIHJlc291cmNlOiBmaWxlTWV0YWRhdGEsXHJcbiAgICAgICAgICAgIG1lZGlhOiBtZWRpYSxcclxuICAgICAgICAgICAgZmllbGRzOiAnaWQnLFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBmcy51bmxpbmsoZmlsZVBhdGgsIChlcnIpID0+IHtcclxuICAgICAgICAgICAgaWYgKGVycikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1NZU1RFTSB8IERSSVZFIHwgRVJSIHwnLCBlcnIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY29uc3QgcGVybWlzc2lvbiA9IHtcclxuICAgICAgICAgICAgcm9sZTogJ3JlYWRlcicsIC8vIFF1eeG7gW4gdHJ1eSBj4bqtcCDEkeG7jWNcclxuICAgICAgICAgICAgdHlwZTogJ2FueW9uZScsIC8vIENobyBwaMOpcCBt4buNaSBuZ8aw4budaSB0cnV5IGPhuq1wXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgYXdhaXQgZHJpdmUucGVybWlzc2lvbnMuY3JlYXRlKHtcclxuICAgICAgICAgICAgZmlsZUlkOiByZXMuZGF0YS5pZCxcclxuICAgICAgICAgICAgcmVzb3VyY2U6IHBlcm1pc3Npb24sXHJcbiAgICAgICAgICAgIGZpZWxkczogJ2lkJyxcclxuICAgICAgICAgICAgYXV0aDogYXV0aCxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHJlcy5kYXRhLmlkO1xyXG4gICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ1NZU1RFTSB8IERSSVZFIHwgRVJSIHwgdXBsb2FkaW5nIGZpbGU6JywgZXJyKTtcclxuICAgIH1cclxufTtcclxuXHJcbmNvbnN0IGdldEZpbGVOYW1lID0gYXN5bmMgKGZpbGVJZCkgPT4ge1xyXG4gICAgY29uc3QgZHJpdmUgPSBnb29nbGUuZHJpdmUoeyB2ZXJzaW9uOiAndjMnLCBhdXRoIH0pO1xyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBkcml2ZS5maWxlcy5nZXQoe1xyXG4gICAgICAgICAgICBmaWxlSWQsXHJcbiAgICAgICAgICAgIGZpZWxkczogJ25hbWUnLFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBmaWxlTmFtZSA9IHJlc3BvbnNlLmRhdGEubmFtZTtcclxuICAgICAgICByZXR1cm4gZmlsZU5hbWU7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdTWVNURU0gfCBEUklWRSB8IEVycm9yIHJldHJpZXZpbmcgZmlsZSBuYW1lOicsIGVycm9yKTtcclxuICAgIH1cclxufTtcclxuXHJcbi8vIERvd25sb2FkIHRoZSBmaWxlIGZyb20gR29vZ2xlIERyaXZlXHJcbmV4cG9ydHMuZG93bmxvYWRGaWxlRnJvbURyaXZlID0gYXN5bmMgKGZpbGVJZCkgPT4ge1xyXG4gICAgYXdhaXQgaW5pdFN0b3JhZ2UoKTtcclxuICAgIGF3YWl0IGdldEFjY2Vzc1Rva2VuKCk7XHJcbiAgICBjb25zdCByZXMgPSBhd2FpdCBkcml2ZS5maWxlcy5nZXQoeyBmaWxlSWQsIGFsdDogJ21lZGlhJyB9LCB7IHJlc3BvbnNlVHlwZTogJ3N0cmVhbScsIGF1dGggfSk7XHJcblxyXG4gICAgLy8gbGV0IGZpbGVOYW1lID0gYXdhaXQgZ2V0RmlsZU5hbWUoZmlsZUlkKTtcclxuICAgIC8vIGNvbnN0IGRlc3RGaWxlUGF0aCA9IHBhdGguam9pbihkZXN0RGlyZWN0b3J5LCBmaWxlTmFtZSk7XHJcbiAgICAvLyBjb25zdCBkZXN0RmlsZSA9IGZzLmNyZWF0ZVdyaXRlU3RyZWFtKGRlc3RGaWxlUGF0aCk7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICBjb25zdCBjaHVua3MgPSBbXTtcclxuXHJcbiAgICAgICAgcmVzLmRhdGFcclxuICAgICAgICAgICAgLm9uKCdkYXRhJywgKGNodW5rKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjaHVua3MucHVzaChjaHVuayk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5vbignZW5kJywgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZUNvbnRlbnQgPSBCdWZmZXIuY29uY2F0KGNodW5rcykudG9TdHJpbmcoJ3V0ZjgnKTtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUoZmlsZUNvbnRlbnQpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAub24oJ2Vycm9yJywgKGVycikgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1NZU1RFTSB8IERSSVZFIHwgRXJyb3IgZG93bmxvYWRpbmcgZmlsZTonLCBlcnIpO1xyXG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIC8vIC5waXBlKGRlc3RGaWxlKTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuZXhwb3J0cy5kb3dubG9hZEZpbGVGcm9tRHJpdmVmb3JVc2VyID0gYXN5bmMgKGZpbGVJZCwgcmVzKSA9PiB7XHJcbiAgICBhd2FpdCBpbml0U3RvcmFnZSgpO1xyXG4gICAgYXdhaXQgZ2V0QWNjZXNzVG9rZW4oKTtcclxuICAgIGNvbnN0IGZpbGVTdHJlYW0gPSBhd2FpdCBkcml2ZS5maWxlcy5nZXQoeyBmaWxlSWQsIGFsdDogJ21lZGlhJyB9LCB7IHJlc3BvbnNlVHlwZTogJ3N0cmVhbScsIGF1dGggfSk7XHJcblxyXG4gICAgLy8gR2V0IHRoZSBmaWxlIG5hbWUgZnJvbSBHb29nbGUgRHJpdmUgQVBJIG9yIHVzZSBhIGZpeGVkIGZpbGVuYW1lXHJcbiAgICBsZXQgZmlsZU5hbWUgPSBhd2FpdCBnZXRGaWxlTmFtZShmaWxlSWQpO1xyXG4gICAgLy8gU2V0IHRoZSBDb250ZW50LURpc3Bvc2l0aW9uIGhlYWRlciB3aXRoIHRoZSBkZXNpcmVkIGZpbGVuYW1lXHJcbiAgICByZXMuc2V0SGVhZGVyKCdDb250ZW50LURpc3Bvc2l0aW9uJywgYGF0dGFjaG1lbnQ7IGZpbGVuYW1lPVwiJHtmaWxlTmFtZX1cImApO1xyXG5cclxuICAgIC8vIFBpcGUgdGhlIGZpbGUgc3RyZWFtIHRvIHRoZSByZXNwb25zZSBvYmplY3RcclxuICAgIGZpbGVTdHJlYW0uZGF0YVxyXG4gICAgICAgIC5vbignZGF0YScsIChjaHVuaykgPT4ge1xyXG4gICAgICAgICAgICByZXMud3JpdGUoY2h1bmspO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLm9uKCdlbmQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHJlcy5lbmQoKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5vbignZXJyb3InLCAoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTWVNURU0gfCBEUklWRSB8IEVycm9yIHNlbmRpbmcgZmlsZTonLCBlcnIpO1xyXG4gICAgICAgICAgICByZXMuc3RhdHVzKDUwMCkuZW5kKCk7IC8vIE9yIGhhbmRsZSB0aGUgZXJyb3IgaW4gYW4gYXBwcm9wcmlhdGUgd2F5XHJcbiAgICAgICAgfSk7XHJcbn07XHJcblxyXG5leHBvcnRzLmdldERyaXZlRmlsZUxpbmtBbmREZXNjcmlwdGlvbiA9IGFzeW5jIChmaWxlSWQpID0+IHtcclxuICAgIGF3YWl0IGluaXRTdG9yYWdlKCk7XHJcbiAgICBhd2FpdCBnZXRBY2Nlc3NUb2tlbigpO1xyXG4gICAgY29uc3QgZmlsZU1ldGFkYXRhID0gYXdhaXQgZHJpdmUuZmlsZXMuZ2V0KHsgZmlsZUlkLCBmaWVsZHM6ICdpZCxkZXNjcmlwdGlvbicsIGF1dGggfSk7XHJcbiAgICBjb25zdCBkaXJlY3RMaW5rID0gYGh0dHBzOi8vZHJpdmUuZ29vZ2xlLmNvbS90aHVtYm5haWw/aWQ9JHtmaWxlTWV0YWRhdGEuZGF0YS5pZH0mc3o9czQwMDBgO1xyXG5cclxuICAgIHJldHVybiB7IGZpbGVEZXNjcmlwdGlvbjogZmlsZU1ldGFkYXRhLmRhdGEuZGVzY3JpcHRpb24sIGZpbGVMaW5rOiBkaXJlY3RMaW5rIH07XHJcbn07XHJcbmV4cG9ydHMuZGVsZXRlRmlsZUZyb21Ecml2ZSA9IGFzeW5jIChmaWxlSWQpID0+IHtcclxuICAgIGF3YWl0IGluaXRTdG9yYWdlKCk7XHJcbiAgICBhd2FpdCBnZXRBY2Nlc3NUb2tlbigpO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBhd2FpdCBkcml2ZS5maWxlcy5kZWxldGUoe1xyXG4gICAgICAgICAgICBmaWxlSWQ6IGZpbGVJZCxcclxuICAgICAgICAgICAgYXV0aDogYXV0aCxcclxuICAgICAgICB9KTtcclxuICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdTWVNURU0gfCBEUklWRSB8IEVycm9yIGRlbGV0aW5nIGZpbGU6JywgZXJyKTtcclxuICAgIH1cclxufTtcclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiJdLCJt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","map":{"version":3,"names":["fs","require","google","NodePersist","path","credentials","drive","storage","create","dir","initStorage","init","auth","OAuth2","web","client_id","client_secret","redirect_uris","length","getNewAccessTokenUsingRefreshToken","refreshToken","setCredentials","refresh_token","refreshedTokens","getAccessToken","res","data","error","console","log","tokens","getItem","token","now","Date","getTime","expiry_date","access_token","new_tokens","setItem","authUrl","generateAuthUrl","access_type","scope","code","getCodeFromUser","getAccessTokenFromCode","Promise","resolve","readline","rl","createInterface","input","process","stdin","output","stdout","question","close","decodeURIComponent","reject","getToken","err","exports","uploadFileToDrive","filePath","description","id_folder","fileName","basename","fileMetadata","name","parents","media","mimeType","body","createReadStream","files","resource","fields","unlink","permission","role","type","permissions","fileId","id","getFileName","version","response","get","downloadFileFromDrive","alt","responseType","chunks","on","chunk","push","fileContent","Buffer","concat","toString","downloadFileFromDriveforUser","fileStream","setHeader","write","end","status","getDriveFileLinkAndDescription","directLink","fileDescription","fileLink","deleteFileFromDrive","delete"],"sourceRoot":"D:\\project\\web\\newCDRL-1\\backend\\lib\\","sources":["csdl_google_lib.js"],"sourcesContent":["/////////////////////////this is drive....//////////////////////////////\r\nconst fs = require('fs');\r\nconst { google } = require('googleapis');\r\nconst NodePersist = require('node-persist');\r\nconst path = require('path');\r\n// Load the credentials from the JSON file\r\nconst credentials = require('../cert/bimat.json');\r\n// Create a new Google Drive instance\r\nconst drive = google.drive('v3');\r\n\r\n// Initialize the NodePersist storage\r\nconst storage = NodePersist.create({\r\n    dir: '.credentials',\r\n});\r\n\r\n// Function to initialize storage asynchronously\r\nconst initStorage = async () => {\r\n    await storage.init();\r\n};\r\n\r\n// Authorize the client\r\nconst auth = new google.auth.OAuth2(\r\n    credentials.web.client_id,\r\n    credentials.web.client_secret,\r\n    credentials.web.redirect_uris && credentials.web.redirect_uris.length > 0\r\n        ? credentials.web.redirect_uris[0]\r\n        : 'http://localhost:8181',\r\n);\r\nasync function getNewAccessTokenUsingRefreshToken(refreshToken) {\r\n    try {\r\n        auth.setCredentials({ refresh_token: refreshToken });\r\n        const refreshedTokens = await auth.getAccessToken();\r\n        return refreshedTokens.res.data;\r\n    } catch (error) {\r\n        console.log('SYSTEM | DRIVE | Lỗi làm mới mã truy cập:', error);\r\n    }\r\n}\r\n// Generate an access token and refresh token if not available\r\nconst getAccessToken = async () => {\r\n    let tokens = await storage.getItem('tokens');\r\n    let token;\r\n\r\n    if (tokens) {\r\n        const now = new Date().getTime();\r\n        if (tokens.expiry_date && tokens.expiry_date > now) {\r\n            token = tokens.access_token;\r\n        } else if (tokens.refresh_token) {\r\n            try {\r\n                const new_tokens = await getNewAccessTokenUsingRefreshToken(tokens.refresh_token);\r\n                token = new_tokens.access_token;\r\n                await storage.setItem('tokens', new_tokens);\r\n            } catch (error) {\r\n                console.log('SYSTEM | DRIVE | Error refreshing access token:', error);\r\n            }\r\n        }\r\n    }\r\n\r\n    if (!token) {\r\n        const authUrl = auth.generateAuthUrl({\r\n            access_type: 'offline',\r\n            scope: ['https://www.googleapis.com/auth/drive'],\r\n        });\r\n\r\n        console.log('SYSTEM | DRIVE | Authorize this app by visiting this URL:', authUrl);\r\n\r\n        const code = await getCodeFromUser();\r\n        tokens = await getAccessTokenFromCode(code);\r\n        await storage.setItem('tokens', tokens);\r\n    }\r\n\r\n    auth.setCredentials(tokens);\r\n};\r\n\r\n// Function to get authorization code from user\r\nconst getCodeFromUser = () => {\r\n    return new Promise((resolve) => {\r\n        // In this example, we assume the user manually enters the code in the terminal\r\n        const readline = require('readline');\r\n        const rl = readline.createInterface({\r\n            input: process.stdin,\r\n            output: process.stdout,\r\n        });\r\n\r\n        rl.question('SYSTEM | DRIVE | Enter the authorization code: ', (code) => {\r\n            rl.close();\r\n            resolve(decodeURIComponent(code));\r\n        });\r\n    });\r\n};\r\n\r\n// Function to exchange authorization code for access token\r\nconst getAccessTokenFromCode = (code) => {\r\n    return new Promise((resolve, reject) => {\r\n        auth.getToken(code, (err, token) => {\r\n            if (err) {\r\n                reject(err);\r\n                return;\r\n            }\r\n            resolve(token);\r\n        });\r\n    });\r\n};\r\n\r\n// Upload the file to Google Drive\r\nexports.uploadFileToDrive = async (filePath, description, id_folder = '1CyiiQwVN1_99jYcbQvy4M3JeI1m4zyKR') => {\r\n    await initStorage();\r\n    await getAccessToken();\r\n    const fileName = path.basename(filePath);\r\n    const fileMetadata = {\r\n        name: fileName,\r\n        parents: [id_folder],\r\n        description: description, // Bổ sung mô tả vào đây\r\n    };\r\n\r\n    const media = {\r\n        mimeType: 'application/octet-stream',\r\n        body: fs.createReadStream(filePath),\r\n    };\r\n\r\n    try {\r\n        const res = await drive.files.create({\r\n            auth,\r\n            resource: fileMetadata,\r\n            media: media,\r\n            fields: 'id',\r\n        });\r\n\r\n        fs.unlink(filePath, (err) => {\r\n            if (err) {\r\n                console.log('SYSTEM | DRIVE | ERR |', err);\r\n                return;\r\n            }\r\n        });\r\n        const permission = {\r\n            role: 'reader', // Quyền truy cập đọc\r\n            type: 'anyone', // Cho phép mọi người truy cập\r\n        };\r\n\r\n        await drive.permissions.create({\r\n            fileId: res.data.id,\r\n            resource: permission,\r\n            fields: 'id',\r\n            auth: auth,\r\n        });\r\n\r\n        return res.data.id;\r\n    } catch (err) {\r\n        console.log('SYSTEM | DRIVE | ERR | uploading file:', err);\r\n    }\r\n};\r\n\r\nconst getFileName = async (fileId) => {\r\n    const drive = google.drive({ version: 'v3', auth });\r\n\r\n    try {\r\n        const response = await drive.files.get({\r\n            fileId,\r\n            fields: 'name',\r\n        });\r\n\r\n        const fileName = response.data.name;\r\n        return fileName;\r\n    } catch (error) {\r\n        console.log('SYSTEM | DRIVE | Error retrieving file name:', error);\r\n    }\r\n};\r\n\r\n// Download the file from Google Drive\r\nexports.downloadFileFromDrive = async (fileId) => {\r\n    await initStorage();\r\n    await getAccessToken();\r\n    const res = await drive.files.get({ fileId, alt: 'media' }, { responseType: 'stream', auth });\r\n\r\n    // let fileName = await getFileName(fileId);\r\n    // const destFilePath = path.join(destDirectory, fileName);\r\n    // const destFile = fs.createWriteStream(destFilePath);\r\n\r\n    return new Promise((resolve, reject) => {\r\n        const chunks = [];\r\n\r\n        res.data\r\n            .on('data', (chunk) => {\r\n                chunks.push(chunk);\r\n            })\r\n            .on('end', () => {\r\n                const fileContent = Buffer.concat(chunks).toString('utf8');\r\n                resolve(fileContent);\r\n            })\r\n            .on('error', (err) => {\r\n                console.log('SYSTEM | DRIVE | Error downloading file:', err);\r\n                reject(err);\r\n            });\r\n        // .pipe(destFile);\r\n    });\r\n};\r\n\r\nexports.downloadFileFromDriveforUser = async (fileId, res) => {\r\n    await initStorage();\r\n    await getAccessToken();\r\n    const fileStream = await drive.files.get({ fileId, alt: 'media' }, { responseType: 'stream', auth });\r\n\r\n    // Get the file name from Google Drive API or use a fixed filename\r\n    let fileName = await getFileName(fileId);\r\n    // Set the Content-Disposition header with the desired filename\r\n    res.setHeader('Content-Disposition', `attachment; filename=\"${fileName}\"`);\r\n\r\n    // Pipe the file stream to the response object\r\n    fileStream.data\r\n        .on('data', (chunk) => {\r\n            res.write(chunk);\r\n        })\r\n        .on('end', () => {\r\n            res.end();\r\n        })\r\n        .on('error', (err) => {\r\n            console.log('SYSTEM | DRIVE | Error sending file:', err);\r\n            res.status(500).end(); // Or handle the error in an appropriate way\r\n        });\r\n};\r\n\r\nexports.getDriveFileLinkAndDescription = async (fileId) => {\r\n    await initStorage();\r\n    await getAccessToken();\r\n    const fileMetadata = await drive.files.get({ fileId, fields: 'id,description', auth });\r\n    const directLink = `https://drive.google.com/thumbnail?id=${fileMetadata.data.id}&sz=s4000`;\r\n\r\n    return { fileDescription: fileMetadata.data.description, fileLink: directLink };\r\n};\r\nexports.deleteFileFromDrive = async (fileId) => {\r\n    await initStorage();\r\n    await getAccessToken();\r\n    try {\r\n        await drive.files.delete({\r\n            fileId: fileId,\r\n            auth: auth,\r\n        });\r\n    } catch (err) {\r\n        console.log('SYSTEM | DRIVE | Error deleting file:', err);\r\n    }\r\n};\r\n// ------------------------------------------------------------------------------------------------------\r\n"],"mappings":"AAAA;AACA,MAAMA,EAAE,GAAGC,OAAO,CAAC,IAAI,CAAC;AACxB,MAAM;EAAEC;AAAO,CAAC,GAAGD,OAAO,CAAC,YAAY,CAAC;AACxC,MAAME,WAAW,GAAGF,OAAO,CAAC,cAAc,CAAC;AAC3C,MAAMG,IAAI,GAAGH,OAAO,CAAC,MAAM,CAAC;AAC5B;AACA,MAAMI,WAAW,GAAGJ,OAAO,CAAC,oBAAoB,CAAC;AACjD;AACA,MAAMK,KAAK,GAAGJ,MAAM,CAACI,KAAK,CAAC,IAAI,CAAC;;AAEhC;AACA,MAAMC,OAAO,GAAGJ,WAAW,CAACK,MAAM,CAAC;EAC/BC,GAAG,EAAE;AACT,CAAC,CAAC;;AAEF;AACA,MAAMC,WAAW,GAAG,MAAAA,CAAA,KAAY;EAC5B,MAAMH,OAAO,CAACI,IAAI,CAAC,CAAC;AACxB,CAAC;;AAED;AACA,MAAMC,IAAI,GAAG,IAAIV,MAAM,CAACU,IAAI,CAACC,MAAM,CAC/BR,WAAW,CAACS,GAAG,CAACC,SAAS,EACzBV,WAAW,CAACS,GAAG,CAACE,aAAa,EAC7BX,WAAW,CAACS,GAAG,CAACG,aAAa,IAAIZ,WAAW,CAACS,GAAG,CAACG,aAAa,CAACC,MAAM,GAAG,CAAC,GACnEb,WAAW,CAACS,GAAG,CAACG,aAAa,CAAC,CAAC,CAAC,GAChC,uBACV,CAAC;AACD,eAAeE,kCAAkCA,CAACC,YAAY,EAAE;EAC5D,IAAI;IACAR,IAAI,CAACS,cAAc,CAAC;MAAEC,aAAa,EAAEF;IAAa,CAAC,CAAC;IACpD,MAAMG,eAAe,GAAG,MAAMX,IAAI,CAACY,cAAc,CAAC,CAAC;IACnD,OAAOD,eAAe,CAACE,GAAG,CAACC,IAAI;EACnC,CAAC,CAAC,OAAOC,KAAK,EAAE;IACZC,OAAO,CAACC,GAAG,CAAC,2CAA2C,EAAEF,KAAK,CAAC;EACnE;AACJ;AACA;AACA,MAAMH,cAAc,GAAG,MAAAA,CAAA,KAAY;EAC/B,IAAIM,MAAM,GAAG,MAAMvB,OAAO,CAACwB,OAAO,CAAC,QAAQ,CAAC;EAC5C,IAAIC,KAAK;EAET,IAAIF,MAAM,EAAE;IACR,MAAMG,GAAG,GAAG,IAAIC,IAAI,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC;IAChC,IAAIL,MAAM,CAACM,WAAW,IAAIN,MAAM,CAACM,WAAW,GAAGH,GAAG,EAAE;MAChDD,KAAK,GAAGF,MAAM,CAACO,YAAY;IAC/B,CAAC,MAAM,IAAIP,MAAM,CAACR,aAAa,EAAE;MAC7B,IAAI;QACA,MAAMgB,UAAU,GAAG,MAAMnB,kCAAkC,CAACW,MAAM,CAACR,aAAa,CAAC;QACjFU,KAAK,GAAGM,UAAU,CAACD,YAAY;QAC/B,MAAM9B,OAAO,CAACgC,OAAO,CAAC,QAAQ,EAAED,UAAU,CAAC;MAC/C,CAAC,CAAC,OAAOX,KAAK,EAAE;QACZC,OAAO,CAACC,GAAG,CAAC,iDAAiD,EAAEF,KAAK,CAAC;MACzE;IACJ;EACJ;EAEA,IAAI,CAACK,KAAK,EAAE;IACR,MAAMQ,OAAO,GAAG5B,IAAI,CAAC6B,eAAe,CAAC;MACjCC,WAAW,EAAE,SAAS;MACtBC,KAAK,EAAE,CAAC,uCAAuC;IACnD,CAAC,CAAC;IAEFf,OAAO,CAACC,GAAG,CAAC,2DAA2D,EAAEW,OAAO,CAAC;IAEjF,MAAMI,IAAI,GAAG,MAAMC,eAAe,CAAC,CAAC;IACpCf,MAAM,GAAG,MAAMgB,sBAAsB,CAACF,IAAI,CAAC;IAC3C,MAAMrC,OAAO,CAACgC,OAAO,CAAC,QAAQ,EAAET,MAAM,CAAC;EAC3C;EAEAlB,IAAI,CAACS,cAAc,CAACS,MAAM,CAAC;AAC/B,CAAC;;AAED;AACA,MAAMe,eAAe,GAAGA,CAAA,KAAM;EAC1B,OAAO,IAAIE,OAAO,CAAEC,OAAO,IAAK;IAC5B;IACA,MAAMC,QAAQ,GAAGhD,OAAO,CAAC,UAAU,CAAC;IACpC,MAAMiD,EAAE,GAAGD,QAAQ,CAACE,eAAe,CAAC;MAChCC,KAAK,EAAEC,OAAO,CAACC,KAAK;MACpBC,MAAM,EAAEF,OAAO,CAACG;IACpB,CAAC,CAAC;IAEFN,EAAE,CAACO,QAAQ,CAAC,iDAAiD,EAAGb,IAAI,IAAK;MACrEM,EAAE,CAACQ,KAAK,CAAC,CAAC;MACVV,OAAO,CAACW,kBAAkB,CAACf,IAAI,CAAC,CAAC;IACrC,CAAC,CAAC;EACN,CAAC,CAAC;AACN,CAAC;;AAED;AACA,MAAME,sBAAsB,GAAIF,IAAI,IAAK;EACrC,OAAO,IAAIG,OAAO,CAAC,CAACC,OAAO,EAAEY,MAAM,KAAK;IACpChD,IAAI,CAACiD,QAAQ,CAACjB,IAAI,EAAE,CAACkB,GAAG,EAAE9B,KAAK,KAAK;MAChC,IAAI8B,GAAG,EAAE;QACLF,MAAM,CAACE,GAAG,CAAC;QACX;MACJ;MACAd,OAAO,CAAChB,KAAK,CAAC;IAClB,CAAC,CAAC;EACN,CAAC,CAAC;AACN,CAAC;;AAED;AACA+B,OAAO,CAACC,iBAAiB,GAAG,OAAOC,QAAQ,EAAEC,WAAW,EAAEC,SAAS,GAAG,mCAAmC,KAAK;EAC1G,MAAMzD,WAAW,CAAC,CAAC;EACnB,MAAMc,cAAc,CAAC,CAAC;EACtB,MAAM4C,QAAQ,GAAGhE,IAAI,CAACiE,QAAQ,CAACJ,QAAQ,CAAC;EACxC,MAAMK,YAAY,GAAG;IACjBC,IAAI,EAAEH,QAAQ;IACdI,OAAO,EAAE,CAACL,SAAS,CAAC;IACpBD,WAAW,EAAEA,WAAW,CAAE;EAC9B,CAAC;EAED,MAAMO,KAAK,GAAG;IACVC,QAAQ,EAAE,0BAA0B;IACpCC,IAAI,EAAE3E,EAAE,CAAC4E,gBAAgB,CAACX,QAAQ;EACtC,CAAC;EAED,IAAI;IACA,MAAMxC,GAAG,GAAG,MAAMnB,KAAK,CAACuE,KAAK,CAACrE,MAAM,CAAC;MACjCI,IAAI;MACJkE,QAAQ,EAAER,YAAY;MACtBG,KAAK,EAAEA,KAAK;MACZM,MAAM,EAAE;IACZ,CAAC,CAAC;IAEF/E,EAAE,CAACgF,MAAM,CAACf,QAAQ,EAAGH,GAAG,IAAK;MACzB,IAAIA,GAAG,EAAE;QACLlC,OAAO,CAACC,GAAG,CAAC,wBAAwB,EAAEiC,GAAG,CAAC;QAC1C;MACJ;IACJ,CAAC,CAAC;IACF,MAAMmB,UAAU,GAAG;MACfC,IAAI,EAAE,QAAQ;MAAE;MAChBC,IAAI,EAAE,QAAQ,CAAE;IACpB,CAAC;IAED,MAAM7E,KAAK,CAAC8E,WAAW,CAAC5E,MAAM,CAAC;MAC3B6E,MAAM,EAAE5D,GAAG,CAACC,IAAI,CAAC4D,EAAE;MACnBR,QAAQ,EAAEG,UAAU;MACpBF,MAAM,EAAE,IAAI;MACZnE,IAAI,EAAEA;IACV,CAAC,CAAC;IAEF,OAAOa,GAAG,CAACC,IAAI,CAAC4D,EAAE;EACtB,CAAC,CAAC,OAAOxB,GAAG,EAAE;IACVlC,OAAO,CAACC,GAAG,CAAC,wCAAwC,EAAEiC,GAAG,CAAC;EAC9D;AACJ,CAAC;AAED,MAAMyB,WAAW,GAAG,MAAOF,MAAM,IAAK;EAClC,MAAM/E,KAAK,GAAGJ,MAAM,CAACI,KAAK,CAAC;IAAEkF,OAAO,EAAE,IAAI;IAAE5E;EAAK,CAAC,CAAC;EAEnD,IAAI;IACA,MAAM6E,QAAQ,GAAG,MAAMnF,KAAK,CAACuE,KAAK,CAACa,GAAG,CAAC;MACnCL,MAAM;MACNN,MAAM,EAAE;IACZ,CAAC,CAAC;IAEF,MAAMX,QAAQ,GAAGqB,QAAQ,CAAC/D,IAAI,CAAC6C,IAAI;IACnC,OAAOH,QAAQ;EACnB,CAAC,CAAC,OAAOzC,KAAK,EAAE;IACZC,OAAO,CAACC,GAAG,CAAC,8CAA8C,EAAEF,KAAK,CAAC;EACtE;AACJ,CAAC;;AAED;AACAoC,OAAO,CAAC4B,qBAAqB,GAAG,MAAON,MAAM,IAAK;EAC9C,MAAM3E,WAAW,CAAC,CAAC;EACnB,MAAMc,cAAc,CAAC,CAAC;EACtB,MAAMC,GAAG,GAAG,MAAMnB,KAAK,CAACuE,KAAK,CAACa,GAAG,CAAC;IAAEL,MAAM;IAAEO,GAAG,EAAE;EAAQ,CAAC,EAAE;IAAEC,YAAY,EAAE,QAAQ;IAAEjF;EAAK,CAAC,CAAC;;EAE7F;EACA;EACA;;EAEA,OAAO,IAAImC,OAAO,CAAC,CAACC,OAAO,EAAEY,MAAM,KAAK;IACpC,MAAMkC,MAAM,GAAG,EAAE;IAEjBrE,GAAG,CAACC,IAAI,CACHqE,EAAE,CAAC,MAAM,EAAGC,KAAK,IAAK;MACnBF,MAAM,CAACG,IAAI,CAACD,KAAK,CAAC;IACtB,CAAC,CAAC,CACDD,EAAE,CAAC,KAAK,EAAE,MAAM;MACb,MAAMG,WAAW,GAAGC,MAAM,CAACC,MAAM,CAACN,MAAM,CAAC,CAACO,QAAQ,CAAC,MAAM,CAAC;MAC1DrD,OAAO,CAACkD,WAAW,CAAC;IACxB,CAAC,CAAC,CACDH,EAAE,CAAC,OAAO,EAAGjC,GAAG,IAAK;MAClBlC,OAAO,CAACC,GAAG,CAAC,0CAA0C,EAAEiC,GAAG,CAAC;MAC5DF,MAAM,CAACE,GAAG,CAAC;IACf,CAAC,CAAC;IACN;EACJ,CAAC,CAAC;AACN,CAAC;AAEDC,OAAO,CAACuC,4BAA4B,GAAG,OAAOjB,MAAM,EAAE5D,GAAG,KAAK;EAC1D,MAAMf,WAAW,CAAC,CAAC;EACnB,MAAMc,cAAc,CAAC,CAAC;EACtB,MAAM+E,UAAU,GAAG,MAAMjG,KAAK,CAACuE,KAAK,CAACa,GAAG,CAAC;IAAEL,MAAM;IAAEO,GAAG,EAAE;EAAQ,CAAC,EAAE;IAAEC,YAAY,EAAE,QAAQ;IAAEjF;EAAK,CAAC,CAAC;;EAEpG;EACA,IAAIwD,QAAQ,GAAG,MAAMmB,WAAW,CAACF,MAAM,CAAC;EACxC;EACA5D,GAAG,CAAC+E,SAAS,CAAC,qBAAqB,EAAG,yBAAwBpC,QAAS,GAAE,CAAC;;EAE1E;EACAmC,UAAU,CAAC7E,IAAI,CACVqE,EAAE,CAAC,MAAM,EAAGC,KAAK,IAAK;IACnBvE,GAAG,CAACgF,KAAK,CAACT,KAAK,CAAC;EACpB,CAAC,CAAC,CACDD,EAAE,CAAC,KAAK,EAAE,MAAM;IACbtE,GAAG,CAACiF,GAAG,CAAC,CAAC;EACb,CAAC,CAAC,CACDX,EAAE,CAAC,OAAO,EAAGjC,GAAG,IAAK;IAClBlC,OAAO,CAACC,GAAG,CAAC,sCAAsC,EAAEiC,GAAG,CAAC;IACxDrC,GAAG,CAACkF,MAAM,CAAC,GAAG,CAAC,CAACD,GAAG,CAAC,CAAC,CAAC,CAAC;EAC3B,CAAC,CAAC;AACV,CAAC;AAED3C,OAAO,CAAC6C,8BAA8B,GAAG,MAAOvB,MAAM,IAAK;EACvD,MAAM3E,WAAW,CAAC,CAAC;EACnB,MAAMc,cAAc,CAAC,CAAC;EACtB,MAAM8C,YAAY,GAAG,MAAMhE,KAAK,CAACuE,KAAK,CAACa,GAAG,CAAC;IAAEL,MAAM;IAAEN,MAAM,EAAE,gBAAgB;IAAEnE;EAAK,CAAC,CAAC;EACtF,MAAMiG,UAAU,GAAI,yCAAwCvC,YAAY,CAAC5C,IAAI,CAAC4D,EAAG,WAAU;EAE3F,OAAO;IAAEwB,eAAe,EAAExC,YAAY,CAAC5C,IAAI,CAACwC,WAAW;IAAE6C,QAAQ,EAAEF;EAAW,CAAC;AACnF,CAAC;AACD9C,OAAO,CAACiD,mBAAmB,GAAG,MAAO3B,MAAM,IAAK;EAC5C,MAAM3E,WAAW,CAAC,CAAC;EACnB,MAAMc,cAAc,CAAC,CAAC;EACtB,IAAI;IACA,MAAMlB,KAAK,CAACuE,KAAK,CAACoC,MAAM,CAAC;MACrB5B,MAAM,EAAEA,MAAM;MACdzE,IAAI,EAAEA;IACV,CAAC,CAAC;EACN,CAAC,CAAC,OAAOkD,GAAG,EAAE;IACVlC,OAAO,CAACC,GAAG,CAAC,uCAAuC,EAAEiC,GAAG,CAAC;EAC7D;AACJ,CAAC;AACD","ignoreList":[]}},"mtime":1719476170723},"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\project\\\\web\\\\newCDRL-1\\\\backend\\\\router\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\project\\\\web\\\\newCDRL-1\",\"filename\":\"D:\\\\project\\\\web\\\\newCDRL-1\\\\backend\\\\router\\\\rootRouters.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\project\\\\web\\\\newCDRL-1\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.24.3:development":{"value":{"code":"const express = require('express');\nconst router = express.Router();\nconst {\n  checkIfUserLoginRoute\n} = require('../lib/function_lib');\nconst {\n  getNameGlobal\n} = require('../lib/mogodb_lib');\nconst name_global_databases = getNameGlobal();\nconst path = require('path');\nfunction createRootRouter(client, parentDirectory) {\n  // index route\n  router.get('/', checkIfUserLoginRoute, async (req, res) => {\n    // kiểm tra châm điểm\n    const school_year = await client.db(name_global_databases).collection('school_year').findOne({}, {\n      projection: {\n        _id: 0,\n        year: 1,\n        start_day: 1,\n        end_day: 1\n      }\n    });\n    const check_y = () => {\n      let today = new Date().getTime();\n      let start_day = new Date(school_year.start_day).getTime();\n      let end_day = new Date(school_year.end_day).getTime();\n      let forever_day = new Date('2003-10-18').getTime(); // special date\n\n      // check if end mark time or not\n      if (start_day <= today && (today < end_day || end_day == forever_day)) {\n        return true;\n      } else {\n        return false;\n      }\n    };\n    let check_year = check_y();\n    // console.log(check_year);\n    //\n    try {\n      const user = req.session.user;\n      if (user.pow[0]) {\n        const schoolYear = await client.db(name_global_databases).collection('school_year').findOne({}, {\n          projection: {\n            _id: 0,\n            year: 1\n          }\n        });\n        if (user.cls[0]) {\n          const schoolYear_all = await client.db(name_global_databases).collection('classes').findOne({\n            _id: user.cls[0]\n          }, {\n            projection: {\n              _id: 0,\n              years: 1\n            }\n          });\n          let schoolYearsToSearch = [];\n          if (schoolYear_all.years[schoolYear.year.slice(4)]) {\n            for (let i = 0; i < Object.keys(schoolYear_all.years[schoolYear.year.slice(4)]).length; i++) {\n              schoolYearsToSearch.push(`HK${i + 1}_` + schoolYear.year.slice(4));\n            }\n            // console.log(\"xx\",schoolYear_all.years[schoolYear.year.slice(4)]);\n\n            const studentTotalScores = await Promise.all(schoolYearsToSearch.map(async year => {\n              // Tìm trong bảng '_dep_table' trước\n              const depCollection = client.db(user.dep).collection(user.cls[0] + '_dep_table');\n              const stfCollection = client.db(user.dep).collection(user.cls[0] + '_stf_table');\n              const stdCollection = client.db(user.dep).collection(user.cls[0] + '_std_table');\n              const depDocument = await depCollection.findOne({\n                mssv: user._id,\n                school_year: year\n              }, {\n                projection: {\n                  _id: 0,\n                  total: 1\n                }\n              });\n              if (depDocument) {\n                return {\n                  year: year,\n                  total: depDocument.total\n                };\n              }\n              const stfDocument = await stfCollection.findOne({\n                mssv: user._id,\n                school_year: year\n              }, {\n                projection: {\n                  _id: 0,\n                  total: 1\n                }\n              });\n              if (stfDocument) {\n                return {\n                  year: year,\n                  total: stfDocument.total\n                };\n              }\n              const stdDocument = await stdCollection.findOne({\n                mssv: user._id,\n                school_year: year\n              }, {\n                projection: {\n                  _id: 0,\n                  total: 1\n                }\n              });\n              if (stdDocument) {\n                return {\n                  year: year,\n                  total: stdDocument.total\n                };\n              }\n              return {\n                year: year,\n                total: 'Chưa có điểm'\n              };\n            }));\n            console.log(studentTotalScores);\n            const studentActivities = await Promise.all(schoolYearsToSearch.map(async year => {\n              info_search = `student_list.${user._id}`;\n              let activitie_info_lop = await client.db(user.dep).collection(`${user.cls[0]}_activities`).find({\n                [info_search]: {\n                  $exists: true\n                },\n                year: year\n              }, {\n                projection: {\n                  name: 1,\n                  student_list: 1,\n                  ai: 1,\n                  level: 1\n                }\n              }).toArray();\n              if (activitie_info_lop.length > 0) {\n                activitie_info_lop.forEach(element => {\n                  if (element.ai && element.ai[user._id]) {\n                    element.thamgia = true;\n                  }\n                  if (element.student_list[user._id] == 2) {\n                    element.khenthuong = true;\n                  }\n                });\n              }\n              let activitie_info_khoa = await client.db(user.dep).collection('activities').find({\n                [info_search]: {\n                  $exists: true\n                },\n                year: year\n              }, {\n                projection: {\n                  name: 1,\n                  student_list: 1,\n                  ai: 1,\n                  level: 1\n                }\n              }).toArray();\n              if (activitie_info_khoa.length > 0) {\n                activitie_info_khoa.forEach(element => {\n                  if (element.ai && element.ai[user._id]) {\n                    element.thamgia = true;\n                  }\n                  if (element.student_list[user._id] == 2) {\n                    element.khenthuong = true;\n                  }\n                });\n              }\n              let activitie_info_truong = await client.db(name_global_databases).collection('activities').find({\n                [info_search]: {\n                  $exists: true\n                },\n                year: year\n              }, {\n                projection: {\n                  name: 1,\n                  student_list: 1,\n                  ai: 1,\n                  level: 1\n                }\n              }).toArray();\n              if (activitie_info_truong.length > 0) {\n                activitie_info_truong.forEach(element => {\n                  if (element.ai && element.ai[user._id]) {\n                    element.thamgia = true;\n                  }\n                  if (element.student_list[user._id] == 2) {\n                    element.khenthuong = true;\n                  }\n                });\n              }\n              return {\n                year: year,\n                activitie_info_lop: activitie_info_lop,\n                activitie_info_khoa: activitie_info_khoa,\n                activitie_info_truong: activitie_info_truong\n              };\n            }));\n            if (user.pow[0] && !user.pow[1] && !user.pow[2] && !user.pow[3] && !user.pow[4] && !user.pow[5] && !user.pow[6] && !user.pow[7] && !user.pow[8]) {\n              return res.render('sinhvien-index', {\n                header: 'global-header',\n                footer: 'global-footer',\n                thongbao: 'global-notifications',\n                bandiem: studentTotalScores,\n                hoatdong: studentActivities,\n                hethan: false,\n                nienkhoa: Object.keys(schoolYear_all.years),\n                check_chamdiem: check_year\n              });\n            } else if (user.pow[0] && user.pow[1] && !user.pow[2] && user.pow[3] && !user.pow[4] && !user.pow[5] && !user.pow[6] && !user.pow[7] && !user.pow[8]) {\n              return res.render('bancansu-index', {\n                header: 'global-header',\n                footer: 'global-footer',\n                thongbao: 'global-notifications',\n                pow: 0,\n                bandiem: studentTotalScores,\n                hoatdong: studentActivities,\n                hethan: false,\n                nienkhoa: Object.keys(schoolYear_all.years),\n                check_chamdiem: check_year\n              });\n            } else if (user.pow[0] && user.pow[1] && !user.pow[2] && !user.pow[3] && !user.pow[4] && !user.pow[5] && !user.pow[6] && !user.pow[7] && !user.pow[8]) {\n              return res.render('bancansu-index', {\n                header: 'global-header',\n                footer: 'global-footer',\n                thongbao: 'global-notifications',\n                pow: 1,\n                bandiem: studentTotalScores,\n                hoatdong: studentActivities,\n                hethan: false,\n                nienkhoa: Object.keys(schoolYear_all.years),\n                check_chamdiem: check_year\n              });\n            } else if (user.pow[0] && !user.pow[1] && !user.pow[2] && user.pow[3] && !user.pow[4] && !user.pow[5] && !user.pow[6] && !user.pow[7] && !user.pow[8]) {\n              return res.render('bancansu-index', {\n                header: 'global-header',\n                footer: 'global-footer',\n                thongbao: 'global-notifications',\n                pow: 2,\n                bandiem: studentTotalScores,\n                hoatdong: studentActivities,\n                hethan: false,\n                nienkhoa: Object.keys(schoolYear_all.years),\n                check_chamdiem: check_year\n              });\n            }\n          } else {\n            // console.log(\"xx\",schoolYear_all.years[schoolYear.year.slice(4)]);\n            for (let i = 0; i < 3; i++) {\n              schoolYearsToSearch.push(`HK${i + 1}_` + schoolYear.year.slice(4));\n            }\n            const studentTotalScores = await Promise.all(schoolYearsToSearch.map(async year => {\n              // Tìm trong bảng '_dep_table' trước\n              const depCollection = client.db(user.dep).collection(user.cls[0] + '_dep_table');\n              const stfCollection = client.db(user.dep).collection(user.cls[0] + '_stf_table');\n              const stdCollection = client.db(user.dep).collection(user.cls[0] + '_std_table');\n              const depDocument = await depCollection.findOne({\n                mssv: user._id,\n                school_year: year\n              }, {\n                projection: {\n                  _id: 0,\n                  total: 1\n                }\n              });\n              if (depDocument) {\n                return {\n                  year: year,\n                  total: depDocument.total\n                };\n              }\n              const stfDocument = await stfCollection.findOne({\n                mssv: user._id,\n                school_year: year\n              }, {\n                projection: {\n                  _id: 0,\n                  total: 1\n                }\n              });\n              if (stfDocument) {\n                return {\n                  year: year,\n                  total: stfDocument.total\n                };\n              }\n              const stdDocument = await stdCollection.findOne({\n                mssv: user._id,\n                school_year: year\n              }, {\n                projection: {\n                  _id: 0,\n                  total: 1\n                }\n              });\n              if (stdDocument) {\n                return {\n                  year: year,\n                  total: stdDocument.total\n                };\n              }\n              return {\n                year: year,\n                total: 'Chưa có điểm'\n              };\n            }));\n            console.log(studentTotalScores);\n            const studentActivities = await Promise.all(schoolYearsToSearch.map(async year => {\n              info_search = `student_list.${user._id}`;\n              let activitie_info_lop = await client.db(user.dep).collection(`${user.cls[0]}_activities`).find({\n                [info_search]: {\n                  $exists: true\n                },\n                year: year\n              }, {\n                projection: {\n                  name: 1,\n                  student_list: 1,\n                  ai: 1,\n                  level: 1\n                }\n              }).toArray();\n              if (activitie_info_lop.length > 0) {\n                activitie_info_lop.forEach(element => {\n                  if (element.ai && element.ai[user._id]) {\n                    element.thamgia = true;\n                  }\n                  if (element.student_list[user._id] == 2) {\n                    element.khenthuong = true;\n                  }\n                });\n              }\n              let activitie_info_khoa = await client.db(user.dep).collection('activities').find({\n                [info_search]: {\n                  $exists: true\n                },\n                year: year\n              }, {\n                projection: {\n                  name: 1,\n                  student_list: 1,\n                  ai: 1,\n                  level: 1\n                }\n              }).toArray();\n              if (activitie_info_khoa.length > 0) {\n                activitie_info_khoa.forEach(element => {\n                  if (element.ai && element.ai[user._id]) {\n                    element.thamgia = true;\n                  }\n                  if (element.student_list[user._id] == 2) {\n                    element.khenthuong = true;\n                  }\n                });\n              }\n              let activitie_info_truong = await client.db(name_global_databases).collection('activities').find({\n                [info_search]: {\n                  $exists: true\n                },\n                year: year\n              }, {\n                projection: {\n                  name: 1,\n                  student_list: 1,\n                  ai: 1,\n                  level: 1\n                }\n              }).toArray();\n              if (activitie_info_truong.length > 0) {\n                activitie_info_truong.forEach(element => {\n                  if (element.ai && element.ai[user._id]) {\n                    element.thamgia = true;\n                  }\n                  if (element.student_list[user._id] == 2) {\n                    element.khenthuong = true;\n                  }\n                });\n              }\n              return {\n                year: year,\n                activitie_info_lop: activitie_info_lop,\n                activitie_info_khoa: activitie_info_khoa,\n                activitie_info_truong: activitie_info_truong\n              };\n            }));\n            if (user.pow[0] && !user.pow[1] && !user.pow[2] && !user.pow[3] && !user.pow[4] && !user.pow[5] && !user.pow[6] && !user.pow[7] && !user.pow[8]) {\n              return res.render('sinhvien-index', {\n                header: 'global-header',\n                footer: 'global-footer',\n                thongbao: 'global-notifications',\n                bandiem: studentTotalScores,\n                hoatdong: studentActivities,\n                hethan: true,\n                nienkhoa: Object.keys(schoolYear_all.years),\n                check_chamdiem: check_year\n              });\n            } else if (user.pow[0] && user.pow[1] && !user.pow[2] && user.pow[3] && !user.pow[4] && !user.pow[5] && !user.pow[6] && !user.pow[7] && !user.pow[8]) {\n              return res.render('bancansu-index', {\n                header: 'global-header',\n                footer: 'global-footer',\n                thongbao: 'global-notifications',\n                pow: 0,\n                bandiem: studentTotalScores,\n                hoatdong: studentActivities,\n                hethan: true,\n                nienkhoa: Object.keys(schoolYear_all.years),\n                check_chamdiem: check_year\n              });\n            } else if (user.pow[0] && user.pow[1] && !user.pow[2] && !user.pow[3] && !user.pow[4] && !user.pow[5] && !user.pow[6] && !user.pow[7] && !user.pow[8]) {\n              return res.render('bancansu-index', {\n                header: 'global-header',\n                footer: 'global-footer',\n                thongbao: 'global-notifications',\n                pow: 1,\n                bandiem: studentTotalScores,\n                hoatdong: studentActivities,\n                hethan: true,\n                nienkhoa: Object.keys(schoolYear_all.years),\n                check_chamdiem: check_year\n              });\n            } else if (user.pow[0] && !user.pow[1] && !user.pow[2] && user.pow[3] && !user.pow[4] && !user.pow[5] && !user.pow[6] && !user.pow[7] && !user.pow[8]) {\n              return res.render('bancansu-index', {\n                header: 'global-header',\n                footer: 'global-footer',\n                thongbao: 'global-notifications',\n                pow: 2,\n                bandiem: studentTotalScores,\n                hoatdong: studentActivities,\n                hethan: true,\n                nienkhoa: Object.keys(schoolYear_all.years),\n                check_chamdiem: check_year\n              });\n            }\n          }\n        } else {\n          return res.sendStatus(403).send('Sinh viên đã tốt nghiệp');\n        }\n      } else {\n        if (!user.pow[0] && user.pow[1] && !user.pow[2] && user.pow[3] && user.pow[4] && !user.pow[5] && !user.pow[6] && !user.pow[7] && !user.pow[8]) {\n          const student_list = user.cls[0];\n          const nulll = [1];\n          return res.render('teacher-index', {\n            header: 'global-header',\n            student_list: student_list != undefined ? student_list : nulll,\n            footer: 'global-footer'\n          });\n        } else if (!user.pow[0] && !user.pow[1] && user.pow[2] && user.pow[3] && user.pow[4] && user.pow[5] && user.pow[6] && user.pow[7] && user.pow[8]) {\n          return res.render('doankhoa-index', {\n            header: 'global-header',\n            footer: 'global-footer',\n            menu: 'doankhoa-menu'\n          });\n        }\n      }\n    } catch (err) {\n      console.log('SYSTEM | INDEX_ROUTE | ERROR | ', err);\n    }\n  });\n\n  // xac thuc route\n  router.get('/verifyOTP', async (req, res) => {\n    try {\n      const user = req.session.user;\n      if (user) {\n        return res.redirect('/');\n      }\n      const mssv = req.query.mssv;\n      const dataUser = await client.db(name_global_databases).collection('user_info').findOne({\n        _id: mssv\n      }, {\n        projection: {\n          _id: 0,\n          email: 1\n        }\n      });\n      let emailToShow = '';\n      if (dataUser) {\n        const email = dataUser.email;\n        emailToShow = email.substring(0, 3) + '*'.repeat(email.indexOf('@') - 3) + email.substring(email.indexOf('@'));\n      }\n      return res.render('global-verify-otp', {\n        header: 'global-header',\n        footer: 'global-footer',\n        avt: null,\n        thongbao: 'global-notifications',\n        email: emailToShow\n      });\n    } catch (err) {\n      console.log('SYSTEM | OTP_ROUTE | ERROR | ', err);\n      return res.render('global-verify-otp', {\n        header: 'global-header',\n        footer: 'global-footer',\n        avt: null,\n        thongbao: 'global-notifications',\n        email: ''\n      });\n    }\n  });\n\n  // Quen mat khau\n  router.get('/quenmatkhau', async (req, res) => {\n    const user = req.session.user;\n    if (user) {\n      return res.redirect('/');\n    }\n    return res.render('global-forgot-password', {\n      header: 'global-header',\n      footer: 'global-footer',\n      thongbao: 'global-notifications',\n      avt: null\n    });\n  });\n  router.get('/dangkyhoatdong', checkIfUserLoginRoute, async (req, res) => {\n    try {\n      const query = req.query;\n      const user = req.session.user;\n      let activitie_info;\n      if (query.id && query.level) {\n        switch (query.level) {\n          case 'lop':\n            if (user.pow[0]) {\n              activitie_info = await client.db(user.dep).collection(`${user.cls[0]}_activities`).findOne({\n                _id: query.id\n              });\n              console.log(user.cls[0]);\n            } else {\n              const collections = await client.db(user.dep).listCollections().toArray();\n              // Filter collections ending with '_activities'\n              const activityCollections = await collections.filter(collection => collection.name.endsWith('_activities'));\n              // Loop through activity collections and retrieve all documents\n              for (const activityCollection of activityCollections) {\n                activitie_info = await client.db(user.dep).collection(activityCollection.name).findOne({\n                  _id: query.id\n                });\n                if (activitie_info) {\n                  break; // Thoát khỏi vòng lặp khi tìm thấy kết quả\n                }\n              }\n            }\n            break;\n          case 'khoa':\n            activitie_info = await client.db(user.dep).collection('activities').findOne({\n              _id: query.id\n            });\n            break;\n          case 'truong':\n            activitie_info = await client.db(name_global_databases).collection('activities').findOne({\n              _id: query.id\n            });\n            break;\n        }\n        if (!activitie_info) {\n          return res.status(404).send('Not Found');\n        }\n        activitie_info.join = false;\n        activitie_info.diemdanh = false;\n        if (activitie_info.student_list) {\n          const list_student = Object.keys(activitie_info.student_list);\n          let info_student = [];\n          for (let i = 0; i < list_student.length; i++) {\n            info_student.push(await client.db(name_global_databases).collection('user_info').findOne({\n              _id: list_student[i]\n            }, {\n              projection: {\n                first_name: 1,\n                last_name: 1,\n                class: 1\n              }\n            }));\n          }\n          activitie_info.info_student = info_student;\n          if (user._id in activitie_info.student_list) {\n            activitie_info.join = true;\n          }\n          if (activitie_info.ai && user._id in activitie_info.ai && activitie_info.ai[user._id]) {\n            activitie_info.diemdanh = true;\n          }\n        }\n        return res.render('sinhvien-activeregistration', {\n          header: 'global-header',\n          thongbao: 'global-notifications',\n          footer: 'global-footer',\n          activitie_info: activitie_info,\n          id_acti: query.id\n        });\n      } else {\n        return res.redirect('/');\n      }\n    } catch (err) {\n      return console.log('SYSTEM | HOAT_DONG_DANG_KY_ROUTE | ERROR | ', err);\n    }\n  });\n\n  // 403 route\n  router.get('/403', async (req, res) => {\n    return res.sendFile(path.join(parentDirectory, 'dPage', '403.html'));\n  });\n  return router;\n}\nmodule.exports = createRootRouter;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIlJvdXRlciIsImNoZWNrSWZVc2VyTG9naW5Sb3V0ZSIsImdldE5hbWVHbG9iYWwiLCJuYW1lX2dsb2JhbF9kYXRhYmFzZXMiLCJwYXRoIiwiY3JlYXRlUm9vdFJvdXRlciIsImNsaWVudCIsInBhcmVudERpcmVjdG9yeSIsImdldCIsInJlcSIsInJlcyIsInNjaG9vbF95ZWFyIiwiZGIiLCJjb2xsZWN0aW9uIiwiZmluZE9uZSIsInByb2plY3Rpb24iLCJfaWQiLCJ5ZWFyIiwic3RhcnRfZGF5IiwiZW5kX2RheSIsImNoZWNrX3kiLCJ0b2RheSIsIkRhdGUiLCJnZXRUaW1lIiwiZm9yZXZlcl9kYXkiLCJjaGVja195ZWFyIiwidXNlciIsInNlc3Npb24iLCJwb3ciLCJzY2hvb2xZZWFyIiwiY2xzIiwic2Nob29sWWVhcl9hbGwiLCJ5ZWFycyIsInNjaG9vbFllYXJzVG9TZWFyY2giLCJzbGljZSIsImkiLCJPYmplY3QiLCJrZXlzIiwibGVuZ3RoIiwicHVzaCIsInN0dWRlbnRUb3RhbFNjb3JlcyIsIlByb21pc2UiLCJhbGwiLCJtYXAiLCJkZXBDb2xsZWN0aW9uIiwiZGVwIiwic3RmQ29sbGVjdGlvbiIsInN0ZENvbGxlY3Rpb24iLCJkZXBEb2N1bWVudCIsIm1zc3YiLCJ0b3RhbCIsInN0ZkRvY3VtZW50Iiwic3RkRG9jdW1lbnQiLCJjb25zb2xlIiwibG9nIiwic3R1ZGVudEFjdGl2aXRpZXMiLCJpbmZvX3NlYXJjaCIsImFjdGl2aXRpZV9pbmZvX2xvcCIsImZpbmQiLCIkZXhpc3RzIiwibmFtZSIsInN0dWRlbnRfbGlzdCIsImFpIiwibGV2ZWwiLCJ0b0FycmF5IiwiZm9yRWFjaCIsImVsZW1lbnQiLCJ0aGFtZ2lhIiwia2hlbnRodW9uZyIsImFjdGl2aXRpZV9pbmZvX2tob2EiLCJhY3Rpdml0aWVfaW5mb190cnVvbmciLCJyZW5kZXIiLCJoZWFkZXIiLCJmb290ZXIiLCJ0aG9uZ2JhbyIsImJhbmRpZW0iLCJob2F0ZG9uZyIsImhldGhhbiIsIm5pZW5raG9hIiwiY2hlY2tfY2hhbWRpZW0iLCJzZW5kU3RhdHVzIiwic2VuZCIsIm51bGxsIiwidW5kZWZpbmVkIiwibWVudSIsImVyciIsInJlZGlyZWN0IiwicXVlcnkiLCJkYXRhVXNlciIsImVtYWlsIiwiZW1haWxUb1Nob3ciLCJzdWJzdHJpbmciLCJyZXBlYXQiLCJpbmRleE9mIiwiYXZ0IiwiYWN0aXZpdGllX2luZm8iLCJpZCIsImNvbGxlY3Rpb25zIiwibGlzdENvbGxlY3Rpb25zIiwiYWN0aXZpdHlDb2xsZWN0aW9ucyIsImZpbHRlciIsImVuZHNXaXRoIiwiYWN0aXZpdHlDb2xsZWN0aW9uIiwic3RhdHVzIiwiam9pbiIsImRpZW1kYW5oIiwibGlzdF9zdHVkZW50IiwiaW5mb19zdHVkZW50IiwiZmlyc3RfbmFtZSIsImxhc3RfbmFtZSIsImNsYXNzIiwiaWRfYWN0aSIsInNlbmRGaWxlIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiRDpcXHByb2plY3RcXHdlYlxcbmV3Q0RSTC0xXFxiYWNrZW5kXFxyb3V0ZXJcXCIsInNvdXJjZXMiOlsicm9vdFJvdXRlcnMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTtcclxuY29uc3Qgcm91dGVyID0gZXhwcmVzcy5Sb3V0ZXIoKTtcclxuY29uc3QgeyBjaGVja0lmVXNlckxvZ2luUm91dGUgfSA9IHJlcXVpcmUoJy4uL2xpYi9mdW5jdGlvbl9saWInKTtcclxuY29uc3QgeyBnZXROYW1lR2xvYmFsIH0gPSByZXF1aXJlKCcuLi9saWIvbW9nb2RiX2xpYicpO1xyXG5jb25zdCBuYW1lX2dsb2JhbF9kYXRhYmFzZXMgPSBnZXROYW1lR2xvYmFsKCk7XHJcbmNvbnN0IHBhdGggPSByZXF1aXJlKCdwYXRoJyk7XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVSb290Um91dGVyKGNsaWVudCwgcGFyZW50RGlyZWN0b3J5KSB7XHJcbiAgICAvLyBpbmRleCByb3V0ZVxyXG4gICAgcm91dGVyLmdldCgnLycsIGNoZWNrSWZVc2VyTG9naW5Sb3V0ZSwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgLy8ga2nhu4NtIHRyYSBjaMOibSDEkWnhu4NtXHJcbiAgICAgICAgY29uc3Qgc2Nob29sX3llYXIgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ3NjaG9vbF95ZWFyJylcclxuICAgICAgICAgICAgLmZpbmRPbmUoXHJcbiAgICAgICAgICAgICAgICB7fSxcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9qZWN0aW9uOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeWVhcjogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRfZGF5OiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmRfZGF5OiAxLFxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIGNvbnN0IGNoZWNrX3kgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCB0b2RheSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xyXG4gICAgICAgICAgICBsZXQgc3RhcnRfZGF5ID0gbmV3IERhdGUoc2Nob29sX3llYXIuc3RhcnRfZGF5KS5nZXRUaW1lKCk7XHJcbiAgICAgICAgICAgIGxldCBlbmRfZGF5ID0gbmV3IERhdGUoc2Nob29sX3llYXIuZW5kX2RheSkuZ2V0VGltZSgpO1xyXG4gICAgICAgICAgICBsZXQgZm9yZXZlcl9kYXkgPSBuZXcgRGF0ZSgnMjAwMy0xMC0xOCcpLmdldFRpbWUoKTsgLy8gc3BlY2lhbCBkYXRlXHJcblxyXG4gICAgICAgICAgICAvLyBjaGVjayBpZiBlbmQgbWFyayB0aW1lIG9yIG5vdFxyXG4gICAgICAgICAgICBpZiAoc3RhcnRfZGF5IDw9IHRvZGF5ICYmICh0b2RheSA8IGVuZF9kYXkgfHwgZW5kX2RheSA9PSBmb3JldmVyX2RheSkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICBsZXQgY2hlY2tfeWVhciA9IGNoZWNrX3koKTtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZyhjaGVja195ZWFyKTtcclxuICAgICAgICAvL1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVzZXIgPSByZXEuc2Vzc2lvbi51c2VyO1xyXG4gICAgICAgICAgICBpZiAodXNlci5wb3dbMF0pIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHNjaG9vbFllYXIgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdzY2hvb2xfeWVhcicpXHJcbiAgICAgICAgICAgICAgICAgICAgLmZpbmRPbmUoe30sIHsgcHJvamVjdGlvbjogeyBfaWQ6IDAsIHllYXI6IDEgfSB9KTtcclxuICAgICAgICAgICAgICAgIGlmICh1c2VyLmNsc1swXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNjaG9vbFllYXJfYWxsID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdjbGFzc2VzJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmRPbmUoeyBfaWQ6IHVzZXIuY2xzWzBdIH0sIHsgcHJvamVjdGlvbjogeyBfaWQ6IDAsIHllYXJzOiAxIH0gfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHNjaG9vbFllYXJzVG9TZWFyY2ggPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoc2Nob29sWWVhcl9hbGwueWVhcnNbc2Nob29sWWVhci55ZWFyLnNsaWNlKDQpXSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IE9iamVjdC5rZXlzKHNjaG9vbFllYXJfYWxsLnllYXJzW3NjaG9vbFllYXIueWVhci5zbGljZSg0KV0pLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2hvb2xZZWFyc1RvU2VhcmNoLnB1c2goYEhLJHtpICsgMX1fYCArIHNjaG9vbFllYXIueWVhci5zbGljZSg0KSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCJ4eFwiLHNjaG9vbFllYXJfYWxsLnllYXJzW3NjaG9vbFllYXIueWVhci5zbGljZSg0KV0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3R1ZGVudFRvdGFsU2NvcmVzID0gYXdhaXQgUHJvbWlzZS5hbGwoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2hvb2xZZWFyc1RvU2VhcmNoLm1hcChhc3luYyAoeWVhcikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFTDrG0gdHJvbmcgYuG6o25nICdfZGVwX3RhYmxlJyB0csaw4bubY1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRlcENvbGxlY3Rpb24gPSBjbGllbnQuZGIodXNlci5kZXApLmNvbGxlY3Rpb24odXNlci5jbHNbMF0gKyAnX2RlcF90YWJsZScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0ZkNvbGxlY3Rpb24gPSBjbGllbnQuZGIodXNlci5kZXApLmNvbGxlY3Rpb24odXNlci5jbHNbMF0gKyAnX3N0Zl90YWJsZScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0ZENvbGxlY3Rpb24gPSBjbGllbnQuZGIodXNlci5kZXApLmNvbGxlY3Rpb24odXNlci5jbHNbMF0gKyAnX3N0ZF90YWJsZScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRlcERvY3VtZW50ID0gYXdhaXQgZGVwQ29sbGVjdGlvbi5maW5kT25lKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IG1zc3Y6IHVzZXIuX2lkLCBzY2hvb2xfeWVhcjogeWVhciB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHByb2plY3Rpb246IHsgX2lkOiAwLCB0b3RhbDogMSB9IH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRlcERvY3VtZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ZWFyOiB5ZWFyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWw6IGRlcERvY3VtZW50LnRvdGFsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGZEb2N1bWVudCA9IGF3YWl0IHN0ZkNvbGxlY3Rpb24uZmluZE9uZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBtc3N2OiB1c2VyLl9pZCwgc2Nob29sX3llYXI6IHllYXIgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBwcm9qZWN0aW9uOiB7IF9pZDogMCwgdG90YWw6IDEgfSB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0ZkRvY3VtZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ZWFyOiB5ZWFyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWw6IHN0ZkRvY3VtZW50LnRvdGFsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGREb2N1bWVudCA9IGF3YWl0IHN0ZENvbGxlY3Rpb24uZmluZE9uZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBtc3N2OiB1c2VyLl9pZCwgc2Nob29sX3llYXI6IHllYXIgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBwcm9qZWN0aW9uOiB7IF9pZDogMCwgdG90YWw6IDEgfSB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0ZERvY3VtZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ZWFyOiB5ZWFyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWw6IHN0ZERvY3VtZW50LnRvdGFsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ZWFyOiB5ZWFyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbDogJ0NoxrBhIGPDsyDEkWnhu4NtJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHN0dWRlbnRUb3RhbFNjb3Jlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0dWRlbnRBY3Rpdml0aWVzID0gYXdhaXQgUHJvbWlzZS5hbGwoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2hvb2xZZWFyc1RvU2VhcmNoLm1hcChhc3luYyAoeWVhcikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZm9fc2VhcmNoID0gYHN0dWRlbnRfbGlzdC4ke3VzZXIuX2lkfWA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGFjdGl2aXRpZV9pbmZvX2xvcCA9IGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZGIodXNlci5kZXApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKGAke3VzZXIuY2xzWzBdfV9hY3Rpdml0aWVzYClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2luZm9fc2VhcmNoXTogeyAkZXhpc3RzOiB0cnVlIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeWVhcjogeWVhcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvamVjdGlvbjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHVkZW50X2xpc3Q6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFpOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXZlbDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRvQXJyYXkoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aXZpdGllX2luZm9fbG9wLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdGllX2luZm9fbG9wLmZvckVhY2goKGVsZW1lbnQpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LmFpICYmIGVsZW1lbnQuYWlbdXNlci5faWRdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC50aGFtZ2lhID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LnN0dWRlbnRfbGlzdFt1c2VyLl9pZF0gPT0gMikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQua2hlbnRodW9uZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgYWN0aXZpdGllX2luZm9fa2hvYSA9IGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZGIodXNlci5kZXApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdhY3Rpdml0aWVzJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2luZm9fc2VhcmNoXTogeyAkZXhpc3RzOiB0cnVlIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeWVhcjogeWVhcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvamVjdGlvbjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHVkZW50X2xpc3Q6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFpOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXZlbDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudG9BcnJheSgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aXZpdGllX2luZm9fa2hvYS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXRpZV9pbmZvX2tob2EuZm9yRWFjaCgoZWxlbWVudCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQuYWkgJiYgZWxlbWVudC5haVt1c2VyLl9pZF0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnRoYW1naWEgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQuc3R1ZGVudF9saXN0W3VzZXIuX2lkXSA9PSAyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5raGVudGh1b25nID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgYWN0aXZpdGllX2luZm9fdHJ1b25nID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdhY3Rpdml0aWVzJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2luZm9fc2VhcmNoXTogeyAkZXhpc3RzOiB0cnVlIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeWVhcjogeWVhcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvamVjdGlvbjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHVkZW50X2xpc3Q6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFpOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXZlbDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudG9BcnJheSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhY3Rpdml0aWVfaW5mb190cnVvbmcubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpdml0aWVfaW5mb190cnVvbmcuZm9yRWFjaCgoZWxlbWVudCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQuYWkgJiYgZWxlbWVudC5haVt1c2VyLl9pZF0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnRoYW1naWEgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQuc3R1ZGVudF9saXN0W3VzZXIuX2lkXSA9PSAyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5raGVudGh1b25nID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ZWFyOiB5ZWFyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpdml0aWVfaW5mb19sb3A6IGFjdGl2aXRpZV9pbmZvX2xvcCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdGllX2luZm9fa2hvYTogYWN0aXZpdGllX2luZm9fa2hvYSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdGllX2luZm9fdHJ1b25nOiBhY3Rpdml0aWVfaW5mb190cnVvbmcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyLnBvd1swXSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIXVzZXIucG93WzFdICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhdXNlci5wb3dbMl0gJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICF1c2VyLnBvd1szXSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIXVzZXIucG93WzRdICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhdXNlci5wb3dbNV0gJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICF1c2VyLnBvd1s2XSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIXVzZXIucG93WzddICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhdXNlci5wb3dbOF1cclxuICAgICAgICAgICAgICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnJlbmRlcignc2luaHZpZW4taW5kZXgnLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyOiAnZ2xvYmFsLWhlYWRlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9vdGVyOiAnZ2xvYmFsLWZvb3RlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhvbmdiYW86ICdnbG9iYWwtbm90aWZpY2F0aW9ucycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFuZGllbTogc3R1ZGVudFRvdGFsU2NvcmVzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvYXRkb25nOiBzdHVkZW50QWN0aXZpdGllcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZXRoYW46IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5pZW5raG9hOiBPYmplY3Qua2V5cyhzY2hvb2xZZWFyX2FsbC55ZWFycyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tfY2hhbWRpZW06IGNoZWNrX3llYXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXIucG93WzBdICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyLnBvd1sxXSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIXVzZXIucG93WzJdICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyLnBvd1szXSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIXVzZXIucG93WzRdICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhdXNlci5wb3dbNV0gJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICF1c2VyLnBvd1s2XSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIXVzZXIucG93WzddICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhdXNlci5wb3dbOF1cclxuICAgICAgICAgICAgICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnJlbmRlcignYmFuY2Fuc3UtaW5kZXgnLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyOiAnZ2xvYmFsLWhlYWRlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9vdGVyOiAnZ2xvYmFsLWZvb3RlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhvbmdiYW86ICdnbG9iYWwtbm90aWZpY2F0aW9ucycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG93OiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhbmRpZW06IHN0dWRlbnRUb3RhbFNjb3JlcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBob2F0ZG9uZzogc3R1ZGVudEFjdGl2aXRpZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGV0aGFuOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuaWVua2hvYTogT2JqZWN0LmtleXMoc2Nob29sWWVhcl9hbGwueWVhcnMpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrX2NoYW1kaWVtOiBjaGVja195ZWFyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyLnBvd1swXSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlci5wb3dbMV0gJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICF1c2VyLnBvd1syXSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIXVzZXIucG93WzNdICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhdXNlci5wb3dbNF0gJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICF1c2VyLnBvd1s1XSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIXVzZXIucG93WzZdICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhdXNlci5wb3dbN10gJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICF1c2VyLnBvd1s4XVxyXG4gICAgICAgICAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXMucmVuZGVyKCdiYW5jYW5zdS1pbmRleCcsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXI6ICdnbG9iYWwtaGVhZGVyJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb290ZXI6ICdnbG9iYWwtZm9vdGVyJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aG9uZ2JhbzogJ2dsb2JhbC1ub3RpZmljYXRpb25zJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3c6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFuZGllbTogc3R1ZGVudFRvdGFsU2NvcmVzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvYXRkb25nOiBzdHVkZW50QWN0aXZpdGllcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZXRoYW46IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5pZW5raG9hOiBPYmplY3Qua2V5cyhzY2hvb2xZZWFyX2FsbC55ZWFycyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tfY2hhbWRpZW06IGNoZWNrX3llYXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXIucG93WzBdICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhdXNlci5wb3dbMV0gJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICF1c2VyLnBvd1syXSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlci5wb3dbM10gJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICF1c2VyLnBvd1s0XSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIXVzZXIucG93WzVdICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhdXNlci5wb3dbNl0gJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICF1c2VyLnBvd1s3XSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIXVzZXIucG93WzhdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5yZW5kZXIoJ2JhbmNhbnN1LWluZGV4Jywge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcjogJ2dsb2JhbC1oZWFkZXInLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvb3RlcjogJ2dsb2JhbC1mb290ZXInLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRob25nYmFvOiAnZ2xvYmFsLW5vdGlmaWNhdGlvbnMnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvdzogMixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYW5kaWVtOiBzdHVkZW50VG90YWxTY29yZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9hdGRvbmc6IHN0dWRlbnRBY3Rpdml0aWVzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhldGhhbjogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmllbmtob2E6IE9iamVjdC5rZXlzKHNjaG9vbFllYXJfYWxsLnllYXJzKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGVja19jaGFtZGllbTogY2hlY2tfeWVhcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCJ4eFwiLHNjaG9vbFllYXJfYWxsLnllYXJzW3NjaG9vbFllYXIueWVhci5zbGljZSg0KV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDM7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nob29sWWVhcnNUb1NlYXJjaC5wdXNoKGBISyR7aSArIDF9X2AgKyBzY2hvb2xZZWFyLnllYXIuc2xpY2UoNCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0dWRlbnRUb3RhbFNjb3JlcyA9IGF3YWl0IFByb21pc2UuYWxsKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nob29sWWVhcnNUb1NlYXJjaC5tYXAoYXN5bmMgKHllYXIpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUw6xtIHRyb25nIGLhuqNuZyAnX2RlcF90YWJsZScgdHLGsOG7m2NcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkZXBDb2xsZWN0aW9uID0gY2xpZW50LmRiKHVzZXIuZGVwKS5jb2xsZWN0aW9uKHVzZXIuY2xzWzBdICsgJ19kZXBfdGFibGUnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGZDb2xsZWN0aW9uID0gY2xpZW50LmRiKHVzZXIuZGVwKS5jb2xsZWN0aW9uKHVzZXIuY2xzWzBdICsgJ19zdGZfdGFibGUnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGRDb2xsZWN0aW9uID0gY2xpZW50LmRiKHVzZXIuZGVwKS5jb2xsZWN0aW9uKHVzZXIuY2xzWzBdICsgJ19zdGRfdGFibGUnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkZXBEb2N1bWVudCA9IGF3YWl0IGRlcENvbGxlY3Rpb24uZmluZE9uZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBtc3N2OiB1c2VyLl9pZCwgc2Nob29sX3llYXI6IHllYXIgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBwcm9qZWN0aW9uOiB7IF9pZDogMCwgdG90YWw6IDEgfSB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkZXBEb2N1bWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeWVhcjogeWVhcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsOiBkZXBEb2N1bWVudC50b3RhbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RmRG9jdW1lbnQgPSBhd2FpdCBzdGZDb2xsZWN0aW9uLmZpbmRPbmUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgbXNzdjogdXNlci5faWQsIHNjaG9vbF95ZWFyOiB5ZWFyIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgcHJvamVjdGlvbjogeyBfaWQ6IDAsIHRvdGFsOiAxIH0gfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGZEb2N1bWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeWVhcjogeWVhcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsOiBzdGZEb2N1bWVudC50b3RhbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RkRG9jdW1lbnQgPSBhd2FpdCBzdGRDb2xsZWN0aW9uLmZpbmRPbmUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgbXNzdjogdXNlci5faWQsIHNjaG9vbF95ZWFyOiB5ZWFyIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgcHJvamVjdGlvbjogeyBfaWQ6IDAsIHRvdGFsOiAxIH0gfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGREb2N1bWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeWVhcjogeWVhcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsOiBzdGREb2N1bWVudC50b3RhbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeWVhcjogeWVhcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWw6ICdDaMawYSBjw7MgxJFp4buDbScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhzdHVkZW50VG90YWxTY29yZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHVkZW50QWN0aXZpdGllcyA9IGF3YWl0IFByb21pc2UuYWxsKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nob29sWWVhcnNUb1NlYXJjaC5tYXAoYXN5bmMgKHllYXIpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmZvX3NlYXJjaCA9IGBzdHVkZW50X2xpc3QuJHt1c2VyLl9pZH1gO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBhY3Rpdml0aWVfaW5mb19sb3AgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmRiKHVzZXIuZGVwKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbihgJHt1c2VyLmNsc1swXX1fYWN0aXZpdGllc2ApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtpbmZvX3NlYXJjaF06IHsgJGV4aXN0czogdHJ1ZSB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHllYXI6IHllYXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2plY3Rpb246IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R1ZGVudF9saXN0OiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhaTogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV2ZWw6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50b0FycmF5KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjdGl2aXRpZV9pbmZvX2xvcC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXRpZV9pbmZvX2xvcC5mb3JFYWNoKChlbGVtZW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC5haSAmJiBlbGVtZW50LmFpW3VzZXIuX2lkXSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQudGhhbWdpYSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC5zdHVkZW50X2xpc3RbdXNlci5faWRdID09IDIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmtoZW50aHVvbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGFjdGl2aXRpZV9pbmZvX2tob2EgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmRiKHVzZXIuZGVwKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbignYWN0aXZpdGllcycpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtpbmZvX3NlYXJjaF06IHsgJGV4aXN0czogdHJ1ZSB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHllYXI6IHllYXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2plY3Rpb246IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R1ZGVudF9saXN0OiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhaTogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV2ZWw6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRvQXJyYXkoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjdGl2aXRpZV9pbmZvX2tob2EubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpdml0aWVfaW5mb19raG9hLmZvckVhY2goKGVsZW1lbnQpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LmFpICYmIGVsZW1lbnQuYWlbdXNlci5faWRdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC50aGFtZ2lhID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LnN0dWRlbnRfbGlzdFt1c2VyLl9pZF0gPT0gMikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQua2hlbnRodW9uZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGFjdGl2aXRpZV9pbmZvX3RydW9uZyA9IGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbignYWN0aXZpdGllcycpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtpbmZvX3NlYXJjaF06IHsgJGV4aXN0czogdHJ1ZSB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHllYXI6IHllYXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2plY3Rpb246IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R1ZGVudF9saXN0OiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhaTogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV2ZWw6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRvQXJyYXkoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aXZpdGllX2luZm9fdHJ1b25nLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdGllX2luZm9fdHJ1b25nLmZvckVhY2goKGVsZW1lbnQpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LmFpICYmIGVsZW1lbnQuYWlbdXNlci5faWRdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC50aGFtZ2lhID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LnN0dWRlbnRfbGlzdFt1c2VyLl9pZF0gPT0gMikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQua2hlbnRodW9uZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeWVhcjogeWVhcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdGllX2luZm9fbG9wOiBhY3Rpdml0aWVfaW5mb19sb3AsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXRpZV9pbmZvX2tob2E6IGFjdGl2aXRpZV9pbmZvX2tob2EsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXRpZV9pbmZvX3RydW9uZzogYWN0aXZpdGllX2luZm9fdHJ1b25nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlci5wb3dbMF0gJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICF1c2VyLnBvd1sxXSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIXVzZXIucG93WzJdICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhdXNlci5wb3dbM10gJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICF1c2VyLnBvd1s0XSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIXVzZXIucG93WzVdICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhdXNlci5wb3dbNl0gJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICF1c2VyLnBvd1s3XSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIXVzZXIucG93WzhdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5yZW5kZXIoJ3Npbmh2aWVuLWluZGV4Jywge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcjogJ2dsb2JhbC1oZWFkZXInLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvb3RlcjogJ2dsb2JhbC1mb290ZXInLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRob25nYmFvOiAnZ2xvYmFsLW5vdGlmaWNhdGlvbnMnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhbmRpZW06IHN0dWRlbnRUb3RhbFNjb3JlcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBob2F0ZG9uZzogc3R1ZGVudEFjdGl2aXRpZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGV0aGFuOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5pZW5raG9hOiBPYmplY3Qua2V5cyhzY2hvb2xZZWFyX2FsbC55ZWFycyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tfY2hhbWRpZW06IGNoZWNrX3llYXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXIucG93WzBdICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyLnBvd1sxXSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIXVzZXIucG93WzJdICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyLnBvd1szXSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIXVzZXIucG93WzRdICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhdXNlci5wb3dbNV0gJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICF1c2VyLnBvd1s2XSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIXVzZXIucG93WzddICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhdXNlci5wb3dbOF1cclxuICAgICAgICAgICAgICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnJlbmRlcignYmFuY2Fuc3UtaW5kZXgnLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyOiAnZ2xvYmFsLWhlYWRlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9vdGVyOiAnZ2xvYmFsLWZvb3RlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhvbmdiYW86ICdnbG9iYWwtbm90aWZpY2F0aW9ucycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG93OiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhbmRpZW06IHN0dWRlbnRUb3RhbFNjb3JlcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBob2F0ZG9uZzogc3R1ZGVudEFjdGl2aXRpZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGV0aGFuOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5pZW5raG9hOiBPYmplY3Qua2V5cyhzY2hvb2xZZWFyX2FsbC55ZWFycyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tfY2hhbWRpZW06IGNoZWNrX3llYXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXIucG93WzBdICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyLnBvd1sxXSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIXVzZXIucG93WzJdICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhdXNlci5wb3dbM10gJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICF1c2VyLnBvd1s0XSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIXVzZXIucG93WzVdICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhdXNlci5wb3dbNl0gJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICF1c2VyLnBvd1s3XSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIXVzZXIucG93WzhdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5yZW5kZXIoJ2JhbmNhbnN1LWluZGV4Jywge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcjogJ2dsb2JhbC1oZWFkZXInLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvb3RlcjogJ2dsb2JhbC1mb290ZXInLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRob25nYmFvOiAnZ2xvYmFsLW5vdGlmaWNhdGlvbnMnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvdzogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYW5kaWVtOiBzdHVkZW50VG90YWxTY29yZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9hdGRvbmc6IHN0dWRlbnRBY3Rpdml0aWVzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhldGhhbjogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuaWVua2hvYTogT2JqZWN0LmtleXMoc2Nob29sWWVhcl9hbGwueWVhcnMpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrX2NoYW1kaWVtOiBjaGVja195ZWFyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyLnBvd1swXSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIXVzZXIucG93WzFdICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhdXNlci5wb3dbMl0gJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXIucG93WzNdICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhdXNlci5wb3dbNF0gJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICF1c2VyLnBvd1s1XSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIXVzZXIucG93WzZdICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhdXNlci5wb3dbN10gJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICF1c2VyLnBvd1s4XVxyXG4gICAgICAgICAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXMucmVuZGVyKCdiYW5jYW5zdS1pbmRleCcsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXI6ICdnbG9iYWwtaGVhZGVyJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb290ZXI6ICdnbG9iYWwtZm9vdGVyJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aG9uZ2JhbzogJ2dsb2JhbC1ub3RpZmljYXRpb25zJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3c6IDIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFuZGllbTogc3R1ZGVudFRvdGFsU2NvcmVzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvYXRkb25nOiBzdHVkZW50QWN0aXZpdGllcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZXRoYW46IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmllbmtob2E6IE9iamVjdC5rZXlzKHNjaG9vbFllYXJfYWxsLnllYXJzKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGVja19jaGFtZGllbTogY2hlY2tfeWVhcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNDAzKS5zZW5kKCdTaW5oIHZpw6puIMSRw6MgdOG7kXQgbmdoaeG7h3AnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgICAgICAhdXNlci5wb3dbMF0gJiZcclxuICAgICAgICAgICAgICAgICAgICB1c2VyLnBvd1sxXSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICF1c2VyLnBvd1syXSAmJlxyXG4gICAgICAgICAgICAgICAgICAgIHVzZXIucG93WzNdICYmXHJcbiAgICAgICAgICAgICAgICAgICAgdXNlci5wb3dbNF0gJiZcclxuICAgICAgICAgICAgICAgICAgICAhdXNlci5wb3dbNV0gJiZcclxuICAgICAgICAgICAgICAgICAgICAhdXNlci5wb3dbNl0gJiZcclxuICAgICAgICAgICAgICAgICAgICAhdXNlci5wb3dbN10gJiZcclxuICAgICAgICAgICAgICAgICAgICAhdXNlci5wb3dbOF1cclxuICAgICAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0dWRlbnRfbGlzdCA9IHVzZXIuY2xzWzBdO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBudWxsbCA9IFsxXTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnJlbmRlcigndGVhY2hlci1pbmRleCcsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyOiAnZ2xvYmFsLWhlYWRlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0dWRlbnRfbGlzdDogc3R1ZGVudF9saXN0ICE9IHVuZGVmaW5lZCA/IHN0dWRlbnRfbGlzdCA6IG51bGxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb290ZXI6ICdnbG9iYWwtZm9vdGVyJyxcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoXHJcbiAgICAgICAgICAgICAgICAgICAgIXVzZXIucG93WzBdICYmXHJcbiAgICAgICAgICAgICAgICAgICAgIXVzZXIucG93WzFdICYmXHJcbiAgICAgICAgICAgICAgICAgICAgdXNlci5wb3dbMl0gJiZcclxuICAgICAgICAgICAgICAgICAgICB1c2VyLnBvd1szXSAmJlxyXG4gICAgICAgICAgICAgICAgICAgIHVzZXIucG93WzRdICYmXHJcbiAgICAgICAgICAgICAgICAgICAgdXNlci5wb3dbNV0gJiZcclxuICAgICAgICAgICAgICAgICAgICB1c2VyLnBvd1s2XSAmJlxyXG4gICAgICAgICAgICAgICAgICAgIHVzZXIucG93WzddICYmXHJcbiAgICAgICAgICAgICAgICAgICAgdXNlci5wb3dbOF1cclxuICAgICAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXMucmVuZGVyKCdkb2Fua2hvYS1pbmRleCcsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyOiAnZ2xvYmFsLWhlYWRlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvb3RlcjogJ2dsb2JhbC1mb290ZXInLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtZW51OiAnZG9hbmtob2EtbWVudScsXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1NZU1RFTSB8IElOREVYX1JPVVRFIHwgRVJST1IgfCAnLCBlcnIpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8vIHhhYyB0aHVjIHJvdXRlXHJcbiAgICByb3V0ZXIuZ2V0KCcvdmVyaWZ5T1RQJywgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgdXNlciA9IHJlcS5zZXNzaW9uLnVzZXI7XHJcbiAgICAgICAgICAgIGlmICh1c2VyKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnJlZGlyZWN0KCcvJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgbXNzdiA9IHJlcS5xdWVyeS5tc3N2O1xyXG4gICAgICAgICAgICBjb25zdCBkYXRhVXNlciA9IGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCd1c2VyX2luZm8nKVxyXG4gICAgICAgICAgICAgICAgLmZpbmRPbmUoeyBfaWQ6IG1zc3YgfSwgeyBwcm9qZWN0aW9uOiB7IF9pZDogMCwgZW1haWw6IDEgfSB9KTtcclxuICAgICAgICAgICAgbGV0IGVtYWlsVG9TaG93ID0gJyc7XHJcbiAgICAgICAgICAgIGlmIChkYXRhVXNlcikge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZW1haWwgPSBkYXRhVXNlci5lbWFpbDtcclxuICAgICAgICAgICAgICAgIGVtYWlsVG9TaG93ID1cclxuICAgICAgICAgICAgICAgICAgICBlbWFpbC5zdWJzdHJpbmcoMCwgMykgKyAnKicucmVwZWF0KGVtYWlsLmluZGV4T2YoJ0AnKSAtIDMpICsgZW1haWwuc3Vic3RyaW5nKGVtYWlsLmluZGV4T2YoJ0AnKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5yZW5kZXIoJ2dsb2JhbC12ZXJpZnktb3RwJywge1xyXG4gICAgICAgICAgICAgICAgaGVhZGVyOiAnZ2xvYmFsLWhlYWRlcicsXHJcbiAgICAgICAgICAgICAgICBmb290ZXI6ICdnbG9iYWwtZm9vdGVyJyxcclxuICAgICAgICAgICAgICAgIGF2dDogbnVsbCxcclxuICAgICAgICAgICAgICAgIHRob25nYmFvOiAnZ2xvYmFsLW5vdGlmaWNhdGlvbnMnLFxyXG4gICAgICAgICAgICAgICAgZW1haWw6IGVtYWlsVG9TaG93LFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1NZU1RFTSB8IE9UUF9ST1VURSB8IEVSUk9SIHwgJywgZXJyKTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5yZW5kZXIoJ2dsb2JhbC12ZXJpZnktb3RwJywge1xyXG4gICAgICAgICAgICAgICAgaGVhZGVyOiAnZ2xvYmFsLWhlYWRlcicsXHJcbiAgICAgICAgICAgICAgICBmb290ZXI6ICdnbG9iYWwtZm9vdGVyJyxcclxuICAgICAgICAgICAgICAgIGF2dDogbnVsbCxcclxuICAgICAgICAgICAgICAgIHRob25nYmFvOiAnZ2xvYmFsLW5vdGlmaWNhdGlvbnMnLFxyXG4gICAgICAgICAgICAgICAgZW1haWw6ICcnLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBRdWVuIG1hdCBraGF1XHJcbiAgICByb3V0ZXIuZ2V0KCcvcXVlbm1hdGtoYXUnLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICAgICAgICBjb25zdCB1c2VyID0gcmVxLnNlc3Npb24udXNlcjtcclxuICAgICAgICBpZiAodXNlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnJlZGlyZWN0KCcvJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXMucmVuZGVyKCdnbG9iYWwtZm9yZ290LXBhc3N3b3JkJywge1xyXG4gICAgICAgICAgICBoZWFkZXI6ICdnbG9iYWwtaGVhZGVyJyxcclxuICAgICAgICAgICAgZm9vdGVyOiAnZ2xvYmFsLWZvb3RlcicsXHJcbiAgICAgICAgICAgIHRob25nYmFvOiAnZ2xvYmFsLW5vdGlmaWNhdGlvbnMnLFxyXG4gICAgICAgICAgICBhdnQ6IG51bGwsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICByb3V0ZXIuZ2V0KCcvZGFuZ2t5aG9hdGRvbmcnLCBjaGVja0lmVXNlckxvZ2luUm91dGUsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHF1ZXJ5ID0gcmVxLnF1ZXJ5O1xyXG4gICAgICAgICAgICBjb25zdCB1c2VyID0gcmVxLnNlc3Npb24udXNlcjtcclxuICAgICAgICAgICAgbGV0IGFjdGl2aXRpZV9pbmZvO1xyXG4gICAgICAgICAgICBpZiAocXVlcnkuaWQgJiYgcXVlcnkubGV2ZWwpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAocXVlcnkubGV2ZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlICdsb3AnOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodXNlci5wb3dbMF0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXRpZV9pbmZvID0gYXdhaXQgY2xpZW50LmRiKHVzZXIuZGVwKS5jb2xsZWN0aW9uKGAke3VzZXIuY2xzWzBdfV9hY3Rpdml0aWVzYCkuZmluZE9uZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2lkOiBxdWVyeS5pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2codXNlci5jbHNbMF0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY29sbGVjdGlvbnMgPSBhd2FpdCBjbGllbnQuZGIodXNlci5kZXApLmxpc3RDb2xsZWN0aW9ucygpLnRvQXJyYXkoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpbHRlciBjb2xsZWN0aW9ucyBlbmRpbmcgd2l0aCAnX2FjdGl2aXRpZXMnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhY3Rpdml0eUNvbGxlY3Rpb25zID0gYXdhaXQgY29sbGVjdGlvbnMuZmlsdGVyKChjb2xsZWN0aW9uKSA9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbGxlY3Rpb24ubmFtZS5lbmRzV2l0aCgnX2FjdGl2aXRpZXMnKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBMb29wIHRocm91Z2ggYWN0aXZpdHkgY29sbGVjdGlvbnMgYW5kIHJldHJpZXZlIGFsbCBkb2N1bWVudHNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgYWN0aXZpdHlDb2xsZWN0aW9uIG9mIGFjdGl2aXR5Q29sbGVjdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpdml0aWVfaW5mbyA9IGF3YWl0IGNsaWVudC5kYih1c2VyLmRlcCkuY29sbGVjdGlvbihhY3Rpdml0eUNvbGxlY3Rpb24ubmFtZSkuZmluZE9uZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogcXVlcnkuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjdGl2aXRpZV9pbmZvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOyAvLyBUaG/DoXQga2jhu49pIHbDsm5nIGzhurdwIGtoaSB0w6xtIHRo4bqleSBr4bq/dCBxdeG6o1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlICdraG9hJzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdGllX2luZm8gPSBhd2FpdCBjbGllbnQuZGIodXNlci5kZXApLmNvbGxlY3Rpb24oJ2FjdGl2aXRpZXMnKS5maW5kT25lKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogcXVlcnkuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlICd0cnVvbmcnOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpdml0aWVfaW5mbyA9IGF3YWl0IGNsaWVudC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpLmNvbGxlY3Rpb24oJ2FjdGl2aXRpZXMnKS5maW5kT25lKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogcXVlcnkuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghYWN0aXZpdGllX2luZm8pIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLnNlbmQoJ05vdCBGb3VuZCcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYWN0aXZpdGllX2luZm8uam9pbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgYWN0aXZpdGllX2luZm8uZGllbWRhbmggPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIGlmIChhY3Rpdml0aWVfaW5mby5zdHVkZW50X2xpc3QpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBsaXN0X3N0dWRlbnQgPSBPYmplY3Qua2V5cyhhY3Rpdml0aWVfaW5mby5zdHVkZW50X2xpc3QpO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBpbmZvX3N0dWRlbnQgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpc3Rfc3R1ZGVudC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbmZvX3N0dWRlbnQucHVzaChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ3VzZXJfaW5mbycpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmRPbmUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogbGlzdF9zdHVkZW50W2ldLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHByb2plY3Rpb246IHsgZmlyc3RfbmFtZTogMSwgbGFzdF9uYW1lOiAxLCBjbGFzczogMSB9IH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZpdGllX2luZm8uaW5mb19zdHVkZW50ID0gaW5mb19zdHVkZW50O1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh1c2VyLl9pZCBpbiBhY3Rpdml0aWVfaW5mby5zdHVkZW50X2xpc3QpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdGllX2luZm8uam9pbiA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChhY3Rpdml0aWVfaW5mby5haSAmJiB1c2VyLl9pZCBpbiBhY3Rpdml0aWVfaW5mby5haSAmJiBhY3Rpdml0aWVfaW5mby5haVt1c2VyLl9pZF0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdGllX2luZm8uZGllbWRhbmggPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnJlbmRlcignc2luaHZpZW4tYWN0aXZlcmVnaXN0cmF0aW9uJywge1xyXG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcjogJ2dsb2JhbC1oZWFkZXInLFxyXG4gICAgICAgICAgICAgICAgICAgIHRob25nYmFvOiAnZ2xvYmFsLW5vdGlmaWNhdGlvbnMnLFxyXG4gICAgICAgICAgICAgICAgICAgIGZvb3RlcjogJ2dsb2JhbC1mb290ZXInLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjdGl2aXRpZV9pbmZvOiBhY3Rpdml0aWVfaW5mbyxcclxuICAgICAgICAgICAgICAgICAgICBpZF9hY3RpOiBxdWVyeS5pZCxcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5yZWRpcmVjdCgnLycpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjb25zb2xlLmxvZygnU1lTVEVNIHwgSE9BVF9ET05HX0RBTkdfS1lfUk9VVEUgfCBFUlJPUiB8ICcsIGVycik7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gNDAzIHJvdXRlXHJcbiAgICByb3V0ZXIuZ2V0KCcvNDAzJywgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zZW5kRmlsZShwYXRoLmpvaW4ocGFyZW50RGlyZWN0b3J5LCAnZFBhZ2UnLCAnNDAzLmh0bWwnKSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gcm91dGVyO1xyXG59XHJcbm1vZHVsZS5leHBvcnRzID0gY3JlYXRlUm9vdFJvdXRlcjtcclxuIl0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxPQUFPLEdBQUdDLE9BQU8sQ0FBQyxTQUFTLENBQUM7QUFDbEMsTUFBTUMsTUFBTSxHQUFHRixPQUFPLENBQUNHLE1BQU0sQ0FBQyxDQUFDO0FBQy9CLE1BQU07RUFBRUM7QUFBc0IsQ0FBQyxHQUFHSCxPQUFPLENBQUMscUJBQXFCLENBQUM7QUFDaEUsTUFBTTtFQUFFSTtBQUFjLENBQUMsR0FBR0os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","map":{"version":3,"names":["express","require","router","Router","checkIfUserLoginRoute","getNameGlobal","name_global_databases","path","createRootRouter","client","parentDirectory","get","req","res","school_year","db","collection","findOne","projection","_id","year","start_day","end_day","check_y","today","Date","getTime","forever_day","check_year","user","session","pow","schoolYear","cls","schoolYear_all","years","schoolYearsToSearch","slice","i","Object","keys","length","push","studentTotalScores","Promise","all","map","depCollection","dep","stfCollection","stdCollection","depDocument","mssv","total","stfDocument","stdDocument","console","log","studentActivities","info_search","activitie_info_lop","find","$exists","name","student_list","ai","level","toArray","forEach","element","thamgia","khenthuong","activitie_info_khoa","activitie_info_truong","render","header","footer","thongbao","bandiem","hoatdong","hethan","nienkhoa","check_chamdiem","sendStatus","send","nulll","undefined","menu","err","redirect","query","dataUser","email","emailToShow","substring","repeat","indexOf","avt","activitie_info","id","collections","listCollections","activityCollections","filter","endsWith","activityCollection","status","join","diemdanh","list_student","info_student","first_name","last_name","class","id_acti","sendFile","module","exports"],"sourceRoot":"D:\\project\\web\\newCDRL-1\\backend\\router\\","sources":["rootRouters.js"],"sourcesContent":["const express = require('express');\r\nconst router = express.Router();\r\nconst { checkIfUserLoginRoute } = require('../lib/function_lib');\r\nconst { getNameGlobal } = require('../lib/mogodb_lib');\r\nconst name_global_databases = getNameGlobal();\r\nconst path = require('path');\r\n\r\nfunction createRootRouter(client, parentDirectory) {\r\n    // index route\r\n    router.get('/', checkIfUserLoginRoute, async (req, res) => {\r\n        // kiểm tra châm điểm\r\n        const school_year = await client\r\n            .db(name_global_databases)\r\n            .collection('school_year')\r\n            .findOne(\r\n                {},\r\n                {\r\n                    projection: {\r\n                        _id: 0,\r\n                        year: 1,\r\n                        start_day: 1,\r\n                        end_day: 1,\r\n                    },\r\n                },\r\n            );\r\n        const check_y = () => {\r\n            let today = new Date().getTime();\r\n            let start_day = new Date(school_year.start_day).getTime();\r\n            let end_day = new Date(school_year.end_day).getTime();\r\n            let forever_day = new Date('2003-10-18').getTime(); // special date\r\n\r\n            // check if end mark time or not\r\n            if (start_day <= today && (today < end_day || end_day == forever_day)) {\r\n                return true;\r\n            } else {\r\n                return false;\r\n            }\r\n        };\r\n        let check_year = check_y();\r\n        // console.log(check_year);\r\n        //\r\n        try {\r\n            const user = req.session.user;\r\n            if (user.pow[0]) {\r\n                const schoolYear = await client\r\n                    .db(name_global_databases)\r\n                    .collection('school_year')\r\n                    .findOne({}, { projection: { _id: 0, year: 1 } });\r\n                if (user.cls[0]) {\r\n                    const schoolYear_all = await client\r\n                        .db(name_global_databases)\r\n                        .collection('classes')\r\n                        .findOne({ _id: user.cls[0] }, { projection: { _id: 0, years: 1 } });\r\n                    let schoolYearsToSearch = [];\r\n                    if (schoolYear_all.years[schoolYear.year.slice(4)]) {\r\n                        for (let i = 0; i < Object.keys(schoolYear_all.years[schoolYear.year.slice(4)]).length; i++) {\r\n                            schoolYearsToSearch.push(`HK${i + 1}_` + schoolYear.year.slice(4));\r\n                        }\r\n                        // console.log(\"xx\",schoolYear_all.years[schoolYear.year.slice(4)]);\r\n\r\n                        const studentTotalScores = await Promise.all(\r\n                            schoolYearsToSearch.map(async (year) => {\r\n                                // Tìm trong bảng '_dep_table' trước\r\n                                const depCollection = client.db(user.dep).collection(user.cls[0] + '_dep_table');\r\n                                const stfCollection = client.db(user.dep).collection(user.cls[0] + '_stf_table');\r\n                                const stdCollection = client.db(user.dep).collection(user.cls[0] + '_std_table');\r\n                                const depDocument = await depCollection.findOne(\r\n                                    { mssv: user._id, school_year: year },\r\n                                    { projection: { _id: 0, total: 1 } },\r\n                                );\r\n\r\n                                if (depDocument) {\r\n                                    return {\r\n                                        year: year,\r\n                                        total: depDocument.total,\r\n                                    };\r\n                                }\r\n                                const stfDocument = await stfCollection.findOne(\r\n                                    { mssv: user._id, school_year: year },\r\n                                    { projection: { _id: 0, total: 1 } },\r\n                                );\r\n                                if (stfDocument) {\r\n                                    return {\r\n                                        year: year,\r\n                                        total: stfDocument.total,\r\n                                    };\r\n                                }\r\n                                const stdDocument = await stdCollection.findOne(\r\n                                    { mssv: user._id, school_year: year },\r\n                                    { projection: { _id: 0, total: 1 } },\r\n                                );\r\n                                if (stdDocument) {\r\n                                    return {\r\n                                        year: year,\r\n                                        total: stdDocument.total,\r\n                                    };\r\n                                }\r\n                                return {\r\n                                    year: year,\r\n                                    total: 'Chưa có điểm',\r\n                                };\r\n                            }),\r\n                        );\r\n                        console.log(studentTotalScores);\r\n                        const studentActivities = await Promise.all(\r\n                            schoolYearsToSearch.map(async (year) => {\r\n                                info_search = `student_list.${user._id}`;\r\n                                let activitie_info_lop = await client\r\n                                    .db(user.dep)\r\n                                    .collection(`${user.cls[0]}_activities`)\r\n                                    .find(\r\n                                        {\r\n                                            [info_search]: { $exists: true },\r\n                                            year: year,\r\n                                        },\r\n                                        {\r\n                                            projection: {\r\n                                                name: 1,\r\n                                                student_list: 1,\r\n                                                ai: 1,\r\n                                                level: 1,\r\n                                            },\r\n                                        },\r\n                                    )\r\n\r\n                                    .toArray();\r\n                                if (activitie_info_lop.length > 0) {\r\n                                    activitie_info_lop.forEach((element) => {\r\n                                        if (element.ai && element.ai[user._id]) {\r\n                                            element.thamgia = true;\r\n                                        }\r\n                                        if (element.student_list[user._id] == 2) {\r\n                                            element.khenthuong = true;\r\n                                        }\r\n                                    });\r\n                                }\r\n                                let activitie_info_khoa = await client\r\n                                    .db(user.dep)\r\n                                    .collection('activities')\r\n                                    .find(\r\n                                        {\r\n                                            [info_search]: { $exists: true },\r\n                                            year: year,\r\n                                        },\r\n                                        {\r\n                                            projection: {\r\n                                                name: 1,\r\n                                                student_list: 1,\r\n                                                ai: 1,\r\n                                                level: 1,\r\n                                            },\r\n                                        },\r\n                                    )\r\n                                    .toArray();\r\n\r\n                                if (activitie_info_khoa.length > 0) {\r\n                                    activitie_info_khoa.forEach((element) => {\r\n                                        if (element.ai && element.ai[user._id]) {\r\n                                            element.thamgia = true;\r\n                                        }\r\n                                        if (element.student_list[user._id] == 2) {\r\n                                            element.khenthuong = true;\r\n                                        }\r\n                                    });\r\n                                }\r\n\r\n                                let activitie_info_truong = await client\r\n                                    .db(name_global_databases)\r\n                                    .collection('activities')\r\n                                    .find(\r\n                                        {\r\n                                            [info_search]: { $exists: true },\r\n                                            year: year,\r\n                                        },\r\n                                        {\r\n                                            projection: {\r\n                                                name: 1,\r\n                                                student_list: 1,\r\n                                                ai: 1,\r\n                                                level: 1,\r\n                                            },\r\n                                        },\r\n                                    )\r\n                                    .toArray();\r\n                                if (activitie_info_truong.length > 0) {\r\n                                    activitie_info_truong.forEach((element) => {\r\n                                        if (element.ai && element.ai[user._id]) {\r\n                                            element.thamgia = true;\r\n                                        }\r\n                                        if (element.student_list[user._id] == 2) {\r\n                                            element.khenthuong = true;\r\n                                        }\r\n                                    });\r\n                                }\r\n\r\n                                return {\r\n                                    year: year,\r\n                                    activitie_info_lop: activitie_info_lop,\r\n                                    activitie_info_khoa: activitie_info_khoa,\r\n                                    activitie_info_truong: activitie_info_truong,\r\n                                };\r\n                            }),\r\n                        );\r\n                        if (\r\n                            user.pow[0] &&\r\n                            !user.pow[1] &&\r\n                            !user.pow[2] &&\r\n                            !user.pow[3] &&\r\n                            !user.pow[4] &&\r\n                            !user.pow[5] &&\r\n                            !user.pow[6] &&\r\n                            !user.pow[7] &&\r\n                            !user.pow[8]\r\n                        ) {\r\n                            return res.render('sinhvien-index', {\r\n                                header: 'global-header',\r\n                                footer: 'global-footer',\r\n                                thongbao: 'global-notifications',\r\n                                bandiem: studentTotalScores,\r\n                                hoatdong: studentActivities,\r\n                                hethan: false,\r\n                                nienkhoa: Object.keys(schoolYear_all.years),\r\n                                check_chamdiem: check_year,\r\n                            });\r\n                        } else if (\r\n                            user.pow[0] &&\r\n                            user.pow[1] &&\r\n                            !user.pow[2] &&\r\n                            user.pow[3] &&\r\n                            !user.pow[4] &&\r\n                            !user.pow[5] &&\r\n                            !user.pow[6] &&\r\n                            !user.pow[7] &&\r\n                            !user.pow[8]\r\n                        ) {\r\n                            return res.render('bancansu-index', {\r\n                                header: 'global-header',\r\n                                footer: 'global-footer',\r\n                                thongbao: 'global-notifications',\r\n                                pow: 0,\r\n                                bandiem: studentTotalScores,\r\n                                hoatdong: studentActivities,\r\n                                hethan: false,\r\n                                nienkhoa: Object.keys(schoolYear_all.years),\r\n                                check_chamdiem: check_year,\r\n                            });\r\n                        } else if (\r\n                            user.pow[0] &&\r\n                            user.pow[1] &&\r\n                            !user.pow[2] &&\r\n                            !user.pow[3] &&\r\n                            !user.pow[4] &&\r\n                            !user.pow[5] &&\r\n                            !user.pow[6] &&\r\n                            !user.pow[7] &&\r\n                            !user.pow[8]\r\n                        ) {\r\n                            return res.render('bancansu-index', {\r\n                                header: 'global-header',\r\n                                footer: 'global-footer',\r\n                                thongbao: 'global-notifications',\r\n                                pow: 1,\r\n                                bandiem: studentTotalScores,\r\n                                hoatdong: studentActivities,\r\n                                hethan: false,\r\n                                nienkhoa: Object.keys(schoolYear_all.years),\r\n                                check_chamdiem: check_year,\r\n                            });\r\n                        } else if (\r\n                            user.pow[0] &&\r\n                            !user.pow[1] &&\r\n                            !user.pow[2] &&\r\n                            user.pow[3] &&\r\n                            !user.pow[4] &&\r\n                            !user.pow[5] &&\r\n                            !user.pow[6] &&\r\n                            !user.pow[7] &&\r\n                            !user.pow[8]\r\n                        ) {\r\n                            return res.render('bancansu-index', {\r\n                                header: 'global-header',\r\n                                footer: 'global-footer',\r\n                                thongbao: 'global-notifications',\r\n                                pow: 2,\r\n                                bandiem: studentTotalScores,\r\n                                hoatdong: studentActivities,\r\n                                hethan: false,\r\n                                nienkhoa: Object.keys(schoolYear_all.years),\r\n                                check_chamdiem: check_year,\r\n                            });\r\n                        }\r\n                    } else {\r\n                        // console.log(\"xx\",schoolYear_all.years[schoolYear.year.slice(4)]);\r\n                        for (let i = 0; i < 3; i++) {\r\n                            schoolYearsToSearch.push(`HK${i + 1}_` + schoolYear.year.slice(4));\r\n                        }\r\n                        const studentTotalScores = await Promise.all(\r\n                            schoolYearsToSearch.map(async (year) => {\r\n                                // Tìm trong bảng '_dep_table' trước\r\n                                const depCollection = client.db(user.dep).collection(user.cls[0] + '_dep_table');\r\n                                const stfCollection = client.db(user.dep).collection(user.cls[0] + '_stf_table');\r\n                                const stdCollection = client.db(user.dep).collection(user.cls[0] + '_std_table');\r\n                                const depDocument = await depCollection.findOne(\r\n                                    { mssv: user._id, school_year: year },\r\n                                    { projection: { _id: 0, total: 1 } },\r\n                                );\r\n\r\n                                if (depDocument) {\r\n                                    return {\r\n                                        year: year,\r\n                                        total: depDocument.total,\r\n                                    };\r\n                                }\r\n                                const stfDocument = await stfCollection.findOne(\r\n                                    { mssv: user._id, school_year: year },\r\n                                    { projection: { _id: 0, total: 1 } },\r\n                                );\r\n                                if (stfDocument) {\r\n                                    return {\r\n                                        year: year,\r\n                                        total: stfDocument.total,\r\n                                    };\r\n                                }\r\n                                const stdDocument = await stdCollection.findOne(\r\n                                    { mssv: user._id, school_year: year },\r\n                                    { projection: { _id: 0, total: 1 } },\r\n                                );\r\n                                if (stdDocument) {\r\n                                    return {\r\n                                        year: year,\r\n                                        total: stdDocument.total,\r\n                                    };\r\n                                }\r\n                                return {\r\n                                    year: year,\r\n                                    total: 'Chưa có điểm',\r\n                                };\r\n                            }),\r\n                        );\r\n                        console.log(studentTotalScores);\r\n                        const studentActivities = await Promise.all(\r\n                            schoolYearsToSearch.map(async (year) => {\r\n                                info_search = `student_list.${user._id}`;\r\n                                let activitie_info_lop = await client\r\n                                    .db(user.dep)\r\n                                    .collection(`${user.cls[0]}_activities`)\r\n                                    .find(\r\n                                        {\r\n                                            [info_search]: { $exists: true },\r\n                                            year: year,\r\n                                        },\r\n                                        {\r\n                                            projection: {\r\n                                                name: 1,\r\n                                                student_list: 1,\r\n                                                ai: 1,\r\n                                                level: 1,\r\n                                            },\r\n                                        },\r\n                                    )\r\n\r\n                                    .toArray();\r\n                                if (activitie_info_lop.length > 0) {\r\n                                    activitie_info_lop.forEach((element) => {\r\n                                        if (element.ai && element.ai[user._id]) {\r\n                                            element.thamgia = true;\r\n                                        }\r\n                                        if (element.student_list[user._id] == 2) {\r\n                                            element.khenthuong = true;\r\n                                        }\r\n                                    });\r\n                                }\r\n                                let activitie_info_khoa = await client\r\n                                    .db(user.dep)\r\n                                    .collection('activities')\r\n                                    .find(\r\n                                        {\r\n                                            [info_search]: { $exists: true },\r\n                                            year: year,\r\n                                        },\r\n                                        {\r\n                                            projection: {\r\n                                                name: 1,\r\n                                                student_list: 1,\r\n                                                ai: 1,\r\n                                                level: 1,\r\n                                            },\r\n                                        },\r\n                                    )\r\n                                    .toArray();\r\n\r\n                                if (activitie_info_khoa.length > 0) {\r\n                                    activitie_info_khoa.forEach((element) => {\r\n                                        if (element.ai && element.ai[user._id]) {\r\n                                            element.thamgia = true;\r\n                                        }\r\n                                        if (element.student_list[user._id] == 2) {\r\n                                            element.khenthuong = true;\r\n                                        }\r\n                                    });\r\n                                }\r\n\r\n                                let activitie_info_truong = await client\r\n                                    .db(name_global_databases)\r\n                                    .collection('activities')\r\n                                    .find(\r\n                                        {\r\n                                            [info_search]: { $exists: true },\r\n                                            year: year,\r\n                                        },\r\n                                        {\r\n                                            projection: {\r\n                                                name: 1,\r\n                                                student_list: 1,\r\n                                                ai: 1,\r\n                                                level: 1,\r\n                                            },\r\n                                        },\r\n                                    )\r\n                                    .toArray();\r\n                                if (activitie_info_truong.length > 0) {\r\n                                    activitie_info_truong.forEach((element) => {\r\n                                        if (element.ai && element.ai[user._id]) {\r\n                                            element.thamgia = true;\r\n                                        }\r\n                                        if (element.student_list[user._id] == 2) {\r\n                                            element.khenthuong = true;\r\n                                        }\r\n                                    });\r\n                                }\r\n\r\n                                return {\r\n                                    year: year,\r\n                                    activitie_info_lop: activitie_info_lop,\r\n                                    activitie_info_khoa: activitie_info_khoa,\r\n                                    activitie_info_truong: activitie_info_truong,\r\n                                };\r\n                            }),\r\n                        );\r\n                        if (\r\n                            user.pow[0] &&\r\n                            !user.pow[1] &&\r\n                            !user.pow[2] &&\r\n                            !user.pow[3] &&\r\n                            !user.pow[4] &&\r\n                            !user.pow[5] &&\r\n                            !user.pow[6] &&\r\n                            !user.pow[7] &&\r\n                            !user.pow[8]\r\n                        ) {\r\n                            return res.render('sinhvien-index', {\r\n                                header: 'global-header',\r\n                                footer: 'global-footer',\r\n                                thongbao: 'global-notifications',\r\n                                bandiem: studentTotalScores,\r\n                                hoatdong: studentActivities,\r\n                                hethan: true,\r\n                                nienkhoa: Object.keys(schoolYear_all.years),\r\n                                check_chamdiem: check_year,\r\n                            });\r\n                        } else if (\r\n                            user.pow[0] &&\r\n                            user.pow[1] &&\r\n                            !user.pow[2] &&\r\n                            user.pow[3] &&\r\n                            !user.pow[4] &&\r\n                            !user.pow[5] &&\r\n                            !user.pow[6] &&\r\n                            !user.pow[7] &&\r\n                            !user.pow[8]\r\n                        ) {\r\n                            return res.render('bancansu-index', {\r\n                                header: 'global-header',\r\n                                footer: 'global-footer',\r\n                                thongbao: 'global-notifications',\r\n                                pow: 0,\r\n                                bandiem: studentTotalScores,\r\n                                hoatdong: studentActivities,\r\n                                hethan: true,\r\n                                nienkhoa: Object.keys(schoolYear_all.years),\r\n                                check_chamdiem: check_year,\r\n                            });\r\n                        } else if (\r\n                            user.pow[0] &&\r\n                            user.pow[1] &&\r\n                            !user.pow[2] &&\r\n                            !user.pow[3] &&\r\n                            !user.pow[4] &&\r\n                            !user.pow[5] &&\r\n                            !user.pow[6] &&\r\n                            !user.pow[7] &&\r\n                            !user.pow[8]\r\n                        ) {\r\n                            return res.render('bancansu-index', {\r\n                                header: 'global-header',\r\n                                footer: 'global-footer',\r\n                                thongbao: 'global-notifications',\r\n                                pow: 1,\r\n                                bandiem: studentTotalScores,\r\n                                hoatdong: studentActivities,\r\n                                hethan: true,\r\n                                nienkhoa: Object.keys(schoolYear_all.years),\r\n                                check_chamdiem: check_year,\r\n                            });\r\n                        } else if (\r\n                            user.pow[0] &&\r\n                            !user.pow[1] &&\r\n                            !user.pow[2] &&\r\n                            user.pow[3] &&\r\n                            !user.pow[4] &&\r\n                            !user.pow[5] &&\r\n                            !user.pow[6] &&\r\n                            !user.pow[7] &&\r\n                            !user.pow[8]\r\n                        ) {\r\n                            return res.render('bancansu-index', {\r\n                                header: 'global-header',\r\n                                footer: 'global-footer',\r\n                                thongbao: 'global-notifications',\r\n                                pow: 2,\r\n                                bandiem: studentTotalScores,\r\n                                hoatdong: studentActivities,\r\n                                hethan: true,\r\n                                nienkhoa: Object.keys(schoolYear_all.years),\r\n                                check_chamdiem: check_year,\r\n                            });\r\n                        }\r\n                    }\r\n                } else {\r\n                    return res.sendStatus(403).send('Sinh viên đã tốt nghiệp');\r\n                }\r\n            } else {\r\n                if (\r\n                    !user.pow[0] &&\r\n                    user.pow[1] &&\r\n                    !user.pow[2] &&\r\n                    user.pow[3] &&\r\n                    user.pow[4] &&\r\n                    !user.pow[5] &&\r\n                    !user.pow[6] &&\r\n                    !user.pow[7] &&\r\n                    !user.pow[8]\r\n                ) {\r\n                    const student_list = user.cls[0];\r\n\r\n                    const nulll = [1];\r\n                    return res.render('teacher-index', {\r\n                        header: 'global-header',\r\n                        student_list: student_list != undefined ? student_list : nulll,\r\n                        footer: 'global-footer',\r\n                    });\r\n                } else if (\r\n                    !user.pow[0] &&\r\n                    !user.pow[1] &&\r\n                    user.pow[2] &&\r\n                    user.pow[3] &&\r\n                    user.pow[4] &&\r\n                    user.pow[5] &&\r\n                    user.pow[6] &&\r\n                    user.pow[7] &&\r\n                    user.pow[8]\r\n                ) {\r\n                    return res.render('doankhoa-index', {\r\n                        header: 'global-header',\r\n                        footer: 'global-footer',\r\n                        menu: 'doankhoa-menu',\r\n                    });\r\n                }\r\n            }\r\n        } catch (err) {\r\n            console.log('SYSTEM | INDEX_ROUTE | ERROR | ', err);\r\n        }\r\n    });\r\n\r\n    // xac thuc route\r\n    router.get('/verifyOTP', async (req, res) => {\r\n        try {\r\n            const user = req.session.user;\r\n            if (user) {\r\n                return res.redirect('/');\r\n            }\r\n            const mssv = req.query.mssv;\r\n            const dataUser = await client\r\n                .db(name_global_databases)\r\n                .collection('user_info')\r\n                .findOne({ _id: mssv }, { projection: { _id: 0, email: 1 } });\r\n            let emailToShow = '';\r\n            if (dataUser) {\r\n                const email = dataUser.email;\r\n                emailToShow =\r\n                    email.substring(0, 3) + '*'.repeat(email.indexOf('@') - 3) + email.substring(email.indexOf('@'));\r\n            }\r\n            return res.render('global-verify-otp', {\r\n                header: 'global-header',\r\n                footer: 'global-footer',\r\n                avt: null,\r\n                thongbao: 'global-notifications',\r\n                email: emailToShow,\r\n            });\r\n        } catch (err) {\r\n            console.log('SYSTEM | OTP_ROUTE | ERROR | ', err);\r\n            return res.render('global-verify-otp', {\r\n                header: 'global-header',\r\n                footer: 'global-footer',\r\n                avt: null,\r\n                thongbao: 'global-notifications',\r\n                email: '',\r\n            });\r\n        }\r\n    });\r\n\r\n    // Quen mat khau\r\n    router.get('/quenmatkhau', async (req, res) => {\r\n        const user = req.session.user;\r\n        if (user) {\r\n            return res.redirect('/');\r\n        }\r\n        return res.render('global-forgot-password', {\r\n            header: 'global-header',\r\n            footer: 'global-footer',\r\n            thongbao: 'global-notifications',\r\n            avt: null,\r\n        });\r\n    });\r\n\r\n    router.get('/dangkyhoatdong', checkIfUserLoginRoute, async (req, res) => {\r\n        try {\r\n            const query = req.query;\r\n            const user = req.session.user;\r\n            let activitie_info;\r\n            if (query.id && query.level) {\r\n                switch (query.level) {\r\n                    case 'lop':\r\n                        if (user.pow[0]) {\r\n                            activitie_info = await client.db(user.dep).collection(`${user.cls[0]}_activities`).findOne({\r\n                                _id: query.id,\r\n                            });\r\n                            console.log(user.cls[0]);\r\n                        } else {\r\n                            const collections = await client.db(user.dep).listCollections().toArray();\r\n                            // Filter collections ending with '_activities'\r\n                            const activityCollections = await collections.filter((collection) =>\r\n                                collection.name.endsWith('_activities'),\r\n                            );\r\n                            // Loop through activity collections and retrieve all documents\r\n                            for (const activityCollection of activityCollections) {\r\n                                activitie_info = await client.db(user.dep).collection(activityCollection.name).findOne({\r\n                                    _id: query.id,\r\n                                });\r\n                                if (activitie_info) {\r\n                                    break; // Thoát khỏi vòng lặp khi tìm thấy kết quả\r\n                                }\r\n                            }\r\n                        }\r\n                        break;\r\n                    case 'khoa':\r\n                        activitie_info = await client.db(user.dep).collection('activities').findOne({\r\n                            _id: query.id,\r\n                        });\r\n                        break;\r\n                    case 'truong':\r\n                        activitie_info = await client.db(name_global_databases).collection('activities').findOne({\r\n                            _id: query.id,\r\n                        });\r\n                        break;\r\n                }\r\n                if (!activitie_info) {\r\n                    return res.status(404).send('Not Found');\r\n                }\r\n                activitie_info.join = false;\r\n                activitie_info.diemdanh = false;\r\n                if (activitie_info.student_list) {\r\n                    const list_student = Object.keys(activitie_info.student_list);\r\n                    let info_student = [];\r\n                    for (let i = 0; i < list_student.length; i++) {\r\n                        info_student.push(\r\n                            await client\r\n                                .db(name_global_databases)\r\n                                .collection('user_info')\r\n                                .findOne(\r\n                                    {\r\n                                        _id: list_student[i],\r\n                                    },\r\n                                    { projection: { first_name: 1, last_name: 1, class: 1 } },\r\n                                ),\r\n                        );\r\n                    }\r\n                    activitie_info.info_student = info_student;\r\n                    if (user._id in activitie_info.student_list) {\r\n                        activitie_info.join = true;\r\n                    }\r\n                    if (activitie_info.ai && user._id in activitie_info.ai && activitie_info.ai[user._id]) {\r\n                        activitie_info.diemdanh = true;\r\n                    }\r\n                }\r\n\r\n                return res.render('sinhvien-activeregistration', {\r\n                    header: 'global-header',\r\n                    thongbao: 'global-notifications',\r\n                    footer: 'global-footer',\r\n                    activitie_info: activitie_info,\r\n                    id_acti: query.id,\r\n                });\r\n            } else {\r\n                return res.redirect('/');\r\n            }\r\n        } catch (err) {\r\n            return console.log('SYSTEM | HOAT_DONG_DANG_KY_ROUTE | ERROR | ', err);\r\n        }\r\n    });\r\n\r\n    // 403 route\r\n    router.get('/403', async (req, res) => {\r\n        return res.sendFile(path.join(parentDirectory, 'dPage', '403.html'));\r\n    });\r\n\r\n    return router;\r\n}\r\nmodule.exports = createRootRouter;\r\n"],"mappings":"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","ignoreList":[]}},"mtime":1719476170726},"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\project\\\\web\\\\newCDRL-1\\\\backend\\\\router\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\project\\\\web\\\\newCDRL-1\",\"filename\":\"D:\\\\project\\\\web\\\\newCDRL-1\\\\backend\\\\router\\\\loginRouters.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\project\\\\web\\\\newCDRL-1\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.24.3:development":{"value":{"code":"const express = require('express');\nconst router = express.Router();\nconst {\n  getNameGlobal\n} = require('../lib/mogodb_lib');\nconst name_global_databases = getNameGlobal();\nfunction createLoginRouter(client) {\n  // login route\n  router.get('/', async (req, res) => {\n    const user = req.session.user;\n    if (user) {\n      return res.redirect('/');\n    }\n    return res.render('global-login', {\n      header: 'global-header',\n      thongbao: 'global-notifications',\n      footer: 'global-footer',\n      avt: null\n    });\n  });\n  // firstlogin route\n  router.get('/firstlogin', async (req, res) => {\n    const user = req.session.user;\n    let tile = 'Đăng nhập lần đầu';\n    if (req.query.tile == 'ok') {\n      tile = 'Cập nhật mật khẩu';\n    }\n    if (!user?.first) {\n      return res.redirect('/');\n    }\n    return res.render('global-first-login', {\n      header: 'global-header',\n      thongbao: 'global-notifications',\n      footer: 'global-footer',\n      avt: null,\n      logout: true,\n      tile: tile\n    });\n  });\n  return router;\n}\nmodule.exports = createLoginRouter;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIlJvdXRlciIsImdldE5hbWVHbG9iYWwiLCJuYW1lX2dsb2JhbF9kYXRhYmFzZXMiLCJjcmVhdGVMb2dpblJvdXRlciIsImNsaWVudCIsImdldCIsInJlcSIsInJlcyIsInVzZXIiLCJzZXNzaW9uIiwicmVkaXJlY3QiLCJyZW5kZXIiLCJoZWFkZXIiLCJ0aG9uZ2JhbyIsImZvb3RlciIsImF2dCIsInRpbGUiLCJxdWVyeSIsImZpcnN0IiwibG9nb3V0IiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiRDpcXHByb2plY3RcXHdlYlxcbmV3Q0RSTC0xXFxiYWNrZW5kXFxyb3V0ZXJcXCIsInNvdXJjZXMiOlsibG9naW5Sb3V0ZXJzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XHJcbmNvbnN0IHJvdXRlciA9IGV4cHJlc3MuUm91dGVyKCk7XHJcbmNvbnN0IHsgZ2V0TmFtZUdsb2JhbCB9ID0gcmVxdWlyZSgnLi4vbGliL21vZ29kYl9saWInKTtcclxuY29uc3QgbmFtZV9nbG9iYWxfZGF0YWJhc2VzID0gZ2V0TmFtZUdsb2JhbCgpO1xyXG5mdW5jdGlvbiBjcmVhdGVMb2dpblJvdXRlcihjbGllbnQpIHtcclxuICAgIC8vIGxvZ2luIHJvdXRlXHJcbiAgICByb3V0ZXIuZ2V0KCcvJywgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgY29uc3QgdXNlciA9IHJlcS5zZXNzaW9uLnVzZXI7XHJcbiAgICAgICAgaWYgKHVzZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5yZWRpcmVjdCgnLycpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzLnJlbmRlcignZ2xvYmFsLWxvZ2luJywge1xyXG4gICAgICAgICAgICBoZWFkZXI6ICdnbG9iYWwtaGVhZGVyJyxcclxuICAgICAgICAgICAgdGhvbmdiYW86ICdnbG9iYWwtbm90aWZpY2F0aW9ucycsXHJcbiAgICAgICAgICAgIGZvb3RlcjogJ2dsb2JhbC1mb290ZXInLFxyXG4gICAgICAgICAgICBhdnQ6IG51bGwsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuICAgIC8vIGZpcnN0bG9naW4gcm91dGVcclxuICAgIHJvdXRlci5nZXQoJy9maXJzdGxvZ2luJywgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgY29uc3QgdXNlciA9IHJlcS5zZXNzaW9uLnVzZXI7XHJcbiAgICAgICAgbGV0IHRpbGUgPSAnxJDEg25nIG5o4bqtcCBs4bqnbiDEkeG6p3UnO1xyXG4gICAgICAgIGlmIChyZXEucXVlcnkudGlsZSA9PSAnb2snKSB7XHJcbiAgICAgICAgICAgIHRpbGUgPSAnQ+G6rXAgbmjhuq10IG3huq10IGto4bqpdSc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdXNlcj8uZmlyc3QpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5yZWRpcmVjdCgnLycpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzLnJlbmRlcignZ2xvYmFsLWZpcnN0LWxvZ2luJywge1xyXG4gICAgICAgICAgICBoZWFkZXI6ICdnbG9iYWwtaGVhZGVyJyxcclxuICAgICAgICAgICAgdGhvbmdiYW86ICdnbG9iYWwtbm90aWZpY2F0aW9ucycsXHJcbiAgICAgICAgICAgIGZvb3RlcjogJ2dsb2JhbC1mb290ZXInLFxyXG4gICAgICAgICAgICBhdnQ6IG51bGwsXHJcbiAgICAgICAgICAgIGxvZ291dDogdHJ1ZSxcclxuICAgICAgICAgICAgdGlsZTogdGlsZSxcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHJvdXRlcjtcclxufVxyXG5tb2R1bGUuZXhwb3J0cyA9IGNyZWF0ZUxvZ2luUm91dGVyO1xyXG4iXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLE9BQU8sR0FBR0MsT0FBTyxDQUFDLFNBQVMsQ0FBQztBQUNsQyxNQUFNQyxNQUFNLEdBQUdGLE9BQU8sQ0FBQ0csTUFBTSxDQUFDLENBQUM7QUFDL0IsTUFBTTtFQUFFQztBQUFjLENBQUMsR0FBR0gsT0FBTyxDQUFDLG1CQUFtQixDQUFDO0FBQ3RELE1BQU1JLHFCQUFxQixHQUFHRCxhQUFhLENBQUMsQ0FBQztBQUM3QyxTQUFTRSxpQkFBaUJBLENBQUNDLE1BQU0sRUFBRTtFQUMvQjtFQUNBTCxNQUFNLENBQUNNLEdBQUcsQ0FBQyxHQUFHLEVBQUUsT0FBT0MsR0FBRyxFQUFFQyxHQUFHLEtBQUs7SUFDaEMsTUFBTUMsSUFBSSxHQUFHRixHQUFHLENBQUNHLE9BQU8sQ0FBQ0QsSUFBSTtJQUM3QixJQUFJQSxJQUFJLEVBQUU7TUFDTixPQUFPRCxHQUFHLENBQUNHLFFBQVEsQ0FBQyxHQUFHLENBQUM7SUFDNUI7SUFDQSxPQUFPSCxHQUFHLENBQUNJLE1BQU0sQ0FBQyxjQUFjLEVBQUU7TUFDOUJDLE1BQU0sRUFBRSxlQUFlO01BQ3ZCQyxRQUFRLEVBQUUsc0JBQXNCO01BQ2hDQyxNQUFNLEVBQUUsZUFBZTtNQUN2QkMsR0FBRyxFQUFFO0lBQ1QsQ0FBQyxDQUFDO0VBQ04sQ0FBQyxDQUFDO0VBQ0Y7RUFDQWhCLE1BQU0sQ0FBQ00sR0FBRyxDQUFDLGFBQWEsRUFBRSxPQUFPQyxHQUFHLEVBQUVDLEdBQUcsS0FBSztJQUMxQyxNQUFNQyxJQUFJLEdBQUdGLEdBQUcsQ0FBQ0csT0FBTyxDQUFDRCxJQUFJO0lBQzdCLElBQUlRLElBQUksR0FBRyxtQkFBbUI7SUFDOUIsSUFBSVYsR0FBRyxDQUFDVyxLQUFLLENBQUNELElBQUksSUFBSSxJQUFJLEVBQUU7TUFDeEJBLElBQUksR0FBRyxtQkFBbUI7SUFDOUI7SUFDQSxJQUFJLENBQUNSLElBQUksRUFBRVUsS0FBSyxFQUFFO01BQ2QsT0FBT1gsR0FBRyxDQUFDRyxRQUFRLENBQUMsR0FBRyxDQUFDO0lBQzVCO0lBQ0EsT0FBT0gsR0FBRyxDQUFDSSxNQUFNLENBQUMsb0JBQW9CLEVBQUU7TUFDcENDLE1BQU0sRUFBRSxlQUFlO01BQ3ZCQyxRQUFRLEVBQUUsc0JBQXNCO01BQ2hDQyxNQUFNLEVBQUUsZUFBZTtNQUN2QkMsR0FBRyxFQUFFLElBQUk7TUFDVEksTUFBTSxFQUFFLElBQUk7TUFDWkgsSUFBSSxFQUFFQTtJQUNWLENBQUMsQ0FBQztFQUNOLENBQUMsQ0FBQztFQUNGLE9BQU9qQixNQUFNO0FBQ2pCO0FBQ0FxQixNQUFNLENBQUNDLE9BQU8sR0FBR2xCLGlCQUFpQiIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["express","require","router","Router","getNameGlobal","name_global_databases","createLoginRouter","client","get","req","res","user","session","redirect","render","header","thongbao","footer","avt","tile","query","first","logout","module","exports"],"sourceRoot":"D:\\project\\web\\newCDRL-1\\backend\\router\\","sources":["loginRouters.js"],"sourcesContent":["const express = require('express');\r\nconst router = express.Router();\r\nconst { getNameGlobal } = require('../lib/mogodb_lib');\r\nconst name_global_databases = getNameGlobal();\r\nfunction createLoginRouter(client) {\r\n    // login route\r\n    router.get('/', async (req, res) => {\r\n        const user = req.session.user;\r\n        if (user) {\r\n            return res.redirect('/');\r\n        }\r\n        return res.render('global-login', {\r\n            header: 'global-header',\r\n            thongbao: 'global-notifications',\r\n            footer: 'global-footer',\r\n            avt: null,\r\n        });\r\n    });\r\n    // firstlogin route\r\n    router.get('/firstlogin', async (req, res) => {\r\n        const user = req.session.user;\r\n        let tile = 'Đăng nhập lần đầu';\r\n        if (req.query.tile == 'ok') {\r\n            tile = 'Cập nhật mật khẩu';\r\n        }\r\n        if (!user?.first) {\r\n            return res.redirect('/');\r\n        }\r\n        return res.render('global-first-login', {\r\n            header: 'global-header',\r\n            thongbao: 'global-notifications',\r\n            footer: 'global-footer',\r\n            avt: null,\r\n            logout: true,\r\n            tile: tile,\r\n        });\r\n    });\r\n    return router;\r\n}\r\nmodule.exports = createLoginRouter;\r\n"],"mappings":"AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAC,SAAS,CAAC;AAClC,MAAMC,MAAM,GAAGF,OAAO,CAACG,MAAM,CAAC,CAAC;AAC/B,MAAM;EAAEC;AAAc,CAAC,GAAGH,OAAO,CAAC,mBAAmB,CAAC;AACtD,MAAMI,qBAAqB,GAAGD,aAAa,CAAC,CAAC;AAC7C,SAASE,iBAAiBA,CAACC,MAAM,EAAE;EAC/B;EACAL,MAAM,CAACM,GAAG,CAAC,GAAG,EAAE,OAAOC,GAAG,EAAEC,GAAG,KAAK;IAChC,MAAMC,IAAI,GAAGF,GAAG,CAACG,OAAO,CAACD,IAAI;IAC7B,IAAIA,IAAI,EAAE;MACN,OAAOD,GAAG,CAACG,QAAQ,CAAC,GAAG,CAAC;IAC5B;IACA,OAAOH,GAAG,CAACI,MAAM,CAAC,cAAc,EAAE;MAC9BC,MAAM,EAAE,eAAe;MACvBC,QAAQ,EAAE,sBAAsB;MAChCC,MAAM,EAAE,eAAe;MACvBC,GAAG,EAAE;IACT,CAAC,CAAC;EACN,CAAC,CAAC;EACF;EACAhB,MAAM,CAACM,GAAG,CAAC,aAAa,EAAE,OAAOC,GAAG,EAAEC,GAAG,KAAK;IAC1C,MAAMC,IAAI,GAAGF,GAAG,CAACG,OAAO,CAACD,IAAI;IAC7B,IAAIQ,IAAI,GAAG,mBAAmB;IAC9B,IAAIV,GAAG,CAACW,KAAK,CAACD,IAAI,IAAI,IAAI,EAAE;MACxBA,IAAI,GAAG,mBAAmB;IAC9B;IACA,IAAI,CAACR,IAAI,EAAEU,KAAK,EAAE;MACd,OAAOX,GAAG,CAACG,QAAQ,CAAC,GAAG,CAAC;IAC5B;IACA,OAAOH,GAAG,CAACI,MAAM,CAAC,oBAAoB,EAAE;MACpCC,MAAM,EAAE,eAAe;MACvBC,QAAQ,EAAE,sBAAsB;MAChCC,MAAM,EAAE,eAAe;MACvBC,GAAG,EAAE,IAAI;MACTI,MAAM,EAAE,IAAI;MACZH,IAAI,EAAEA;IACV,CAAC,CAAC;EACN,CAAC,CAAC;EACF,OAAOjB,MAAM;AACjB;AACAqB,MAAM,CAACC,OAAO,GAAGlB,iBAAiB","ignoreList":[]}},"mtime":1705240655664},"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\project\\\\web\\\\newCDRL-1\\\\backend\\\\router\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\project\\\\web\\\\newCDRL-1\",\"filename\":\"D:\\\\project\\\\web\\\\newCDRL-1\\\\backend\\\\router\\\\profileRouters.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\project\\\\web\\\\newCDRL-1\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.24.3:development":{"value":{"code":"const express = require('express');\nconst router = express.Router();\nconst {\n  checkIfUserLoginRoute\n} = require('../lib/function_lib');\nconst {\n  getNameGlobal\n} = require('../lib/mogodb_lib');\nconst name_global_databases = getNameGlobal();\nfunction createProfileRouter(client) {\n  // thong tin ca nhan route\n  router.get('/', checkIfUserLoginRoute, async (req, res) => {\n    const user = req.session.user;\n    const user_info = await client.db(name_global_databases).collection('user_info').findOne({\n      _id: req.session.user._id\n    }, {\n      projection: {\n        last_name: 1,\n        first_name: 1,\n        email: 1\n      }\n    });\n    return res.render('global-edit-profile', {\n      header: 'global-header',\n      footer: 'global-footer',\n      menu: 'doankhoa-menu',\n      name: user_info.last_name + ' ' + user_info.first_name,\n      mssv: user_info._id,\n      email: user_info.email,\n      quyen: user,\n      thongbao: 'global-notifications'\n    });\n  });\n  // doi password route\n  router.get('/change_pass', checkIfUserLoginRoute, async (req, res) => {\n    const user = req.session.user;\n    return res.render('global-change-password', {\n      header: 'global-header',\n      thongbao: 'global-notifications',\n      menu: 'doankhoa-menu',\n      quyen: user,\n      footer: 'global-footer'\n    });\n  });\n  return router;\n}\nmodule.exports = createProfileRouter;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIlJvdXRlciIsImNoZWNrSWZVc2VyTG9naW5Sb3V0ZSIsImdldE5hbWVHbG9iYWwiLCJuYW1lX2dsb2JhbF9kYXRhYmFzZXMiLCJjcmVhdGVQcm9maWxlUm91dGVyIiwiY2xpZW50IiwiZ2V0IiwicmVxIiwicmVzIiwidXNlciIsInNlc3Npb24iLCJ1c2VyX2luZm8iLCJkYiIsImNvbGxlY3Rpb24iLCJmaW5kT25lIiwiX2lkIiwicHJvamVjdGlvbiIsImxhc3RfbmFtZSIsImZpcnN0X25hbWUiLCJlbWFpbCIsInJlbmRlciIsImhlYWRlciIsImZvb3RlciIsIm1lbnUiLCJuYW1lIiwibXNzdiIsInF1eWVuIiwidGhvbmdiYW8iLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiJEOlxccHJvamVjdFxcd2ViXFxuZXdDRFJMLTFcXGJhY2tlbmRcXHJvdXRlclxcIiwic291cmNlcyI6WyJwcm9maWxlUm91dGVycy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBleHByZXNzID0gcmVxdWlyZSgnZXhwcmVzcycpO1xyXG5jb25zdCByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpO1xyXG5jb25zdCB7IGNoZWNrSWZVc2VyTG9naW5Sb3V0ZSB9ID0gcmVxdWlyZSgnLi4vbGliL2Z1bmN0aW9uX2xpYicpO1xyXG5jb25zdCB7IGdldE5hbWVHbG9iYWwgfSA9IHJlcXVpcmUoJy4uL2xpYi9tb2dvZGJfbGliJyk7XHJcbmNvbnN0IG5hbWVfZ2xvYmFsX2RhdGFiYXNlcyA9IGdldE5hbWVHbG9iYWwoKTtcclxuZnVuY3Rpb24gY3JlYXRlUHJvZmlsZVJvdXRlcihjbGllbnQpIHtcclxuICAgIC8vIHRob25nIHRpbiBjYSBuaGFuIHJvdXRlXHJcbiAgICByb3V0ZXIuZ2V0KCcvJywgY2hlY2tJZlVzZXJMb2dpblJvdXRlLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICAgICAgICBjb25zdCB1c2VyID0gcmVxLnNlc3Npb24udXNlcjtcclxuICAgICAgICBjb25zdCB1c2VyX2luZm8gPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ3VzZXJfaW5mbycpXHJcbiAgICAgICAgICAgIC5maW5kT25lKHsgX2lkOiByZXEuc2Vzc2lvbi51c2VyLl9pZCB9LCB7IHByb2plY3Rpb246IHsgbGFzdF9uYW1lOiAxLCBmaXJzdF9uYW1lOiAxLCBlbWFpbDogMSB9IH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gcmVzLnJlbmRlcignZ2xvYmFsLWVkaXQtcHJvZmlsZScsIHtcclxuICAgICAgICAgICAgaGVhZGVyOiAnZ2xvYmFsLWhlYWRlcicsXHJcbiAgICAgICAgICAgIGZvb3RlcjogJ2dsb2JhbC1mb290ZXInLFxyXG4gICAgICAgICAgICBtZW51OiAnZG9hbmtob2EtbWVudScsXHJcbiAgICAgICAgICAgIG5hbWU6IHVzZXJfaW5mby5sYXN0X25hbWUgKyAnICcgKyB1c2VyX2luZm8uZmlyc3RfbmFtZSxcclxuICAgICAgICAgICAgbXNzdjogdXNlcl9pbmZvLl9pZCxcclxuICAgICAgICAgICAgZW1haWw6IHVzZXJfaW5mby5lbWFpbCxcclxuICAgICAgICAgICAgcXV5ZW46IHVzZXIsXHJcbiAgICAgICAgICAgIHRob25nYmFvOiAnZ2xvYmFsLW5vdGlmaWNhdGlvbnMnLFxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgICAvLyBkb2kgcGFzc3dvcmQgcm91dGVcclxuICAgIHJvdXRlci5nZXQoJy9jaGFuZ2VfcGFzcycsIGNoZWNrSWZVc2VyTG9naW5Sb3V0ZSwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgY29uc3QgdXNlciA9IHJlcS5zZXNzaW9uLnVzZXI7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5yZW5kZXIoJ2dsb2JhbC1jaGFuZ2UtcGFzc3dvcmQnLCB7XHJcbiAgICAgICAgICAgIGhlYWRlcjogJ2dsb2JhbC1oZWFkZXInLFxyXG4gICAgICAgICAgICB0aG9uZ2JhbzogJ2dsb2JhbC1ub3RpZmljYXRpb25zJyxcclxuICAgICAgICAgICAgbWVudTogJ2RvYW5raG9hLW1lbnUnLFxyXG4gICAgICAgICAgICBxdXllbjogdXNlcixcclxuICAgICAgICAgICAgZm9vdGVyOiAnZ2xvYmFsLWZvb3RlcicsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiByb3V0ZXI7XHJcbn1cclxubW9kdWxlLmV4cG9ydHMgPSBjcmVhdGVQcm9maWxlUm91dGVyO1xyXG4iXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLE9BQU8sR0FBR0MsT0FBTyxDQUFDLFNBQVMsQ0FBQztBQUNsQyxNQUFNQyxNQUFNLEdBQUdGLE9BQU8sQ0FBQ0csTUFBTSxDQUFDLENBQUM7QUFDL0IsTUFBTTtFQUFFQztBQUFzQixDQUFDLEdBQUdILE9BQU8sQ0FBQyxxQkFBcUIsQ0FBQztBQUNoRSxNQUFNO0VBQUVJO0FBQWMsQ0FBQyxHQUFHSixPQUFPLENBQUMsbUJBQW1CLENBQUM7QUFDdEQsTUFBTUsscUJBQXFCLEdBQUdELGFBQWEsQ0FBQyxDQUFDO0FBQzdDLFNBQVNFLG1CQUFtQkEsQ0FBQ0MsTUFBTSxFQUFFO0VBQ2pDO0VBQ0FOLE1BQU0sQ0FBQ08sR0FBRyxDQUFDLEdBQUcsRUFBRUwscUJBQXFCLEVBQUUsT0FBT00sR0FBRyxFQUFFQyxHQUFHLEtBQUs7SUFDdkQsTUFBTUMsSUFBSSxHQUFHRixHQUFHLENBQUNHLE9BQU8sQ0FBQ0QsSUFBSTtJQUM3QixNQUFNRSxTQUFTLEdBQUcsTUFBTU4sTUFBTSxDQUN6Qk8sRUFBRSxDQUFDVCxxQkFBcUIsQ0FBQyxDQUN6QlUsVUFBVSxDQUFDLFdBQVcsQ0FBQyxDQUN2QkMsT0FBTyxDQUFDO01BQUVDLEdBQUcsRUFBRVIsR0FBRyxDQUFDRyxPQUFPLENBQUNELElBQUksQ0FBQ007SUFBSSxDQUFDLEVBQUU7TUFBRUMsVUFBVSxFQUFFO1FBQUVDLFNBQVMsRUFBRSxDQUFDO1FBQUVDLFVBQVUsRUFBRSxDQUFDO1FBQUVDLEtBQUssRUFBRTtNQUFFO0lBQUUsQ0FBQyxDQUFDO0lBRXRHLE9BQU9YLEdBQUcsQ0FBQ1ksTUFBTSxDQUFDLHFCQUFxQixFQUFFO01BQ3JDQyxNQUFNLEVBQUUsZUFBZTtNQUN2QkMsTUFBTSxFQUFFLGVBQWU7TUFDdkJDLElBQUksRUFBRSxlQUFlO01BQ3JCQyxJQUFJLEVBQUViLFNBQVMsQ0FBQ00sU0FBUyxHQUFHLEdBQUcsR0FBR04sU0FBUyxDQUFDTyxVQUFVO01BQ3RETyxJQUFJLEVBQUVkLFNBQVMsQ0FBQ0ksR0FBRztNQUNuQkksS0FBSyxFQUFFUixTQUFTLENBQUNRLEtBQUs7TUFDdEJPLEtBQUssRUFBRWpCLElBQUk7TUFDWGtCLFFBQVEsRUFBRTtJQUNkLENBQUMsQ0FBQztFQUNOLENBQUMsQ0FBQztFQUNGO0VBQ0E1QixNQUFNLENBQUNPLEdBQUcsQ0FBQyxjQUFjLEVBQUVMLHFCQUFxQixFQUFFLE9BQU9NLEdBQUcsRUFBRUMsR0FBRyxLQUFLO0lBQ2xFLE1BQU1DLElBQUksR0FBR0YsR0FBRyxDQUFDRyxPQUFPLENBQUNELElBQUk7SUFDN0IsT0FBT0QsR0FBRyxDQUFDWSxNQUFNLENBQUMsd0JBQXdCLEVBQUU7TUFDeENDLE1BQU0sRUFBRSxlQUFlO01BQ3ZCTSxRQUFRLEVBQUUsc0JBQXNCO01BQ2hDSixJQUFJLEVBQUUsZUFBZTtNQUNyQkcsS0FBSyxFQUFFakIsSUFBSTtNQUNYYSxNQUFNLEVBQUU7SUFDWixDQUFDLENBQUM7RUFDTixDQUFDLENBQUM7RUFDRixPQUFPdkIsTUFBTTtBQUNqQjtBQUNBNkIsTUFBTSxDQUFDQyxPQUFPLEdBQUd6QixtQkFBbUIiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["express","require","router","Router","checkIfUserLoginRoute","getNameGlobal","name_global_databases","createProfileRouter","client","get","req","res","user","session","user_info","db","collection","findOne","_id","projection","last_name","first_name","email","render","header","footer","menu","name","mssv","quyen","thongbao","module","exports"],"sourceRoot":"D:\\project\\web\\newCDRL-1\\backend\\router\\","sources":["profileRouters.js"],"sourcesContent":["const express = require('express');\r\nconst router = express.Router();\r\nconst { checkIfUserLoginRoute } = require('../lib/function_lib');\r\nconst { getNameGlobal } = require('../lib/mogodb_lib');\r\nconst name_global_databases = getNameGlobal();\r\nfunction createProfileRouter(client) {\r\n    // thong tin ca nhan route\r\n    router.get('/', checkIfUserLoginRoute, async (req, res) => {\r\n        const user = req.session.user;\r\n        const user_info = await client\r\n            .db(name_global_databases)\r\n            .collection('user_info')\r\n            .findOne({ _id: req.session.user._id }, { projection: { last_name: 1, first_name: 1, email: 1 } });\r\n\r\n        return res.render('global-edit-profile', {\r\n            header: 'global-header',\r\n            footer: 'global-footer',\r\n            menu: 'doankhoa-menu',\r\n            name: user_info.last_name + ' ' + user_info.first_name,\r\n            mssv: user_info._id,\r\n            email: user_info.email,\r\n            quyen: user,\r\n            thongbao: 'global-notifications',\r\n        });\r\n    });\r\n    // doi password route\r\n    router.get('/change_pass', checkIfUserLoginRoute, async (req, res) => {\r\n        const user = req.session.user;\r\n        return res.render('global-change-password', {\r\n            header: 'global-header',\r\n            thongbao: 'global-notifications',\r\n            menu: 'doankhoa-menu',\r\n            quyen: user,\r\n            footer: 'global-footer',\r\n        });\r\n    });\r\n    return router;\r\n}\r\nmodule.exports = createProfileRouter;\r\n"],"mappings":"AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAC,SAAS,CAAC;AAClC,MAAMC,MAAM,GAAGF,OAAO,CAACG,MAAM,CAAC,CAAC;AAC/B,MAAM;EAAEC;AAAsB,CAAC,GAAGH,OAAO,CAAC,qBAAqB,CAAC;AAChE,MAAM;EAAEI;AAAc,CAAC,GAAGJ,OAAO,CAAC,mBAAmB,CAAC;AACtD,MAAMK,qBAAqB,GAAGD,aAAa,CAAC,CAAC;AAC7C,SAASE,mBAAmBA,CAACC,MAAM,EAAE;EACjC;EACAN,MAAM,CAACO,GAAG,CAAC,GAAG,EAAEL,qBAAqB,EAAE,OAAOM,GAAG,EAAEC,GAAG,KAAK;IACvD,MAAMC,IAAI,GAAGF,GAAG,CAACG,OAAO,CAACD,IAAI;IAC7B,MAAME,SAAS,GAAG,MAAMN,MAAM,CACzBO,EAAE,CAACT,qBAAqB,CAAC,CACzBU,UAAU,CAAC,WAAW,CAAC,CACvBC,OAAO,CAAC;MAAEC,GAAG,EAAER,GAAG,CAACG,OAAO,CAACD,IAAI,CAACM;IAAI,CAAC,EAAE;MAAEC,UAAU,EAAE;QAAEC,SAAS,EAAE,CAAC;QAAEC,UAAU,EAAE,CAAC;QAAEC,KAAK,EAAE;MAAE;IAAE,CAAC,CAAC;IAEtG,OAAOX,GAAG,CAACY,MAAM,CAAC,qBAAqB,EAAE;MACrCC,MAAM,EAAE,eAAe;MACvBC,MAAM,EAAE,eAAe;MACvBC,IAAI,EAAE,eAAe;MACrBC,IAAI,EAAEb,SAAS,CAACM,SAAS,GAAG,GAAG,GAAGN,SAAS,CAACO,UAAU;MACtDO,IAAI,EAAEd,SAAS,CAACI,GAAG;MACnBI,KAAK,EAAER,SAAS,CAACQ,KAAK;MACtBO,KAAK,EAAEjB,IAAI;MACXkB,QAAQ,EAAE;IACd,CAAC,CAAC;EACN,CAAC,CAAC;EACF;EACA5B,MAAM,CAACO,GAAG,CAAC,cAAc,EAAEL,qBAAqB,EAAE,OAAOM,GAAG,EAAEC,GAAG,KAAK;IAClE,MAAMC,IAAI,GAAGF,GAAG,CAACG,OAAO,CAACD,IAAI;IAC7B,OAAOD,GAAG,CAACY,MAAM,CAAC,wBAAwB,EAAE;MACxCC,MAAM,EAAE,eAAe;MACvBM,QAAQ,EAAE,sBAAsB;MAChCJ,IAAI,EAAE,eAAe;MACrBG,KAAK,EAAEjB,IAAI;MACXa,MAAM,EAAE;IACZ,CAAC,CAAC;EACN,CAAC,CAAC;EACF,OAAOvB,MAAM;AACjB;AACA6B,MAAM,CAACC,OAAO,GAAGzB,mBAAmB","ignoreList":[]}},"mtime":1705240655665},"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\project\\\\web\\\\newCDRL-1\\\\backend\\\\router\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\project\\\\web\\\\newCDRL-1\",\"filename\":\"D:\\\\project\\\\web\\\\newCDRL-1\\\\backend\\\\router\\\\apiRouters.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\project\\\\web\\\\newCDRL-1\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.24.3:development":{"value":{"code":"const express = require('express');\nconst router = express.Router();\nconst XlsxPopulate = require('xlsx-populate');\nconst {\n  v4: uuidv4\n} = require('uuid');\nconst path = require('path');\nconst fs = require('fs');\nconst uploadDirectory = path.join('../../upload_temp');\nconst multer = require('multer');\nconst server = require('../lib/csdl_google_lib');\nconst {\n  ObjectId\n} = require('mongodb');\nconst {\n  getNameGlobal\n} = require('../lib/mogodb_lib');\nconst name_global_databases = getNameGlobal();\nconst {\n  comparePassword,\n  hashPassword,\n  sortStudentName,\n  scheduleFileDeletion,\n  mark,\n  updateStudentTotalScore,\n  sendEmail,\n  randomPassword,\n  checkIfUserLoginAPI,\n  createId,\n  get_full_id,\n  deleteClassApi,\n  createPdf\n} = require('../lib/function_lib');\nif (!fs.existsSync(uploadDirectory)) {\n  fs.mkdirSync(uploadDirectory);\n}\nconst storage_file = multer.diskStorage({\n  destination: function (req, file, cb) {\n    cb(null, uploadDirectory);\n  },\n  filename: function (req, file, cb) {\n    cb(null, file.originalname);\n  }\n});\nconst upload = multer({\n  storage: storage_file\n});\n\n// API SPACE ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\nfunction createAPIRouter(client, wss) {\n  // Log in --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n  router.post('/login', async (req, res) => {\n    const data = req.body;\n    // 403: sai thong tin dang nhap\n    // data = {mssv: bbp, password: 1234567890, remember: true}\n    try {\n      const user = req.session.user;\n      if (!user) {\n        //(log in database)\n        let user = await client.db(name_global_databases).collection('login_info').findOne({\n          _id: data.mssv\n        });\n        let user_info_check = await client.db(name_global_databases).collection('user_info').findOne({\n          _id: data.mssv\n        });\n        if (user === null || user_info_check === null || user_info_check.class == []) {\n          // kiểm tra nếu bên login có info mà bên user k có thì xoá bên login (ghost account)\n          if (user) {\n            await client.db(name_global_databases).collection('login_info').deleteOne({\n              _id: data.mssv\n            });\n          }\n          if (user_info_check) {\n            await client.db(name_global_databases).collection('user_info').deleteOne({\n              _id: data.mssv\n            });\n          }\n          // Đăng nhập không thành công\n          return res.sendStatus(403);\n        } else if (user._id === data.mssv && comparePassword(data.password, user.password)) {\n          let seasionIDs = await client.db(name_global_databases).collection('sessions_manager').findOne({\n            _id: data.mssv\n          });\n          if (seasionIDs) {\n            seasionIDs = seasionIDs.sessionId;\n            const existingDocs = await client.db(name_global_databases).collection('sessions').find({\n              _id: {\n                $in: seasionIDs\n              }\n            }).toArray();\n            const existingIDs = existingDocs.map(doc => doc._id);\n            const idsToDelete = seasionIDs.filter(id => !existingIDs.includes(id));\n            if (idsToDelete.length > 0) {\n              await client.db(name_global_databases).collection('sessions_manager').updateOne({\n                _id: data.mssv\n              }, {\n                $pull: {\n                  sessionId: {\n                    $in: idsToDelete\n                  }\n                }\n              });\n            }\n          }\n\n          // get user class(cls), power and department(dep)\n          const cls = await client.db(name_global_databases).collection('user_info').findOne({\n            _id: data.mssv\n          }, {\n            projection: {\n              _id: 0,\n              class: 1,\n              power: 1,\n              dep: 1\n            }\n          });\n          if (!cls.power[2]) {\n            const branch = await client.db(name_global_databases).collection('classes').findOne({\n              _id: cls.class[0]\n            }, {\n              projection: {\n                _id: 0,\n                branch: 1\n              }\n            });\n            if (branch) {\n              const dep = await client.db(name_global_databases).collection('branchs').findOne({\n                _id: branch.branch\n              }, {\n                projection: {\n                  _id: 0,\n                  dep: 1\n                }\n              });\n              user.dep = dep.dep;\n            }\n            user.cls = cls.class;\n          } else {\n            user.dep = cls.dep;\n          }\n          user.pow = cls.power;\n          // Đăng nhập thành công, lưu thông tin người dùng vào phiên\n          req.session.user = user;\n          // Kiểm tra xem người dùng có chọn \"Remember me\" không\n          if (data.remember) {\n            // Thiết lập thời gian sống cookie lâu hơn để lưu thông tin đăng nhập trong 30 ngày\n            req.session.cookie.maxAge = 30 * 24 * 60 * 60 * 1000; // 30 days\n          } else {\n            // Thiết lập thời gian sống cookie lại về mặc định (1 giờ)\n            req.session.cookie.maxAge = 3600000; // 1 hour\n          }\n          const sessionId = req.session.id;\n          await client.db(name_global_databases).collection('sessions_manager').updateOne({\n            _id: user._id\n          }, {\n            $push: {\n              sessionId: sessionId\n            }\n          }, {\n            upsert: true\n          });\n          if (user.first == 'new_user') {\n            return res.status(200).json({\n              check: true\n            });\n          } else {\n            return res.status(200).json({\n              check: false\n            });\n          }\n        } else {\n          // Đăng nhập không thành công\n          return res.sendStatus(403);\n        }\n      } else {\n        return res.sendStatus(404);\n      }\n    } catch (err) {\n      console.log('SYSTEM | LOG_IN | ERROR | ', err);\n      return res.sendStatus(500);\n    }\n  });\n\n  // Logout ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n  router.get('/logout', checkIfUserLoginAPI, async (req, res) => {\n    // Xóa thông tin phiên (session) của người dùng\n    const mssv = req.session.user._id;\n    req.session.destroy(err => {\n      if (err) {\n        console.log('SYSTEM | LOG_OUT | Failed to logout:', err);\n        return res.sendStatus(500);\n      } else {\n        let seasionIDs;\n        async function processSessionIDs() {\n          try {\n            seasionIDs = await client.db(name_global_databases).collection('sessions_manager').findOne({\n              _id: mssv\n            });\n            if (seasionIDs) {\n              seasionIDs = seasionIDs.sessionId;\n              const existingDocs = await client.db(name_global_databases).collection('sessions').find({\n                _id: {\n                  $in: seasionIDs\n                }\n              }).toArray();\n              const existingIDs = existingDocs.map(doc => doc._id);\n              const idsToDelete = seasionIDs.filter(id => !existingIDs.includes(id));\n              if (idsToDelete.length > 0) {\n                await client.db(name_global_databases).collection('sessions_manager').updateOne({\n                  _id: mssv\n                }, {\n                  $pull: {\n                    sessionId: {\n                      $in: idsToDelete\n                    }\n                  }\n                });\n              }\n            }\n            return res.redirect('/login'); // Chạy hàm dưới sau khi đã xử lý xong\n          } catch (error) {\n            console.log('SYSTEM | LOG_OUT | Failed to clean up sessions:', error);\n            return res.sendStatus(500);\n          }\n        }\n        processSessionIDs();\n      }\n    });\n  });\n\n  // Đăng xuất tất cả thiết bị\n  router.get('/logoutAlldevice', checkIfUserLoginAPI, async (req, res) => {\n    // Xóa thông tin phiên (session) của người dùng\n    const _id = req.session.user._id;\n    const result = await client.db(name_global_databases).collection('sessions_manager').findOne({\n      _id: _id\n    });\n    const listSeasionId = result.sessionId;\n    listSeasionId.splice(listSeasionId.indexOf(req.session.id), 1);\n    await client.db(name_global_databases).collection('sessions_manager').updateOne({\n      _id: _id\n    }, {\n      $pull: {\n        sessionId: {\n          $ne: req.session.id\n        }\n      }\n    });\n    await client.db(name_global_databases).collection('sessions').deleteMany({\n      _id: {\n        $in: listSeasionId\n      }\n    });\n    wss.clients.forEach(ws => {\n      if (listSeasionId.includes(ws.id)) {\n        ws.send('reload');\n      }\n    });\n    return res.sendStatus(200);\n  });\n\n  // Đổi thông tin người dùng --------------------------------------------------------------------------------------------------------------------------------\n  router.post('/updateInfo', checkIfUserLoginAPI, async (req, res) => {\n    try {\n      const data = req.body;\n      await client.db(name_global_databases).collection('user_info').updateOne({\n        _id: req.session.user._id\n      }, {\n        $set: {\n          displayName: data.displayName,\n          avt: data.avt\n        }\n      });\n      return res.sendStatus(200);\n    } catch (err) {\n      console.log('SYSTEM | UPDATE_INFO | ERROR | ', err);\n      return res.sendStatus(500);\n    }\n  });\n\n  // Reset pass ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n  router.post('/resetpassword', async (req, res) => {\n    try {\n      const data = req.body;\n      const OTP = await client.db(name_global_databases).collection('OTP').findOne({\n        _id: data.mssv\n      }, {\n        projection: {\n          _id: 0\n        }\n      });\n      if (OTP && comparePassword(data.otp, OTP.otpcode)) {\n        await client.db(name_global_databases).collection('login_info').updateOne({\n          _id: data.mssv\n        }, {\n          $set: {\n            first: 'otp'\n          }\n        });\n        //(log in database)\n        let user = await client.db(name_global_databases).collection('login_info').findOne({\n          _id: data.mssv\n        });\n        await client.db(name_global_databases).collection('OTP').deleteOne({\n          _id: data.mssv\n        });\n        let seasionIDs = await client.db(name_global_databases).collection('sessions_manager').findOne({\n          _id: data.mssv\n        });\n        if (seasionIDs) {\n          seasionIDs = seasionIDs.sessionId;\n          const existingDocs = await client.db(name_global_databases).collection('sessions').find({\n            _id: {\n              $in: seasionIDs\n            }\n          }).toArray();\n          const existingIDs = existingDocs.map(doc => doc._id);\n          const idsToDelete = seasionIDs.filter(id => !existingIDs.includes(id));\n          if (idsToDelete.length > 0) {\n            await client.db(name_global_databases).collection('sessions_manager').updateOne({\n              _id: data.mssv\n            }, {\n              $pull: {\n                sessionId: {\n                  $in: idsToDelete\n                }\n              }\n            });\n          }\n        }\n\n        // get user class(cls), power and department(dep)\n        const cls = await client.db(name_global_databases).collection('user_info').findOne({\n          _id: data.mssv\n        }, {\n          projection: {\n            _id: 0,\n            class: 1,\n            power: 1,\n            dep: 1\n          }\n        });\n        if (!cls.power[2]) {\n          const branch = await client.db(name_global_databases).collection('classes').findOne({\n            _id: cls.class[0]\n          }, {\n            projection: {\n              _id: 0,\n              branch: 1\n            }\n          });\n          if (branch) {\n            const dep = await client.db(name_global_databases).collection('branchs').findOne({\n              _id: branch.branch\n            }, {\n              projection: {\n                _id: 0,\n                dep: 1\n              }\n            });\n            user.dep = dep.dep;\n          }\n          user.cls = cls.class;\n        } else {\n          user.dep = cls.dep;\n        }\n        user.pow = cls.power;\n        // Đăng nhập thành công, lưu thông tin người dùng vào phiên\n        req.session.user = user;\n        // Kiểm tra xem người dùng có chọn \"Remember me\" không\n        if (data.remember) {\n          // Thiết lập thời gian sống cookie lâu hơn để lưu thông tin đăng nhập trong 30 ngày\n          req.session.cookie.maxAge = 30 * 24 * 60 * 60 * 1000; // 30 days\n        } else {\n          // Thiết lập thời gian sống cookie lại về mặc định (1 giờ)\n          req.session.cookie.maxAge = 3600000; // 1 hour\n        }\n        const sessionId = req.session.id;\n        await client.db(name_global_databases).collection('sessions_manager').updateOne({\n          _id: user._id\n        }, {\n          $push: {\n            sessionId: sessionId\n          }\n        }, {\n          upsert: true\n        });\n        return res.sendStatus(200);\n      } else {\n        res.sendStatus(403);\n      }\n    } catch (err) {\n      console.log('SYSTEM | RESET_PASSWORD | ERROR | ', err);\n      return res.sendStatus(500);\n    }\n  });\n\n  // Resent OTP ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n  router.post('/resendotp', async (req, res) => {\n    try {\n      const mssv = req.body.mssv;\n      const dataUser = await client.db(name_global_databases).collection('user_info').findOne({\n        _id: mssv\n      }, {\n        projection: {\n          _id: 0,\n          email: 1\n        }\n      });\n      // Thêm tài liệu mới có thời gian hết hạn sau 1 phút\n      const OTPscode = await randomPassword();\n      await client.db(name_global_databases).collection('OTP').updateOne({\n        _id: mssv\n      }, {\n        $set: {\n          otpcode: hashPassword(OTPscode),\n          expireAt: new Date(Date.now() + 60 * 5 * 1000) // Hết hạn sau 5 phút\n        }\n      }, {\n        upsert: true\n      });\n      if (dataUser) {\n        const email = dataUser.email;\n        await sendEmail(OTPscode, email);\n      }\n      return res.sendStatus(200);\n    } catch (err) {\n      console.log('SYSTEM | RESEND_OTP | ERROR | ', err);\n      return res.sendStatus(500);\n    }\n  });\n\n  // Đổi pass ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n  router.post('/change_pass', checkIfUserLoginAPI, async (req, res) => {\n    try {\n      const data = req.body;\n      const old_pass = await client.db(name_global_databases).collection('login_info').findOne({\n        _id: req.session.user._id\n      }, {\n        projection: {\n          _id: 0,\n          password: 1\n        }\n      });\n      if (comparePassword(data.old_password, old_pass.password)) {\n        if (!comparePassword(data.new_password, old_pass.password)) {\n          await client.db(name_global_databases).collection('login_info').updateOne({\n            _id: req.session.user._id\n          }, {\n            $set: {\n              password: hashPassword(data.new_password)\n            }\n          });\n          return res.sendStatus(200);\n        } else {\n          return res.sendStatus(403);\n        }\n      } else {\n        res.sendStatus(404);\n      }\n    } catch (err) {\n      console.log('SYSTEM | CHANGE_PASSWORD | ERROR | ', err);\n      return res.sendStatus(500);\n    }\n  });\n\n  // Đổi pass lần đầu đăng nhập -------------------------------------------------------------------------------------------------------------------------------\n  router.post('/first_login', checkIfUserLoginAPI, async (req, res) => {\n    try {\n      const data = req.body;\n      const old_pass = await client.db(name_global_databases).collection('login_info').findOne({\n        _id: req.session.user._id\n      }, {\n        projection: {\n          _id: 0,\n          password: 1\n        }\n      });\n      if (comparePassword(data.new_password, old_pass.password)) {\n        return res.sendStatus(403);\n      } else {\n        delete req.session.user.first;\n        await client.db(name_global_databases).collection('login_info').updateOne({\n          _id: req.session.user._id\n        }, {\n          $unset: {\n            first: ''\n          }\n        });\n        await client.db(name_global_databases).collection('login_info').updateOne({\n          _id: req.session.user._id\n        }, {\n          $set: {\n            password: hashPassword(data.new_password)\n          }\n        });\n        return res.sendStatus(200);\n      }\n    } catch (err) {\n      console.log('SYSTEM | CHANGE_PASSWORD | ERROR | ', err);\n      return res.sendStatus(500);\n    }\n  });\n\n  // Save table and update old table std------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n  router.post('/std_mark', checkIfUserLoginAPI, async (req, res) => {\n    try {\n      const user = req.session.user;\n      if (user.pow[0]) {\n        const data = req.body;\n        const marker = await client.db(name_global_databases).collection('user_info').findOne({\n          _id: user._id\n        }, {\n          projection: {\n            _id: 0,\n            last_name: 1,\n            first_name: 1\n          }\n        });\n        const marked = await mark('_std_table', user, user._id, data, marker, user.cls[0]);\n        switch (marked) {\n          case 0:\n            return res.sendStatus(200);\n          case 1:\n            return res.sendStatus(203);\n          case 2:\n            return res.sendStatus(205);\n        }\n      } else {\n        return res.sendStatus(403);\n      }\n    } catch (err) {\n      console.log('SYSTEM | STD_MARK | ERROR | ', err);\n      return res.sendStatus(500);\n    }\n  });\n\n  // Save table and update old table stf------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n  router.post('/stf_mark', checkIfUserLoginAPI, async (req, res) => {\n    const user = req.session.user;\n    if (user.pow[1]) {\n      try {\n        const data = req.body;\n        const marker = await client.db(name_global_databases).collection('user_info').findOne({\n          _id: user._id\n        }, {\n          projection: {\n            _id: 0,\n            last_name: 1,\n            first_name: 1\n          }\n        });\n        const marked = await mark('_stf_table', user, data.mssv, data, marker, data.class);\n        switch (marked) {\n          case 0:\n            return res.sendStatus(200);\n          case 1:\n            return res.sendStatus(203);\n          case 2:\n            return res.sendStatus(205);\n        }\n      } catch (err) {\n        console.log('SYSTEM | STF_MARK | ERROR | ', err);\n        return res.sendStatus(500);\n      }\n    } else if (user.pow[4]) {\n      try {\n        const data = req.body;\n        const marker = await client.db(name_global_databases).collection('user_info').findOne({\n          _id: user._id\n        }, {\n          projection: {\n            _id: 0,\n            last_name: 1,\n            first_name: 1\n          }\n        });\n        const marked = await mark('_stf_table', user, data.mssv, data, marker, user.cls[0]);\n        switch (marked) {\n          case 0:\n            return res.sendStatus(200);\n          case 1:\n            return res.sendStatus(203);\n          case 2:\n            return res.sendStatus(205);\n        }\n      } catch (err) {\n        console.log('SYSTEM | STF_MARK | ERROR | ', err);\n        return res.sendStatus(500);\n      }\n    } else {\n      return res.sendStatus(403);\n    }\n  });\n\n  // Save table and update old table dep------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n  router.post('/dep_mark', checkIfUserLoginAPI, async (req, res) => {\n    const user = req.session.user;\n    if (user.pow[2]) {\n      try {\n        const data = req.body;\n        const marker = await client.db(name_global_databases).collection('user_info').findOne({\n          _id: user._id\n        }, {\n          projection: {\n            _id: 0,\n            last_name: 1,\n            first_name: 1\n          }\n        });\n        const marked = await mark('_dep_table', user, data.mssv, data, marker, data.class);\n        switch (marked) {\n          case 0:\n            return res.sendStatus(200);\n          case 1:\n            return res.sendStatus(203);\n        }\n        return res.sendStatus(200);\n      } catch (err) {\n        console.log('SYSTEM | STF_MARK | ERROR | ', err);\n        return res.sendStatus(500);\n      }\n    } else {\n      return res.sendStatus(403);\n    }\n  });\n\n  // Upload file -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n  router.post('/uploadFile', upload.array('files[]'), checkIfUserLoginAPI, async function (req, res) {\n    if (!req.files) {\n      return res.status(400).send('No file uploaded.');\n    }\n    let list_name = [];\n    let list_dep = [];\n    // Kiểm tra kiểu dữ liệu của các tệp\n    for (let i = 0; i < req.files.length; i++) {\n      const fileName = req.files[i].originalname;\n      const fileDescription = req.body.descripts[i]; // Trích xuất mô tả tương ứng từ danh sách descripts[]\n      list_dep.push(fileDescription);\n      list_name.push(fileName);\n    }\n\n    // Xử lý các tệp đã tải lên ở đây\n    res.writeHead(200, {\n      'Content-Type': 'applicaiton/json'\n    });\n    return res.end(JSON.stringify(await get_full_id(uploadDirectory, list_name, list_dep)));\n  });\n\n  // Create new account -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n  router.post('/createAccount', upload.single('file'), checkIfUserLoginAPI, async (req, res) => {\n    const user = req.session.user;\n    const dummyScore = {\n      first: [0, 0, 0, 0, 0],\n      second: [0, 0],\n      third: [0, 0, 0],\n      fourth: [0, 0, 0],\n      fifth: [0, 0, 0, 0],\n      img_ids: [],\n      total: 0\n    };\n    if (user.pow[4] || user.pow[7]) {\n      const fileStudents = req.file;\n      async function generateEmail(str) {\n        let s1 = 'ÀÁÂÃÈÉÊÌÍÒÓÔÕÙÚÝàáâãèéêìíòóôõùúýĂăĐđĨĩŨũƠơƯưẠạẢảẤấẦầẨẩẪẫẬậẮắẰằẲẳẴẵẶặẸẹẺẻẼẽẾếỀềỂểỄễỆệỈỉỊịỌọỎỏỐốỒồỔổỖỗỘộỚớỜờỞởỠỡỢợỤụỦủỨứỪừỬửỮữỰựỲỳỴỵỶỷỸỹ';\n        let s0 = 'AAAAEEEIIOOOOUUYaaaaeeeiioooouuyAaDdIiUuOoUuAaAaAaAaAaAaAaAaAaAaAaAaEeEeEeEeEeEeEeEeEeIiIiOoOoOoOoOoOoOoOoOoOoOoUuUuUuUuUuUuUuYyYyYyYy';\n        let newStr = '';\n        let listSpace = [];\n        for (let i = 0; i < str.length; i++) {\n          if (s1.indexOf(str[i]) != -1) {\n            newStr += s0[s1.indexOf(str[i])];\n          } else {\n            newStr += str[i];\n          }\n          if (str[i] == ' ') {\n            listSpace.push(i);\n          }\n        }\n        let output = newStr[0];\n        for (let i = 0; i < listSpace.length - 2; i++) {\n          output += newStr.charAt(listSpace[i] + 1);\n        }\n        output += newStr.slice(listSpace[listSpace.length - 2] + 1).replace(/\\s/g, '');\n        return output.toLowerCase() + '@student.ctuet.edu.vn';\n      }\n      if (fileStudents) {\n        const workbook = await XlsxPopulate.fromFileAsync(fileStudents.path);\n        const sheet = workbook.sheet(0);\n        // const sheetCount = workbook.sheetCount();\n        const values = sheet.usedRange().value();\n        const usedRange = sheet.usedRange();\n        const expectedValues = ['MSSV', 'HỌ', 'TÊN'];\n        // const columnCount = expectedValues.length;\n        let isCorrect = true;\n        const endCell = usedRange.endCell();\n        const rowCount = endCell.rowNumber();\n        const columnCount = 3;\n        for (let column = 1; column <= columnCount; column++) {\n          const cell = sheet.cell(1, column); // Ô đầu tiên trên hàng 1 và cột column\n          const value = cell.value();\n          if (value !== expectedValues[column - 1]) {\n            isCorrect = false;\n            break;\n          }\n        }\n        if (isCorrect) {\n          let havevalue = true;\n          for (let row = 2; row <= 5; row++) {\n            let hasValue = false;\n            for (let column = 1; column <= columnCount; column++) {\n              const cell = sheet.cell(row, column);\n              const value = cell.value();\n              if (value) {\n                hasValue = true;\n                break;\n              }\n            }\n            if (hasValue) {\n              break;\n            } else {\n              havevalue = false;\n              break;\n            }\n          }\n          if (havevalue) {\n            if (req.body.status == 'true') {\n              try {\n                // read excel file:\n                // create all account\n\n                let maxWidthEmail = 0;\n                //[['MSSV', 'Họ', 'Tên' ]]\n                sheet.cell('D1').value('Email');\n                sheet.cell('E1').value('Password');\n                const dataRows = [];\n                for (let i = 1; i < values.length; i++) {\n                  let pw = await randomPassword();\n                  let email = await generateEmail(`${values[i][1].toString()} ${values[i][2].toString()} ${values[i][0].toString()}`);\n                  let dataInsertUser = {\n                    _id: values[i][0].toString(),\n                    first_name: values[i][2].toString(),\n                    last_name: values[i][1].toString(),\n                    avt: 'https://i.pinimg.com/236x/89/08/3b/89083bba40545a72fa15321af5fab760--chibi-girl-zero.jpg',\n                    power: {\n                      0: true\n                    },\n                    class: [req.body.cls],\n                    displayName: `${values[i][1].toString()} ${values[i][2].toString()}`,\n                    email: email,\n                    total_score: {}\n                  };\n                  let dataInsertLogin = {\n                    _id: values[i][0].toString(),\n                    password: hashPassword(pw),\n                    first: 'new_user'\n                  };\n                  const dataRow = [dataInsertUser._id, pw, dataInsertUser.last_name, dataInsertUser.first_name];\n                  dataRows.push(dataRow);\n                  client.db('global').collection('user_info').updateOne({\n                    _id: dataInsertUser._id\n                  }, {\n                    $set: dataInsertUser\n                  }, {\n                    upsert: true\n                  });\n                  client.db('global').collection('login_info').updateOne({\n                    _id: dataInsertLogin._id\n                  }, {\n                    $set: dataInsertLogin\n                  }, {\n                    upsert: true\n                  });\n                  await mark('_std_table', user, dataInsertUser._id, dummyScore, {\n                    first_name: dataInsertUser.first_name,\n                    last_name: dataInsertUser.last_name\n                  }, dataInsertUser.class[0]);\n                  await sheet.cell(`D${i + 1}`).value(email);\n                  await sheet.cell(`E${i + 1}`).value(pw);\n                  const range = sheet.range(`D${i + 1}:E${i + 1}`);\n                  range.style({\n                    border: true\n                  });\n                  if (email.length > maxWidthEmail) {\n                    maxWidthEmail = email.length;\n                  }\n                }\n                // Write to file.\n                sheet.column('D').width(maxWidthEmail);\n                const uuid = uuidv4();\n                await workbook.toFileAsync(path.join('.downloads', uuid + '.xlsx'));\n                // xoa file sau khi xu ly\n                scheduleFileDeletion(path.join('.downloads', uuid + '.xlsx'));\n                const workbookacc = await XlsxPopulate.fromFileAsync('./src/excelTemplate/FILE_TAO_ACC.xlsx');\n                if (dataRows.length > 0) {\n                  await workbookacc.sheet(0).cell('A2').value(dataRows);\n                }\n                const outputFile = path.join(`.downloads/${uuid}.xlsx`);\n                await workbookacc.toFileAsync(outputFile);\n                scheduleFileDeletion(path.join('.downloads', uuid + '.xlsx'));\n                return res.download(path.join('.downloads', uuid + '.xlsx'));\n              } catch (err) {\n                console.log('SYSTEM | CREATE_ACCOUNT | ERROR | ', err);\n                return res.sendStatus(500);\n              }\n            } else {\n              try {\n                // read excel file:\n                // create all account\n                const workbook = await XlsxPopulate.fromFileAsync(fileStudents.path);\n                const sheet = workbook.sheet(0);\n                const values = sheet.usedRange().value();\n                let maxWidthEmail = 0;\n                //[['MSSV', 'Họ', 'Tên' ]]\n                sheet.cell('D1').value('Email');\n                sheet.cell('E1').value('Password');\n                for (let i = 1; i < values.length; i++) {\n                  let studentIdToCheck = values[i][0].toString(); // Mã số sinh viên cần kiểm tra\n\n                  const marker = await client.db(name_global_databases).collection('user_info').findOne({\n                    _id: studentIdToCheck\n                  }, {\n                    projection: {\n                      _id: 0,\n                      last_name: 1,\n                      first_name: 1\n                    }\n                  });\n                  if (!marker) {\n                    let pw = await randomPassword();\n                    let email = await generateEmail(`${values[i][1]} ${values[i][2]} ${values[i][0].toString()}`);\n                    let dataInsertUser = {\n                      _id: values[i][0].toString(),\n                      first_name: values[i][2].toString(),\n                      last_name: values[i][1].toString(),\n                      avt: 'https://i.pinimg.com/236x/89/08/3b/89083bba40545a72fa15321af5fab760--chibi-girl-zero.jpg',\n                      power: {\n                        0: true\n                      },\n                      class: [req.body.cls],\n                      displayName: `${values[i][1].toString()} ${values[i][2].toString()}`,\n                      email: email,\n                      total_score: {}\n                    };\n                    let dataInsertLogin = {\n                      _id: values[i][0].toString(),\n                      password: hashPassword(pw),\n                      first: 'new_user'\n                    };\n                    client.db('global').collection('user_info').updateOne({\n                      _id: dataInsertUser._id\n                    }, {\n                      $set: dataInsertUser\n                    }, {\n                      upsert: true\n                    });\n                    client.db('global').collection('login_info').updateOne({\n                      _id: dataInsertLogin._id\n                    }, {\n                      $set: dataInsertLogin\n                    }, {\n                      upsert: true\n                    });\n                    await mark('_std_table', user, dataInsertUser._id, dummyScore, {\n                      first_name: dataInsertUser.first_name,\n                      last_name: dataInsertUser.last_name\n                    }, dataInsertUser.class[0]);\n                    await sheet.cell(`D${i + 1}`).value(email);\n                    await sheet.cell(`E${i + 1}`).value(pw);\n                    const range = sheet.range(`D${i + 1}:E${i + 1}`);\n                    range.style({\n                      border: true\n                    });\n                    if (email.length > maxWidthEmail) {\n                      maxWidthEmail = email.length;\n                    }\n\n                    // Write to file.\n                    sheet.column('D').width(maxWidthEmail);\n                    const uuid = uuidv4();\n                    await workbook.toFileAsync(path.join('.downloads', uuid + '.xlsx'));\n                    res.download(path.join('.downloads', uuid + '.xlsx'));\n                    // xoa file sau khi xu ly\n                    scheduleFileDeletion(path.join('.downloads', uuid + '.xlsx'));\n                  }\n                }\n              } catch (err) {\n                console.log('SYSTEM | CREATE_ACCOUNT | ERROR | ', err);\n                return res.sendStatus(500);\n              }\n            }\n          } else {\n            return res.sendStatus(404);\n          }\n        } else {\n          return res.sendStatus(405);\n        }\n      } else {\n        const dataStudent = req.body;\n        let pw = await randomPassword();\n        let email = await generateEmail(`${dataStudent['ho']} ${dataStudent['ten']} ${dataStudent['mssv'].toString()}`);\n        let power;\n        power = {\n          0: true,\n          1: dataStudent['chamdiem'],\n          3: dataStudent['lbhd'],\n          10: dataStudent['dangvien']\n        };\n        let dataInsertUser = {\n          _id: dataStudent['mssv'].toString(),\n          first_name: dataStudent['ten'],\n          last_name: dataStudent['ho'],\n          avt: 'https://i.pinimg.com/236x/89/08/3b/89083bba40545a72fa15321af5fab760--chibi-girl-zero.jpg',\n          power: power,\n          class: [dataStudent['cls']],\n          displayName: `${dataStudent['ho']} ${dataStudent['ten']}`,\n          email: email,\n          total_score: {}\n        };\n        let dataInsertLogin = {\n          _id: dataStudent['mssv'].toString(),\n          password: hashPassword(pw),\n          first: 'new_user'\n        };\n        client.db('global').collection('user_info').updateOne({\n          _id: dataInsertUser._id\n        }, {\n          $set: dataInsertUser\n        }, {\n          upsert: true\n        });\n        client.db('global').collection('login_info').updateOne({\n          _id: dataInsertLogin._id\n        }, {\n          $set: dataInsertLogin\n        }, {\n          upsert: true\n        });\n        await mark('_std_table', user, dataInsertUser._id, dummyScore, {\n          first_name: dataInsertUser.first_name,\n          last_name: dataInsertUser.last_name\n        }, dataInsertUser.class[0]);\n        // xu ly sau khi them sinh vien\n        const uuid = uuidv4();\n        const workbook = await XlsxPopulate.fromFileAsync('./src/excelTemplate/Tao_danh_sach_lop_moi.xlsx');\n        const sheet = workbook.sheet(0);\n        await sheet.cell(`A2`).value(dataStudent['mssv'].toString());\n        await sheet.cell(`B2`).value(dataStudent['ho']);\n        await sheet.cell(`C2`).value(dataStudent['ten']);\n        await sheet.cell(`D1`).value('Email');\n        await sheet.cell(`E1`).value('Password');\n        await sheet.cell(`D2`).value(email);\n        await sheet.cell(`E2`).value(pw);\n        let range = sheet.range(`D2:E2`);\n        range.style({\n          border: true\n        });\n        sheet.column('D').width(email.length);\n        await workbook.toFileAsync(path.join('.downloads', uuid + '.xlsx'));\n        res.download(path.join('.downloads', uuid + '.xlsx'));\n        // xoa file sau khi xu ly\n        scheduleFileDeletion(path.join('.downloads', uuid + '.xlsx'));\n\n        // return res.sendStatus(200);\n      }\n    } else {\n      return res.sendStatus(403);\n    }\n  });\n\n  // Update student\n  router.post('/updateAccount', checkIfUserLoginAPI, async (req, res) => {\n    const user = req.session.user;\n    if (user.pow[4] || user.pow[7]) {\n      const dataStudent = req.body;\n      let power = {\n        0: true,\n        1: dataStudent['chamdiem'],\n        3: dataStudent['lbhd'],\n        10: dataStudent['dangvien']\n      };\n      let dataInsertUser = {\n        _id: dataStudent['mssv'].toString(),\n        first_name: dataStudent['ten'],\n        last_name: dataStudent['ho'],\n        power: power,\n        displayName: `${dataStudent['ho']} ${dataStudent['ten']}`\n      };\n      client.db('global').collection('user_info').updateOne({\n        _id: dataInsertUser._id\n      }, {\n        $set: dataInsertUser\n      }, {\n        upsert: true\n      });\n      return res.sendStatus(200);\n    } else {\n      return res.sendStatus(403);\n    }\n  });\n  router.get('/getTemplateAddStudent', upload.single('file'), checkIfUserLoginAPI, async (req, res) => {\n    const user = req.session.user;\n    if (user.pow[4] || user.pow[7]) {\n      return res.download('./src/excelTemplate/Tao_danh_sach_lop_moi.xlsx');\n    } else {\n      return res.sendStatus(403);\n    }\n  });\n  router.post('/deleteAccount', checkIfUserLoginAPI, async (req, res) => {\n    const user = req.session.user;\n    if (user.pow[4] || user.pow[7]) {\n      try {\n        const cls = req.body.cls;\n        const listDelete = req.body.dataDelete;\n        for (let i = 0; i < listDelete.length; i++) {\n          await client.db('global').collection('user_info').deleteOne({\n            _id: listDelete[i]\n          });\n          let info_search = `student_list.${listDelete[i]}`;\n          await client.db(user.dep).collection(`${cls}_activities`).updateMany({\n            [info_search]: {\n              $exists: true\n            }\n          }, {\n            $pull: {\n              student_list: user._id,\n              ai: user._id\n            }\n          });\n          await client.db(user.dep).collection('activities').updateMany({\n            [info_search]: {\n              $exists: true\n            }\n          }, {\n            $pull: {\n              student_list: user._id,\n              ai: user._id\n            }\n          });\n          await client.db(name_global_databases).collection('activities').updateMany({\n            [info_search]: {\n              $exists: true\n            }\n          }, {\n            $pull: {\n              student_list: user._id,\n              ai: user._id\n            }\n          });\n        }\n        return res.sendStatus(200);\n      } catch (err) {\n        console.log('SYSTEM | DELETE_ACCOUNT | ERROR | ', err);\n        return res.sendStatus(500);\n      }\n    } else {\n      return res.sendStatus(403);\n    }\n  });\n  // Export class score report --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n  router.get('/exportClassScore', checkIfUserLoginAPI, async (req, res) => {\n    try {\n      const user = req.session.user;\n      if (user.pow[1] || user.pow[2]) {\n        const data = req.query;\n        //data = {year: \"HK1_2022-2023\", cls: '1'}\n        const school_year = data.year;\n        let cls = data.cls;\n        // create uuid for download file\n        const uuid = uuidv4();\n\n        // check for post data.cls if class define this mean they choose class so that must\n\n        let student_list = [];\n        if (user.pow[1]) {\n          student_list = sortStudentName(await client.db(name_global_databases).collection('user_info').find({\n            class: user.cls[0],\n            'power.0': {\n              $exists: true\n            }\n          }, {\n            projection: {\n              first_name: 1,\n              last_name: 1\n            }\n          }).toArray());\n        } else {\n          student_list = sortStudentName(await client.db(name_global_databases).collection('user_info').find({\n            class: cls,\n            'power.0': {\n              $exists: true\n            }\n          }, {\n            projection: {\n              first_name: 1,\n              last_name: 1\n            }\n          }).toArray());\n        }\n\n        // get all student total score from themself:\n        let scores = [];\n        if (student_list.length !== 0) {\n          for (let i = 0; i < student_list.length; i++) {\n            // [stt, mssv. ho, ten, lop,\n            // 1.0, 1.1, 1.2, 1.3, 1.4,\n            // 2.0, 2.1,\n            // 3.0, 3.1, 3.2,\n            // 4.0, 4.1, 4.2,\n            // 5.0, 5.1, 5.2, 5.3,\n            // \"\", total, conduct, \"\"]\n            let curr_score = [i + 1, student_list[i]._id, student_list[i].last_name, student_list[i].first_name, cls];\n            const curr_departmentt_score = await client.db(user.dep).collection(cls + '_dep_table').findOne({\n              mssv: student_list[i]._id,\n              school_year: school_year\n            }, {\n              projection: {\n                first: 1,\n                second: 1,\n                third: 1,\n                fourth: 1,\n                fifth: 1,\n                total: 1\n              }\n            });\n            if (curr_departmentt_score) {\n              curr_score.push(...curr_departmentt_score.first);\n              curr_score.push(...curr_departmentt_score.second);\n              curr_score.push(...curr_departmentt_score.third);\n              curr_score.push(...curr_departmentt_score.fourth);\n              curr_score.push(...curr_departmentt_score.fifth);\n            } else {\n              for (let j = 0; j < 17; j++) {\n                curr_score.push(null);\n              }\n            }\n            curr_score.push(null);\n            if (curr_departmentt_score) {\n              curr_score.push(curr_departmentt_score.total);\n              // set kind of conduct:\n              if (curr_departmentt_score.total >= 90) {\n                curr_score.push('xuất sắc');\n              } else if (curr_departmentt_score.total >= 80) {\n                curr_score.push('tốt');\n              } else if (curr_departmentt_score.total >= 65) {\n                curr_score.push('khá');\n              } else if (curr_departmentt_score.total >= 50) {\n                curr_score.push('trung bình');\n              } else if (curr_departmentt_score.total >= 35) {\n                curr_score.push('yếu');\n              } else {\n                curr_score.push('kém');\n              }\n            } else {\n              curr_score.push(null);\n              curr_score.push(null);\n            }\n\n            // add curr_score to scores\n            scores.push(curr_score);\n          }\n        } else {}\n\n        // Load an existing workbook\n        const workbook = await XlsxPopulate.fromFileAsync('./src/excelTemplate/Bang_diem_ca_lop_xuat_tu_he_thong.xlsx');\n        if (scores.length != 0) {\n          await workbook.sheet(0).cell('A7').value(scores);\n        }\n        // Write to file.\n\n        await workbook.toFileAsync(path.join('.downloads', uuid + '.xlsx'));\n\n        // tải file xlsx về máy người dùng\n        // res.download(path.join('.downloads', uuid + \".xlsx\"));\n\n        res.download(path.join('.downloads', uuid + '.xlsx'));\n\n        // delete file after 12 hours\n        scheduleFileDeletion(path.join('.downloads', uuid + '.xlsx'));\n      } else {\n        return res.sendStatus(403);\n      }\n    } catch (err) {\n      console.log('SYSTEM | EXPORT_CLASS_SCORE | ERROR | ', err);\n      return res.sendStatus(500);\n    }\n  });\n  // Export students score report --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n  router.get('/exportStudentsScore', checkIfUserLoginAPI, async (req, res) => {\n    try {\n      const user = req.session.user;\n      const data = req.query;\n      let cls = data.cls;\n      let stdlist = [];\n      if (data.stdlist) {\n        stdlist = JSON.parse(data.stdlist);\n      }\n      const school_year = data.year;\n      if (user.pow[0] || user.pow[1] || user.pow[2]) {\n        if (data.type === 'singe' & user.pow[0]) {\n          cls = user.cls[0];\n          stdlist = [user._id];\n        }\n        //data = {year: \"HK1_2022-2023\", cls: '1', stdlist: []}\n        // create uuid for download file\n        const uuid = uuidv4();\n        // check for post data.cls if class define this mean they choose class so that must\n        let student_list = [];\n        student_list = sortStudentName(await client.db(name_global_databases).collection('user_info').find({\n          class: cls,\n          'power.0': {\n            $exists: true\n          },\n          _id: {\n            $in: stdlist\n          }\n        }, {\n          projection: {\n            first_name: 1,\n            last_name: 1\n          }\n        }).toArray());\n        // get all student total score from themself:\n        let scores = [];\n        if (student_list.length !== 0) {\n          for (let i = 0; i < student_list.length; i++) {\n            // [stt, mssv. ho, ten, lop,\n            // 1.0, 1.1, 1.2, 1.3, 1.4,\n            // 2.0, 2.1,\n            // 3.0, 3.1, 3.2,\n            // 4.0, 4.1, 4.2,\n            // 5.0, 5.1, 5.2, 5.3,\n            // \"\", total, conduct, \"\"]\n            let curr_score = {\n              year: school_year,\n              mssv: student_list[i]._id,\n              name: student_list[i].last_name + ' ' + student_list[i].first_name,\n              class: cls,\n              std: [],\n              stf: [],\n              dep: []\n            };\n            const curr_students_score = await client.db(user.dep).collection(cls + '_std_table').findOne({\n              mssv: student_list[i]._id,\n              school_year: school_year\n            }, {\n              projection: {\n                first: 1,\n                second: 1,\n                third: 1,\n                fourth: 1,\n                fifth: 1,\n                total: 1\n              }\n            });\n            const curr_staff_score = await client.db(user.dep).collection(cls + '_stf_table').findOne({\n              mssv: student_list[i]._id,\n              school_year: school_year\n            }, {\n              projection: {\n                first: 1,\n                second: 1,\n                third: 1,\n                fourth: 1,\n                fifth: 1,\n                total: 1\n              }\n            });\n            const curr_departmentt_score = await client.db(user.dep).collection(cls + '_dep_table').findOne({\n              mssv: student_list[i]._id,\n              school_year: school_year\n            }, {\n              projection: {\n                first: 1,\n                second: 1,\n                third: 1,\n                fourth: 1,\n                fifth: 1,\n                total: 1\n              }\n            });\n            if (curr_students_score) {\n              curr_score.std.push(...curr_students_score.first);\n              curr_score.std.push(...curr_students_score.second);\n              curr_score.std.push(...curr_students_score.third);\n              curr_score.std.push(...curr_students_score.fourth);\n              curr_score.std.push(...curr_students_score.fifth);\n              curr_score.std.push(curr_students_score.total);\n            } else {\n              for (let j = 0; j < 18; j++) {\n                curr_score.std.push('N/A');\n              }\n            }\n            if (curr_staff_score) {\n              curr_score.stf.push(...curr_staff_score.first);\n              curr_score.stf.push(...curr_staff_score.second);\n              curr_score.stf.push(...curr_staff_score.third);\n              curr_score.stf.push(...curr_staff_score.fourth);\n              curr_score.stf.push(...curr_staff_score.fifth);\n              curr_score.stf.push(curr_staff_score.total);\n            } else {\n              for (let j = 0; j < 18; j++) {\n                curr_score.stf.push('N/A');\n              }\n            }\n            if (curr_departmentt_score) {\n              curr_score.dep.push(...curr_departmentt_score.first);\n              curr_score.dep.push(...curr_departmentt_score.second);\n              curr_score.dep.push(...curr_departmentt_score.third);\n              curr_score.dep.push(...curr_departmentt_score.fourth);\n              curr_score.dep.push(...curr_departmentt_score.fifth);\n              curr_score.dep.push(curr_departmentt_score.total);\n            } else {\n              for (let j = 0; j < 18; j++) {\n                curr_score.dep.push('N/A');\n              }\n            }\n            scores.push(curr_score);\n          }\n        } else {\n          return res.sendStatus(402);\n        }\n        const temp_namefile = await createPdf('.downloads', scores);\n        // tải file xlsx về máy người dùng\n        res.download(path.join('.downloads', temp_namefile));\n\n        // delete file after 12 hours\n\n        scheduleFileDeletion(path.join('.downloads', temp_namefile));\n      } else {\n        return res.sendStatus(403);\n      }\n    } catch (err) {\n      console.log('SYSTEM | EXPORT_STUDENTS_SCORE | ERROR | ', err);\n      return res.sendStatus(500);\n    }\n  });\n  // Load score list of student in specific class at specific time ---------------------------------------------------------------------------------------------------------------------------------------------------------------------\n  router.get('/loadScoresList', checkIfUserLoginAPI, async (req, res) => {\n    try {\n      const user = req.session.user;\n      if (user.pow[1]) {\n        const data = req.query;\n        //data = {year: \"HK1_2022-2023\", cls: \"1\"}\n        const school_year = data.year;\n        const year_available = await client.db(name_global_databases).collection('school_year').findOne({}, {\n          projection: {\n            _id: 0,\n            year: 1,\n            start_day: 1,\n            end_day: 1\n          }\n        });\n        const student_list = sortStudentName(await client.db(name_global_databases).collection('user_info').find({\n          class: user.cls[0],\n          'power.0': {\n            $exists: true\n          }\n        }, {\n          projection: {\n            first_name: 1,\n            last_name: 1,\n            total_score: 1\n          }\n        }).toArray());\n\n        // get all student total score from themself:\n        let result = {\n          // staff_name: [],\n          student_list: student_list,\n          // student_scores: [],\n          // staff_scores: [],\n          // department_scores: [],\n          year_available: year_available\n        };\n        return res.status(200).json(result);\n      } else {\n        // user not staff members\n        // redirect to home (return 403, api khong the chuyenh huong ve trang chu duoc)\n        return res.sendStatus(403);\n      }\n    } catch (err) {\n      console.log('SYSTEM | LOAD_SCORE_LIST | ERROR | ', err);\n      return res.sendStatus(500);\n    }\n  });\n  // doan khoa load scores\n  router.get('/doan_khoa/loadScoresList', checkIfUserLoginAPI, async (req, res) => {\n    try {\n      const user = req.session.user;\n      if (user.pow[2]) {\n        const data = req.query;\n        //data = {year: \"HK1_2022-2023\", cls: \"1\"}\n        const school_year = data.year;\n        let cls = data.class;\n        // const bo_mon = data.bo_mon;\n        // check for post data.cls if class define this mean they choose class so that must\n        if (!cls) {\n          cls = 0;\n        }\n        const year_available = await client.db(name_global_databases).collection('school_year').findOne({}, {\n          projection: {\n            _id: 0,\n            year: 1,\n            start_day: 1,\n            end_day: 1\n          }\n        });\n        const student_list = sortStudentName(await client.db(name_global_databases).collection('user_info').find({\n          class: cls,\n          'power.0': {\n            $exists: true\n          }\n        }, {\n          projection: {\n            first_name: 1,\n            last_name: 1,\n            total_score: 1\n          }\n        }).toArray());\n\n        // get all student total score from themself:\n        let result = {\n          // staff_name: [],\n          student_list: student_list,\n          // student_scores: [],\n          // staff_scores: [],\n          // department_scores: [],\n          year_available: year_available\n        };\n        return res.status(200).json(result);\n      } else {\n        // user not staff members\n        // redirect to home\n        return res.statusCode(403);\n      }\n    } catch (err) {\n      console.log('SYSTEM | DOAN_KHOA_LOAD_SCORE_LIST | ERROR | ', err);\n      return res.sendStatus(500);\n    }\n  });\n  // Auto mark (copy student mark to staff mark)\n  router.post('/autoMark', checkIfUserLoginAPI, async (req, res) => {\n    try {\n      const user = req.session.user;\n      if (user.pow[1]) {\n        const data = req.body;\n        let cls = data.cls;\n        //data = {year: \"HK1_2022-2023\", cls: \"1\", std_list = []}\n\n        // get staff member info :\n        const marker = await client.db(name_global_databases).collection('user_info').findOne({\n          _id: user._id\n        }, {\n          projection: {\n            _id: 0,\n            last_name: 1,\n            first_name: 1\n          }\n        });\n        // check for post data.cls if class define this mean they choose class so that must\n        if (!cls) {\n          cls = 0;\n        }\n\n        // check if table is exist or not\n        // update or add new table copy from std_table to staff_table\n        for (let i = 0; i < data.std_list.length; i++) {\n          const std_table = await client.db(user.dep).collection(user.cls[parseInt(cls)] + '_std_table').findOne({\n            mssv: data.std_list[i],\n            school_year: data.year\n          });\n\n          // update old table if exist else insert new one\n          // copy from student table and add marker name\n          if (std_table) {\n            std_table.marker = marker.last_name + ' ' + marker.first_name;\n            delete std_table._id;\n            await client.db(user.dep).collection(user.cls[parseInt(cls)] + '_stf_table').updateOne({\n              mssv: data.std_list[i],\n              school_year: data.year\n            }, {\n              $set: std_table\n            }, {\n              upsert: true\n            });\n          }\n          await updateStudentTotalScore('_stf_table', std_table.school_year, std_table.mssv, std_table.total, std_table.marker);\n        }\n        return res.sendStatus(200);\n      } else {\n        return res.sendStatus(403);\n      }\n    } catch (err) {\n      console.log('SYSTEM | AUTO_MARK | ERROR | ', err);\n      return res.sendStatus(500);\n    }\n  });\n  router.post('/doan_khoa/autoMark', checkIfUserLoginAPI, async (req, res) => {\n    try {\n      const user = req.session.user;\n      if (user.pow[2]) {\n        const data = req.body;\n        let cls = data.cls;\n        //data = {year: \"HK1_2022-2023\", cls: \"1\", std_list = []}\n\n        // get staff member info :\n        const marker = await client.db(name_global_databases).collection('user_info').findOne({\n          _id: user._id\n        }, {\n          projection: {\n            _id: 0,\n            last_name: 1,\n            first_name: 1\n          }\n        });\n\n        // check if table is exist or not\n        // update or add new table copy from std_table to staff_table\n        for (let i = 0; i < data.std_list.length; i++) {\n          const std_table = await client.db(user.dep).collection(cls + '_stf_table').findOne({\n            mssv: data.std_list[i],\n            school_year: data.year\n          });\n\n          // update old table if exist else insert new one\n          // copy from student table and add marker name\n          if (std_table) {\n            std_table.marker = marker.last_name + ' ' + marker.first_name;\n            delete std_table._id;\n            await client.db(user.dep).collection(cls + '_dep_table').updateOne({\n              mssv: data.std_list[i],\n              school_year: data.year\n            }, {\n              $set: std_table\n            }, {\n              upsert: true\n            });\n          }\n          await updateStudentTotalScore('_dep_table', std_table.school_year, std_table.mssv, std_table.total, std_table.marker);\n        }\n        return res.sendStatus(200);\n      } else {\n        return res.sendStatus(403);\n      }\n    } catch (err) {\n      console.log('SYSTEM | AUTO_MARK | ERROR | ', err);\n      return res.sendStatus(500);\n    }\n  });\n\n  // api danh sach sinh vien\n  router.post('/getStudentList', checkIfUserLoginAPI, async (req, res) => {\n    const user = req.session.user;\n    const data = req.body; // data = {class: KTPM0121 (class id), skip: 1 // time load befour}\n    let reqClass = data.class;\n    // if (!reqClass) {\n    //   reqClass = user.cls[0];\n    // }\n    if (reqClass) {\n      if (user.pow[1] || user.pow[2]) {\n        const student_list = sortStudentName(await client.db(name_global_databases).collection('user_info').find({\n          class: reqClass,\n          'power.0': {\n            $exists: true\n          }\n        }, {\n          projection: {\n            first_name: 1,\n            last_name: 1,\n            power: 1\n          }\n        }).limit(30).skip(30 * data.skip).toArray());\n        const transformedData = student_list.map(item => {\n          let role = 'UnKnow'; // Giả định giá trị mặc định là 'unknow'\n          let dang_vien = false;\n          let cham_diem = false;\n          let lap_hoat_dong = false;\n          dang_vien = item.power['10'] ? true : false;\n          cham_diem = item.power['1'] ? true : false;\n          lap_hoat_dong = item.power['3'] ? true : false;\n          if (item.power['1'] || item.power['3']) {\n            role = 'Ban cán sự';\n          } else if (item.power['0']) {\n            role = 'Sinh viên';\n          }\n          return {\n            _id: item._id,\n            first_name: item.first_name,\n            last_name: item.last_name,\n            role,\n            dang_vien,\n            cham_diem,\n            lap_hoat_dong\n          };\n        });\n        return res.status(200).json(transformedData);\n      } else {\n        return res.sendStatus(403);\n      }\n    } else {\n      return res.sendStatus(404);\n    }\n  });\n  router.get('/getStudentInfoMark', checkIfUserLoginAPI, async (req, res) => {\n    const user = req.session.user;\n    let result = {\n      dang_vien: user.pow[10] ? true : false,\n      cham_diem: user.pow[1] ? true : false,\n      lap_hoat_dong: user.pow[3] ? true : false\n    };\n    return res.status(200).json(result);\n  });\n  router.get('/getuserscore', checkIfUserLoginAPI, async (req, res) => {\n    try {\n      const user = req.session.user;\n      if (user.pow[0]) {\n        const schoolYearParam = req.query.schoolYear;\n        const schoolYearsToSearch = ['HK1_' + schoolYearParam, 'HK2_' + schoolYearParam];\n        const studentTotalScores = await Promise.all(schoolYearsToSearch.map(async year => {\n          const studentTotalScore = await client.db(user.dep).collection(user.cls[0] + '_std_table').findOne({\n            mssv: user._id,\n            school_year: year\n          }, {\n            projection: {\n              _id: 0,\n              total: 1\n            }\n          });\n          return {\n            year: year.slice(0, 3),\n            total: studentTotalScore ? studentTotalScore.total : 'Chưa có điểm'\n          };\n        }));\n        return res.status(200).json(studentTotalScores);\n      } else {\n        return res.sendStatus(403);\n      }\n    } catch (err) {\n      console.log('SYSTEM | GET_USER_SCORE | ERROR | ', err);\n      return res.sendStatus(500);\n    }\n  });\n\n  // api add or edit branch of department base on it exist or not\n  router.post('/addOrEditBranchs', checkIfUserLoginAPI, async (req, res) => {\n    try {\n      const user = req.session.user;\n      const data = req.body; // data = {old_name: \"Hệ thống thông tin\", name: \"Kỹ Thuật Phần Mềm\"}\n\n      // must be department to use this api\n      if (user.pow[5]) {\n        // remove old branch\n        await client.db(name_global_databases).collection('branchs').deleteOne({\n          _id: createId(data.old_name)\n        });\n        // add new branch\n        await client.db(name_global_databases).collection('branchs').insertOne({\n          _id: createId(data.name),\n          name: data.name,\n          dep: user.dep\n        });\n      } else {\n        return res.sendStatus(403); // back to home\n      }\n      return res.sendStatus(200);\n    } catch (err) {\n      console.log('SYSTEM | ADD_OR_EDIT_BRANCHS | ERROR | ', err);\n      return res.sendStatus(500);\n    }\n  });\n\n  // api delete cheked branchs\n  router.post('/deleteBranchs', checkIfUserLoginAPI, async (req, res) => {\n    try {\n      const user = req.session.user;\n      const data = req.body; // data = {rm_bs: [\"Kỹ Thuật Phần Mềm\", ...]}\n\n      // must be department to use this api\n      if (user.pow[5]) {\n        // remove all cheked branch in remove branchs líst\n        for (let i = 0; i < data.rm_bs.length; i++) {\n          await client.db(name_global_databases).collection('branchs').deleteOne({\n            _id: createId(data.rm_bs[i])\n          });\n          const dummy_class = await client.db(name_global_databases).collection('classes').find({\n            branch: createId(data.rm_bs[i])\n          }, {\n            projection: {\n              cvht: 1\n            }\n          }).toArray();\n          const cls_rm_data = dummy_class.map(cls => cls._id);\n          const cvht_rm_data = dummy_class.map(cls => cls.cvht);\n          const requestData = {\n            rm_cls: cls_rm_data,\n            rm_ts: cvht_rm_data\n          };\n\n          // // Gọi API bằng axios với phương thức POST\n          await deleteClassApi(requestData, user);\n          await client.db(name_global_databases).collection('user_info').updateMany({\n            _id: {\n              $in: cvht_rm_data\n            }\n          }, {\n            $set: {\n              branch: ObjectId.createFromHexString('650985a345e2e896b37efd4f')\n            }\n          });\n        }\n        return res.sendStatus(200);\n      } else {\n        return res.sendStatus(403); // back to home\n      }\n    } catch (err) {\n      console.log('SYSTEM | DELETE_BRANCHS | ERROR | ', err);\n      return res.sendStatus(500);\n    }\n  });\n\n  // change mark deadline\n  router.post('/changeDeadLine', checkIfUserLoginAPI, async (req, res) => {\n    try {\n      const user = req.session.user;\n      // must be department to use this api\n      if (user.pow[6]) {\n        const data = req.body; // data = {sch_y: \"HK1_2022-2023\", start_day: '18/10/2023', end_day: '19/11/999999999999999999']}\n        const cy = data.sch_y.split('_');\n        console.log(data);\n        // set end day to special date if it is ''\n        if (!data.end_day) {\n          data.end_day = '2003-10-18'; // special date\n        }\n        await client.db(name_global_databases).collection('school_year').updateOne({}, {\n          $set: {\n            year: data.sch_y,\n            start_day: new Date(data.start_day),\n            // change string to Date\n            end_day: new Date(data.end_day)\n          }\n        });\n        const keyupdate = `years.${cy[1]}`;\n        await client.db(name_global_databases).collection('classes').updateMany({}, {\n          $set: {\n            [keyupdate]: [1, 2, 3]\n          }\n        });\n        return res.sendStatus(200);\n      } else {\n        return res.sendStatus(403); // back to home\n      }\n    } catch (err) {\n      console.log('SYSTEM | CHANGE_DEADLINE | ERROR | ', err);\n      return res.sendStatus(500);\n    }\n  });\n\n  // api add or edit teacher of department base on it exist or not\n  router.post('/addOrEditTeachers', checkIfUserLoginAPI, async (req, res) => {\n    try {\n      const user = req.session.user;\n      const data = req.body; // data = {old_id: \"19112003\", new_id: \"18102003\", new_name: \"Nguyễn Văn A\", branch: \"KTPM\"}\n\n      // must be department to use this api\n      if (user.pow[8]) {\n        // find to get old pass of teacher before remove it\n        const teacher_pass = await client.db(name_global_databases).collection('login_info').findOne({\n          _id: data.old_id\n        }, {\n          projection: {\n            password: 1\n          }\n        });\n        // find to get curr classes\n        const curr_teacher = await client.db(name_global_databases).collection('user_info').findOne({\n          _id: data.old_id\n        }, {\n          projection: {\n            class: 1,\n            avt: 1,\n            email: 1\n          }\n        });\n        if (curr_teacher) {\n          // remove old teachers\n          await client.db(name_global_databases).collection('user_info').deleteOne({\n            _id: data.old_id\n          });\n\n          // edit old one\n          await client.db(name_global_databases).collection('user_info').insertOne({\n            _id: data.new_id,\n            first_name: data.new_name.split(' ').slice(-1).join(' '),\n            last_name: data.new_name.split(' ').slice(0, -1).join(' '),\n            avt: curr_teacher.avt,\n            power: {\n              1: true,\n              3: true,\n              4: true\n            },\n            class: curr_teacher.class,\n            displayName: data.new_name,\n            // here before pop\n            branch: data.branch,\n            email: curr_teacher.email\n          });\n        } else {\n          // add new one\n          await client.db(name_global_databases).collection('user_info').insertOne({\n            _id: data.new_id,\n            first_name: data.new_name.split(' ').slice(-1).join(' '),\n            last_name: data.new_name.split(' ').slice(0, -1).join(' '),\n            avt: 'https://i.pinimg.com/236x/89/08/3b/89083bba40545a72fa15321af5fab760--chibi-girl-zero.jpg',\n            power: {\n              1: true,\n              3: true,\n              4: true\n            },\n            class: [],\n            displayName: data.new_name,\n            // here before pop\n            branch: data.branch,\n            email: ''\n          });\n        }\n        if (teacher_pass) {\n          await client.db(name_global_databases).collection('login_info').deleteOne({\n            _id: data.old_id\n          });\n          // edit old one\n          await client.db(name_global_databases).collection('login_info').insertOne({\n            _id: data.new_id,\n            password: hashPassword(teacher_pass.password)\n          });\n        } else {\n          // add new one\n          await client.db(name_global_databases).collection('login_info').insertOne({\n            _id: data.new_id,\n            password: hashPassword(data.new_id)\n          });\n        }\n      } else {\n        return res.sendStatus(403); // back to home\n      }\n      return res.sendStatus(200);\n    } catch (err) {\n      console.log('SYSTEM | ADD_OR_EDIT_BRANCHS | ERROR | ', err);\n      return res.sendStatus(500);\n    }\n  });\n\n  // api delete teachers checked\n  router.post('/deleteTeachers', checkIfUserLoginAPI, async (req, res) => {\n    try {\n      const user = req.session.user;\n      const data = req.body; // data = {rm_ts: [\"19112003\" (teacher_id), ...]}\n\n      // must be department to use this api\n      if (user.pow[8]) {\n        // remove all cheked teacher in remove teachers líst in user_info and login_info\n        await client.db(name_global_databases).collection('user_info').deleteMany({\n          _id: {\n            $in: data.rm_ts\n          }\n        });\n        await client.db(name_global_databases).collection('login_info').deleteMany({\n          _id: {\n            $in: data.rm_ts\n          }\n        });\n        await client.db(name_global_databases).collection('classes').updateMany({\n          cvht: {\n            $in: data.rm_ts\n          }\n        },\n        // Điều kiện để xác định tài liệu cần cập nhật\n        {\n          $set: {\n            cvht: ObjectId.createFromHexString('650985a345e2e896b37efd4f')\n          }\n        } // Sử dụng $pull để xoá các giá trị trong mảng cvht\n        );\n      } else {\n        return res.sendStatus(403); // back to home\n      }\n      return res.sendStatus(200);\n    } catch (err) {\n      console.log('SYSTEM | DELETE_TEACHER | ERROR | ', err);\n      return res.sendStatus(500);\n    }\n  });\n\n  // api checkin students to activity\n  router.post('/CheckinActivities', checkIfUserLoginAPI, async (req, res) => {\n    try {\n      const user = req.session.user;\n      const data = req.body; // data = {id: '19181011' (activity's id), level: (Lớp/Khoa/Trường);\n      if (user.pow[0]) {\n        switch (data.level) {\n          case 'Lớp':\n            await client.db(user.dep).collection(`${user.cls[0]}_activities`).updateOne({\n              _id: data.id\n            }, {\n              $set: {\n                [`student_list.${user._id}`]: 0\n              }\n              // $push: {\n              //   bonus_list: user._id,\n              // },\n            }, {\n              upsert: true\n            });\n            return res.status(200).json({\n              id: user._id,\n              cls: user.cls\n            });\n          case 'Khoa':\n            // save activity in activities collection in 'Dep name' database\n            await client.db(user.dep).collection('activities').updateOne({\n              _id: data.id\n            }, {\n              $set: {\n                [`student_list.${user._id}`]: 0\n              }\n              // $push: {\n              //   bonus_list: user._id,\n              // },\n            }, {\n              upsert: true\n            });\n            return res.status(200).json({\n              id: user._id,\n              cls: user.cls\n            });\n          case 'Trường':\n            await client.db(name_global_databases).collection('activities').updateOne({\n              _id: data.id\n            }, {\n              $set: {\n                [`student_list.${user._id}`]: 0\n              }\n              // $push: {\n              //   bonus_list: user._id,\n              // },\n            }, {\n              upsert: true\n            });\n            return res.status(200).json({\n              id: user._id,\n              cls: user.cls\n            });\n        }\n        return res.status(404).json({\n          message: 'Thông tin xác thực sai!'\n        });\n      } else {\n        return res.sendStatus(403);\n      }\n\n      // use later to update student joining inside activities database\n      // student_list: {}, // change later to list of student with value is boolean (true for joining and false for not joining)\n      // bonus_list: [], // list of student's id that have bonus.\n    } catch (err) {\n      console.log('SYSTEM | CHECK_IN_ACTIVITIES | ERROR | ', err);\n      return res.sendStatus(500);\n    }\n  });\n\n  // api 出席 gakusei to activity\n  router.post('/muster', checkIfUserLoginAPI, async (req, res) => {\n    try {\n      const user = req.session.user;\n      const data = req.body; // data = {id: '19181011' (activity's id), level: (Lớp/Khoa/Trường);\n      if (user.pow[0]) {\n        switch (data.level) {\n          case 'Lớp':\n            await client.db(user.dep).collection(`${user.cls[0]}_activities`).updateOne({\n              _id: data.id\n            }, {\n              $set: {\n                [`ai.${user._id}`]: true\n              }\n              // $push: {\n              //   bonus_list: user._id,\n              // },\n            }, {\n              upsert: true\n            });\n            break;\n          case 'Khoa':\n            // save activity in activities collection in 'Dep name' database\n            await client.db(user.dep).collection('activities').updateOne({\n              _id: data.id\n            }, {\n              $set: {\n                [`ai.${user._id}`]: true\n              }\n              // $push: {\n              //   bonus_list: user._id,\n              // },\n            }, {\n              upsert: true\n            });\n            break;\n          case 'Trường':\n            await client.db(name_global_databases).collection('activities').updateOne({\n              _id: data.id\n            }, {\n              $set: {\n                [`ai.${user._id}`]: true\n              }\n              // $push: {\n              //   bonus_list: user._id,\n              // },\n            }, {\n              upsert: true\n            });\n            break;\n        }\n        await client.db(user.dep).collection(user.cls[0] + '_std_table').updateOne({\n          mssv: user._id,\n          school_year: data.year\n        }, {\n          $set: {\n            [`img_ids.${data.id}`]: data.img_ids\n          }\n        }, {\n          upsert: true\n        });\n        return res.status(200).json({\n          id: user._id,\n          cls: user.cls\n        });\n      } else {\n        return res.sendStatus(403);\n      }\n\n      // use later to update student joining inside activities database\n      // student_list: {}, // change later to list of student with value is boolean (true for joining and false for not joining)\n      // bonus_list: [], // list of student's id that have bonus.\n    } catch (err) {\n      console.log('SYSTEM | CHECK_IN_ACTIVITIES | ERROR | ', err);\n      return res.sendStatus(500);\n    }\n  });\n\n  // api add and edit activities -------------------------------------------------------------------------------------------------------------------------------\n  router.post('/addOrEditActivities', checkIfUserLoginAPI, async (req, res) => {\n    try {\n      const user = req.session.user;\n      const data = req.body; // data = {atv_id: '19181011' (activity's id);\n      // name: 'Hoat dong hay nha';\n      // content: 'Di du thu noi';\n      // 'level': 'khoa';\n      // cls_id:'KTPM';\n      // start_date: '2020-05-18';\n      // start_hour: '14:10:30'}\n\n      if (user.pow[3] && user.pow[11]) {\n        // get curr school year\n        const school_year = await client.db(name_global_databases).collection('school_year').findOne({}, {\n          projection: {\n            _id: 0,\n            year: 1\n          }\n        });\n        // if it is a new one Send fake id and sure that not exist in database\n        switch (data.level) {\n          case 'lop':\n            // save activity in 'Class name' + _activities collection in 'Department name' database\n            await client.db(user.dep).collection(data.cls_id + '_activities').updateOne({\n              _id: data.atv_id\n            }, {\n              $set: {\n                name: data.name,\n                content: data.content,\n                level: 'Lớp',\n                cls: data.cls_id,\n                year: school_year.year,\n                start_time: new Date([data.start_date, data.start_hour]),\n                end: false\n              }\n            }, {\n              upsert: true\n            });\n\n            // check other databases if this activities in thoese collection remove it\n            await client.db(name_global_databases).collection('activities').deleteOne({\n              _id: data.atv_id\n            }); // school\n\n            await client.db(user.dep).collection('activities').deleteOne({\n              _id: data.atv_id\n            }); // department\n\n            // create index for new table has just created\n            await await client.db(user.dep).collection(data.cls_id + '_activities').createIndex({\n              year: 1\n            }, {\n              name: '_year'\n            });\n            break;\n          case 'khoa':\n            // save activity in activities collection in 'Dep name' database\n            await client.db(user.dep).collection('activities').updateOne({\n              _id: data.atv_id\n            }, {\n              $set: {\n                name: data.name,\n                content: data.content,\n                level: 'Khoa',\n                year: school_year.year,\n                start_time: new Date([data.start_date, data.start_hour]),\n                end: false\n              }\n            }, {\n              upsert: true\n            });\n\n            // check other databases if this activities in thoese collection remove it\n            await client.db(name_global_databases).collection('activities').deleteOne({\n              _id: data.atv_id\n            }); // school\n            await client.db(user.dep).collection(data.cls_id + '_activities').deleteOne({\n              _id: data.atv_id\n            }); // class\n\n            // create index for new table has just created\n            await client.db(user.dep).collection('activities').createIndex({\n              year: 1\n            }, {\n              name: '_year'\n            });\n            break;\n          case 'truong':\n            // save activity in activities collection in global database\n            await client.db(name_global_databases).collection('activities').updateOne({\n              _id: data.atv_id\n            }, {\n              $set: {\n                name: data.name,\n                content: data.content,\n                level: 'Trường',\n                year: school_year.year,\n                start_time: new Date([data.start_date, data.start_hour]),\n                end: false\n              }\n            }, {\n              upsert: true\n            });\n\n            // check other databases if this activities in thoese collection remove it\n            await client.db(user.dep).collection('activities').deleteOne({\n              _id: data.atv_id\n            }); // department\n            await client.db(user.dep).collection(data.cls_id + '_activities').deleteOne({\n              _id: data.atv_id\n            }); // class\n\n            // school database do not need create index because it already have it\n            break;\n        }\n        wss.clients.forEach(ws => {\n          if (ws.actId == data.atv_id) {\n            ws.send('reload');\n          }\n        });\n        return res.status(200).json({\n          message: 'Success'\n        });\n      } else {\n        return res.sendStatus(403);\n      }\n\n      // use later to update student joining inside activities database\n      // student_list: {}, // change later to list of student with value is boolean (true for joining and false for not joining)\n      // bonus_list: [], // list of student's id that have bonus.\n    } catch (err) {\n      console.log('SYSTEM | ADD_EDIT_ACTIVITIES | ERROR | ', err);\n      return res.sendStatus(500);\n    }\n  });\n\n  // api load activities base on years -------------------------------------------------------------------------------------------------------------------------------\n  router.post('/loadYearActivities', checkIfUserLoginAPI, async (req, res) => {\n    try {\n      const user = req.session.user;\n      const data = req.body; // data = {year: '2022-2023', semester: '1'}\n      const curr_year = 'HK' + data.semester + '_' + data.year;\n      if (user.pow[3]) {\n        // find all activities in this year:\n        // get all activities of school\n        const school_atv = await client.db(name_global_databases).collection('activities').find({\n          year: curr_year\n        }, {\n          projection: {\n            name: 1,\n            content: 1,\n            year: 1\n          }\n        }).toArray();\n\n        // get all activities of dep\n        const dep_atv = await client.db(user.dep).collection('activities').find({\n          year: curr_year\n        }, {\n          projection: {\n            name: 1,\n            content: 1,\n            year: 1\n          }\n        }).toArray();\n\n        // get all activities of class of department\n        const collections = await client.db(user.dep).listCollections().toArray();\n\n        // Filter collections ending with '_activities'\n        const activityCollections = collections.filter(collection => collection.name.endsWith('_activities'));\n\n        // Loop through activity collections and retrieve all documents\n        const cls_atvs = await activityCollections.map(async collection => {\n          if (user.pow[1]) {\n            const dummy = await client.db(user.dep).collection(collection.name).find({\n              year: curr_year,\n              cls: user.cls[0]\n            }, {\n              projection: {\n                name: 1,\n                content: 1,\n                cls: 1,\n                year: 1\n              }\n            }).toArray();\n            return dummy;\n          } else {\n            const dummy = await client.db(user.dep).collection(collection.name).find({\n              year: curr_year\n            }, {\n              projection: {\n                name: 1,\n                content: 1,\n                cls: 1,\n                year: 1\n              }\n            }).toArray();\n            return dummy;\n          }\n        });\n        Promise.all(cls_atvs).then(results => {\n          // Khi tất cả các promise đã hoàn thành, results sẽ là một mảng chứa kết quả từ mỗi truy vấn.\n          // Bạn có thể làm gì đó với kết quả ở đây.\n          const cls_atv = [].concat(...results); // Kết hợp kết quả từ các truy vấn vào một mảng duy nhất\n\n          const final = {\n            school_atv: school_atv,\n            dep_atv: dep_atv,\n            cls_atv: cls_atv\n          };\n          return res.status(200).json(final);\n        }).catch(error => {\n          // Xử lý lỗi nếu có\n          console.log('SYSTEM | LOAD_YEAR_ACTIVITIES | ERROR |', error);\n        });\n      } else {\n        return res.sendStatus(403);\n      }\n    } catch (err) {\n      console.log('SYSTEM | LOAD_YEAR_ACTIVITIES | ERROR | ', err);\n      return res.sendStatus(500);\n    }\n  });\n\n  // api load activities base on class -------------------------------------------------------------------------------------------------------------------------------\n  router.post('/loadClassActivities', checkIfUserLoginAPI, async (req, res) => {\n    try {\n      const user = req.session.user;\n      const data = req.body; // data = {cls: 'KTPM0121'}\n      if (user.pow[3]) {\n        // get all activities in that class:\n        const cls_act = await client.db(user.dep).collection(data.cls + '_activities').find({}).toArray();\n        return res.status(200).json(cls_act);\n      } else {\n        return res.sendStatus(403);\n      }\n    } catch (err) {\n      console.log('SYSTEM | LOAD_CLASS_ACTIVITIES | ERROR | ', err);\n      return res.sendStatus(500);\n    }\n  });\n\n  // api end activities\n  router.post('/updateActivitiesStatus', checkIfUserLoginAPI, async (req, res) => {\n    try {\n      const user = req.session.user;\n      const data = req.body; // data = {_id: 18102003 (activities' id), level: 'Truong', status: '1' (1: đang diễn ra, 0: đã kết thúc)}\n      // must be department to use this api\n      if (user.pow[3]) {\n        if (data.level == 'Truong') {\n          // update status of current activity\n          await client.db(name_global_databases).collection('activities').updateOne({\n            _id: data._id\n          }, {\n            $set: {\n              end: data.status == '1'\n            }\n          });\n        } else if (data.level == 'Khoa') {\n          // update status of current activity\n          await client.db(user.dep).collection('activities').updateOne({\n            _id: data._id\n          }, {\n            $set: {\n              end: data.status == '1'\n            }\n          });\n        } else {\n          // update status of current activity\n          await client.db(user.dep).collection(data.level + '_activities').updateOne({\n            _id: data._id\n          }, {\n            $set: {\n              end: data.status == '1'\n            }\n          });\n        }\n        wss.clients.forEach(ws => {\n          if (ws.actId == data._id) {\n            ws.send('reload');\n          }\n        });\n        return res.sendStatus(200);\n      } else {\n        return res.sendStatus(403); // send user to 403 page\n      }\n    } catch (err) {\n      console.log('SYSTEM | DELETE_TEACHER | ERROR | ', err);\n      return res.sendStatus(500);\n    }\n  });\n\n  // api approval students join in activity\n  router.post('/approvalActivityStudent', checkIfUserLoginAPI, async (req, res) => {\n    try {\n      const user = req.session.user;\n      const data = req.body; // data = {_id: _id, level: level, dataUpdate: list of update students, defaultApproval: old student list}\n      // must be department to use this api\n      const ai = {};\n      Object.keys(data.dataUpdate).forEach(key => {\n        ai[key] = data.dataUpdate[key] === 1 ? true : false;\n      });\n      if (user.pow[3]) {\n        if (data.level == 'Truong') {\n          // update status of current activity\n          await client.db(name_global_databases).collection('activities').updateOne({\n            _id: data._id\n          }, {\n            $set: {\n              student_list: data.dataUpdate,\n              ai: ai\n            }\n          });\n        } else if (data.level == 'Khoa') {\n          // update status of current activity\n          await client.db(user.dep).collection('activities').updateOne({\n            _id: data._id\n          }, {\n            $set: {\n              student_list: data.dataUpdate,\n              ai: ai\n            }\n          });\n        } else {\n          // update status of current activity\n          await client.db(user.dep).collection(data.level + '_activities').updateOne({\n            _id: data._id\n          }, {\n            $set: {\n              student_list: data.dataUpdate,\n              ai: ai\n            }\n          });\n        }\n        return res.sendStatus(200);\n      } else {\n        return res.sendStatus(403); // send user to 403 page\n      }\n    } catch (err) {\n      console.log('SYSTEM | APPROVAL ACTIVITY STUDENTS | ERROR | ', err);\n      return res.sendStatus(500);\n    }\n  });\n\n  // api delete student join in activity\n  router.post('/deleteActivityStudent', checkIfUserLoginAPI, async (req, res) => {\n    try {\n      const user = req.session.user;\n      const data = req.body; // data = {_id: _id, level: level, dataDelete: dataDelete }\n\n      // must be department to use this api\n      if (user.pow[3]) {\n        if (data.level == 'Truong') {\n          // update status of current activity\n          await client.db(name_global_databases).collection('activities').updateOne({\n            _id: data._id\n          }, {\n            $unset: data.dataDelete\n          });\n        } else if (data.level == 'Khoa') {\n          // update status of current activity\n          await client.db(user.dep).collection('activities').updateOne({\n            _id: data._id\n          }, {\n            $unset: data.bonusDelete\n          });\n        } else {\n          // update status of current activity\n          await client.db(user.dep).collection(data.level + '_activities').updateOne({\n            _id: data._id\n          }, {\n            $unset: data.bonusDelete\n          });\n        }\n        return res.sendStatus(200);\n      } else {\n        return res.sendStatus(403); // send user to 403 page\n      }\n    } catch (err) {\n      console.log('SYSTEM | DELETE ACTIVITY STUDENTS | ERROR | ', err);\n      return res.sendStatus(500);\n    }\n  });\n\n  // api delete activities checked\n  router.post('/deleteActivities', checkIfUserLoginAPI, async (req, res) => {\n    try {\n      const user = req.session.user;\n      const data = req.body; // data = {school_rmatv: [\"19112003\" (school_activity_id), ...], dep_rmatv: [\"28091978\" (dep_activity_id), ...], cls_rmatv: [\"18102003\" (cls_activity_id), ...]}\n\n      // must be department to use this api\n      if (user.pow[3] && user.pow[11]) {\n        // remove all checked school activities\n        await client.db(name_global_databases).collection('activities').deleteMany({\n          _id: {\n            $in: data.school_rmatv\n          }\n        });\n\n        // remove all checked dep activities\n        await client.db(user.dep).collection('activities').deleteMany({\n          _id: {\n            $in: data.dep_rmatv\n          }\n        });\n\n        // remove all checked class activities\n        // get all activities of class of department\n        const collections = await client.db(user.dep).listCollections().toArray();\n\n        // Filter collections ending with '_activities'\n        const activityCollections = await collections.filter(collection => collection.name.endsWith('_activities'));\n\n        // Loop through activity collections and retrieve all documents\n        activityCollections.forEach(async activityCollection => {\n          await client.db(user.dep).collection(activityCollection.name).deleteMany({\n            _id: {\n              $in: data.cls_rmatv\n            }\n          });\n        });\n        return res.sendStatus(200);\n      } else {\n        return res.sendStatus(403); // send user to 403 page\n      }\n    } catch (err) {\n      console.log('SYSTEM | DELETE_TEACHER | ERROR | ', err);\n      return res.sendStatus(500);\n    }\n  });\n\n  // load bang diem cua giao vien------------------------------------------------------------------------------------------------------------------\n  router.get('/teacher/loadScoresList', checkIfUserLoginAPI, async (req, res) => {\n    try {\n      const user = req.session.user;\n      if (user.pow[1]) {\n        const data = req.query;\n        //data = {year: \"HK1_2022-2023\", cls: \"1\"}\n        const school_year = data.year;\n        const year_available = await client.db(name_global_databases).collection('school_year').findOne({}, {\n          projection: {\n            _id: 0,\n            year: 1,\n            start_day: 1,\n            end_day: 1\n          }\n        });\n        const student_list = sortStudentName(await client.db(name_global_databases).collection('user_info').find({\n          class: data.cls,\n          'power.0': {\n            $exists: true\n          }\n        }, {\n          projection: {\n            first_name: 1,\n            last_name: 1,\n            total_score: 1\n          }\n        }).toArray());\n\n        // get all student total score from themself:\n        let result = {\n          // staff_name: [],\n          student_list: student_list,\n          // student_scores: [],\n          // staff_scores: [],\n          // department_scores: [],\n          year_available: year_available\n        };\n        return res.status(200).json(result);\n      } else {\n        // user not staff members\n        // redirect to home (return 403, api khong the chuyenh huong ve trang chu duoc)\n        return res.sendStatus(403);\n      }\n    } catch (err) {\n      console.log('SYSTEM | GIAO_VIEN_LOAD_SCORE_LIST | ERROR | ', err);\n      return res.sendStatus(500);\n    }\n  });\n\n  // api add and edit new class\n  router.post('/addOrEditClasses', checkIfUserLoginAPI, async (req, res) => {\n    try {\n      const user = req.session.user;\n      const data = req.body; // data = {new_id: KTPM0121, old_id: CNTT0221, branch: KTPM, cvht: 18101911}\n\n      // must be department to use this api\n      if (user.pow[9]) {\n        const school_year = await client.db(name_global_databases).collection('school_year').findOne({}, {\n          projection: {\n            _id: 0,\n            year: 1\n          }\n        });\n        const curr_year = school_year.year.split('_')[1];\n\n        // find year of old_id class before remove it\n        const old_class = await client.db(name_global_databases).collection('classes').findOne({\n          _id: data.old_id\n        }, {\n          projection: {\n            _id: 0,\n            years: 1,\n            cvht: 1\n          }\n        });\n        if (old_class) {\n          // remove old_id class\n          await client.db(name_global_databases).collection('classes').deleteOne({\n            _id: data.old_id\n          });\n\n          // add (edit old_id class)\n          await client.db(name_global_databases).collection('classes').insertOne({\n            _id: data.new_id,\n            years: old_class.years,\n            // years of old_id class\n            branch: data.branch,\n            cvht: data.cvht\n          });\n\n          // remove class from old teacher's class\n          await client.db(name_global_databases).collection('user_info').updateOne({\n            _id: old_class.cvht\n          }, {\n            $pull: {\n              class: data.old_id\n            }\n          });\n\n          // add new class to new teacher's class\n          await client.db(name_global_databases).collection('user_info').updateOne({\n            _id: data.cvht\n          }, {\n            $addToSet: {\n              class: data.new_id\n            }\n          });\n        } else {\n          // add new_id class\n          await client.db(name_global_databases).collection('classes').insertOne({\n            _id: data.new_id,\n            years: {\n              [`${curr_year}`]: [1, 2, 3]\n            },\n            branch: data.branch,\n            cvht: data.cvht\n          });\n\n          // add new class to teacher's class\n          await client.db(name_global_databases).collection('user_info').updateOne({\n            _id: data.cvht\n          }, {\n            $addToSet: {\n              class: data.new_id\n            }\n          });\n        }\n      } else {\n        return res.sendStatus(403); // back to home\n      }\n      return res.sendStatus(200);\n    } catch (err) {\n      console.log('SYSTEM | ADD_EDIT_CLASS | ERROR | ', err);\n      return res.sendStatus(500);\n    }\n  });\n\n  // api delete classes checked\n  router.post('/deleteClasses', checkIfUserLoginAPI, async (req, res) => {\n    try {\n      const user = req.session.user;\n      const data = req.body; // data = {rm_cls: [\"KTPM0121\" (class_id), ...], rm_ts: [\"18101911\" (teacher_id), ...]}\n\n      // must be department to use this api\n      if (user.pow[9]) {\n        // remove all checked classes in remove branchs líst in user_info and login_info\n        // remove class from teacher's class\n        await deleteClassApi(data, user);\n      } else {\n        return res.sendStatus(403); // back to home\n      }\n      return res.sendStatus(200);\n    } catch (err) {\n      console.log('SYSTEM | DELETE_CLASS | ERROR | ', err);\n      return res.sendStatus(500);\n    }\n  });\n\n  // api load classes\n  router.post('/loadClasses', checkIfUserLoginAPI, async (req, res) => {\n    try {\n      const user = req.session.user;\n      const data = req.body; // data = {curr_load_branch: 1 (next index to load), branchs: [KTPM, CNTT, ...] (all branch in department)}\n\n      // must be department to use this api\n      if (user.pow[9]) {\n        // get all classes of not load branchs:\n        let classes = {}; // classes = {KTPM: [KTPM0121, KTPM0108, ...], CNTT: [CNTT0109, CNTT0209, ...], ...}\n        let class_teachers = []; // class_teachers = [18102003, 19112003, ...]\n        let new_curr_load_branch; // next final branch loaded\n\n        for (let i = data.curr_load_branch; i < data.branchs.length; i++) {\n          let dummy = await client.db(name_global_databases).collection('classes').find({\n            branch: data.branchs[i]._id\n          },\n          // find all data\n          {\n            projection: {\n              cvht: 1\n            }\n          }).toArray();\n          classes[data.branchs[i]._id] = dummy.map(cls => cls._id);\n          class_teachers.push(...dummy.map(cls => cls.cvht));\n          new_curr_load_branch = i + 1;\n          // finish load one brach then check does number of classes over 30.\n          if (class_teachers.length >= 30) {\n            break;\n          }\n        }\n\n        // get all teacher's name of classes\n        for (let i = 0; i < class_teachers.length; i++) {\n          // replace current teacher's _id with teacher's name\n          class_teachers[i] = await client.db(name_global_databases).collection('user_info').findOne({\n            _id: class_teachers[i],\n            'power.1': {\n              $exists: true\n            },\n            'power.4': {\n              $exists: true\n            }\n          },\n          // user is teacher\n          {\n            projection: {\n              first_name: 1,\n              last_name: 1\n            }\n          });\n        }\n        return res.status(200).json({\n          classes: classes,\n          class_teachers: class_teachers,\n          new_curr_load_branch: new_curr_load_branch\n        });\n      } else {\n        return res.sendStatus(403); // back to home\n      }\n    } catch (err) {\n      console.log('SYSTEM | DELETE_CLASS | ERROR | ', err);\n      return res.sendStatus(500);\n    }\n  });\n  router.post('/exportaccount', upload.single('file'), checkIfUserLoginAPI, async (req, res) => {\n    try {\n      const user = req.session.user;\n      const Class = req.body.class;\n      const studentList = sortStudentName(await client.db(name_global_databases).collection('user_info').find({\n        class: Class,\n        'power.0': {\n          $exists: true\n        }\n      }, {\n        projection: {\n          _id: 1,\n          last_name: 1,\n          first_name: 1\n        }\n      }).toArray());\n      const workbook = await XlsxPopulate.fromFileAsync('./src/excelTemplate/FILE_TAO_ACC.xlsx');\n      const dataRows = [];\n      for (const student of studentList) {\n        const loginInfo = await client.db(name_global_databases).collection('login_info').findOne({\n          _id: student._id\n        }, {\n          projection: {\n            _id: 1,\n            password: 1\n          }\n        });\n        if (loginInfo) {\n          const dataRow = [student._id, loginInfo.password, student.last_name, student.first_name];\n          dataRows.push(dataRow);\n        }\n      }\n      if (dataRows.length > 0) {\n        await workbook.sheet(0).cell('A2').value(dataRows);\n      }\n      const uuid = uuidv4();\n      const outputFile = path.join(`.downloads/${uuid}.xlsx`);\n      await workbook.toFileAsync(outputFile);\n      console.log(path.join('.downloads', uuid + '.xlsx'));\n      scheduleFileDeletion(path.join('.downloads', uuid + '.xlsx'));\n      return res.download(path.join('.downloads', uuid + '.xlsx'));\n    } catch (err) {\n      console.log('SYSTEM | EXPORT ACCOUNT | ERROR | ', err);\n      return res.sendStatus(500);\n    }\n  });\n  // api get img acti student\n  router.post('/getImgActivities', checkIfUserLoginAPI, async (req, res) => {\n    try {\n      const user = req.session.user;\n      const data = req.body; // data = {curr_load_branch: 1 (next index to load), branchs: [KTPM, CNTT, ...] (all branch in department)}\n\n      // must be department to use this api\n      if (user.pow[3]) {\n        imglist = await client.db(user.dep).collection(data.class + '_std_table').findOne({\n          mssv: data._id,\n          school_year: data.year\n        }, {\n          projection: {\n            img_ids: 1\n          }\n        });\n        if (data.idact in imglist.img_ids) {\n          let imginfo = [];\n          for (const i of imglist.img_ids[data.idact]) {\n            imginfo.push(await server.getDriveFileLinkAndDescription(i));\n          }\n          return res.status(200).json(imginfo);\n        } else return res.status(404).json();\n      } else {\n        return res.sendStatus(403); // back to home\n      }\n    } catch (err) {\n      console.log('SYSTEM | LOAD_IMG_STUDENTS | ERROR | ', err);\n      return res.sendStatus(500);\n    }\n  });\n  return router;\n}\nmodule.exports = createAPIRouter;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIlJvdXRlciIsIlhsc3hQb3B1bGF0ZSIsInY0IiwidXVpZHY0IiwicGF0aCIsImZzIiwidXBsb2FkRGlyZWN0b3J5Iiwiam9pbiIsIm11bHRlciIsInNlcnZlciIsIk9iamVjdElkIiwiZ2V0TmFtZUdsb2JhbCIsIm5hbWVfZ2xvYmFsX2RhdGFiYXNlcyIsImNvbXBhcmVQYXNzd29yZCIsImhhc2hQYXNzd29yZCIsInNvcnRTdHVkZW50TmFtZSIsInNjaGVkdWxlRmlsZURlbGV0aW9uIiwibWFyayIsInVwZGF0ZVN0dWRlbnRUb3RhbFNjb3JlIiwic2VuZEVtYWlsIiwicmFuZG9tUGFzc3dvcmQiLCJjaGVja0lmVXNlckxvZ2luQVBJIiwiY3JlYXRlSWQiLCJnZXRfZnVsbF9pZCIsImRlbGV0ZUNsYXNzQXBpIiwiY3JlYXRlUGRmIiwiZXhpc3RzU3luYyIsIm1rZGlyU3luYyIsInN0b3JhZ2VfZmlsZSIsImRpc2tTdG9yYWdlIiwiZGVzdGluYXRpb24iLCJyZXEiLCJmaWxlIiwiY2IiLCJmaWxlbmFtZSIsIm9yaWdpbmFsbmFtZSIsInVwbG9hZCIsInN0b3JhZ2UiLCJjcmVhdGVBUElSb3V0ZXIiLCJjbGllbnQiLCJ3c3MiLCJwb3N0IiwicmVzIiwiZGF0YSIsImJvZHkiLCJ1c2VyIiwic2Vzc2lvbiIsImRiIiwiY29sbGVjdGlvbiIsImZpbmRPbmUiLCJfaWQiLCJtc3N2IiwidXNlcl9pbmZvX2NoZWNrIiwiY2xhc3MiLCJkZWxldGVPbmUiLCJzZW5kU3RhdHVzIiwicGFzc3dvcmQiLCJzZWFzaW9uSURzIiwic2Vzc2lvbklkIiwiZXhpc3RpbmdEb2NzIiwiZmluZCIsIiRpbiIsInRvQXJyYXkiLCJleGlzdGluZ0lEcyIsIm1hcCIsImRvYyIsImlkc1RvRGVsZXRlIiwiZmlsdGVyIiwiaWQiLCJpbmNsdWRlcyIsImxlbmd0aCIsInVwZGF0ZU9uZSIsIiRwdWxsIiwiY2xzIiwicHJvamVjdGlvbiIsInBvd2VyIiwiZGVwIiwiYnJhbmNoIiwicG93IiwicmVtZW1iZXIiLCJjb29raWUiLCJtYXhBZ2UiLCIkcHVzaCIsInVwc2VydCIsImZpcnN0Iiwic3RhdHVzIiwianNvbiIsImNoZWNrIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImdldCIsImRlc3Ryb3kiLCJwcm9jZXNzU2Vzc2lvbklEcyIsInJlZGlyZWN0IiwiZXJyb3IiLCJyZXN1bHQiLCJsaXN0U2Vhc2lvbklkIiwic3BsaWNlIiwiaW5kZXhPZiIsIiRuZSIsImRlbGV0ZU1hbnkiLCJjbGllbnRzIiwiZm9yRWFjaCIsIndzIiwic2VuZCIsIiRzZXQiLCJkaXNwbGF5TmFtZSIsImF2dCIsIk9UUCIsIm90cCIsIm90cGNvZGUiLCJkYXRhVXNlciIsImVtYWlsIiwiT1RQc2NvZGUiLCJleHBpcmVBdCIsIkRhdGUiLCJub3ciLCJvbGRfcGFzcyIsIm9sZF9wYXNzd29yZCIsIm5ld19wYXNzd29yZCIsIiR1bnNldCIsIm1hcmtlciIsImxhc3RfbmFtZSIsImZpcnN0X25hbWUiLCJtYXJrZWQiLCJhcnJheSIsImZpbGVzIiwibGlzdF9uYW1lIiwibGlzdF9kZXAiLCJpIiwiZmlsZU5hbWUiLCJmaWxlRGVzY3JpcHRpb24iLCJkZXNjcmlwdHMiLCJwdXNoIiwid3JpdGVIZWFkIiwiZW5kIiwiSlNPTiIsInN0cmluZ2lmeSIsInNpbmdsZSIsImR1bW15U2NvcmUiLCJzZWNvbmQiLCJ0aGlyZCIsImZvdXJ0aCIsImZpZnRoIiwiaW1nX2lkcyIsInRvdGFsIiwiZmlsZVN0dWRlbnRzIiwiZ2VuZXJhdGVFbWFpbCIsInN0ciIsInMxIiwiczAiLCJuZXdTdHIiLCJsaXN0U3BhY2UiLCJvdXRwdXQiLCJjaGFyQXQiLCJzbGljZSIsInJlcGxhY2UiLCJ0b0xvd2VyQ2FzZSIsIndvcmtib29rIiwiZnJvbUZpbGVBc3luYyIsInNoZWV0IiwidmFsdWVzIiwidXNlZFJhbmdlIiwidmFsdWUiLCJleHBlY3RlZFZhbHVlcyIsImlzQ29ycmVjdCIsImVuZENlbGwiLCJyb3dDb3VudCIsInJvd051bWJlciIsImNvbHVtbkNvdW50IiwiY29sdW1uIiwiY2VsbCIsImhhdmV2YWx1ZSIsInJvdyIsImhhc1ZhbHVlIiwibWF4V2lkdGhFbWFpbCIsImRhdGFSb3dzIiwicHciLCJ0b1N0cmluZyIsImRhdGFJbnNlcnRVc2VyIiwidG90YWxfc2NvcmUiLCJkYXRhSW5zZXJ0TG9naW4iLCJkYXRhUm93IiwicmFuZ2UiLCJzdHlsZSIsImJvcmRlciIsIndpZHRoIiwidXVpZCIsInRvRmlsZUFzeW5jIiwid29ya2Jvb2thY2MiLCJvdXRwdXRGaWxlIiwiZG93bmxvYWQiLCJzdHVkZW50SWRUb0NoZWNrIiwiZGF0YVN0dWRlbnQiLCJsaXN0RGVsZXRlIiwiZGF0YURlbGV0ZSIsImluZm9fc2VhcmNoIiwidXBkYXRlTWFueSIsIiRleGlzdHMiLCJzdHVkZW50X2xpc3QiLCJhaSIsInF1ZXJ5Iiwic2Nob29sX3llYXIiLCJ5ZWFyIiwic2NvcmVzIiwiY3Vycl9zY29yZSIsImN1cnJfZGVwYXJ0bWVudHRfc2NvcmUiLCJqIiwic3RkbGlzdCIsInBhcnNlIiwidHlwZSIsIm5hbWUiLCJzdGQiLCJzdGYiLCJjdXJyX3N0dWRlbnRzX3Njb3JlIiwiY3Vycl9zdGFmZl9zY29yZSIsInRlbXBfbmFtZWZpbGUiLCJ5ZWFyX2F2YWlsYWJsZSIsInN0YXJ0X2RheSIsImVuZF9kYXkiLCJzdGF0dXNDb2RlIiwic3RkX2xpc3QiLCJzdGRfdGFibGUiLCJwYXJzZUludCIsInJlcUNsYXNzIiwibGltaXQiLCJza2lwIiwidHJhbnNmb3JtZWREYXRhIiwiaXRlbSIsInJvbGUiLCJkYW5nX3ZpZW4iLCJjaGFtX2RpZW0iLCJsYXBfaG9hdF9kb25nIiwic2Nob29sWWVhclBhcmFtIiwic2Nob29sWWVhciIsInNjaG9vbFllYXJzVG9TZWFyY2giLCJzdHVkZW50VG90YWxTY29yZXMiLCJQcm9taXNlIiwiYWxsIiwic3R1ZGVudFRvdGFsU2NvcmUiLCJvbGRfbmFtZSIsImluc2VydE9uZSIsInJtX2JzIiwiZHVtbXlfY2xhc3MiLCJjdmh0IiwiY2xzX3JtX2RhdGEiLCJjdmh0X3JtX2RhdGEiLCJyZXF1ZXN0RGF0YSIsInJtX2NscyIsInJtX3RzIiwiY3JlYXRlRnJvbUhleFN0cmluZyIsImN5Iiwic2NoX3kiLCJzcGxpdCIsImtleXVwZGF0ZSIsInRlYWNoZXJfcGFzcyIsIm9sZF9pZCIsImN1cnJfdGVhY2hlciIsIm5ld19pZCIsIm5ld19uYW1lIiwibGV2ZWwiLCJtZXNzYWdlIiwiY2xzX2lkIiwiYXR2X2lkIiwiY29udGVudCIsInN0YXJ0X3RpbWUiLCJzdGFydF9kYXRlIiwic3RhcnRfaG91ciIsImNyZWF0ZUluZGV4IiwiYWN0SWQiLCJjdXJyX3llYXIiLCJzZW1lc3RlciIsInNjaG9vbF9hdHYiLCJkZXBfYXR2IiwiY29sbGVjdGlvbnMiLCJsaXN0Q29sbGVjdGlvbnMiLCJhY3Rpdml0eUNvbGxlY3Rpb25zIiwiZW5kc1dpdGgiLCJjbHNfYXR2cyIsImR1bW15IiwidGhlbiIsInJlc3VsdHMiLCJjbHNfYXR2IiwiY29uY2F0IiwiZmluYWwiLCJjYXRjaCIsImNsc19hY3QiLCJPYmplY3QiLCJrZXlzIiwiZGF0YVVwZGF0ZSIsImtleSIsImJvbnVzRGVsZXRlIiwic2Nob29sX3JtYXR2IiwiZGVwX3JtYXR2IiwiYWN0aXZpdHlDb2xsZWN0aW9uIiwiY2xzX3JtYXR2Iiwib2xkX2NsYXNzIiwieWVhcnMiLCIkYWRkVG9TZXQiLCJjbGFzc2VzIiwiY2xhc3NfdGVhY2hlcnMiLCJuZXdfY3Vycl9sb2FkX2JyYW5jaCIsImN1cnJfbG9hZF9icmFuY2giLCJicmFuY2hzIiwiQ2xhc3MiLCJzdHVkZW50TGlzdCIsInN0dWRlbnQiLCJsb2dpbkluZm8iLCJpbWdsaXN0IiwiaWRhY3QiLCJpbWdpbmZvIiwiZ2V0RHJpdmVGaWxlTGlua0FuZERlc2NyaXB0aW9uIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiRDpcXHByb2plY3RcXHdlYlxcbmV3Q0RSTC0xXFxiYWNrZW5kXFxyb3V0ZXJcXCIsInNvdXJjZXMiOlsiYXBpUm91dGVycy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBleHByZXNzID0gcmVxdWlyZSgnZXhwcmVzcycpO1xyXG5jb25zdCByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpO1xyXG5jb25zdCBYbHN4UG9wdWxhdGUgPSByZXF1aXJlKCd4bHN4LXBvcHVsYXRlJyk7XHJcbmNvbnN0IHsgdjQ6IHV1aWR2NCB9ID0gcmVxdWlyZSgndXVpZCcpO1xyXG5jb25zdCBwYXRoID0gcmVxdWlyZSgncGF0aCcpO1xyXG5jb25zdCBmcyA9IHJlcXVpcmUoJ2ZzJyk7XHJcbmNvbnN0IHVwbG9hZERpcmVjdG9yeSA9IHBhdGguam9pbignLi4vLi4vdXBsb2FkX3RlbXAnKTtcclxuY29uc3QgbXVsdGVyID0gcmVxdWlyZSgnbXVsdGVyJyk7XHJcbmNvbnN0IHNlcnZlciA9IHJlcXVpcmUoJy4uL2xpYi9jc2RsX2dvb2dsZV9saWInKTtcclxuXHJcbmNvbnN0IHsgT2JqZWN0SWQgfSA9IHJlcXVpcmUoJ21vbmdvZGInKTtcclxuY29uc3QgeyBnZXROYW1lR2xvYmFsIH0gPSByZXF1aXJlKCcuLi9saWIvbW9nb2RiX2xpYicpO1xyXG5jb25zdCBuYW1lX2dsb2JhbF9kYXRhYmFzZXMgPSBnZXROYW1lR2xvYmFsKCk7XHJcbmNvbnN0IHtcclxuICAgIGNvbXBhcmVQYXNzd29yZCxcclxuICAgIGhhc2hQYXNzd29yZCxcclxuICAgIHNvcnRTdHVkZW50TmFtZSxcclxuICAgIHNjaGVkdWxlRmlsZURlbGV0aW9uLFxyXG4gICAgbWFyayxcclxuICAgIHVwZGF0ZVN0dWRlbnRUb3RhbFNjb3JlLFxyXG4gICAgc2VuZEVtYWlsLFxyXG4gICAgcmFuZG9tUGFzc3dvcmQsXHJcbiAgICBjaGVja0lmVXNlckxvZ2luQVBJLFxyXG4gICAgY3JlYXRlSWQsXHJcbiAgICBnZXRfZnVsbF9pZCxcclxuICAgIGRlbGV0ZUNsYXNzQXBpLFxyXG4gICAgY3JlYXRlUGRmLFxyXG59ID0gcmVxdWlyZSgnLi4vbGliL2Z1bmN0aW9uX2xpYicpO1xyXG5cclxuaWYgKCFmcy5leGlzdHNTeW5jKHVwbG9hZERpcmVjdG9yeSkpIHtcclxuICAgIGZzLm1rZGlyU3luYyh1cGxvYWREaXJlY3RvcnkpO1xyXG59XHJcbmNvbnN0IHN0b3JhZ2VfZmlsZSA9IG11bHRlci5kaXNrU3RvcmFnZSh7XHJcbiAgICBkZXN0aW5hdGlvbjogZnVuY3Rpb24gKHJlcSwgZmlsZSwgY2IpIHtcclxuICAgICAgICBjYihudWxsLCB1cGxvYWREaXJlY3RvcnkpO1xyXG4gICAgfSxcclxuICAgIGZpbGVuYW1lOiBmdW5jdGlvbiAocmVxLCBmaWxlLCBjYikge1xyXG4gICAgICAgIGNiKG51bGwsIGZpbGUub3JpZ2luYWxuYW1lKTtcclxuICAgIH0sXHJcbn0pO1xyXG5jb25zdCB1cGxvYWQgPSBtdWx0ZXIoeyBzdG9yYWdlOiBzdG9yYWdlX2ZpbGUgfSk7XHJcblxyXG4vLyBBUEkgU1BBQ0UgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuZnVuY3Rpb24gY3JlYXRlQVBJUm91dGVyKGNsaWVudCwgd3NzKSB7XHJcbiAgICAvLyBMb2cgaW4gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIHJvdXRlci5wb3N0KCcvbG9naW4nLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICAgICAgICBjb25zdCBkYXRhID0gcmVxLmJvZHk7XHJcbiAgICAgICAgLy8gNDAzOiBzYWkgdGhvbmcgdGluIGRhbmcgbmhhcFxyXG4gICAgICAgIC8vIGRhdGEgPSB7bXNzdjogYmJwLCBwYXNzd29yZDogMTIzNDU2Nzg5MCwgcmVtZW1iZXI6IHRydWV9XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgdXNlciA9IHJlcS5zZXNzaW9uLnVzZXI7XHJcbiAgICAgICAgICAgIGlmICghdXNlcikge1xyXG4gICAgICAgICAgICAgICAgLy8obG9nIGluIGRhdGFiYXNlKVxyXG4gICAgICAgICAgICAgICAgbGV0IHVzZXIgPSBhd2FpdCBjbGllbnQuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKS5jb2xsZWN0aW9uKCdsb2dpbl9pbmZvJykuZmluZE9uZSh7IF9pZDogZGF0YS5tc3N2IH0pO1xyXG4gICAgICAgICAgICAgICAgbGV0IHVzZXJfaW5mb19jaGVjayA9IGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ3VzZXJfaW5mbycpXHJcbiAgICAgICAgICAgICAgICAgICAgLmZpbmRPbmUoeyBfaWQ6IGRhdGEubXNzdiB9KTtcclxuICAgICAgICAgICAgICAgIGlmICh1c2VyID09PSBudWxsIHx8IHVzZXJfaW5mb19jaGVjayA9PT0gbnVsbCB8fCB1c2VyX2luZm9fY2hlY2suY2xhc3MgPT0gW10pIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBraeG7g20gdHJhIG7hur91IGLDqm4gbG9naW4gY8OzIGluZm8gbcOgIGLDqm4gdXNlciBrIGPDsyB0aMOsIHhvw6EgYsOqbiBsb2dpbiAoZ2hvc3QgYWNjb3VudClcclxuICAgICAgICAgICAgICAgICAgICBpZiAodXNlcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBjbGllbnQuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKS5jb2xsZWN0aW9uKCdsb2dpbl9pbmZvJykuZGVsZXRlT25lKHsgX2lkOiBkYXRhLm1zc3YgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh1c2VyX2luZm9fY2hlY2spIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgY2xpZW50LmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcykuY29sbGVjdGlvbigndXNlcl9pbmZvJykuZGVsZXRlT25lKHsgX2lkOiBkYXRhLm1zc3YgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIMSQxINuZyBuaOG6rXAga2jDtG5nIHRow6BuaCBjw7RuZ1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg0MDMpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh1c2VyLl9pZCA9PT0gZGF0YS5tc3N2ICYmIGNvbXBhcmVQYXNzd29yZChkYXRhLnBhc3N3b3JkLCB1c2VyLnBhc3N3b3JkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBzZWFzaW9uSURzID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdzZXNzaW9uc19tYW5hZ2VyJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmRPbmUoeyBfaWQ6IGRhdGEubXNzdiB9KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoc2Vhc2lvbklEcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWFzaW9uSURzID0gc2Vhc2lvbklEcy5zZXNzaW9uSWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nRG9jcyA9IGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdzZXNzaW9ucycpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZmluZCh7IF9pZDogeyAkaW46IHNlYXNpb25JRHMgfSB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRvQXJyYXkoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdJRHMgPSBleGlzdGluZ0RvY3MubWFwKChkb2MpID0+IGRvYy5faWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpZHNUb0RlbGV0ZSA9IHNlYXNpb25JRHMuZmlsdGVyKChpZCkgPT4gIWV4aXN0aW5nSURzLmluY2x1ZGVzKGlkKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZHNUb0RlbGV0ZS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdzZXNzaW9uc19tYW5hZ2VyJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudXBkYXRlT25lKHsgX2lkOiBkYXRhLm1zc3YgfSwgeyAkcHVsbDogeyBzZXNzaW9uSWQ6IHsgJGluOiBpZHNUb0RlbGV0ZSB9IH0gfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGdldCB1c2VyIGNsYXNzKGNscyksIHBvd2VyIGFuZCBkZXBhcnRtZW50KGRlcClcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjbHMgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ3VzZXJfaW5mbycpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kT25lKHsgX2lkOiBkYXRhLm1zc3YgfSwgeyBwcm9qZWN0aW9uOiB7IF9pZDogMCwgY2xhc3M6IDEsIHBvd2VyOiAxLCBkZXA6IDEgfSB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjbHMucG93ZXJbMl0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYnJhbmNoID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ2NsYXNzZXMnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmRPbmUoeyBfaWQ6IGNscy5jbGFzc1swXSB9LCB7IHByb2plY3Rpb246IHsgX2lkOiAwLCBicmFuY2g6IDEgfSB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJyYW5jaCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZGVwID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbignYnJhbmNocycpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmRPbmUoeyBfaWQ6IGJyYW5jaC5icmFuY2ggfSwgeyBwcm9qZWN0aW9uOiB7IF9pZDogMCwgZGVwOiAxIH0gfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlci5kZXAgPSBkZXAuZGVwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXIuY2xzID0gY2xzLmNsYXNzO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXIuZGVwID0gY2xzLmRlcDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlci5wb3cgPSBjbHMucG93ZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gxJDEg25nIG5o4bqtcCB0aMOgbmggY8O0bmcsIGzGsHUgdGjDtG5nIHRpbiBuZ8aw4budaSBkw7luZyB2w6BvIHBoacOqblxyXG4gICAgICAgICAgICAgICAgICAgIHJlcS5zZXNzaW9uLnVzZXIgPSB1c2VyO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIEtp4buDbSB0cmEgeGVtIG5nxrDhu51pIGTDuW5nIGPDsyBjaOG7jW4gXCJSZW1lbWJlciBtZVwiIGtow7RuZ1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnJlbWVtYmVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaeG6v3QgbOG6rXAgdGjhu51pIGdpYW4gc+G7kW5nIGNvb2tpZSBsw6J1IGjGoW4gxJHhu4MgbMawdSB0aMO0bmcgdGluIMSRxINuZyBuaOG6rXAgdHJvbmcgMzAgbmfDoHlcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxLnNlc3Npb24uY29va2llLm1heEFnZSA9IDMwICogMjQgKiA2MCAqIDYwICogMTAwMDsgLy8gMzAgZGF5c1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaeG6v3QgbOG6rXAgdGjhu51pIGdpYW4gc+G7kW5nIGNvb2tpZSBs4bqhaSB24buBIG3hurdjIMSR4buLbmggKDEgZ2nhu50pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcS5zZXNzaW9uLmNvb2tpZS5tYXhBZ2UgPSAzNjAwMDAwOyAvLyAxIGhvdXJcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2Vzc2lvbklkID0gcmVxLnNlc3Npb24uaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdzZXNzaW9uc19tYW5hZ2VyJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnVwZGF0ZU9uZSh7IF9pZDogdXNlci5faWQgfSwgeyAkcHVzaDogeyBzZXNzaW9uSWQ6IHNlc3Npb25JZCB9IH0sIHsgdXBzZXJ0OiB0cnVlIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAodXNlci5maXJzdCA9PSAnbmV3X3VzZXInKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7IGNoZWNrOiB0cnVlIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7IGNoZWNrOiBmYWxzZSB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIMSQxINuZyBuaOG6rXAga2jDtG5nIHRow6BuaCBjw7RuZ1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg0MDMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zZW5kU3RhdHVzKDQwNCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1NZU1RFTSB8IExPR19JTiB8IEVSUk9SIHwgJywgZXJyKTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zZW5kU3RhdHVzKDUwMCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gTG9nb3V0IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgcm91dGVyLmdldCgnL2xvZ291dCcsIGNoZWNrSWZVc2VyTG9naW5BUEksIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgICAgIC8vIFjDs2EgdGjDtG5nIHRpbiBwaGnDqm4gKHNlc3Npb24pIGPhu6dhIG5nxrDhu51pIGTDuW5nXHJcbiAgICAgICAgY29uc3QgbXNzdiA9IHJlcS5zZXNzaW9uLnVzZXIuX2lkO1xyXG4gICAgICAgIHJlcS5zZXNzaW9uLmRlc3Ryb3koKGVycikgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnU1lTVEVNIHwgTE9HX09VVCB8IEZhaWxlZCB0byBsb2dvdXQ6JywgZXJyKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg1MDApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbGV0IHNlYXNpb25JRHM7XHJcbiAgICAgICAgICAgICAgICBhc3luYyBmdW5jdGlvbiBwcm9jZXNzU2Vzc2lvbklEcygpIHtcclxuICAgICAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWFzaW9uSURzID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ3Nlc3Npb25zX21hbmFnZXInKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmRPbmUoeyBfaWQ6IG1zc3YgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWFzaW9uSURzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWFzaW9uSURzID0gc2Vhc2lvbklEcy5zZXNzaW9uSWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBleGlzdGluZ0RvY3MgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdzZXNzaW9ucycpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQoeyBfaWQ6IHsgJGluOiBzZWFzaW9uSURzIH0gfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudG9BcnJheSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdJRHMgPSBleGlzdGluZ0RvY3MubWFwKChkb2MpID0+IGRvYy5faWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaWRzVG9EZWxldGUgPSBzZWFzaW9uSURzLmZpbHRlcigoaWQpID0+ICFleGlzdGluZ0lEcy5pbmNsdWRlcyhpZCkpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZHNUb0RlbGV0ZS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdzZXNzaW9uc19tYW5hZ2VyJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnVwZGF0ZU9uZSh7IF9pZDogbXNzdiB9LCB7ICRwdWxsOiB7IHNlc3Npb25JZDogeyAkaW46IGlkc1RvRGVsZXRlIH0gfSB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5yZWRpcmVjdCgnL2xvZ2luJyk7IC8vIENo4bqheSBow6BtIGTGsOG7m2kgc2F1IGtoaSDEkcOjIHjhu60gbMO9IHhvbmdcclxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnU1lTVEVNIHwgTE9HX09VVCB8IEZhaWxlZCB0byBjbGVhbiB1cCBzZXNzaW9uczonLCBlcnJvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg1MDApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBwcm9jZXNzU2Vzc2lvbklEcygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyDEkMSDbmcgeHXhuqV0IHThuqV0IGPhuqMgdGhp4bq/dCBi4buLXHJcbiAgICByb3V0ZXIuZ2V0KCcvbG9nb3V0QWxsZGV2aWNlJywgY2hlY2tJZlVzZXJMb2dpbkFQSSwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgLy8gWMOzYSB0aMO0bmcgdGluIHBoacOqbiAoc2Vzc2lvbikgY+G7p2EgbmfGsOG7nWkgZMO5bmdcclxuICAgICAgICBjb25zdCBfaWQgPSByZXEuc2Vzc2lvbi51c2VyLl9pZDtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjbGllbnQuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKS5jb2xsZWN0aW9uKCdzZXNzaW9uc19tYW5hZ2VyJykuZmluZE9uZSh7IF9pZDogX2lkIH0pO1xyXG4gICAgICAgIGNvbnN0IGxpc3RTZWFzaW9uSWQgPSByZXN1bHQuc2Vzc2lvbklkO1xyXG4gICAgICAgIGxpc3RTZWFzaW9uSWQuc3BsaWNlKGxpc3RTZWFzaW9uSWQuaW5kZXhPZihyZXEuc2Vzc2lvbi5pZCksIDEpO1xyXG4gICAgICAgIGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAuY29sbGVjdGlvbignc2Vzc2lvbnNfbWFuYWdlcicpXHJcbiAgICAgICAgICAgIC51cGRhdGVPbmUoXHJcbiAgICAgICAgICAgICAgICB7IF9pZDogX2lkIH0sXHJcblxyXG4gICAgICAgICAgICAgICAgeyAkcHVsbDogeyBzZXNzaW9uSWQ6IHsgJG5lOiByZXEuc2Vzc2lvbi5pZCB9IH0gfSxcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ3Nlc3Npb25zJylcclxuICAgICAgICAgICAgLmRlbGV0ZU1hbnkoeyBfaWQ6IHsgJGluOiBsaXN0U2Vhc2lvbklkIH0gfSk7XHJcbiAgICAgICAgd3NzLmNsaWVudHMuZm9yRWFjaCgod3MpID0+IHtcclxuICAgICAgICAgICAgaWYgKGxpc3RTZWFzaW9uSWQuaW5jbHVkZXMod3MuaWQpKSB7XHJcbiAgICAgICAgICAgICAgICB3cy5zZW5kKCdyZWxvYWQnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cygyMDApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gxJDhu5VpIHRow7RuZyB0aW4gbmfGsOG7nWkgZMO5bmcgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIHJvdXRlci5wb3N0KCcvdXBkYXRlSW5mbycsIGNoZWNrSWZVc2VyTG9naW5BUEksIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSByZXEuYm9keTtcclxuICAgICAgICAgICAgYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ3VzZXJfaW5mbycpXHJcbiAgICAgICAgICAgICAgICAudXBkYXRlT25lKFxyXG4gICAgICAgICAgICAgICAgICAgIHsgX2lkOiByZXEuc2Vzc2lvbi51c2VyLl9pZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNldDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheU5hbWU6IGRhdGEuZGlzcGxheU5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdnQ6IGRhdGEuYXZ0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoMjAwKTtcclxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1NZU1RFTSB8IFVQREFURV9JTkZPIHwgRVJST1IgfCAnLCBlcnIpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNTAwKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBSZXNldCBwYXNzIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgcm91dGVyLnBvc3QoJy9yZXNldHBhc3N3b3JkJywgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgZGF0YSA9IHJlcS5ib2R5O1xyXG4gICAgICAgICAgICBjb25zdCBPVFAgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAuY29sbGVjdGlvbignT1RQJylcclxuICAgICAgICAgICAgICAgIC5maW5kT25lKHsgX2lkOiBkYXRhLm1zc3YgfSwgeyBwcm9qZWN0aW9uOiB7IF9pZDogMCB9IH0pO1xyXG4gICAgICAgICAgICBpZiAoT1RQICYmIGNvbXBhcmVQYXNzd29yZChkYXRhLm90cCwgT1RQLm90cGNvZGUpKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdsb2dpbl9pbmZvJylcclxuICAgICAgICAgICAgICAgICAgICAudXBkYXRlT25lKHsgX2lkOiBkYXRhLm1zc3YgfSwgeyAkc2V0OiB7IGZpcnN0OiAnb3RwJyB9IH0pO1xyXG4gICAgICAgICAgICAgICAgLy8obG9nIGluIGRhdGFiYXNlKVxyXG4gICAgICAgICAgICAgICAgbGV0IHVzZXIgPSBhd2FpdCBjbGllbnQuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKS5jb2xsZWN0aW9uKCdsb2dpbl9pbmZvJykuZmluZE9uZSh7IF9pZDogZGF0YS5tc3N2IH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgY2xpZW50LmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcykuY29sbGVjdGlvbignT1RQJykuZGVsZXRlT25lKHsgX2lkOiBkYXRhLm1zc3YgfSk7XHJcbiAgICAgICAgICAgICAgICBsZXQgc2Vhc2lvbklEcyA9IGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ3Nlc3Npb25zX21hbmFnZXInKVxyXG4gICAgICAgICAgICAgICAgICAgIC5maW5kT25lKHsgX2lkOiBkYXRhLm1zc3YgfSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2Vhc2lvbklEcykge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlYXNpb25JRHMgPSBzZWFzaW9uSURzLnNlc3Npb25JZDtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBleGlzdGluZ0RvY3MgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ3Nlc3Npb25zJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQoeyBfaWQ6IHsgJGluOiBzZWFzaW9uSURzIH0gfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnRvQXJyYXkoKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBleGlzdGluZ0lEcyA9IGV4aXN0aW5nRG9jcy5tYXAoKGRvYykgPT4gZG9jLl9pZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaWRzVG9EZWxldGUgPSBzZWFzaW9uSURzLmZpbHRlcigoaWQpID0+ICFleGlzdGluZ0lEcy5pbmNsdWRlcyhpZCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpZHNUb0RlbGV0ZS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdzZXNzaW9uc19tYW5hZ2VyJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC51cGRhdGVPbmUoeyBfaWQ6IGRhdGEubXNzdiB9LCB7ICRwdWxsOiB7IHNlc3Npb25JZDogeyAkaW46IGlkc1RvRGVsZXRlIH0gfSB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gZ2V0IHVzZXIgY2xhc3MoY2xzKSwgcG93ZXIgYW5kIGRlcGFydG1lbnQoZGVwKVxyXG4gICAgICAgICAgICAgICAgY29uc3QgY2xzID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbigndXNlcl9pbmZvJylcclxuICAgICAgICAgICAgICAgICAgICAuZmluZE9uZSh7IF9pZDogZGF0YS5tc3N2IH0sIHsgcHJvamVjdGlvbjogeyBfaWQ6IDAsIGNsYXNzOiAxLCBwb3dlcjogMSwgZGVwOiAxIH0gfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKCFjbHMucG93ZXJbMl0pIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBicmFuY2ggPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ2NsYXNzZXMnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZmluZE9uZSh7IF9pZDogY2xzLmNsYXNzWzBdIH0sIHsgcHJvamVjdGlvbjogeyBfaWQ6IDAsIGJyYW5jaDogMSB9IH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChicmFuY2gpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZGVwID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ2JyYW5jaHMnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmRPbmUoeyBfaWQ6IGJyYW5jaC5icmFuY2ggfSwgeyBwcm9qZWN0aW9uOiB7IF9pZDogMCwgZGVwOiAxIH0gfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VyLmRlcCA9IGRlcC5kZXA7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHVzZXIuY2xzID0gY2xzLmNsYXNzO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB1c2VyLmRlcCA9IGNscy5kZXA7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB1c2VyLnBvdyA9IGNscy5wb3dlcjtcclxuICAgICAgICAgICAgICAgIC8vIMSQxINuZyBuaOG6rXAgdGjDoG5oIGPDtG5nLCBsxrB1IHRow7RuZyB0aW4gbmfGsOG7nWkgZMO5bmcgdsOgbyBwaGnDqm5cclxuICAgICAgICAgICAgICAgIHJlcS5zZXNzaW9uLnVzZXIgPSB1c2VyO1xyXG4gICAgICAgICAgICAgICAgLy8gS2nhu4NtIHRyYSB4ZW0gbmfGsOG7nWkgZMO5bmcgY8OzIGNo4buNbiBcIlJlbWVtYmVyIG1lXCIga2jDtG5nXHJcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5yZW1lbWJlcikge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFRoaeG6v3QgbOG6rXAgdGjhu51pIGdpYW4gc+G7kW5nIGNvb2tpZSBsw6J1IGjGoW4gxJHhu4MgbMawdSB0aMO0bmcgdGluIMSRxINuZyBuaOG6rXAgdHJvbmcgMzAgbmfDoHlcclxuICAgICAgICAgICAgICAgICAgICByZXEuc2Vzc2lvbi5jb29raWUubWF4QWdlID0gMzAgKiAyNCAqIDYwICogNjAgKiAxMDAwOyAvLyAzMCBkYXlzXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFRoaeG6v3QgbOG6rXAgdGjhu51pIGdpYW4gc+G7kW5nIGNvb2tpZSBs4bqhaSB24buBIG3hurdjIMSR4buLbmggKDEgZ2nhu50pXHJcbiAgICAgICAgICAgICAgICAgICAgcmVxLnNlc3Npb24uY29va2llLm1heEFnZSA9IDM2MDAwMDA7IC8vIDEgaG91clxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3Qgc2Vzc2lvbklkID0gcmVxLnNlc3Npb24uaWQ7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdzZXNzaW9uc19tYW5hZ2VyJylcclxuICAgICAgICAgICAgICAgICAgICAudXBkYXRlT25lKHsgX2lkOiB1c2VyLl9pZCB9LCB7ICRwdXNoOiB7IHNlc3Npb25JZDogc2Vzc2lvbklkIH0gfSwgeyB1cHNlcnQ6IHRydWUgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoMjAwKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJlcy5zZW5kU3RhdHVzKDQwMyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1NZU1RFTSB8IFJFU0VUX1BBU1NXT1JEIHwgRVJST1IgfCAnLCBlcnIpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNTAwKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBSZXNlbnQgT1RQIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgcm91dGVyLnBvc3QoJy9yZXNlbmRvdHAnLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCBtc3N2ID0gcmVxLmJvZHkubXNzdjtcclxuICAgICAgICAgICAgY29uc3QgZGF0YVVzZXIgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAuY29sbGVjdGlvbigndXNlcl9pbmZvJylcclxuICAgICAgICAgICAgICAgIC5maW5kT25lKHsgX2lkOiBtc3N2IH0sIHsgcHJvamVjdGlvbjogeyBfaWQ6IDAsIGVtYWlsOiAxIH0gfSk7XHJcbiAgICAgICAgICAgIC8vIFRow6ptIHTDoGkgbGnhu4d1IG3hu5tpIGPDsyB0aOG7nWkgZ2lhbiBo4bq/dCBo4bqhbiBzYXUgMSBwaMO6dFxyXG4gICAgICAgICAgICBjb25zdCBPVFBzY29kZSA9IGF3YWl0IHJhbmRvbVBhc3N3b3JkKCk7XHJcbiAgICAgICAgICAgIGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdPVFAnKVxyXG4gICAgICAgICAgICAgICAgLnVwZGF0ZU9uZShcclxuICAgICAgICAgICAgICAgICAgICB7IF9pZDogbXNzdiB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNldDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3RwY29kZTogaGFzaFBhc3N3b3JkKE9UUHNjb2RlKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGlyZUF0OiBuZXcgRGF0ZShEYXRlLm5vdygpICsgNjAgKiA1ICogMTAwMCksIC8vIEjhur90IGjhuqFuIHNhdSA1IHBow7p0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICB7IHVwc2VydDogdHJ1ZSB9LFxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgaWYgKGRhdGFVc2VyKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlbWFpbCA9IGRhdGFVc2VyLmVtYWlsO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgc2VuZEVtYWlsKE9UUHNjb2RlLCBlbWFpbCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zZW5kU3RhdHVzKDIwMCk7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTWVNURU0gfCBSRVNFTkRfT1RQIHwgRVJST1IgfCAnLCBlcnIpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNTAwKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyDEkOG7lWkgcGFzcyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIHJvdXRlci5wb3N0KCcvY2hhbmdlX3Bhc3MnLCBjaGVja0lmVXNlckxvZ2luQVBJLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCBkYXRhID0gcmVxLmJvZHk7XHJcbiAgICAgICAgICAgIGNvbnN0IG9sZF9wYXNzID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ2xvZ2luX2luZm8nKVxyXG4gICAgICAgICAgICAgICAgLmZpbmRPbmUoeyBfaWQ6IHJlcS5zZXNzaW9uLnVzZXIuX2lkIH0sIHsgcHJvamVjdGlvbjogeyBfaWQ6IDAsIHBhc3N3b3JkOiAxIH0gfSk7XHJcbiAgICAgICAgICAgIGlmIChjb21wYXJlUGFzc3dvcmQoZGF0YS5vbGRfcGFzc3dvcmQsIG9sZF9wYXNzLnBhc3N3b3JkKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFjb21wYXJlUGFzc3dvcmQoZGF0YS5uZXdfcGFzc3dvcmQsIG9sZF9wYXNzLnBhc3N3b3JkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbignbG9naW5faW5mbycpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC51cGRhdGVPbmUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IF9pZDogcmVxLnNlc3Npb24udXNlci5faWQgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgJHNldDogeyBwYXNzd29yZDogaGFzaFBhc3N3b3JkKGRhdGEubmV3X3Bhc3N3b3JkKSB9IH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zZW5kU3RhdHVzKDIwMCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg0MDMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmVzLnNlbmRTdGF0dXMoNDA0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnU1lTVEVNIHwgQ0hBTkdFX1BBU1NXT1JEIHwgRVJST1IgfCAnLCBlcnIpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNTAwKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyDEkOG7lWkgcGFzcyBs4bqnbiDEkeG6p3UgxJHEg25nIG5o4bqtcCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICByb3V0ZXIucG9zdCgnL2ZpcnN0X2xvZ2luJywgY2hlY2tJZlVzZXJMb2dpbkFQSSwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgZGF0YSA9IHJlcS5ib2R5O1xyXG4gICAgICAgICAgICBjb25zdCBvbGRfcGFzcyA9IGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdsb2dpbl9pbmZvJylcclxuICAgICAgICAgICAgICAgIC5maW5kT25lKHsgX2lkOiByZXEuc2Vzc2lvbi51c2VyLl9pZCB9LCB7IHByb2plY3Rpb246IHsgX2lkOiAwLCBwYXNzd29yZDogMSB9IH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKGNvbXBhcmVQYXNzd29yZChkYXRhLm5ld19wYXNzd29yZCwgb2xkX3Bhc3MucGFzc3dvcmQpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNDAzKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGRlbGV0ZSByZXEuc2Vzc2lvbi51c2VyLmZpcnN0O1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbignbG9naW5faW5mbycpXHJcbiAgICAgICAgICAgICAgICAgICAgLnVwZGF0ZU9uZSh7IF9pZDogcmVxLnNlc3Npb24udXNlci5faWQgfSwgeyAkdW5zZXQ6IHsgZmlyc3Q6ICcnIH0gfSk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdsb2dpbl9pbmZvJylcclxuICAgICAgICAgICAgICAgICAgICAudXBkYXRlT25lKHsgX2lkOiByZXEuc2Vzc2lvbi51c2VyLl9pZCB9LCB7ICRzZXQ6IHsgcGFzc3dvcmQ6IGhhc2hQYXNzd29yZChkYXRhLm5ld19wYXNzd29yZCkgfSB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cygyMDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTWVNURU0gfCBDSEFOR0VfUEFTU1dPUkQgfCBFUlJPUiB8ICcsIGVycik7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg1MDApO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8vIFNhdmUgdGFibGUgYW5kIHVwZGF0ZSBvbGQgdGFibGUgc3RkLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICByb3V0ZXIucG9zdCgnL3N0ZF9tYXJrJywgY2hlY2tJZlVzZXJMb2dpbkFQSSwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgdXNlciA9IHJlcS5zZXNzaW9uLnVzZXI7XHJcbiAgICAgICAgICAgIGlmICh1c2VyLnBvd1swXSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IHJlcS5ib2R5O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbWFya2VyID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbigndXNlcl9pbmZvJylcclxuICAgICAgICAgICAgICAgICAgICAuZmluZE9uZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgeyBfaWQ6IHVzZXIuX2lkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2plY3Rpb246IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaWQ6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdF9uYW1lOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0X25hbWU6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgbWFya2VkID0gYXdhaXQgbWFyaygnX3N0ZF90YWJsZScsIHVzZXIsIHVzZXIuX2lkLCBkYXRhLCBtYXJrZXIsIHVzZXIuY2xzWzBdKTtcclxuXHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKG1hcmtlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zZW5kU3RhdHVzKDIwMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoMjAzKTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cygyMDUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zZW5kU3RhdHVzKDQwMyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1NZU1RFTSB8IFNURF9NQVJLIHwgRVJST1IgfCAnLCBlcnIpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNTAwKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBTYXZlIHRhYmxlIGFuZCB1cGRhdGUgb2xkIHRhYmxlIHN0Zi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgcm91dGVyLnBvc3QoJy9zdGZfbWFyaycsIGNoZWNrSWZVc2VyTG9naW5BUEksIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgICAgIGNvbnN0IHVzZXIgPSByZXEuc2Vzc2lvbi51c2VyO1xyXG4gICAgICAgIGlmICh1c2VyLnBvd1sxXSkge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IHJlcS5ib2R5O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbWFya2VyID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbigndXNlcl9pbmZvJylcclxuICAgICAgICAgICAgICAgICAgICAuZmluZE9uZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgeyBfaWQ6IHVzZXIuX2lkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2plY3Rpb246IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaWQ6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdF9uYW1lOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0X25hbWU6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgbWFya2VkID0gYXdhaXQgbWFyaygnX3N0Zl90YWJsZScsIHVzZXIsIGRhdGEubXNzdiwgZGF0YSwgbWFya2VyLCBkYXRhLmNsYXNzKTtcclxuXHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKG1hcmtlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zZW5kU3RhdHVzKDIwMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoMjAzKTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cygyMDUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTWVNURU0gfCBTVEZfTUFSSyB8IEVSUk9SIHwgJywgZXJyKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg1MDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIGlmICh1c2VyLnBvd1s0XSkge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IHJlcS5ib2R5O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbWFya2VyID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbigndXNlcl9pbmZvJylcclxuICAgICAgICAgICAgICAgICAgICAuZmluZE9uZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgeyBfaWQ6IHVzZXIuX2lkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2plY3Rpb246IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaWQ6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdF9uYW1lOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0X25hbWU6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgbWFya2VkID0gYXdhaXQgbWFyaygnX3N0Zl90YWJsZScsIHVzZXIsIGRhdGEubXNzdiwgZGF0YSwgbWFya2VyLCB1c2VyLmNsc1swXSk7XHJcblxyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChtYXJrZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cygyMDApO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zZW5kU3RhdHVzKDIwMyk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoMjA1KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnU1lTVEVNIHwgU1RGX01BUksgfCBFUlJPUiB8ICcsIGVycik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNTAwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg0MDMpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8vIFNhdmUgdGFibGUgYW5kIHVwZGF0ZSBvbGQgdGFibGUgZGVwLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICByb3V0ZXIucG9zdCgnL2RlcF9tYXJrJywgY2hlY2tJZlVzZXJMb2dpbkFQSSwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgY29uc3QgdXNlciA9IHJlcS5zZXNzaW9uLnVzZXI7XHJcbiAgICAgICAgaWYgKHVzZXIucG93WzJdKSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gcmVxLmJvZHk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBtYXJrZXIgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCd1c2VyX2luZm8nKVxyXG4gICAgICAgICAgICAgICAgICAgIC5maW5kT25lKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7IF9pZDogdXNlci5faWQgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvamVjdGlvbjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0X25hbWU6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RfbmFtZTogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBtYXJrZWQgPSBhd2FpdCBtYXJrKCdfZGVwX3RhYmxlJywgdXNlciwgZGF0YS5tc3N2LCBkYXRhLCBtYXJrZXIsIGRhdGEuY2xhc3MpO1xyXG5cclxuICAgICAgICAgICAgICAgIHN3aXRjaCAobWFya2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoMjAwKTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cygyMDMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cygyMDApO1xyXG4gICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTWVNURU0gfCBTVEZfTUFSSyB8IEVSUk9SIHwgJywgZXJyKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg1MDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zZW5kU3RhdHVzKDQwMyk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gVXBsb2FkIGZpbGUgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIHJvdXRlci5wb3N0KCcvdXBsb2FkRmlsZScsIHVwbG9hZC5hcnJheSgnZmlsZXNbXScpLCBjaGVja0lmVXNlckxvZ2luQVBJLCBhc3luYyBmdW5jdGlvbiAocmVxLCByZXMpIHtcclxuICAgICAgICBpZiAoIXJlcS5maWxlcykge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoJ05vIGZpbGUgdXBsb2FkZWQuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBsaXN0X25hbWUgPSBbXTtcclxuICAgICAgICBsZXQgbGlzdF9kZXAgPSBbXTtcclxuICAgICAgICAvLyBLaeG7g20gdHJhIGtp4buDdSBk4buvIGxp4buHdSBj4bunYSBjw6FjIHThu4dwXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZXEuZmlsZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgY29uc3QgZmlsZU5hbWUgPSByZXEuZmlsZXNbaV0ub3JpZ2luYWxuYW1lO1xyXG4gICAgICAgICAgICBjb25zdCBmaWxlRGVzY3JpcHRpb24gPSByZXEuYm9keS5kZXNjcmlwdHNbaV07IC8vIFRyw61jaCB4deG6pXQgbcO0IHThuqMgdMawxqFuZyDhu6luZyB04burIGRhbmggc8OhY2ggZGVzY3JpcHRzW11cclxuICAgICAgICAgICAgbGlzdF9kZXAucHVzaChmaWxlRGVzY3JpcHRpb24pO1xyXG4gICAgICAgICAgICBsaXN0X25hbWUucHVzaChmaWxlTmFtZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBY4butIGzDvSBjw6FjIHThu4dwIMSRw6MgdOG6o2kgbMOqbiDhu58gxJHDonlcclxuICAgICAgICByZXMud3JpdGVIZWFkKDIwMCwgeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2FpdG9uL2pzb24nIH0pO1xyXG4gICAgICAgIHJldHVybiByZXMuZW5kKEpTT04uc3RyaW5naWZ5KGF3YWl0IGdldF9mdWxsX2lkKHVwbG9hZERpcmVjdG9yeSwgbGlzdF9uYW1lLCBsaXN0X2RlcCkpKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIENyZWF0ZSBuZXcgYWNjb3VudCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgcm91dGVyLnBvc3QoJy9jcmVhdGVBY2NvdW50JywgdXBsb2FkLnNpbmdsZSgnZmlsZScpLCBjaGVja0lmVXNlckxvZ2luQVBJLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICAgICAgICBjb25zdCB1c2VyID0gcmVxLnNlc3Npb24udXNlcjtcclxuICAgICAgICBjb25zdCBkdW1teVNjb3JlID0ge1xyXG4gICAgICAgICAgICBmaXJzdDogWzAsIDAsIDAsIDAsIDBdLFxyXG4gICAgICAgICAgICBzZWNvbmQ6IFswLCAwXSxcclxuICAgICAgICAgICAgdGhpcmQ6IFswLCAwLCAwXSxcclxuICAgICAgICAgICAgZm91cnRoOiBbMCwgMCwgMF0sXHJcbiAgICAgICAgICAgIGZpZnRoOiBbMCwgMCwgMCwgMF0sXHJcbiAgICAgICAgICAgIGltZ19pZHM6IFtdLFxyXG4gICAgICAgICAgICB0b3RhbDogMCxcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBpZiAodXNlci5wb3dbNF0gfHwgdXNlci5wb3dbN10pIHtcclxuICAgICAgICAgICAgY29uc3QgZmlsZVN0dWRlbnRzID0gcmVxLmZpbGU7XHJcbiAgICAgICAgICAgIGFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlRW1haWwoc3RyKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgczEgPVxyXG4gICAgICAgICAgICAgICAgICAgICfDgMOBw4LDg8OIw4nDisOMw43DksOTw5TDlcOZw5rDncOgw6HDosOjw6jDqcOqw6zDrcOyw7PDtMO1w7nDusO9xILEg8SQxJHEqMSpxajFqcagxqHGr8aw4bqg4bqh4bqi4bqj4bqk4bql4bqm4bqn4bqo4bqp4bqq4bqr4bqs4bqt4bqu4bqv4bqw4bqx4bqy4bqz4bq04bq14bq24bq34bq44bq54bq64bq74bq84bq94bq+4bq/4buA4buB4buC4buD4buE4buF4buG4buH4buI4buJ4buK4buL4buM4buN4buO4buP4buQ4buR4buS4buT4buU4buV4buW4buX4buY4buZ4bua4bub4buc4bud4bue4buf4bug4buh4bui4buj4buk4bul4bum4bun4buo4bup4buq4bur4bus4but4buu4buv4buw4bux4buy4buz4bu04bu14bu24bu34bu44bu5JztcclxuICAgICAgICAgICAgICAgIGxldCBzMCA9XHJcbiAgICAgICAgICAgICAgICAgICAgJ0FBQUFFRUVJSU9PT09VVVlhYWFhZWVlaWlvb29vdXV5QWFEZElpVXVPb1V1QWFBYUFhQWFBYUFhQWFBYUFhQWFBYUFhRWVFZUVlRWVFZUVlRWVFZUVlSWlJaU9vT29Pb09vT29Pb09vT29Pb09vT29VdVV1VXVVdVV1VXVVdVl5WXlZeVl5JztcclxuICAgICAgICAgICAgICAgIGxldCBuZXdTdHIgPSAnJztcclxuICAgICAgICAgICAgICAgIGxldCBsaXN0U3BhY2UgPSBbXTtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHMxLmluZGV4T2Yoc3RyW2ldKSAhPSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdTdHIgKz0gczBbczEuaW5kZXhPZihzdHJbaV0pXTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdTdHIgKz0gc3RyW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoc3RyW2ldID09ICcgJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsaXN0U3BhY2UucHVzaChpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBsZXQgb3V0cHV0ID0gbmV3U3RyWzBdO1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaXN0U3BhY2UubGVuZ3RoIC0gMjsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0ICs9IG5ld1N0ci5jaGFyQXQobGlzdFNwYWNlW2ldICsgMSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBvdXRwdXQgKz0gbmV3U3RyLnNsaWNlKGxpc3RTcGFjZVtsaXN0U3BhY2UubGVuZ3RoIC0gMl0gKyAxKS5yZXBsYWNlKC9cXHMvZywgJycpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG91dHB1dC50b0xvd2VyQ2FzZSgpICsgJ0BzdHVkZW50LmN0dWV0LmVkdS52bic7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChmaWxlU3R1ZGVudHMpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHdvcmtib29rID0gYXdhaXQgWGxzeFBvcHVsYXRlLmZyb21GaWxlQXN5bmMoZmlsZVN0dWRlbnRzLnBhdGgpO1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc2hlZXQgPSB3b3JrYm9vay5zaGVldCgwKTtcclxuICAgICAgICAgICAgICAgIC8vIGNvbnN0IHNoZWV0Q291bnQgPSB3b3JrYm9vay5zaGVldENvdW50KCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZXMgPSBzaGVldC51c2VkUmFuZ2UoKS52YWx1ZSgpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdXNlZFJhbmdlID0gc2hlZXQudXNlZFJhbmdlKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgZXhwZWN0ZWRWYWx1ZXMgPSBbJ01TU1YnLCAnSOG7jCcsICdUw4pOJ107XHJcbiAgICAgICAgICAgICAgICAvLyBjb25zdCBjb2x1bW5Db3VudCA9IGV4cGVjdGVkVmFsdWVzLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgIGxldCBpc0NvcnJlY3QgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZW5kQ2VsbCA9IHVzZWRSYW5nZS5lbmRDZWxsKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByb3dDb3VudCA9IGVuZENlbGwucm93TnVtYmVyKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjb2x1bW5Db3VudCA9IDM7XHJcblxyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgY29sdW1uID0gMTsgY29sdW1uIDw9IGNvbHVtbkNvdW50OyBjb2x1bW4rKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNlbGwgPSBzaGVldC5jZWxsKDEsIGNvbHVtbik7IC8vIMOUIMSR4bqndSB0acOqbiB0csOqbiBow6BuZyAxIHbDoCBj4buZdCBjb2x1bW5cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGNlbGwudmFsdWUoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlICE9PSBleHBlY3RlZFZhbHVlc1tjb2x1bW4gLSAxXSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpc0NvcnJlY3QgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChpc0NvcnJlY3QpIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgaGF2ZXZhbHVlID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgcm93ID0gMjsgcm93IDw9IDU7IHJvdysrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBoYXNWYWx1ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBjb2x1bW4gPSAxOyBjb2x1bW4gPD0gY29sdW1uQ291bnQ7IGNvbHVtbisrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjZWxsID0gc2hlZXQuY2VsbChyb3csIGNvbHVtbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGNlbGwudmFsdWUoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNWYWx1ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoYXNWYWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXZldmFsdWUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChoYXZldmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcS5ib2R5LnN0YXR1cyA9PSAndHJ1ZScpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVhZCBleGNlbCBmaWxlOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSBhbGwgYWNjb3VudFxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbWF4V2lkdGhFbWFpbCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9bWydNU1NWJywgJ0jhu40nLCAnVMOqbicgXV1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGVldC5jZWxsKCdEMScpLnZhbHVlKCdFbWFpbCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoZWV0LmNlbGwoJ0UxJykudmFsdWUoJ1Bhc3N3b3JkJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0YVJvd3MgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHZhbHVlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcHcgPSBhd2FpdCByYW5kb21QYXNzd29yZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZW1haWwgPSBhd2FpdCBnZW5lcmF0ZUVtYWlsKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYCR7dmFsdWVzW2ldWzFdLnRvU3RyaW5nKCl9ICR7dmFsdWVzW2ldWzJdLnRvU3RyaW5nKCl9ICR7dmFsdWVzW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF1bMF0udG9TdHJpbmcoKX1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZGF0YUluc2VydFVzZXIgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaWQ6IHZhbHVlc1tpXVswXS50b1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RfbmFtZTogdmFsdWVzW2ldWzJdLnRvU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0X25hbWU6IHZhbHVlc1tpXVsxXS50b1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXZ0OiAnaHR0cHM6Ly9pLnBpbmltZy5jb20vMjM2eC84OS8wOC8zYi84OTA4M2JiYTQwNTQ1YTcyZmExNTMyMWFmNWZhYjc2MC0tY2hpYmktZ2lybC16ZXJvLmpwZycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3dlcjogeyAwOiB0cnVlIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzczogW3JlcS5ib2R5LmNsc10sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZTogYCR7dmFsdWVzW2ldWzFdLnRvU3RyaW5nKCl9ICR7dmFsdWVzW2ldWzJdLnRvU3RyaW5nKCl9YCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtYWlsOiBlbWFpbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsX3Njb3JlOiB7fSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGRhdGFJbnNlcnRMb2dpbiA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogdmFsdWVzW2ldWzBdLnRvU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzd29yZDogaGFzaFBhc3N3b3JkKHB3KSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0OiAnbmV3X3VzZXInLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0YVJvdyA9IFtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFJbnNlcnRVc2VyLl9pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB3LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YUluc2VydFVzZXIubGFzdF9uYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YUluc2VydFVzZXIuZmlyc3RfbmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVJvd3MucHVzaChkYXRhUm93KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsaWVudC5kYignZ2xvYmFsJykuY29sbGVjdGlvbigndXNlcl9pbmZvJykudXBkYXRlT25lKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogZGF0YUluc2VydFVzZXIuX2lkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2V0OiBkYXRhSW5zZXJ0VXNlcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBzZXJ0OiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xpZW50LmRiKCdnbG9iYWwnKS5jb2xsZWN0aW9uKCdsb2dpbl9pbmZvJykudXBkYXRlT25lKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogZGF0YUluc2VydExvZ2luLl9pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNldDogZGF0YUluc2VydExvZ2luLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cHNlcnQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBtYXJrKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ19zdGRfdGFibGUnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFJbnNlcnRVc2VyLl9pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR1bW15U2NvcmUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RfbmFtZTogZGF0YUluc2VydFVzZXIuZmlyc3RfbmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0X25hbWU6IGRhdGFJbnNlcnRVc2VyLmxhc3RfbmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhSW5zZXJ0VXNlci5jbGFzc1swXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgc2hlZXQuY2VsbChgRCR7aSArIDF9YCkudmFsdWUoZW1haWwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBzaGVldC5jZWxsKGBFJHtpICsgMX1gKS52YWx1ZShwdyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJhbmdlID0gc2hlZXQucmFuZ2UoYEQke2kgKyAxfTpFJHtpICsgMX1gKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2Uuc3R5bGUoeyBib3JkZXI6IHRydWUgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbWFpbC5sZW5ndGggPiBtYXhXaWR0aEVtYWlsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhXaWR0aEVtYWlsID0gZW1haWwubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFdyaXRlIHRvIGZpbGUuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hlZXQuY29sdW1uKCdEJykud2lkdGgobWF4V2lkdGhFbWFpbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdXVpZCA9IHV1aWR2NCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHdvcmtib29rLnRvRmlsZUFzeW5jKHBhdGguam9pbignLmRvd25sb2FkcycsIHV1aWQgKyAnLnhsc3gnKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8geG9hIGZpbGUgc2F1IGtoaSB4dSBseVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjaGVkdWxlRmlsZURlbGV0aW9uKHBhdGguam9pbignLmRvd25sb2FkcycsIHV1aWQgKyAnLnhsc3gnKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgd29ya2Jvb2thY2MgPSBhd2FpdCBYbHN4UG9wdWxhdGUuZnJvbUZpbGVBc3luYyhcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJy4vc3JjL2V4Y2VsVGVtcGxhdGUvRklMRV9UQU9fQUNDLnhsc3gnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhUm93cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHdvcmtib29rYWNjLnNoZWV0KDApLmNlbGwoJ0EyJykudmFsdWUoZGF0YVJvd3MpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBvdXRwdXRGaWxlID0gcGF0aC5qb2luKGAuZG93bmxvYWRzLyR7dXVpZH0ueGxzeGApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB3b3JrYm9va2FjYy50b0ZpbGVBc3luYyhvdXRwdXRGaWxlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2hlZHVsZUZpbGVEZWxldGlvbihwYXRoLmpvaW4oJy5kb3dubG9hZHMnLCB1dWlkICsgJy54bHN4JykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXMuZG93bmxvYWQocGF0aC5qb2luKCcuZG93bmxvYWRzJywgdXVpZCArICcueGxzeCcpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTWVNURU0gfCBDUkVBVEVfQUNDT1VOVCB8IEVSUk9SIHwgJywgZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNTAwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVhZCBleGNlbCBmaWxlOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSBhbGwgYWNjb3VudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHdvcmtib29rID0gYXdhaXQgWGxzeFBvcHVsYXRlLmZyb21GaWxlQXN5bmMoZmlsZVN0dWRlbnRzLnBhdGgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNoZWV0ID0gd29ya2Jvb2suc2hlZXQoMCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlcyA9IHNoZWV0LnVzZWRSYW5nZSgpLnZhbHVlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG1heFdpZHRoRW1haWwgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vW1snTVNTVicsICdI4buNJywgJ1TDqm4nIF1dXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hlZXQuY2VsbCgnRDEnKS52YWx1ZSgnRW1haWwnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGVldC5jZWxsKCdFMScpLnZhbHVlKCdQYXNzd29yZCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgdmFsdWVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzdHVkZW50SWRUb0NoZWNrID0gdmFsdWVzW2ldWzBdLnRvU3RyaW5nKCk7IC8vIE3DoyBz4buRIHNpbmggdmnDqm4gY+G6p24ga2nhu4NtIHRyYVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbWFya2VyID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ3VzZXJfaW5mbycpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZmluZE9uZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IF9pZDogc3R1ZGVudElkVG9DaGVjayB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvamVjdGlvbjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2lkOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdF9uYW1lOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RfbmFtZTogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFtYXJrZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBwdyA9IGF3YWl0IHJhbmRvbVBhc3N3b3JkKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZW1haWwgPSBhd2FpdCBnZW5lcmF0ZUVtYWlsKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGAke3ZhbHVlc1tpXVsxXX0gJHt2YWx1ZXNbaV1bMl19ICR7dmFsdWVzW2ldWzBdLnRvU3RyaW5nKCl9YCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZGF0YUluc2VydFVzZXIgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2lkOiB2YWx1ZXNbaV1bMF0udG9TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJzdF9uYW1lOiB2YWx1ZXNbaV1bMl0udG9TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0X25hbWU6IHZhbHVlc1tpXVsxXS50b1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF2dDogJ2h0dHBzOi8vaS5waW5pbWcuY29tLzIzNngvODkvMDgvM2IvODkwODNiYmE0MDU0NWE3MmZhMTUzMjFhZjVmYWI3NjAtLWNoaWJpLWdpcmwtemVyby5qcGcnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvd2VyOiB7IDA6IHRydWUgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzczogW3JlcS5ib2R5LmNsc10sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheU5hbWU6IGAke3ZhbHVlc1tpXVsxXS50b1N0cmluZygpfSAke3ZhbHVlc1tpXVsyXS50b1N0cmluZygpfWAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW1haWw6IGVtYWlsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsX3Njb3JlOiB7fSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZGF0YUluc2VydExvZ2luID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogdmFsdWVzW2ldWzBdLnRvU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzc3dvcmQ6IGhhc2hQYXNzd29yZChwdyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3Q6ICduZXdfdXNlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xpZW50LmRiKCdnbG9iYWwnKS5jb2xsZWN0aW9uKCd1c2VyX2luZm8nKS51cGRhdGVPbmUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaWQ6IGRhdGFJbnNlcnRVc2VyLl9pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNldDogZGF0YUluc2VydFVzZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwc2VydDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsaWVudC5kYignZ2xvYmFsJykuY29sbGVjdGlvbignbG9naW5faW5mbycpLnVwZGF0ZU9uZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogZGF0YUluc2VydExvZ2luLl9pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNldDogZGF0YUluc2VydExvZ2luLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cHNlcnQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBtYXJrKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdfc3RkX3RhYmxlJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFJbnNlcnRVc2VyLl9pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkdW1teVNjb3JlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RfbmFtZTogZGF0YUluc2VydFVzZXIuZmlyc3RfbmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdF9uYW1lOiBkYXRhSW5zZXJ0VXNlci5sYXN0X25hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhSW5zZXJ0VXNlci5jbGFzc1swXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBzaGVldC5jZWxsKGBEJHtpICsgMX1gKS52YWx1ZShlbWFpbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBzaGVldC5jZWxsKGBFJHtpICsgMX1gKS52YWx1ZShwdyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByYW5nZSA9IHNoZWV0LnJhbmdlKGBEJHtpICsgMX06RSR7aSArIDF9YCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5zdHlsZSh7IGJvcmRlcjogdHJ1ZSB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbWFpbC5sZW5ndGggPiBtYXhXaWR0aEVtYWlsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4V2lkdGhFbWFpbCA9IGVtYWlsLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBXcml0ZSB0byBmaWxlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hlZXQuY29sdW1uKCdEJykud2lkdGgobWF4V2lkdGhFbWFpbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB1dWlkID0gdXVpZHY0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB3b3JrYm9vay50b0ZpbGVBc3luYyhwYXRoLmpvaW4oJy5kb3dubG9hZHMnLCB1dWlkICsgJy54bHN4JykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzLmRvd25sb2FkKHBhdGguam9pbignLmRvd25sb2FkcycsIHV1aWQgKyAnLnhsc3gnKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB4b2EgZmlsZSBzYXUga2hpIHh1IGx5XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2hlZHVsZUZpbGVEZWxldGlvbihwYXRoLmpvaW4oJy5kb3dubG9hZHMnLCB1dWlkICsgJy54bHN4JykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1NZU1RFTSB8IENSRUFURV9BQ0NPVU5UIHwgRVJST1IgfCAnLCBlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg1MDApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zZW5kU3RhdHVzKDQwNCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNDA1KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGRhdGFTdHVkZW50ID0gcmVxLmJvZHk7XHJcbiAgICAgICAgICAgICAgICBsZXQgcHcgPSBhd2FpdCByYW5kb21QYXNzd29yZCgpO1xyXG4gICAgICAgICAgICAgICAgbGV0IGVtYWlsID0gYXdhaXQgZ2VuZXJhdGVFbWFpbChcclxuICAgICAgICAgICAgICAgICAgICBgJHtkYXRhU3R1ZGVudFsnaG8nXX0gJHtkYXRhU3R1ZGVudFsndGVuJ119ICR7ZGF0YVN0dWRlbnRbJ21zc3YnXS50b1N0cmluZygpfWAsXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgbGV0IHBvd2VyO1xyXG5cclxuICAgICAgICAgICAgICAgIHBvd2VyID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIDA6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgMTogZGF0YVN0dWRlbnRbJ2NoYW1kaWVtJ10sXHJcbiAgICAgICAgICAgICAgICAgICAgMzogZGF0YVN0dWRlbnRbJ2xiaGQnXSxcclxuICAgICAgICAgICAgICAgICAgICAxMDogZGF0YVN0dWRlbnRbJ2Rhbmd2aWVuJ10sXHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCBkYXRhSW5zZXJ0VXNlciA9IHtcclxuICAgICAgICAgICAgICAgICAgICBfaWQ6IGRhdGFTdHVkZW50Wydtc3N2J10udG9TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgICAgICBmaXJzdF9uYW1lOiBkYXRhU3R1ZGVudFsndGVuJ10sXHJcbiAgICAgICAgICAgICAgICAgICAgbGFzdF9uYW1lOiBkYXRhU3R1ZGVudFsnaG8nXSxcclxuICAgICAgICAgICAgICAgICAgICBhdnQ6ICdodHRwczovL2kucGluaW1nLmNvbS8yMzZ4Lzg5LzA4LzNiLzg5MDgzYmJhNDA1NDVhNzJmYTE1MzIxYWY1ZmFiNzYwLS1jaGliaS1naXJsLXplcm8uanBnJyxcclxuICAgICAgICAgICAgICAgICAgICBwb3dlcjogcG93ZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgY2xhc3M6IFtkYXRhU3R1ZGVudFsnY2xzJ11dLFxyXG4gICAgICAgICAgICAgICAgICAgIGRpc3BsYXlOYW1lOiBgJHtkYXRhU3R1ZGVudFsnaG8nXX0gJHtkYXRhU3R1ZGVudFsndGVuJ119YCxcclxuICAgICAgICAgICAgICAgICAgICBlbWFpbDogZW1haWwsXHJcbiAgICAgICAgICAgICAgICAgICAgdG90YWxfc2NvcmU6IHt9LFxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIGxldCBkYXRhSW5zZXJ0TG9naW4gPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2lkOiBkYXRhU3R1ZGVudFsnbXNzdiddLnRvU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICAgICAgcGFzc3dvcmQ6IGhhc2hQYXNzd29yZChwdyksXHJcbiAgICAgICAgICAgICAgICAgICAgZmlyc3Q6ICduZXdfdXNlcicsXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgY2xpZW50LmRiKCdnbG9iYWwnKS5jb2xsZWN0aW9uKCd1c2VyX2luZm8nKS51cGRhdGVPbmUoXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfaWQ6IGRhdGFJbnNlcnRVc2VyLl9pZCxcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNldDogZGF0YUluc2VydFVzZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwc2VydDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIGNsaWVudC5kYignZ2xvYmFsJykuY29sbGVjdGlvbignbG9naW5faW5mbycpLnVwZGF0ZU9uZShcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogZGF0YUluc2VydExvZ2luLl9pZCxcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNldDogZGF0YUluc2VydExvZ2luLFxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1cHNlcnQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBtYXJrKFxyXG4gICAgICAgICAgICAgICAgICAgICdfc3RkX3RhYmxlJyxcclxuICAgICAgICAgICAgICAgICAgICB1c2VyLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGFJbnNlcnRVc2VyLl9pZCxcclxuICAgICAgICAgICAgICAgICAgICBkdW1teVNjb3JlLFxyXG4gICAgICAgICAgICAgICAgICAgIHsgZmlyc3RfbmFtZTogZGF0YUluc2VydFVzZXIuZmlyc3RfbmFtZSwgbGFzdF9uYW1lOiBkYXRhSW5zZXJ0VXNlci5sYXN0X25hbWUgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhSW5zZXJ0VXNlci5jbGFzc1swXSxcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAvLyB4dSBseSBzYXUga2hpIHRoZW0gc2luaCB2aWVuXHJcbiAgICAgICAgICAgICAgICBjb25zdCB1dWlkID0gdXVpZHY0KCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB3b3JrYm9vayA9IGF3YWl0IFhsc3hQb3B1bGF0ZS5mcm9tRmlsZUFzeW5jKCcuL3NyYy9leGNlbFRlbXBsYXRlL1Rhb19kYW5oX3NhY2hfbG9wX21vaS54bHN4Jyk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzaGVldCA9IHdvcmtib29rLnNoZWV0KDApO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgc2hlZXQuY2VsbChgQTJgKS52YWx1ZShkYXRhU3R1ZGVudFsnbXNzdiddLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgc2hlZXQuY2VsbChgQjJgKS52YWx1ZShkYXRhU3R1ZGVudFsnaG8nXSk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBzaGVldC5jZWxsKGBDMmApLnZhbHVlKGRhdGFTdHVkZW50Wyd0ZW4nXSk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBzaGVldC5jZWxsKGBEMWApLnZhbHVlKCdFbWFpbCcpO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgc2hlZXQuY2VsbChgRTFgKS52YWx1ZSgnUGFzc3dvcmQnKTtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHNoZWV0LmNlbGwoYEQyYCkudmFsdWUoZW1haWwpO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgc2hlZXQuY2VsbChgRTJgKS52YWx1ZShwdyk7XHJcbiAgICAgICAgICAgICAgICBsZXQgcmFuZ2UgPSBzaGVldC5yYW5nZShgRDI6RTJgKTtcclxuICAgICAgICAgICAgICAgIHJhbmdlLnN0eWxlKHsgYm9yZGVyOiB0cnVlIH0pO1xyXG4gICAgICAgICAgICAgICAgc2hlZXQuY29sdW1uKCdEJykud2lkdGgoZW1haWwubGVuZ3RoKTtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHdvcmtib29rLnRvRmlsZUFzeW5jKHBhdGguam9pbignLmRvd25sb2FkcycsIHV1aWQgKyAnLnhsc3gnKSk7XHJcbiAgICAgICAgICAgICAgICByZXMuZG93bmxvYWQocGF0aC5qb2luKCcuZG93bmxvYWRzJywgdXVpZCArICcueGxzeCcpKTtcclxuICAgICAgICAgICAgICAgIC8vIHhvYSBmaWxlIHNhdSBraGkgeHUgbHlcclxuICAgICAgICAgICAgICAgIHNjaGVkdWxlRmlsZURlbGV0aW9uKHBhdGguam9pbignLmRvd25sb2FkcycsIHV1aWQgKyAnLnhsc3gnKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gcmV0dXJuIHJlcy5zZW5kU3RhdHVzKDIwMCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNDAzKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBVcGRhdGUgc3R1ZGVudFxyXG4gICAgcm91dGVyLnBvc3QoJy91cGRhdGVBY2NvdW50JywgY2hlY2tJZlVzZXJMb2dpbkFQSSwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgY29uc3QgdXNlciA9IHJlcS5zZXNzaW9uLnVzZXI7XHJcbiAgICAgICAgaWYgKHVzZXIucG93WzRdIHx8IHVzZXIucG93WzddKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGFTdHVkZW50ID0gcmVxLmJvZHk7XHJcbiAgICAgICAgICAgIGxldCBwb3dlciA9IHtcclxuICAgICAgICAgICAgICAgIDA6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAxOiBkYXRhU3R1ZGVudFsnY2hhbWRpZW0nXSxcclxuICAgICAgICAgICAgICAgIDM6IGRhdGFTdHVkZW50WydsYmhkJ10sXHJcbiAgICAgICAgICAgICAgICAxMDogZGF0YVN0dWRlbnRbJ2Rhbmd2aWVuJ10sXHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBsZXQgZGF0YUluc2VydFVzZXIgPSB7XHJcbiAgICAgICAgICAgICAgICBfaWQ6IGRhdGFTdHVkZW50Wydtc3N2J10udG9TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIGZpcnN0X25hbWU6IGRhdGFTdHVkZW50Wyd0ZW4nXSxcclxuICAgICAgICAgICAgICAgIGxhc3RfbmFtZTogZGF0YVN0dWRlbnRbJ2hvJ10sXHJcbiAgICAgICAgICAgICAgICBwb3dlcjogcG93ZXIsXHJcbiAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZTogYCR7ZGF0YVN0dWRlbnRbJ2hvJ119ICR7ZGF0YVN0dWRlbnRbJ3RlbiddfWAsXHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBjbGllbnQuZGIoJ2dsb2JhbCcpLmNvbGxlY3Rpb24oJ3VzZXJfaW5mbycpLnVwZGF0ZU9uZShcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBfaWQ6IGRhdGFJbnNlcnRVc2VyLl9pZCxcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNldDogZGF0YUluc2VydFVzZXIsXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHVwc2VydDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoMjAwKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNDAzKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICByb3V0ZXIuZ2V0KCcvZ2V0VGVtcGxhdGVBZGRTdHVkZW50JywgdXBsb2FkLnNpbmdsZSgnZmlsZScpLCBjaGVja0lmVXNlckxvZ2luQVBJLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICAgICAgICBjb25zdCB1c2VyID0gcmVxLnNlc3Npb24udXNlcjtcclxuICAgICAgICBpZiAodXNlci5wb3dbNF0gfHwgdXNlci5wb3dbN10pIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5kb3dubG9hZCgnLi9zcmMvZXhjZWxUZW1wbGF0ZS9UYW9fZGFuaF9zYWNoX2xvcF9tb2kueGxzeCcpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg0MDMpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJvdXRlci5wb3N0KCcvZGVsZXRlQWNjb3VudCcsIGNoZWNrSWZVc2VyTG9naW5BUEksIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgICAgIGNvbnN0IHVzZXIgPSByZXEuc2Vzc2lvbi51c2VyO1xyXG4gICAgICAgIGlmICh1c2VyLnBvd1s0XSB8fCB1c2VyLnBvd1s3XSkge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2xzID0gcmVxLmJvZHkuY2xzO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbGlzdERlbGV0ZSA9IHJlcS5ib2R5LmRhdGFEZWxldGU7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpc3REZWxldGUubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBjbGllbnQuZGIoJ2dsb2JhbCcpLmNvbGxlY3Rpb24oJ3VzZXJfaW5mbycpLmRlbGV0ZU9uZSh7IF9pZDogbGlzdERlbGV0ZVtpXSB9KTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgaW5mb19zZWFyY2ggPSBgc3R1ZGVudF9saXN0LiR7bGlzdERlbGV0ZVtpXX1gO1xyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZGIodXNlci5kZXApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKGAke2Nsc31fYWN0aXZpdGllc2ApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC51cGRhdGVNYW55KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtpbmZvX3NlYXJjaF06IHsgJGV4aXN0czogdHJ1ZSB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcHVsbDogeyBzdHVkZW50X2xpc3Q6IHVzZXIuX2lkLCBhaTogdXNlci5faWQgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZGIodXNlci5kZXApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdhY3Rpdml0aWVzJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnVwZGF0ZU1hbnkoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2luZm9fc2VhcmNoXTogeyAkZXhpc3RzOiB0cnVlIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRwdWxsOiB7IHN0dWRlbnRfbGlzdDogdXNlci5faWQsIGFpOiB1c2VyLl9pZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdhY3Rpdml0aWVzJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnVwZGF0ZU1hbnkoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2luZm9fc2VhcmNoXTogeyAkZXhpc3RzOiB0cnVlIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRwdWxsOiB7IHN0dWRlbnRfbGlzdDogdXNlci5faWQsIGFpOiB1c2VyLl9pZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cygyMDApO1xyXG4gICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTWVNURU0gfCBERUxFVEVfQUNDT1VOVCB8IEVSUk9SIHwgJywgZXJyKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg1MDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zZW5kU3RhdHVzKDQwMyk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICAvLyBFeHBvcnQgY2xhc3Mgc2NvcmUgcmVwb3J0IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICByb3V0ZXIuZ2V0KCcvZXhwb3J0Q2xhc3NTY29yZScsIGNoZWNrSWZVc2VyTG9naW5BUEksIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVzZXIgPSByZXEuc2Vzc2lvbi51c2VyO1xyXG4gICAgICAgICAgICBpZiAodXNlci5wb3dbMV0gfHwgdXNlci5wb3dbMl0pIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSByZXEucXVlcnk7XHJcbiAgICAgICAgICAgICAgICAvL2RhdGEgPSB7eWVhcjogXCJISzFfMjAyMi0yMDIzXCIsIGNsczogJzEnfVxyXG4gICAgICAgICAgICAgICAgY29uc3Qgc2Nob29sX3llYXIgPSBkYXRhLnllYXI7XHJcbiAgICAgICAgICAgICAgICBsZXQgY2xzID0gZGF0YS5jbHM7XHJcbiAgICAgICAgICAgICAgICAvLyBjcmVhdGUgdXVpZCBmb3IgZG93bmxvYWQgZmlsZVxyXG4gICAgICAgICAgICAgICAgY29uc3QgdXVpZCA9IHV1aWR2NCgpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIGNoZWNrIGZvciBwb3N0IGRhdGEuY2xzIGlmIGNsYXNzIGRlZmluZSB0aGlzIG1lYW4gdGhleSBjaG9vc2UgY2xhc3Mgc28gdGhhdCBtdXN0XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IHN0dWRlbnRfbGlzdCA9IFtdO1xyXG4gICAgICAgICAgICAgICAgaWYgKHVzZXIucG93WzFdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3R1ZGVudF9saXN0ID0gc29ydFN0dWRlbnROYW1lKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbigndXNlcl9pbmZvJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgY2xhc3M6IHVzZXIuY2xzWzBdLCAncG93ZXIuMCc6IHsgJGV4aXN0czogdHJ1ZSB9IH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBwcm9qZWN0aW9uOiB7IGZpcnN0X25hbWU6IDEsIGxhc3RfbmFtZTogMSB9IH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudG9BcnJheSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0dWRlbnRfbGlzdCA9IHNvcnRTdHVkZW50TmFtZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ3VzZXJfaW5mbycpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZmluZChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IGNsYXNzOiBjbHMsICdwb3dlci4wJzogeyAkZXhpc3RzOiB0cnVlIH0gfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHByb2plY3Rpb246IHsgZmlyc3RfbmFtZTogMSwgbGFzdF9uYW1lOiAxIH0gfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50b0FycmF5KCksXHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAvLyBnZXQgYWxsIHN0dWRlbnQgdG90YWwgc2NvcmUgZnJvbSB0aGVtc2VsZjpcclxuICAgICAgICAgICAgICAgIGxldCBzY29yZXMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoc3R1ZGVudF9saXN0Lmxlbmd0aCAhPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3R1ZGVudF9saXN0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFtzdHQsIG1zc3YuIGhvLCB0ZW4sIGxvcCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gMS4wLCAxLjEsIDEuMiwgMS4zLCAxLjQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIDIuMCwgMi4xLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAzLjAsIDMuMSwgMy4yLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyA0LjAsIDQuMSwgNC4yLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyA1LjAsIDUuMSwgNS4yLCA1LjMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFwiXCIsIHRvdGFsLCBjb25kdWN0LCBcIlwiXVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgY3Vycl9zY29yZSA9IFtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgKyAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R1ZGVudF9saXN0W2ldLl9pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0dWRlbnRfbGlzdFtpXS5sYXN0X25hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHVkZW50X2xpc3RbaV0uZmlyc3RfbmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNscyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJfZGVwYXJ0bWVudHRfc2NvcmUgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5kYih1c2VyLmRlcClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKGNscyArICdfZGVwX3RhYmxlJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kT25lKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXNzdjogc3R1ZGVudF9saXN0W2ldLl9pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nob29sX3llYXI6IHNjaG9vbF95ZWFyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9qZWN0aW9uOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJzdDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlY29uZDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXJkOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91cnRoOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlmdGg6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJyX2RlcGFydG1lbnR0X3Njb3JlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyX3Njb3JlLnB1c2goLi4uY3Vycl9kZXBhcnRtZW50dF9zY29yZS5maXJzdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyX3Njb3JlLnB1c2goLi4uY3Vycl9kZXBhcnRtZW50dF9zY29yZS5zZWNvbmQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3Vycl9zY29yZS5wdXNoKC4uLmN1cnJfZGVwYXJ0bWVudHRfc2NvcmUudGhpcmQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3Vycl9zY29yZS5wdXNoKC4uLmN1cnJfZGVwYXJ0bWVudHRfc2NvcmUuZm91cnRoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJfc2NvcmUucHVzaCguLi5jdXJyX2RlcGFydG1lbnR0X3Njb3JlLmZpZnRoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgMTc7IGorKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJfc2NvcmUucHVzaChudWxsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgY3Vycl9zY29yZS5wdXNoKG51bGwpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJfZGVwYXJ0bWVudHRfc2NvcmUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJfc2NvcmUucHVzaChjdXJyX2RlcGFydG1lbnR0X3Njb3JlLnRvdGFsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNldCBraW5kIG9mIGNvbmR1Y3Q6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3Vycl9kZXBhcnRtZW50dF9zY29yZS50b3RhbCA+PSA5MCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJfc2NvcmUucHVzaCgneHXhuqV0IHPhuq9jJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGN1cnJfZGVwYXJ0bWVudHRfc2NvcmUudG90YWwgPj0gODApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyX3Njb3JlLnB1c2goJ3Thu5F0Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGN1cnJfZGVwYXJ0bWVudHRfc2NvcmUudG90YWwgPj0gNjUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyX3Njb3JlLnB1c2goJ2tow6EnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY3Vycl9kZXBhcnRtZW50dF9zY29yZS50b3RhbCA+PSA1MCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJfc2NvcmUucHVzaCgndHJ1bmcgYsOsbmgnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY3Vycl9kZXBhcnRtZW50dF9zY29yZS50b3RhbCA+PSAzNSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJfc2NvcmUucHVzaCgneeG6v3UnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3Vycl9zY29yZS5wdXNoKCdrw6ltJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyX3Njb3JlLnB1c2gobnVsbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyX3Njb3JlLnB1c2gobnVsbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFkZCBjdXJyX3Njb3JlIHRvIHNjb3Jlc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY29yZXMucHVzaChjdXJyX3Njb3JlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIC8vIExvYWQgYW4gZXhpc3Rpbmcgd29ya2Jvb2tcclxuICAgICAgICAgICAgICAgIGNvbnN0IHdvcmtib29rID0gYXdhaXQgWGxzeFBvcHVsYXRlLmZyb21GaWxlQXN5bmMoXHJcbiAgICAgICAgICAgICAgICAgICAgJy4vc3JjL2V4Y2VsVGVtcGxhdGUvQmFuZ19kaWVtX2NhX2xvcF94dWF0X3R1X2hlX3Rob25nLnhsc3gnLFxyXG4gICAgICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoc2NvcmVzLmxlbmd0aCAhPSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgd29ya2Jvb2suc2hlZXQoMCkuY2VsbCgnQTcnKS52YWx1ZShzY29yZXMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gV3JpdGUgdG8gZmlsZS5cclxuXHJcbiAgICAgICAgICAgICAgICBhd2FpdCB3b3JrYm9vay50b0ZpbGVBc3luYyhwYXRoLmpvaW4oJy5kb3dubG9hZHMnLCB1dWlkICsgJy54bHN4JykpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIHThuqNpIGZpbGUgeGxzeCB24buBIG3DoXkgbmfGsOG7nWkgZMO5bmdcclxuICAgICAgICAgICAgICAgIC8vIHJlcy5kb3dubG9hZChwYXRoLmpvaW4oJy5kb3dubG9hZHMnLCB1dWlkICsgXCIueGxzeFwiKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmVzLmRvd25sb2FkKHBhdGguam9pbignLmRvd25sb2FkcycsIHV1aWQgKyAnLnhsc3gnKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gZGVsZXRlIGZpbGUgYWZ0ZXIgMTIgaG91cnNcclxuICAgICAgICAgICAgICAgIHNjaGVkdWxlRmlsZURlbGV0aW9uKHBhdGguam9pbignLmRvd25sb2FkcycsIHV1aWQgKyAnLnhsc3gnKSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNDAzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnU1lTVEVNIHwgRVhQT1JUX0NMQVNTX1NDT1JFIHwgRVJST1IgfCAnLCBlcnIpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNTAwKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIC8vIEV4cG9ydCBzdHVkZW50cyBzY29yZSByZXBvcnQgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIHJvdXRlci5nZXQoJy9leHBvcnRTdHVkZW50c1Njb3JlJywgY2hlY2tJZlVzZXJMb2dpbkFQSSwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgdXNlciA9IHJlcS5zZXNzaW9uLnVzZXI7XHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSByZXEucXVlcnk7XHJcbiAgICAgICAgICAgIGxldCBjbHMgPSBkYXRhLmNscztcclxuICAgICAgICAgICAgbGV0IHN0ZGxpc3QgPSBbXTtcclxuICAgICAgICAgICAgaWYgKGRhdGEuc3RkbGlzdCkge1xyXG4gICAgICAgICAgICAgICAgc3RkbGlzdCA9IEpTT04ucGFyc2UoZGF0YS5zdGRsaXN0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBzY2hvb2xfeWVhciA9IGRhdGEueWVhcjtcclxuXHJcbiAgICAgICAgICAgIGlmICh1c2VyLnBvd1swXSB8fCB1c2VyLnBvd1sxXSB8fCB1c2VyLnBvd1syXSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKChkYXRhLnR5cGUgPT09ICdzaW5nZScpICYgdXNlci5wb3dbMF0pIHtcclxuICAgICAgICAgICAgICAgICAgICBjbHMgPSB1c2VyLmNsc1swXTtcclxuICAgICAgICAgICAgICAgICAgICBzdGRsaXN0ID0gW3VzZXIuX2lkXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vZGF0YSA9IHt5ZWFyOiBcIkhLMV8yMDIyLTIwMjNcIiwgY2xzOiAnMScsIHN0ZGxpc3Q6IFtdfVxyXG4gICAgICAgICAgICAgICAgLy8gY3JlYXRlIHV1aWQgZm9yIGRvd25sb2FkIGZpbGVcclxuICAgICAgICAgICAgICAgIGNvbnN0IHV1aWQgPSB1dWlkdjQoKTtcclxuICAgICAgICAgICAgICAgIC8vIGNoZWNrIGZvciBwb3N0IGRhdGEuY2xzIGlmIGNsYXNzIGRlZmluZSB0aGlzIG1lYW4gdGhleSBjaG9vc2UgY2xhc3Mgc28gdGhhdCBtdXN0XHJcbiAgICAgICAgICAgICAgICBsZXQgc3R1ZGVudF9saXN0ID0gW107XHJcblxyXG4gICAgICAgICAgICAgICAgc3R1ZGVudF9saXN0ID0gc29ydFN0dWRlbnROYW1lKFxyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbigndXNlcl9pbmZvJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M6IGNscyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAncG93ZXIuMCc6IHsgJGV4aXN0czogdHJ1ZSB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogeyAkaW46IHN0ZGxpc3QgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHByb2plY3Rpb246IHsgZmlyc3RfbmFtZTogMSwgbGFzdF9uYW1lOiAxIH0gfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudG9BcnJheSgpLFxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIC8vIGdldCBhbGwgc3R1ZGVudCB0b3RhbCBzY29yZSBmcm9tIHRoZW1zZWxmOlxyXG4gICAgICAgICAgICAgICAgbGV0IHNjb3JlcyA9IFtdO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChzdHVkZW50X2xpc3QubGVuZ3RoICE9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdHVkZW50X2xpc3QubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gW3N0dCwgbXNzdi4gaG8sIHRlbiwgbG9wLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAxLjAsIDEuMSwgMS4yLCAxLjMsIDEuNCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gMi4wLCAyLjEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIDMuMCwgMy4xLCAzLjIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIDQuMCwgNC4xLCA0LjIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIDUuMCwgNS4xLCA1LjIsIDUuMyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gXCJcIiwgdG90YWwsIGNvbmR1Y3QsIFwiXCJdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjdXJyX3Njb3JlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeWVhcjogc2Nob29sX3llYXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtc3N2OiBzdHVkZW50X2xpc3RbaV0uX2lkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogc3R1ZGVudF9saXN0W2ldLmxhc3RfbmFtZSArICcgJyArIHN0dWRlbnRfbGlzdFtpXS5maXJzdF9uYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M6IGNscyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ZDogW10sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGY6IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVwOiBbXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJfc3R1ZGVudHNfc2NvcmUgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5kYih1c2VyLmRlcClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKGNscyArICdfc3RkX3RhYmxlJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kT25lKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXNzdjogc3R1ZGVudF9saXN0W2ldLl9pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nob29sX3llYXI6IHNjaG9vbF95ZWFyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9qZWN0aW9uOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJzdDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlY29uZDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXJkOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91cnRoOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlmdGg6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJfc3RhZmZfc2NvcmUgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5kYih1c2VyLmRlcClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKGNscyArICdfc3RmX3RhYmxlJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kT25lKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXNzdjogc3R1ZGVudF9saXN0W2ldLl9pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nob29sX3llYXI6IHNjaG9vbF95ZWFyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9qZWN0aW9uOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJzdDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlY29uZDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXJkOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91cnRoOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlmdGg6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJfZGVwYXJ0bWVudHRfc2NvcmUgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5kYih1c2VyLmRlcClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKGNscyArICdfZGVwX3RhYmxlJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kT25lKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXNzdjogc3R1ZGVudF9saXN0W2ldLl9pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nob29sX3llYXI6IHNjaG9vbF95ZWFyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9qZWN0aW9uOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJzdDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlY29uZDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXJkOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91cnRoOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlmdGg6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJyX3N0dWRlbnRzX3Njb3JlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyX3Njb3JlLnN0ZC5wdXNoKC4uLmN1cnJfc3R1ZGVudHNfc2NvcmUuZmlyc3QpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3Vycl9zY29yZS5zdGQucHVzaCguLi5jdXJyX3N0dWRlbnRzX3Njb3JlLnNlY29uZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyX3Njb3JlLnN0ZC5wdXNoKC4uLmN1cnJfc3R1ZGVudHNfc2NvcmUudGhpcmQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3Vycl9zY29yZS5zdGQucHVzaCguLi5jdXJyX3N0dWRlbnRzX3Njb3JlLmZvdXJ0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyX3Njb3JlLnN0ZC5wdXNoKC4uLmN1cnJfc3R1ZGVudHNfc2NvcmUuZmlmdGgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3Vycl9zY29yZS5zdGQucHVzaChjdXJyX3N0dWRlbnRzX3Njb3JlLnRvdGFsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgMTg7IGorKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJfc2NvcmUuc3RkLnB1c2goJ04vQScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJyX3N0YWZmX3Njb3JlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyX3Njb3JlLnN0Zi5wdXNoKC4uLmN1cnJfc3RhZmZfc2NvcmUuZmlyc3QpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3Vycl9zY29yZS5zdGYucHVzaCguLi5jdXJyX3N0YWZmX3Njb3JlLnNlY29uZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyX3Njb3JlLnN0Zi5wdXNoKC4uLmN1cnJfc3RhZmZfc2NvcmUudGhpcmQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3Vycl9zY29yZS5zdGYucHVzaCguLi5jdXJyX3N0YWZmX3Njb3JlLmZvdXJ0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyX3Njb3JlLnN0Zi5wdXNoKC4uLmN1cnJfc3RhZmZfc2NvcmUuZmlmdGgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3Vycl9zY29yZS5zdGYucHVzaChjdXJyX3N0YWZmX3Njb3JlLnRvdGFsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgMTg7IGorKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJfc2NvcmUuc3RmLnB1c2goJ04vQScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3Vycl9kZXBhcnRtZW50dF9zY29yZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3Vycl9zY29yZS5kZXAucHVzaCguLi5jdXJyX2RlcGFydG1lbnR0X3Njb3JlLmZpcnN0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJfc2NvcmUuZGVwLnB1c2goLi4uY3Vycl9kZXBhcnRtZW50dF9zY29yZS5zZWNvbmQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3Vycl9zY29yZS5kZXAucHVzaCguLi5jdXJyX2RlcGFydG1lbnR0X3Njb3JlLnRoaXJkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJfc2NvcmUuZGVwLnB1c2goLi4uY3Vycl9kZXBhcnRtZW50dF9zY29yZS5mb3VydGgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3Vycl9zY29yZS5kZXAucHVzaCguLi5jdXJyX2RlcGFydG1lbnR0X3Njb3JlLmZpZnRoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJfc2NvcmUuZGVwLnB1c2goY3Vycl9kZXBhcnRtZW50dF9zY29yZS50b3RhbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDE4OyBqKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyX3Njb3JlLmRlcC5wdXNoKCdOL0EnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcmVzLnB1c2goY3Vycl9zY29yZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNDAyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ZW1wX25hbWVmaWxlID0gYXdhaXQgY3JlYXRlUGRmKCcuZG93bmxvYWRzJywgc2NvcmVzKTtcclxuICAgICAgICAgICAgICAgIC8vIHThuqNpIGZpbGUgeGxzeCB24buBIG3DoXkgbmfGsOG7nWkgZMO5bmdcclxuICAgICAgICAgICAgICAgIHJlcy5kb3dubG9hZChwYXRoLmpvaW4oJy5kb3dubG9hZHMnLCB0ZW1wX25hbWVmaWxlKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gZGVsZXRlIGZpbGUgYWZ0ZXIgMTIgaG91cnNcclxuXHJcbiAgICAgICAgICAgICAgICBzY2hlZHVsZUZpbGVEZWxldGlvbihwYXRoLmpvaW4oJy5kb3dubG9hZHMnLCB0ZW1wX25hbWVmaWxlKSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNDAzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnU1lTVEVNIHwgRVhQT1JUX1NUVURFTlRTX1NDT1JFIHwgRVJST1IgfCAnLCBlcnIpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNTAwKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIC8vIExvYWQgc2NvcmUgbGlzdCBvZiBzdHVkZW50IGluIHNwZWNpZmljIGNsYXNzIGF0IHNwZWNpZmljIHRpbWUgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICByb3V0ZXIuZ2V0KCcvbG9hZFNjb3Jlc0xpc3QnLCBjaGVja0lmVXNlckxvZ2luQVBJLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCB1c2VyID0gcmVxLnNlc3Npb24udXNlcjtcclxuICAgICAgICAgICAgaWYgKHVzZXIucG93WzFdKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gcmVxLnF1ZXJ5O1xyXG4gICAgICAgICAgICAgICAgLy9kYXRhID0ge3llYXI6IFwiSEsxXzIwMjItMjAyM1wiLCBjbHM6IFwiMVwifVxyXG4gICAgICAgICAgICAgICAgY29uc3Qgc2Nob29sX3llYXIgPSBkYXRhLnllYXI7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB5ZWFyX2F2YWlsYWJsZSA9IGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ3NjaG9vbF95ZWFyJylcclxuICAgICAgICAgICAgICAgICAgICAuZmluZE9uZShcclxuICAgICAgICAgICAgICAgICAgICAgICAge30sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2plY3Rpb246IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaWQ6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeWVhcjogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydF9kYXk6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kX2RheTogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBzdHVkZW50X2xpc3QgPSBzb3J0U3R1ZGVudE5hbWUoXHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCd1c2VyX2luZm8nKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZmluZChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgY2xhc3M6IHVzZXIuY2xzWzBdLCAncG93ZXIuMCc6IHsgJGV4aXN0czogdHJ1ZSB9IH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvamVjdGlvbjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJzdF9uYW1lOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0X25hbWU6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsX3Njb3JlOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC50b0FycmF5KCksXHJcbiAgICAgICAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIGdldCBhbGwgc3R1ZGVudCB0b3RhbCBzY29yZSBmcm9tIHRoZW1zZWxmOlxyXG4gICAgICAgICAgICAgICAgbGV0IHJlc3VsdCA9IHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBzdGFmZl9uYW1lOiBbXSxcclxuICAgICAgICAgICAgICAgICAgICBzdHVkZW50X2xpc3Q6IHN0dWRlbnRfbGlzdCxcclxuICAgICAgICAgICAgICAgICAgICAvLyBzdHVkZW50X3Njb3JlczogW10sXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gc3RhZmZfc2NvcmVzOiBbXSxcclxuICAgICAgICAgICAgICAgICAgICAvLyBkZXBhcnRtZW50X3Njb3JlczogW10sXHJcbiAgICAgICAgICAgICAgICAgICAgeWVhcl9hdmFpbGFibGU6IHllYXJfYXZhaWxhYmxlLFxyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24ocmVzdWx0KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIHVzZXIgbm90IHN0YWZmIG1lbWJlcnNcclxuICAgICAgICAgICAgICAgIC8vIHJlZGlyZWN0IHRvIGhvbWUgKHJldHVybiA0MDMsIGFwaSBraG9uZyB0aGUgY2h1eWVuaCBodW9uZyB2ZSB0cmFuZyBjaHUgZHVvYylcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg0MDMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTWVNURU0gfCBMT0FEX1NDT1JFX0xJU1QgfCBFUlJPUiB8ICcsIGVycik7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg1MDApO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgLy8gZG9hbiBraG9hIGxvYWQgc2NvcmVzXHJcbiAgICByb3V0ZXIuZ2V0KCcvZG9hbl9raG9hL2xvYWRTY29yZXNMaXN0JywgY2hlY2tJZlVzZXJMb2dpbkFQSSwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgdXNlciA9IHJlcS5zZXNzaW9uLnVzZXI7XHJcbiAgICAgICAgICAgIGlmICh1c2VyLnBvd1syXSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IHJlcS5xdWVyeTtcclxuICAgICAgICAgICAgICAgIC8vZGF0YSA9IHt5ZWFyOiBcIkhLMV8yMDIyLTIwMjNcIiwgY2xzOiBcIjFcIn1cclxuICAgICAgICAgICAgICAgIGNvbnN0IHNjaG9vbF95ZWFyID0gZGF0YS55ZWFyO1xyXG4gICAgICAgICAgICAgICAgbGV0IGNscyA9IGRhdGEuY2xhc3M7XHJcbiAgICAgICAgICAgICAgICAvLyBjb25zdCBib19tb24gPSBkYXRhLmJvX21vbjtcclxuICAgICAgICAgICAgICAgIC8vIGNoZWNrIGZvciBwb3N0IGRhdGEuY2xzIGlmIGNsYXNzIGRlZmluZSB0aGlzIG1lYW4gdGhleSBjaG9vc2UgY2xhc3Mgc28gdGhhdCBtdXN0XHJcbiAgICAgICAgICAgICAgICBpZiAoIWNscykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNscyA9IDA7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgeWVhcl9hdmFpbGFibGUgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdzY2hvb2xfeWVhcicpXHJcbiAgICAgICAgICAgICAgICAgICAgLmZpbmRPbmUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHt9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9qZWN0aW9uOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2lkOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHllYXI6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRfZGF5OiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZF9kYXk6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3Qgc3R1ZGVudF9saXN0ID0gc29ydFN0dWRlbnROYW1lKFxyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbigndXNlcl9pbmZvJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IGNsYXNzOiBjbHMsICdwb3dlci4wJzogeyAkZXhpc3RzOiB0cnVlIH0gfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9qZWN0aW9uOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0X25hbWU6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RfbmFtZTogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxfc2NvcmU6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnRvQXJyYXkoKSxcclxuICAgICAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gZ2V0IGFsbCBzdHVkZW50IHRvdGFsIHNjb3JlIGZyb20gdGhlbXNlbGY6XHJcbiAgICAgICAgICAgICAgICBsZXQgcmVzdWx0ID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHN0YWZmX25hbWU6IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgIHN0dWRlbnRfbGlzdDogc3R1ZGVudF9saXN0LFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHN0dWRlbnRfc2NvcmVzOiBbXSxcclxuICAgICAgICAgICAgICAgICAgICAvLyBzdGFmZl9zY29yZXM6IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGRlcGFydG1lbnRfc2NvcmVzOiBbXSxcclxuICAgICAgICAgICAgICAgICAgICB5ZWFyX2F2YWlsYWJsZTogeWVhcl9hdmFpbGFibGUsXHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbihyZXN1bHQpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gdXNlciBub3Qgc3RhZmYgbWVtYmVyc1xyXG4gICAgICAgICAgICAgICAgLy8gcmVkaXJlY3QgdG8gaG9tZVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXNDb2RlKDQwMyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1NZU1RFTSB8IERPQU5fS0hPQV9MT0FEX1NDT1JFX0xJU1QgfCBFUlJPUiB8ICcsIGVycik7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg1MDApO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgLy8gQXV0byBtYXJrIChjb3B5IHN0dWRlbnQgbWFyayB0byBzdGFmZiBtYXJrKVxyXG4gICAgcm91dGVyLnBvc3QoJy9hdXRvTWFyaycsIGNoZWNrSWZVc2VyTG9naW5BUEksIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVzZXIgPSByZXEuc2Vzc2lvbi51c2VyO1xyXG4gICAgICAgICAgICBpZiAodXNlci5wb3dbMV0pIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSByZXEuYm9keTtcclxuICAgICAgICAgICAgICAgIGxldCBjbHMgPSBkYXRhLmNscztcclxuICAgICAgICAgICAgICAgIC8vZGF0YSA9IHt5ZWFyOiBcIkhLMV8yMDIyLTIwMjNcIiwgY2xzOiBcIjFcIiwgc3RkX2xpc3QgPSBbXX1cclxuXHJcbiAgICAgICAgICAgICAgICAvLyBnZXQgc3RhZmYgbWVtYmVyIGluZm8gOlxyXG4gICAgICAgICAgICAgICAgY29uc3QgbWFya2VyID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbigndXNlcl9pbmZvJylcclxuICAgICAgICAgICAgICAgICAgICAuZmluZE9uZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgeyBfaWQ6IHVzZXIuX2lkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2plY3Rpb246IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaWQ6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdF9uYW1lOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0X25hbWU6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAvLyBjaGVjayBmb3IgcG9zdCBkYXRhLmNscyBpZiBjbGFzcyBkZWZpbmUgdGhpcyBtZWFuIHRoZXkgY2hvb3NlIGNsYXNzIHNvIHRoYXQgbXVzdFxyXG4gICAgICAgICAgICAgICAgaWYgKCFjbHMpIHtcclxuICAgICAgICAgICAgICAgICAgICBjbHMgPSAwO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRhYmxlIGlzIGV4aXN0IG9yIG5vdFxyXG4gICAgICAgICAgICAgICAgLy8gdXBkYXRlIG9yIGFkZCBuZXcgdGFibGUgY29weSBmcm9tIHN0ZF90YWJsZSB0byBzdGFmZl90YWJsZVxyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRhLnN0ZF9saXN0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RkX3RhYmxlID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kYih1c2VyLmRlcClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24odXNlci5jbHNbcGFyc2VJbnQoY2xzKV0gKyAnX3N0ZF90YWJsZScpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kT25lKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1zc3Y6IGRhdGEuc3RkX2xpc3RbaV0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2hvb2xfeWVhcjogZGF0YS55ZWFyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gdXBkYXRlIG9sZCB0YWJsZSBpZiBleGlzdCBlbHNlIGluc2VydCBuZXcgb25lXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gY29weSBmcm9tIHN0dWRlbnQgdGFibGUgYW5kIGFkZCBtYXJrZXIgbmFtZVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGRfdGFibGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RkX3RhYmxlLm1hcmtlciA9IG1hcmtlci5sYXN0X25hbWUgKyAnICcgKyBtYXJrZXIuZmlyc3RfbmFtZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHN0ZF90YWJsZS5faWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmRiKHVzZXIuZGVwKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24odXNlci5jbHNbcGFyc2VJbnQoY2xzKV0gKyAnX3N0Zl90YWJsZScpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudXBkYXRlT25lKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXNzdjogZGF0YS5zdGRfbGlzdFtpXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nob29sX3llYXI6IGRhdGEueWVhcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNldDogc3RkX3RhYmxlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB1cHNlcnQ6IHRydWUgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB1cGRhdGVTdHVkZW50VG90YWxTY29yZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ19zdGZfdGFibGUnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGRfdGFibGUuc2Nob29sX3llYXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0ZF90YWJsZS5tc3N2LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGRfdGFibGUudG90YWwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0ZF90YWJsZS5tYXJrZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoMjAwKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg0MDMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTWVNURU0gfCBBVVRPX01BUksgfCBFUlJPUiB8ICcsIGVycik7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg1MDApO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJvdXRlci5wb3N0KCcvZG9hbl9raG9hL2F1dG9NYXJrJywgY2hlY2tJZlVzZXJMb2dpbkFQSSwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgdXNlciA9IHJlcS5zZXNzaW9uLnVzZXI7XHJcbiAgICAgICAgICAgIGlmICh1c2VyLnBvd1syXSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IHJlcS5ib2R5O1xyXG4gICAgICAgICAgICAgICAgbGV0IGNscyA9IGRhdGEuY2xzO1xyXG4gICAgICAgICAgICAgICAgLy9kYXRhID0ge3llYXI6IFwiSEsxXzIwMjItMjAyM1wiLCBjbHM6IFwiMVwiLCBzdGRfbGlzdCA9IFtdfVxyXG5cclxuICAgICAgICAgICAgICAgIC8vIGdldCBzdGFmZiBtZW1iZXIgaW5mbyA6XHJcbiAgICAgICAgICAgICAgICBjb25zdCBtYXJrZXIgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCd1c2VyX2luZm8nKVxyXG4gICAgICAgICAgICAgICAgICAgIC5maW5kT25lKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7IF9pZDogdXNlci5faWQgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvamVjdGlvbjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0X25hbWU6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RfbmFtZTogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBjaGVjayBpZiB0YWJsZSBpcyBleGlzdCBvciBub3RcclxuICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSBvciBhZGQgbmV3IHRhYmxlIGNvcHkgZnJvbSBzdGRfdGFibGUgdG8gc3RhZmZfdGFibGVcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5zdGRfbGlzdC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0ZF90YWJsZSA9IGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZGIodXNlci5kZXApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKGNscyArICdfc3RmX3RhYmxlJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmRPbmUoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbXNzdjogZGF0YS5zdGRfbGlzdFtpXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjaG9vbF95ZWFyOiBkYXRhLnllYXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyB1cGRhdGUgb2xkIHRhYmxlIGlmIGV4aXN0IGVsc2UgaW5zZXJ0IG5ldyBvbmVcclxuICAgICAgICAgICAgICAgICAgICAvLyBjb3B5IGZyb20gc3R1ZGVudCB0YWJsZSBhbmQgYWRkIG1hcmtlciBuYW1lXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0ZF90YWJsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGRfdGFibGUubWFya2VyID0gbWFya2VyLmxhc3RfbmFtZSArICcgJyArIG1hcmtlci5maXJzdF9uYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgc3RkX3RhYmxlLl9pZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZGIodXNlci5kZXApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbihjbHMgKyAnX2RlcF90YWJsZScpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudXBkYXRlT25lKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXNzdjogZGF0YS5zdGRfbGlzdFtpXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nob29sX3llYXI6IGRhdGEueWVhcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNldDogc3RkX3RhYmxlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB1cHNlcnQ6IHRydWUgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB1cGRhdGVTdHVkZW50VG90YWxTY29yZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ19kZXBfdGFibGUnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGRfdGFibGUuc2Nob29sX3llYXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0ZF90YWJsZS5tc3N2LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGRfdGFibGUudG90YWwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0ZF90YWJsZS5tYXJrZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoMjAwKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg0MDMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTWVNURU0gfCBBVVRPX01BUksgfCBFUlJPUiB8ICcsIGVycik7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg1MDApO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8vIGFwaSBkYW5oIHNhY2ggc2luaCB2aWVuXHJcbiAgICByb3V0ZXIucG9zdCgnL2dldFN0dWRlbnRMaXN0JywgY2hlY2tJZlVzZXJMb2dpbkFQSSwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgY29uc3QgdXNlciA9IHJlcS5zZXNzaW9uLnVzZXI7XHJcblxyXG4gICAgICAgIGNvbnN0IGRhdGEgPSByZXEuYm9keTsgLy8gZGF0YSA9IHtjbGFzczogS1RQTTAxMjEgKGNsYXNzIGlkKSwgc2tpcDogMSAvLyB0aW1lIGxvYWQgYmVmb3VyfVxyXG4gICAgICAgIGxldCByZXFDbGFzcyA9IGRhdGEuY2xhc3M7XHJcbiAgICAgICAgLy8gaWYgKCFyZXFDbGFzcykge1xyXG4gICAgICAgIC8vICAgcmVxQ2xhc3MgPSB1c2VyLmNsc1swXTtcclxuICAgICAgICAvLyB9XHJcbiAgICAgICAgaWYgKHJlcUNsYXNzKSB7XHJcbiAgICAgICAgICAgIGlmICh1c2VyLnBvd1sxXSB8fCB1c2VyLnBvd1syXSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc3R1ZGVudF9saXN0ID0gc29ydFN0dWRlbnROYW1lKFxyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbigndXNlcl9pbmZvJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IGNsYXNzOiByZXFDbGFzcywgJ3Bvd2VyLjAnOiB7ICRleGlzdHM6IHRydWUgfSB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBwcm9qZWN0aW9uOiB7IGZpcnN0X25hbWU6IDEsIGxhc3RfbmFtZTogMSwgcG93ZXI6IDEgfSB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5saW1pdCgzMClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnNraXAoMzAgKiBkYXRhLnNraXApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC50b0FycmF5KCksXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdHJhbnNmb3JtZWREYXRhID0gc3R1ZGVudF9saXN0Lm1hcCgoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCByb2xlID0gJ1VuS25vdyc7IC8vIEdp4bqjIMSR4buLbmggZ2nDoSB0cuG7iyBt4bq3YyDEkeG7i25oIGzDoCAndW5rbm93J1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBkYW5nX3ZpZW4gPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgY2hhbV9kaWVtID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGxhcF9ob2F0X2RvbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBkYW5nX3ZpZW4gPSBpdGVtLnBvd2VyWycxMCddID8gdHJ1ZSA6IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYW1fZGllbSA9IGl0ZW0ucG93ZXJbJzEnXSA/IHRydWUgOiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBsYXBfaG9hdF9kb25nID0gaXRlbS5wb3dlclsnMyddID8gdHJ1ZSA6IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpdGVtLnBvd2VyWycxJ10gfHwgaXRlbS5wb3dlclsnMyddKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvbGUgPSAnQmFuIGPDoW4gc+G7sSc7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpdGVtLnBvd2VyWycwJ10pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcm9sZSA9ICdTaW5oIHZpw6puJztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogaXRlbS5faWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0X25hbWU6IGl0ZW0uZmlyc3RfbmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGFzdF9uYW1lOiBpdGVtLmxhc3RfbmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcm9sZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGFuZ192aWVuLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFtX2RpZW0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhcF9ob2F0X2RvbmcsXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHRyYW5zZm9ybWVkRGF0YSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNDAzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg0MDQpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJvdXRlci5nZXQoJy9nZXRTdHVkZW50SW5mb01hcmsnLCBjaGVja0lmVXNlckxvZ2luQVBJLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICAgICAgICBjb25zdCB1c2VyID0gcmVxLnNlc3Npb24udXNlcjtcclxuICAgICAgICBsZXQgcmVzdWx0ID0ge1xyXG4gICAgICAgICAgICBkYW5nX3ZpZW46IHVzZXIucG93WzEwXSA/IHRydWUgOiBmYWxzZSxcclxuICAgICAgICAgICAgY2hhbV9kaWVtOiB1c2VyLnBvd1sxXSA/IHRydWUgOiBmYWxzZSxcclxuICAgICAgICAgICAgbGFwX2hvYXRfZG9uZzogdXNlci5wb3dbM10gPyB0cnVlIDogZmFsc2UsXHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24ocmVzdWx0KTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJvdXRlci5nZXQoJy9nZXR1c2Vyc2NvcmUnLCBjaGVja0lmVXNlckxvZ2luQVBJLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCB1c2VyID0gcmVxLnNlc3Npb24udXNlcjtcclxuICAgICAgICAgICAgaWYgKHVzZXIucG93WzBdKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzY2hvb2xZZWFyUGFyYW0gPSByZXEucXVlcnkuc2Nob29sWWVhcjtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBzY2hvb2xZZWFyc1RvU2VhcmNoID0gWydISzFfJyArIHNjaG9vbFllYXJQYXJhbSwgJ0hLMl8nICsgc2Nob29sWWVhclBhcmFtXTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHN0dWRlbnRUb3RhbFNjb3JlcyA9IGF3YWl0IFByb21pc2UuYWxsKFxyXG4gICAgICAgICAgICAgICAgICAgIHNjaG9vbFllYXJzVG9TZWFyY2gubWFwKGFzeW5jICh5ZWFyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0dWRlbnRUb3RhbFNjb3JlID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZGIodXNlci5kZXApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbih1c2VyLmNsc1swXSArICdfc3RkX3RhYmxlJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kT25lKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXNzdjogdXNlci5faWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjaG9vbF95ZWFyOiB5ZWFyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9qZWN0aW9uOiB7IF9pZDogMCwgdG90YWw6IDEgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHllYXI6IHllYXIuc2xpY2UoMCwgMyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbDogc3R1ZGVudFRvdGFsU2NvcmUgPyBzdHVkZW50VG90YWxTY29yZS50b3RhbCA6ICdDaMawYSBjw7MgxJFp4buDbScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHN0dWRlbnRUb3RhbFNjb3Jlcyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNDAzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnU1lTVEVNIHwgR0VUX1VTRVJfU0NPUkUgfCBFUlJPUiB8ICcsIGVycik7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg1MDApO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8vIGFwaSBhZGQgb3IgZWRpdCBicmFuY2ggb2YgZGVwYXJ0bWVudCBiYXNlIG9uIGl0IGV4aXN0IG9yIG5vdFxyXG4gICAgcm91dGVyLnBvc3QoJy9hZGRPckVkaXRCcmFuY2hzJywgY2hlY2tJZlVzZXJMb2dpbkFQSSwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgdXNlciA9IHJlcS5zZXNzaW9uLnVzZXI7XHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSByZXEuYm9keTsgLy8gZGF0YSA9IHtvbGRfbmFtZTogXCJI4buHIHRo4buRbmcgdGjDtG5nIHRpblwiLCBuYW1lOiBcIkvhu7kgVGh14bqtdCBQaOG6p24gTeG7gW1cIn1cclxuXHJcbiAgICAgICAgICAgIC8vIG11c3QgYmUgZGVwYXJ0bWVudCB0byB1c2UgdGhpcyBhcGlcclxuICAgICAgICAgICAgaWYgKHVzZXIucG93WzVdKSB7XHJcbiAgICAgICAgICAgICAgICAvLyByZW1vdmUgb2xkIGJyYW5jaFxyXG4gICAgICAgICAgICAgICAgYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbignYnJhbmNocycpXHJcbiAgICAgICAgICAgICAgICAgICAgLmRlbGV0ZU9uZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogY3JlYXRlSWQoZGF0YS5vbGRfbmFtZSksXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAvLyBhZGQgbmV3IGJyYW5jaFxyXG4gICAgICAgICAgICAgICAgYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbignYnJhbmNocycpXHJcbiAgICAgICAgICAgICAgICAgICAgLmluc2VydE9uZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogY3JlYXRlSWQoZGF0YS5uYW1lKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXA6IHVzZXIuZGVwLFxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zZW5kU3RhdHVzKDQwMyk7IC8vIGJhY2sgdG8gaG9tZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoMjAwKTtcclxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1NZU1RFTSB8IEFERF9PUl9FRElUX0JSQU5DSFMgfCBFUlJPUiB8ICcsIGVycik7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg1MDApO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8vIGFwaSBkZWxldGUgY2hla2VkIGJyYW5jaHNcclxuICAgIHJvdXRlci5wb3N0KCcvZGVsZXRlQnJhbmNocycsIGNoZWNrSWZVc2VyTG9naW5BUEksIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVzZXIgPSByZXEuc2Vzc2lvbi51c2VyO1xyXG4gICAgICAgICAgICBjb25zdCBkYXRhID0gcmVxLmJvZHk7IC8vIGRhdGEgPSB7cm1fYnM6IFtcIkvhu7kgVGh14bqtdCBQaOG6p24gTeG7gW1cIiwgLi4uXX1cclxuXHJcbiAgICAgICAgICAgIC8vIG11c3QgYmUgZGVwYXJ0bWVudCB0byB1c2UgdGhpcyBhcGlcclxuICAgICAgICAgICAgaWYgKHVzZXIucG93WzVdKSB7XHJcbiAgICAgICAgICAgICAgICAvLyByZW1vdmUgYWxsIGNoZWtlZCBicmFuY2ggaW4gcmVtb3ZlIGJyYW5jaHMgbMOtc3RcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5ybV9icy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbignYnJhbmNocycpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kZWxldGVPbmUoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2lkOiBjcmVhdGVJZChkYXRhLnJtX2JzW2ldKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZHVtbXlfY2xhc3MgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ2NsYXNzZXMnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZmluZCh7IGJyYW5jaDogY3JlYXRlSWQoZGF0YS5ybV9ic1tpXSkgfSwgeyBwcm9qZWN0aW9uOiB7IGN2aHQ6IDEgfSB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudG9BcnJheSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNsc19ybV9kYXRhID0gZHVtbXlfY2xhc3MubWFwKChjbHMpID0+IGNscy5faWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGN2aHRfcm1fZGF0YSA9IGR1bW15X2NsYXNzLm1hcCgoY2xzKSA9PiBjbHMuY3ZodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVxdWVzdERhdGEgPSB7IHJtX2NsczogY2xzX3JtX2RhdGEsIHJtX3RzOiBjdmh0X3JtX2RhdGEgfTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gLy8gR+G7jWkgQVBJIGLhurFuZyBheGlvcyB24bubaSBwaMawxqFuZyB0aOG7qWMgUE9TVFxyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGRlbGV0ZUNsYXNzQXBpKHJlcXVlc3REYXRhLCB1c2VyKTtcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ3VzZXJfaW5mbycpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC51cGRhdGVNYW55KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogeyAkaW46IGN2aHRfcm1fZGF0YSB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2V0OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyYW5jaDogT2JqZWN0SWQuY3JlYXRlRnJvbUhleFN0cmluZygnNjUwOTg1YTM0NWUyZTg5NmIzN2VmZDRmJyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoMjAwKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg0MDMpOyAvLyBiYWNrIHRvIGhvbWVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnU1lTVEVNIHwgREVMRVRFX0JSQU5DSFMgfCBFUlJPUiB8ICcsIGVycik7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg1MDApO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8vIGNoYW5nZSBtYXJrIGRlYWRsaW5lXHJcbiAgICByb3V0ZXIucG9zdCgnL2NoYW5nZURlYWRMaW5lJywgY2hlY2tJZlVzZXJMb2dpbkFQSSwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgdXNlciA9IHJlcS5zZXNzaW9uLnVzZXI7XHJcbiAgICAgICAgICAgIC8vIG11c3QgYmUgZGVwYXJ0bWVudCB0byB1c2UgdGhpcyBhcGlcclxuICAgICAgICAgICAgaWYgKHVzZXIucG93WzZdKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gcmVxLmJvZHk7IC8vIGRhdGEgPSB7c2NoX3k6IFwiSEsxXzIwMjItMjAyM1wiLCBzdGFydF9kYXk6ICcxOC8xMC8yMDIzJywgZW5kX2RheTogJzE5LzExLzk5OTk5OTk5OTk5OTk5OTk5OSddfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgY3kgPSBkYXRhLnNjaF95LnNwbGl0KCdfJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAvLyBzZXQgZW5kIGRheSB0byBzcGVjaWFsIGRhdGUgaWYgaXQgaXMgJydcclxuICAgICAgICAgICAgICAgIGlmICghZGF0YS5lbmRfZGF5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5lbmRfZGF5ID0gJzIwMDMtMTAtMTgnOyAvLyBzcGVjaWFsIGRhdGVcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdzY2hvb2xfeWVhcicpXHJcbiAgICAgICAgICAgICAgICAgICAgLnVwZGF0ZU9uZShcclxuICAgICAgICAgICAgICAgICAgICAgICAge30sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzZXQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ZWFyOiBkYXRhLnNjaF95LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0X2RheTogbmV3IERhdGUoZGF0YS5zdGFydF9kYXkpLCAvLyBjaGFuZ2Ugc3RyaW5nIHRvIERhdGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmRfZGF5OiBuZXcgRGF0ZShkYXRhLmVuZF9kYXkpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgY29uc3Qga2V5dXBkYXRlID0gYHllYXJzLiR7Y3lbMV19YDtcclxuICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ2NsYXNzZXMnKVxyXG4gICAgICAgICAgICAgICAgICAgIC51cGRhdGVNYW55KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7fSxcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNldDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtrZXl1cGRhdGVdOiBbMSwgMiwgM10sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zZW5kU3RhdHVzKDIwMCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNDAzKTsgLy8gYmFjayB0byBob21lXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1NZU1RFTSB8IENIQU5HRV9ERUFETElORSB8IEVSUk9SIHwgJywgZXJyKTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zZW5kU3RhdHVzKDUwMCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gYXBpIGFkZCBvciBlZGl0IHRlYWNoZXIgb2YgZGVwYXJ0bWVudCBiYXNlIG9uIGl0IGV4aXN0IG9yIG5vdFxyXG4gICAgcm91dGVyLnBvc3QoJy9hZGRPckVkaXRUZWFjaGVycycsIGNoZWNrSWZVc2VyTG9naW5BUEksIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVzZXIgPSByZXEuc2Vzc2lvbi51c2VyO1xyXG4gICAgICAgICAgICBjb25zdCBkYXRhID0gcmVxLmJvZHk7IC8vIGRhdGEgPSB7b2xkX2lkOiBcIjE5MTEyMDAzXCIsIG5ld19pZDogXCIxODEwMjAwM1wiLCBuZXdfbmFtZTogXCJOZ3V54buFbiBWxINuIEFcIiwgYnJhbmNoOiBcIktUUE1cIn1cclxuXHJcbiAgICAgICAgICAgIC8vIG11c3QgYmUgZGVwYXJ0bWVudCB0byB1c2UgdGhpcyBhcGlcclxuICAgICAgICAgICAgaWYgKHVzZXIucG93WzhdKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBmaW5kIHRvIGdldCBvbGQgcGFzcyBvZiB0ZWFjaGVyIGJlZm9yZSByZW1vdmUgaXRcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRlYWNoZXJfcGFzcyA9IGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ2xvZ2luX2luZm8nKVxyXG4gICAgICAgICAgICAgICAgICAgIC5maW5kT25lKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaWQ6IGRhdGEub2xkX2lkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9qZWN0aW9uOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzc3dvcmQ6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAvLyBmaW5kIHRvIGdldCBjdXJyIGNsYXNzZXNcclxuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJfdGVhY2hlciA9IGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ3VzZXJfaW5mbycpXHJcbiAgICAgICAgICAgICAgICAgICAgLmZpbmRPbmUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogZGF0YS5vbGRfaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2plY3Rpb246IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzczogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdnQ6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW1haWw6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJfdGVhY2hlcikge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBvbGQgdGVhY2hlcnNcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBjbGllbnQuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKS5jb2xsZWN0aW9uKCd1c2VyX2luZm8nKS5kZWxldGVPbmUoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfaWQ6IGRhdGEub2xkX2lkLFxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBlZGl0IG9sZCBvbmVcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ3VzZXJfaW5mbycpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5pbnNlcnRPbmUoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2lkOiBkYXRhLm5ld19pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0X25hbWU6IGRhdGEubmV3X25hbWUuc3BsaXQoJyAnKS5zbGljZSgtMSkuam9pbignICcpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdF9uYW1lOiBkYXRhLm5ld19uYW1lLnNwbGl0KCcgJykuc2xpY2UoMCwgLTEpLmpvaW4oJyAnKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF2dDogY3Vycl90ZWFjaGVyLmF2dCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvd2VyOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAzOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M6IGN1cnJfdGVhY2hlci5jbGFzcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlOYW1lOiBkYXRhLm5ld19uYW1lLCAvLyBoZXJlIGJlZm9yZSBwb3BcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyYW5jaDogZGF0YS5icmFuY2gsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbWFpbDogY3Vycl90ZWFjaGVyLmVtYWlsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gYWRkIG5ldyBvbmVcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ3VzZXJfaW5mbycpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5pbnNlcnRPbmUoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2lkOiBkYXRhLm5ld19pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0X25hbWU6IGRhdGEubmV3X25hbWUuc3BsaXQoJyAnKS5zbGljZSgtMSkuam9pbignICcpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdF9uYW1lOiBkYXRhLm5ld19uYW1lLnNwbGl0KCcgJykuc2xpY2UoMCwgLTEpLmpvaW4oJyAnKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF2dDogJ2h0dHBzOi8vaS5waW5pbWcuY29tLzIzNngvODkvMDgvM2IvODkwODNiYmE0MDU0NWE3MmZhMTUzMjFhZjVmYWI3NjAtLWNoaWJpLWdpcmwtemVyby5qcGcnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG93ZXI6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAxOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDM6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgNDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzczogW10sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZTogZGF0YS5uZXdfbmFtZSwgLy8gaGVyZSBiZWZvcmUgcG9wXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmFuY2g6IGRhdGEuYnJhbmNoLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZW1haWw6ICcnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAodGVhY2hlcl9wYXNzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgY2xpZW50LmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcykuY29sbGVjdGlvbignbG9naW5faW5mbycpLmRlbGV0ZU9uZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogZGF0YS5vbGRfaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gZWRpdCBvbGQgb25lXHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdsb2dpbl9pbmZvJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmluc2VydE9uZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaWQ6IGRhdGEubmV3X2lkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzc3dvcmQ6IGhhc2hQYXNzd29yZCh0ZWFjaGVyX3Bhc3MucGFzc3dvcmQpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gYWRkIG5ldyBvbmVcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ2xvZ2luX2luZm8nKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuaW5zZXJ0T25lKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogZGF0YS5uZXdfaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzd29yZDogaGFzaFBhc3N3b3JkKGRhdGEubmV3X2lkKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNDAzKTsgLy8gYmFjayB0byBob21lXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cygyMDApO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnU1lTVEVNIHwgQUREX09SX0VESVRfQlJBTkNIUyB8IEVSUk9SIHwgJywgZXJyKTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zZW5kU3RhdHVzKDUwMCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gYXBpIGRlbGV0ZSB0ZWFjaGVycyBjaGVja2VkXHJcbiAgICByb3V0ZXIucG9zdCgnL2RlbGV0ZVRlYWNoZXJzJywgY2hlY2tJZlVzZXJMb2dpbkFQSSwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgdXNlciA9IHJlcS5zZXNzaW9uLnVzZXI7XHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSByZXEuYm9keTsgLy8gZGF0YSA9IHtybV90czogW1wiMTkxMTIwMDNcIiAodGVhY2hlcl9pZCksIC4uLl19XHJcblxyXG4gICAgICAgICAgICAvLyBtdXN0IGJlIGRlcGFydG1lbnQgdG8gdXNlIHRoaXMgYXBpXHJcbiAgICAgICAgICAgIGlmICh1c2VyLnBvd1s4XSkge1xyXG4gICAgICAgICAgICAgICAgLy8gcmVtb3ZlIGFsbCBjaGVrZWQgdGVhY2hlciBpbiByZW1vdmUgdGVhY2hlcnMgbMOtc3QgaW4gdXNlcl9pbmZvIGFuZCBsb2dpbl9pbmZvXHJcbiAgICAgICAgICAgICAgICBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCd1c2VyX2luZm8nKVxyXG4gICAgICAgICAgICAgICAgICAgIC5kZWxldGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2lkOiB7ICRpbjogZGF0YS5ybV90cyB9LFxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ2xvZ2luX2luZm8nKVxyXG4gICAgICAgICAgICAgICAgICAgIC5kZWxldGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2lkOiB7ICRpbjogZGF0YS5ybV90cyB9LFxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ2NsYXNzZXMnKVxyXG4gICAgICAgICAgICAgICAgICAgIC51cGRhdGVNYW55KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7IGN2aHQ6IHsgJGluOiBkYXRhLnJtX3RzIH0gfSwgLy8gxJBp4buBdSBraeG7h24gxJHhu4MgeMOhYyDEkeG7i25oIHTDoGkgbGnhu4d1IGPhuqduIGPhuq1wIG5o4bqtdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2V0OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3ZodDogT2JqZWN0SWQuY3JlYXRlRnJvbUhleFN0cmluZygnNjUwOTg1YTM0NWUyZTg5NmIzN2VmZDRmJyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAvLyBT4butIGThu6VuZyAkcHVsbCDEkeG7gyB4b8OhIGPDoWMgZ2nDoSB0cuG7iyB0cm9uZyBt4bqjbmcgY3ZodFxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNDAzKTsgLy8gYmFjayB0byBob21lXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cygyMDApO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnU1lTVEVNIHwgREVMRVRFX1RFQUNIRVIgfCBFUlJPUiB8ICcsIGVycik7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg1MDApO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8vIGFwaSBjaGVja2luIHN0dWRlbnRzIHRvIGFjdGl2aXR5XHJcbiAgICByb3V0ZXIucG9zdCgnL0NoZWNraW5BY3Rpdml0aWVzJywgY2hlY2tJZlVzZXJMb2dpbkFQSSwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgdXNlciA9IHJlcS5zZXNzaW9uLnVzZXI7XHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSByZXEuYm9keTsgLy8gZGF0YSA9IHtpZDogJzE5MTgxMDExJyAoYWN0aXZpdHkncyBpZCksIGxldmVsOiAoTOG7m3AvS2hvYS9Ucsaw4budbmcpO1xyXG4gICAgICAgICAgICBpZiAodXNlci5wb3dbMF0pIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoZGF0YS5sZXZlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ0zhu5twJzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZGIodXNlci5kZXApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbihgJHt1c2VyLmNsc1swXX1fYWN0aXZpdGllc2ApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudXBkYXRlT25lKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2lkOiBkYXRhLmlkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2V0OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbYHN0dWRlbnRfbGlzdC4ke3VzZXIuX2lkfWBdOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAkcHVzaDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgIGJvbnVzX2xpc3Q6IHVzZXIuX2lkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cHNlcnQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7IGlkOiB1c2VyLl9pZCwgY2xzOiB1c2VyLmNscyB9KTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlICdLaG9hJzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2F2ZSBhY3Rpdml0eSBpbiBhY3Rpdml0aWVzIGNvbGxlY3Rpb24gaW4gJ0RlcCBuYW1lJyBkYXRhYmFzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5kYih1c2VyLmRlcClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdhY3Rpdml0aWVzJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC51cGRhdGVPbmUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaWQ6IGRhdGEuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzZXQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtgc3R1ZGVudF9saXN0LiR7dXNlci5faWR9YF06IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICRwdXNoOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgYm9udXNfbGlzdDogdXNlci5faWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwc2VydDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgaWQ6IHVzZXIuX2lkLCBjbHM6IHVzZXIuY2xzIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ1RyxrDhu51uZyc6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdhY3Rpdml0aWVzJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC51cGRhdGVPbmUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaWQ6IGRhdGEuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzZXQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtgc3R1ZGVudF9saXN0LiR7dXNlci5faWR9YF06IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICRwdXNoOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgYm9udXNfbGlzdDogdXNlci5faWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwc2VydDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgaWQ6IHVzZXIuX2lkLCBjbHM6IHVzZXIuY2xzIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgbWVzc2FnZTogJ1Row7RuZyB0aW4geMOhYyB0aOG7sWMgc2FpIScgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNDAzKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gdXNlIGxhdGVyIHRvIHVwZGF0ZSBzdHVkZW50IGpvaW5pbmcgaW5zaWRlIGFjdGl2aXRpZXMgZGF0YWJhc2VcclxuICAgICAgICAgICAgLy8gc3R1ZGVudF9saXN0OiB7fSwgLy8gY2hhbmdlIGxhdGVyIHRvIGxpc3Qgb2Ygc3R1ZGVudCB3aXRoIHZhbHVlIGlzIGJvb2xlYW4gKHRydWUgZm9yIGpvaW5pbmcgYW5kIGZhbHNlIGZvciBub3Qgam9pbmluZylcclxuICAgICAgICAgICAgLy8gYm9udXNfbGlzdDogW10sIC8vIGxpc3Qgb2Ygc3R1ZGVudCdzIGlkIHRoYXQgaGF2ZSBib251cy5cclxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1NZU1RFTSB8IENIRUNLX0lOX0FDVElWSVRJRVMgfCBFUlJPUiB8ICcsIGVycik7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg1MDApO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8vIGFwaSDlh7rluK0gZ2FrdXNlaSB0byBhY3Rpdml0eVxyXG4gICAgcm91dGVyLnBvc3QoJy9tdXN0ZXInLCBjaGVja0lmVXNlckxvZ2luQVBJLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCB1c2VyID0gcmVxLnNlc3Npb24udXNlcjtcclxuICAgICAgICAgICAgY29uc3QgZGF0YSA9IHJlcS5ib2R5OyAvLyBkYXRhID0ge2lkOiAnMTkxODEwMTEnIChhY3Rpdml0eSdzIGlkKSwgbGV2ZWw6IChM4bubcC9LaG9hL1RyxrDhu51uZyk7XHJcbiAgICAgICAgICAgIGlmICh1c2VyLnBvd1swXSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChkYXRhLmxldmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnTOG7m3AnOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5kYih1c2VyLmRlcClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKGAke3VzZXIuY2xzWzBdfV9hY3Rpdml0aWVzYClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC51cGRhdGVPbmUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaWQ6IGRhdGEuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzZXQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtgYWkuJHt1c2VyLl9pZH1gXTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gJHB1c2g6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICBib251c19saXN0OiB1c2VyLl9pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBzZXJ0OiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlICdLaG9hJzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2F2ZSBhY3Rpdml0eSBpbiBhY3Rpdml0aWVzIGNvbGxlY3Rpb24gaW4gJ0RlcCBuYW1lJyBkYXRhYmFzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5kYih1c2VyLmRlcClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdhY3Rpdml0aWVzJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC51cGRhdGVPbmUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaWQ6IGRhdGEuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzZXQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtgYWkuJHt1c2VyLl9pZH1gXTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gJHB1c2g6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICBib251c19saXN0OiB1c2VyLl9pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBzZXJ0OiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlICdUcsaw4budbmcnOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbignYWN0aXZpdGllcycpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudXBkYXRlT25lKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2lkOiBkYXRhLmlkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2V0OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbYGFpLiR7dXNlci5faWR9YF06IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICRwdXNoOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgYm9udXNfbGlzdDogdXNlci5faWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwc2VydDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgLmRiKHVzZXIuZGVwKVxyXG4gICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKHVzZXIuY2xzWzBdICsgJ19zdGRfdGFibGUnKVxyXG4gICAgICAgICAgICAgICAgICAgIC51cGRhdGVPbmUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1zc3Y6IHVzZXIuX2lkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nob29sX3llYXI6IGRhdGEueWVhcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNldDogeyBbYGltZ19pZHMuJHtkYXRhLmlkfWBdOiBkYXRhLmltZ19pZHMgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeyB1cHNlcnQ6IHRydWUgfSxcclxuICAgICAgICAgICAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7IGlkOiB1c2VyLl9pZCwgY2xzOiB1c2VyLmNscyB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg0MDMpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyB1c2UgbGF0ZXIgdG8gdXBkYXRlIHN0dWRlbnQgam9pbmluZyBpbnNpZGUgYWN0aXZpdGllcyBkYXRhYmFzZVxyXG4gICAgICAgICAgICAvLyBzdHVkZW50X2xpc3Q6IHt9LCAvLyBjaGFuZ2UgbGF0ZXIgdG8gbGlzdCBvZiBzdHVkZW50IHdpdGggdmFsdWUgaXMgYm9vbGVhbiAodHJ1ZSBmb3Igam9pbmluZyBhbmQgZmFsc2UgZm9yIG5vdCBqb2luaW5nKVxyXG4gICAgICAgICAgICAvLyBib251c19saXN0OiBbXSwgLy8gbGlzdCBvZiBzdHVkZW50J3MgaWQgdGhhdCBoYXZlIGJvbnVzLlxyXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnU1lTVEVNIHwgQ0hFQ0tfSU5fQUNUSVZJVElFUyB8IEVSUk9SIHwgJywgZXJyKTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zZW5kU3RhdHVzKDUwMCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gYXBpIGFkZCBhbmQgZWRpdCBhY3Rpdml0aWVzIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIHJvdXRlci5wb3N0KCcvYWRkT3JFZGl0QWN0aXZpdGllcycsIGNoZWNrSWZVc2VyTG9naW5BUEksIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVzZXIgPSByZXEuc2Vzc2lvbi51c2VyO1xyXG4gICAgICAgICAgICBjb25zdCBkYXRhID0gcmVxLmJvZHk7IC8vIGRhdGEgPSB7YXR2X2lkOiAnMTkxODEwMTEnIChhY3Rpdml0eSdzIGlkKTtcclxuICAgICAgICAgICAgLy8gbmFtZTogJ0hvYXQgZG9uZyBoYXkgbmhhJztcclxuICAgICAgICAgICAgLy8gY29udGVudDogJ0RpIGR1IHRodSBub2knO1xyXG4gICAgICAgICAgICAvLyAnbGV2ZWwnOiAna2hvYSc7XHJcbiAgICAgICAgICAgIC8vIGNsc19pZDonS1RQTSc7XHJcbiAgICAgICAgICAgIC8vIHN0YXJ0X2RhdGU6ICcyMDIwLTA1LTE4JztcclxuICAgICAgICAgICAgLy8gc3RhcnRfaG91cjogJzE0OjEwOjMwJ31cclxuXHJcbiAgICAgICAgICAgIGlmICh1c2VyLnBvd1szXSAmJiB1c2VyLnBvd1sxMV0pIHtcclxuICAgICAgICAgICAgICAgIC8vIGdldCBjdXJyIHNjaG9vbCB5ZWFyXHJcbiAgICAgICAgICAgICAgICBjb25zdCBzY2hvb2xfeWVhciA9IGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ3NjaG9vbF95ZWFyJylcclxuICAgICAgICAgICAgICAgICAgICAuZmluZE9uZSh7fSwgeyBwcm9qZWN0aW9uOiB7IF9pZDogMCwgeWVhcjogMSB9IH0pO1xyXG4gICAgICAgICAgICAgICAgLy8gaWYgaXQgaXMgYSBuZXcgb25lIFNlbmQgZmFrZSBpZCBhbmQgc3VyZSB0aGF0IG5vdCBleGlzdCBpbiBkYXRhYmFzZVxyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChkYXRhLmxldmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnbG9wJzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2F2ZSBhY3Rpdml0eSBpbiAnQ2xhc3MgbmFtZScgKyBfYWN0aXZpdGllcyBjb2xsZWN0aW9uIGluICdEZXBhcnRtZW50IG5hbWUnIGRhdGFiYXNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmRiKHVzZXIuZGVwKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oZGF0YS5jbHNfaWQgKyAnX2FjdGl2aXRpZXMnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnVwZGF0ZU9uZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogZGF0YS5hdHZfaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzZXQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGRhdGEubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGRhdGEuY29udGVudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldmVsOiAnTOG7m3AnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xzOiBkYXRhLmNsc19pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHllYXI6IHNjaG9vbF95ZWFyLnllYXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydF90aW1lOiBuZXcgRGF0ZShbZGF0YS5zdGFydF9kYXRlLCBkYXRhLnN0YXJ0X2hvdXJdKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwc2VydDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIG90aGVyIGRhdGFiYXNlcyBpZiB0aGlzIGFjdGl2aXRpZXMgaW4gdGhvZXNlIGNvbGxlY3Rpb24gcmVtb3ZlIGl0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpLmNvbGxlY3Rpb24oJ2FjdGl2aXRpZXMnKS5kZWxldGVPbmUoeyBfaWQ6IGRhdGEuYXR2X2lkIH0pOyAvLyBzY2hvb2xcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudC5kYih1c2VyLmRlcCkuY29sbGVjdGlvbignYWN0aXZpdGllcycpLmRlbGV0ZU9uZSh7IF9pZDogZGF0YS5hdHZfaWQgfSk7IC8vIGRlcGFydG1lbnRcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSBpbmRleCBmb3IgbmV3IHRhYmxlIGhhcyBqdXN0IGNyZWF0ZWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZGIodXNlci5kZXApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbihkYXRhLmNsc19pZCArICdfYWN0aXZpdGllcycpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY3JlYXRlSW5kZXgoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ZWFyOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAnX3llYXInLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAna2hvYSc6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNhdmUgYWN0aXZpdHkgaW4gYWN0aXZpdGllcyBjb2xsZWN0aW9uIGluICdEZXAgbmFtZScgZGF0YWJhc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZGIodXNlci5kZXApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbignYWN0aXZpdGllcycpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudXBkYXRlT25lKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2lkOiBkYXRhLmF0dl9pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNldDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogZGF0YS5jb250ZW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV2ZWw6ICdLaG9hJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHllYXI6IHNjaG9vbF95ZWFyLnllYXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydF90aW1lOiBuZXcgRGF0ZShbZGF0YS5zdGFydF9kYXRlLCBkYXRhLnN0YXJ0X2hvdXJdKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwc2VydDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIG90aGVyIGRhdGFiYXNlcyBpZiB0aGlzIGFjdGl2aXRpZXMgaW4gdGhvZXNlIGNvbGxlY3Rpb24gcmVtb3ZlIGl0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpLmNvbGxlY3Rpb24oJ2FjdGl2aXRpZXMnKS5kZWxldGVPbmUoeyBfaWQ6IGRhdGEuYXR2X2lkIH0pOyAvLyBzY2hvb2xcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZGIodXNlci5kZXApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbihkYXRhLmNsc19pZCArICdfYWN0aXZpdGllcycpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZGVsZXRlT25lKHsgX2lkOiBkYXRhLmF0dl9pZCB9KTsgLy8gY2xhc3NcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSBpbmRleCBmb3IgbmV3IHRhYmxlIGhhcyBqdXN0IGNyZWF0ZWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgY2xpZW50LmRiKHVzZXIuZGVwKS5jb2xsZWN0aW9uKCdhY3Rpdml0aWVzJykuY3JlYXRlSW5kZXgoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeWVhcjogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ195ZWFyJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlICd0cnVvbmcnOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzYXZlIGFjdGl2aXR5IGluIGFjdGl2aXRpZXMgY29sbGVjdGlvbiBpbiBnbG9iYWwgZGF0YWJhc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ2FjdGl2aXRpZXMnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnVwZGF0ZU9uZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogZGF0YS5hdHZfaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzZXQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGRhdGEubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGRhdGEuY29udGVudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldmVsOiAnVHLGsOG7nW5nJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHllYXI6IHNjaG9vbF95ZWFyLnllYXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydF90aW1lOiBuZXcgRGF0ZShbZGF0YS5zdGFydF9kYXRlLCBkYXRhLnN0YXJ0X2hvdXJdKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwc2VydDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIG90aGVyIGRhdGFiYXNlcyBpZiB0aGlzIGFjdGl2aXRpZXMgaW4gdGhvZXNlIGNvbGxlY3Rpb24gcmVtb3ZlIGl0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudC5kYih1c2VyLmRlcCkuY29sbGVjdGlvbignYWN0aXZpdGllcycpLmRlbGV0ZU9uZSh7IF9pZDogZGF0YS5hdHZfaWQgfSk7IC8vIGRlcGFydG1lbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZGIodXNlci5kZXApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbihkYXRhLmNsc19pZCArICdfYWN0aXZpdGllcycpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZGVsZXRlT25lKHsgX2lkOiBkYXRhLmF0dl9pZCB9KTsgLy8gY2xhc3NcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNjaG9vbCBkYXRhYmFzZSBkbyBub3QgbmVlZCBjcmVhdGUgaW5kZXggYmVjYXVzZSBpdCBhbHJlYWR5IGhhdmUgaXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB3c3MuY2xpZW50cy5mb3JFYWNoKCh3cykgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh3cy5hY3RJZCA9PSBkYXRhLmF0dl9pZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3cy5zZW5kKCdyZWxvYWQnKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7IG1lc3NhZ2U6ICdTdWNjZXNzJyB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg0MDMpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyB1c2UgbGF0ZXIgdG8gdXBkYXRlIHN0dWRlbnQgam9pbmluZyBpbnNpZGUgYWN0aXZpdGllcyBkYXRhYmFzZVxyXG4gICAgICAgICAgICAvLyBzdHVkZW50X2xpc3Q6IHt9LCAvLyBjaGFuZ2UgbGF0ZXIgdG8gbGlzdCBvZiBzdHVkZW50IHdpdGggdmFsdWUgaXMgYm9vbGVhbiAodHJ1ZSBmb3Igam9pbmluZyBhbmQgZmFsc2UgZm9yIG5vdCBqb2luaW5nKVxyXG4gICAgICAgICAgICAvLyBib251c19saXN0OiBbXSwgLy8gbGlzdCBvZiBzdHVkZW50J3MgaWQgdGhhdCBoYXZlIGJvbnVzLlxyXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnU1lTVEVNIHwgQUREX0VESVRfQUNUSVZJVElFUyB8IEVSUk9SIHwgJywgZXJyKTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zZW5kU3RhdHVzKDUwMCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gYXBpIGxvYWQgYWN0aXZpdGllcyBiYXNlIG9uIHllYXJzIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIHJvdXRlci5wb3N0KCcvbG9hZFllYXJBY3Rpdml0aWVzJywgY2hlY2tJZlVzZXJMb2dpbkFQSSwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgdXNlciA9IHJlcS5zZXNzaW9uLnVzZXI7XHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSByZXEuYm9keTsgLy8gZGF0YSA9IHt5ZWFyOiAnMjAyMi0yMDIzJywgc2VtZXN0ZXI6ICcxJ31cclxuICAgICAgICAgICAgY29uc3QgY3Vycl95ZWFyID0gJ0hLJyArIGRhdGEuc2VtZXN0ZXIgKyAnXycgKyBkYXRhLnllYXI7XHJcbiAgICAgICAgICAgIGlmICh1c2VyLnBvd1szXSkge1xyXG4gICAgICAgICAgICAgICAgLy8gZmluZCBhbGwgYWN0aXZpdGllcyBpbiB0aGlzIHllYXI6XHJcbiAgICAgICAgICAgICAgICAvLyBnZXQgYWxsIGFjdGl2aXRpZXMgb2Ygc2Nob29sXHJcbiAgICAgICAgICAgICAgICBjb25zdCBzY2hvb2xfYXR2ID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbignYWN0aXZpdGllcycpXHJcbiAgICAgICAgICAgICAgICAgICAgLmZpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHllYXI6IGN1cnJfeWVhcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvamVjdGlvbjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ZWFyOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgLnRvQXJyYXkoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBnZXQgYWxsIGFjdGl2aXRpZXMgb2YgZGVwXHJcbiAgICAgICAgICAgICAgICBjb25zdCBkZXBfYXR2ID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgLmRiKHVzZXIuZGVwKVxyXG4gICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdhY3Rpdml0aWVzJylcclxuICAgICAgICAgICAgICAgICAgICAuZmluZChcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeWVhcjogY3Vycl95ZWFyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9qZWN0aW9uOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHllYXI6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICAudG9BcnJheSgpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIGdldCBhbGwgYWN0aXZpdGllcyBvZiBjbGFzcyBvZiBkZXBhcnRtZW50XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjb2xsZWN0aW9ucyA9IGF3YWl0IGNsaWVudC5kYih1c2VyLmRlcCkubGlzdENvbGxlY3Rpb25zKCkudG9BcnJheSgpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIEZpbHRlciBjb2xsZWN0aW9ucyBlbmRpbmcgd2l0aCAnX2FjdGl2aXRpZXMnXHJcbiAgICAgICAgICAgICAgICBjb25zdCBhY3Rpdml0eUNvbGxlY3Rpb25zID0gY29sbGVjdGlvbnMuZmlsdGVyKChjb2xsZWN0aW9uKSA9PiBjb2xsZWN0aW9uLm5hbWUuZW5kc1dpdGgoJ19hY3Rpdml0aWVzJykpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIExvb3AgdGhyb3VnaCBhY3Rpdml0eSBjb2xsZWN0aW9ucyBhbmQgcmV0cmlldmUgYWxsIGRvY3VtZW50c1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2xzX2F0dnMgPSBhd2FpdCBhY3Rpdml0eUNvbGxlY3Rpb25zLm1hcChhc3luYyAoY29sbGVjdGlvbikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh1c2VyLnBvd1sxXSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkdW1teSA9IGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmRiKHVzZXIuZGVwKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oY29sbGVjdGlvbi5uYW1lKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ZWFyOiBjdXJyX3llYXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsczogdXNlci5jbHNbMF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2plY3Rpb246IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xzOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeWVhcjogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRvQXJyYXkoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGR1bW15O1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGR1bW15ID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZGIodXNlci5kZXApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbihjb2xsZWN0aW9uLm5hbWUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZmluZChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHllYXI6IGN1cnJfeWVhcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvamVjdGlvbjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbHM6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ZWFyOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudG9BcnJheSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZHVtbXk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBQcm9taXNlLmFsbChjbHNfYXR2cylcclxuICAgICAgICAgICAgICAgICAgICAudGhlbigocmVzdWx0cykgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBLaGkgdOG6pXQgY+G6oyBjw6FjIHByb21pc2UgxJHDoyBob8OgbiB0aMOgbmgsIHJlc3VsdHMgc+G6vSBsw6AgbeG7mXQgbeG6o25nIGNo4bupYSBr4bq/dCBxdeG6oyB04burIG3hu5dpIHRydXkgduG6pW4uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIELhuqFuIGPDsyB0aOG7gyBsw6BtIGfDrCDEkcOzIHbhu5tpIGvhur90IHF14bqjIOG7nyDEkcOieS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2xzX2F0diA9IFtdLmNvbmNhdCguLi5yZXN1bHRzKTsgLy8gS+G6v3QgaOG7o3Aga+G6v3QgcXXhuqMgdOG7qyBjw6FjIHRydXkgduG6pW4gdsOgbyBt4buZdCBt4bqjbmcgZHV5IG5o4bqldFxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmluYWwgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2hvb2xfYXR2OiBzY2hvb2xfYXR2LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVwX2F0djogZGVwX2F0dixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsc19hdHY6IGNsc19hdHYsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbihmaW5hbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFjhu60gbMO9IGzhu5dpIG7hur91IGPDs1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnU1lTVEVNIHwgTE9BRF9ZRUFSX0FDVElWSVRJRVMgfCBFUlJPUiB8JywgZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zZW5kU3RhdHVzKDQwMyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1NZU1RFTSB8IExPQURfWUVBUl9BQ1RJVklUSUVTIHwgRVJST1IgfCAnLCBlcnIpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNTAwKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBhcGkgbG9hZCBhY3Rpdml0aWVzIGJhc2Ugb24gY2xhc3MgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgcm91dGVyLnBvc3QoJy9sb2FkQ2xhc3NBY3Rpdml0aWVzJywgY2hlY2tJZlVzZXJMb2dpbkFQSSwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgdXNlciA9IHJlcS5zZXNzaW9uLnVzZXI7XHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSByZXEuYm9keTsgLy8gZGF0YSA9IHtjbHM6ICdLVFBNMDEyMSd9XHJcbiAgICAgICAgICAgIGlmICh1c2VyLnBvd1szXSkge1xyXG4gICAgICAgICAgICAgICAgLy8gZ2V0IGFsbCBhY3Rpdml0aWVzIGluIHRoYXQgY2xhc3M6XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjbHNfYWN0ID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgLmRiKHVzZXIuZGVwKVxyXG4gICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKGRhdGEuY2xzICsgJ19hY3Rpdml0aWVzJylcclxuICAgICAgICAgICAgICAgICAgICAuZmluZCh7fSlcclxuICAgICAgICAgICAgICAgICAgICAudG9BcnJheSgpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbihjbHNfYWN0KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg0MDMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTWVNURU0gfCBMT0FEX0NMQVNTX0FDVElWSVRJRVMgfCBFUlJPUiB8ICcsIGVycik7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg1MDApO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8vIGFwaSBlbmQgYWN0aXZpdGllc1xyXG4gICAgcm91dGVyLnBvc3QoJy91cGRhdGVBY3Rpdml0aWVzU3RhdHVzJywgY2hlY2tJZlVzZXJMb2dpbkFQSSwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgdXNlciA9IHJlcS5zZXNzaW9uLnVzZXI7XHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSByZXEuYm9keTsgLy8gZGF0YSA9IHtfaWQ6IDE4MTAyMDAzIChhY3Rpdml0aWVzJyBpZCksIGxldmVsOiAnVHJ1b25nJywgc3RhdHVzOiAnMScgKDE6IMSRYW5nIGRp4buFbiByYSwgMDogxJHDoyBr4bq/dCB0aMO6Yyl9XHJcbiAgICAgICAgICAgIC8vIG11c3QgYmUgZGVwYXJ0bWVudCB0byB1c2UgdGhpcyBhcGlcclxuICAgICAgICAgICAgaWYgKHVzZXIucG93WzNdKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5sZXZlbCA9PSAnVHJ1b25nJykge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSBzdGF0dXMgb2YgY3VycmVudCBhY3Rpdml0eVxyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbignYWN0aXZpdGllcycpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC51cGRhdGVPbmUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2lkOiBkYXRhLl9pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNldDogeyBlbmQ6IGRhdGEuc3RhdHVzID09ICcxJyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YS5sZXZlbCA9PSAnS2hvYScpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyB1cGRhdGUgc3RhdHVzIG9mIGN1cnJlbnQgYWN0aXZpdHlcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmRiKHVzZXIuZGVwKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbignYWN0aXZpdGllcycpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC51cGRhdGVPbmUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2lkOiBkYXRhLl9pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNldDogeyBlbmQ6IGRhdGEuc3RhdHVzID09ICcxJyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gdXBkYXRlIHN0YXR1cyBvZiBjdXJyZW50IGFjdGl2aXR5XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kYih1c2VyLmRlcClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oZGF0YS5sZXZlbCArICdfYWN0aXZpdGllcycpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC51cGRhdGVPbmUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2lkOiBkYXRhLl9pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNldDogeyBlbmQ6IGRhdGEuc3RhdHVzID09ICcxJyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHdzcy5jbGllbnRzLmZvckVhY2goKHdzKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHdzLmFjdElkID09IGRhdGEuX2lkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdzLnNlbmQoJ3JlbG9hZCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zZW5kU3RhdHVzKDIwMCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNDAzKTsgLy8gc2VuZCB1c2VyIHRvIDQwMyBwYWdlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1NZU1RFTSB8IERFTEVURV9URUFDSEVSIHwgRVJST1IgfCAnLCBlcnIpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNTAwKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBhcGkgYXBwcm92YWwgc3R1ZGVudHMgam9pbiBpbiBhY3Rpdml0eVxyXG4gICAgcm91dGVyLnBvc3QoJy9hcHByb3ZhbEFjdGl2aXR5U3R1ZGVudCcsIGNoZWNrSWZVc2VyTG9naW5BUEksIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVzZXIgPSByZXEuc2Vzc2lvbi51c2VyO1xyXG4gICAgICAgICAgICBjb25zdCBkYXRhID0gcmVxLmJvZHk7IC8vIGRhdGEgPSB7X2lkOiBfaWQsIGxldmVsOiBsZXZlbCwgZGF0YVVwZGF0ZTogbGlzdCBvZiB1cGRhdGUgc3R1ZGVudHMsIGRlZmF1bHRBcHByb3ZhbDogb2xkIHN0dWRlbnQgbGlzdH1cclxuICAgICAgICAgICAgLy8gbXVzdCBiZSBkZXBhcnRtZW50IHRvIHVzZSB0aGlzIGFwaVxyXG4gICAgICAgICAgICBjb25zdCBhaSA9IHt9O1xyXG4gICAgICAgICAgICBPYmplY3Qua2V5cyhkYXRhLmRhdGFVcGRhdGUpLmZvckVhY2goKGtleSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgYWlba2V5XSA9IGRhdGEuZGF0YVVwZGF0ZVtrZXldID09PSAxID8gdHJ1ZSA6IGZhbHNlO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaWYgKHVzZXIucG93WzNdKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5sZXZlbCA9PSAnVHJ1b25nJykge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSBzdGF0dXMgb2YgY3VycmVudCBhY3Rpdml0eVxyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbignYWN0aXZpdGllcycpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC51cGRhdGVPbmUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2lkOiBkYXRhLl9pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNldDogeyBzdHVkZW50X2xpc3Q6IGRhdGEuZGF0YVVwZGF0ZSwgYWk6IGFpIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRhLmxldmVsID09ICdLaG9hJykge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSBzdGF0dXMgb2YgY3VycmVudCBhY3Rpdml0eVxyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZGIodXNlci5kZXApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdhY3Rpdml0aWVzJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnVwZGF0ZU9uZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaWQ6IGRhdGEuX2lkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2V0OiB7IHN0dWRlbnRfbGlzdDogZGF0YS5kYXRhVXBkYXRlLCBhaTogYWkgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSBzdGF0dXMgb2YgY3VycmVudCBhY3Rpdml0eVxyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZGIodXNlci5kZXApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKGRhdGEubGV2ZWwgKyAnX2FjdGl2aXRpZXMnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudXBkYXRlT25lKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogZGF0YS5faWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzZXQ6IHsgc3R1ZGVudF9saXN0OiBkYXRhLmRhdGFVcGRhdGUsIGFpOiBhaSB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoMjAwKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg0MDMpOyAvLyBzZW5kIHVzZXIgdG8gNDAzIHBhZ2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnU1lTVEVNIHwgQVBQUk9WQUwgQUNUSVZJVFkgU1RVREVOVFMgfCBFUlJPUiB8ICcsIGVycik7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg1MDApO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8vIGFwaSBkZWxldGUgc3R1ZGVudCBqb2luIGluIGFjdGl2aXR5XHJcbiAgICByb3V0ZXIucG9zdCgnL2RlbGV0ZUFjdGl2aXR5U3R1ZGVudCcsIGNoZWNrSWZVc2VyTG9naW5BUEksIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVzZXIgPSByZXEuc2Vzc2lvbi51c2VyO1xyXG4gICAgICAgICAgICBjb25zdCBkYXRhID0gcmVxLmJvZHk7IC8vIGRhdGEgPSB7X2lkOiBfaWQsIGxldmVsOiBsZXZlbCwgZGF0YURlbGV0ZTogZGF0YURlbGV0ZSB9XHJcblxyXG4gICAgICAgICAgICAvLyBtdXN0IGJlIGRlcGFydG1lbnQgdG8gdXNlIHRoaXMgYXBpXHJcbiAgICAgICAgICAgIGlmICh1c2VyLnBvd1szXSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEubGV2ZWwgPT0gJ1RydW9uZycpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyB1cGRhdGUgc3RhdHVzIG9mIGN1cnJlbnQgYWN0aXZpdHlcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBjbGllbnQuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKS5jb2xsZWN0aW9uKCdhY3Rpdml0aWVzJykudXBkYXRlT25lKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaWQ6IGRhdGEuX2lkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdW5zZXQ6IGRhdGEuZGF0YURlbGV0ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRhLmxldmVsID09ICdLaG9hJykge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSBzdGF0dXMgb2YgY3VycmVudCBhY3Rpdml0eVxyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudC5kYih1c2VyLmRlcCkuY29sbGVjdGlvbignYWN0aXZpdGllcycpLnVwZGF0ZU9uZShcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2lkOiBkYXRhLl9pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHVuc2V0OiBkYXRhLmJvbnVzRGVsZXRlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSBzdGF0dXMgb2YgY3VycmVudCBhY3Rpdml0eVxyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZGIodXNlci5kZXApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKGRhdGEubGV2ZWwgKyAnX2FjdGl2aXRpZXMnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudXBkYXRlT25lKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogZGF0YS5faWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR1bnNldDogZGF0YS5ib251c0RlbGV0ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zZW5kU3RhdHVzKDIwMCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNDAzKTsgLy8gc2VuZCB1c2VyIHRvIDQwMyBwYWdlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1NZU1RFTSB8IERFTEVURSBBQ1RJVklUWSBTVFVERU5UUyB8IEVSUk9SIHwgJywgZXJyKTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zZW5kU3RhdHVzKDUwMCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gYXBpIGRlbGV0ZSBhY3Rpdml0aWVzIGNoZWNrZWRcclxuICAgIHJvdXRlci5wb3N0KCcvZGVsZXRlQWN0aXZpdGllcycsIGNoZWNrSWZVc2VyTG9naW5BUEksIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVzZXIgPSByZXEuc2Vzc2lvbi51c2VyO1xyXG4gICAgICAgICAgICBjb25zdCBkYXRhID0gcmVxLmJvZHk7IC8vIGRhdGEgPSB7c2Nob29sX3JtYXR2OiBbXCIxOTExMjAwM1wiIChzY2hvb2xfYWN0aXZpdHlfaWQpLCAuLi5dLCBkZXBfcm1hdHY6IFtcIjI4MDkxOTc4XCIgKGRlcF9hY3Rpdml0eV9pZCksIC4uLl0sIGNsc19ybWF0djogW1wiMTgxMDIwMDNcIiAoY2xzX2FjdGl2aXR5X2lkKSwgLi4uXX1cclxuXHJcbiAgICAgICAgICAgIC8vIG11c3QgYmUgZGVwYXJ0bWVudCB0byB1c2UgdGhpcyBhcGlcclxuICAgICAgICAgICAgaWYgKHVzZXIucG93WzNdICYmIHVzZXIucG93WzExXSkge1xyXG4gICAgICAgICAgICAgICAgLy8gcmVtb3ZlIGFsbCBjaGVja2VkIHNjaG9vbCBhY3Rpdml0aWVzXHJcbiAgICAgICAgICAgICAgICBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdhY3Rpdml0aWVzJylcclxuICAgICAgICAgICAgICAgICAgICAuZGVsZXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogeyAkaW46IGRhdGEuc2Nob29sX3JtYXR2IH0sXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gcmVtb3ZlIGFsbCBjaGVja2VkIGRlcCBhY3Rpdml0aWVzXHJcbiAgICAgICAgICAgICAgICBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAuZGIodXNlci5kZXApXHJcbiAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ2FjdGl2aXRpZXMnKVxyXG4gICAgICAgICAgICAgICAgICAgIC5kZWxldGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2lkOiB7ICRpbjogZGF0YS5kZXBfcm1hdHYgfSxcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyByZW1vdmUgYWxsIGNoZWNrZWQgY2xhc3MgYWN0aXZpdGllc1xyXG4gICAgICAgICAgICAgICAgLy8gZ2V0IGFsbCBhY3Rpdml0aWVzIG9mIGNsYXNzIG9mIGRlcGFydG1lbnRcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNvbGxlY3Rpb25zID0gYXdhaXQgY2xpZW50LmRiKHVzZXIuZGVwKS5saXN0Q29sbGVjdGlvbnMoKS50b0FycmF5KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gRmlsdGVyIGNvbGxlY3Rpb25zIGVuZGluZyB3aXRoICdfYWN0aXZpdGllcydcclxuICAgICAgICAgICAgICAgIGNvbnN0IGFjdGl2aXR5Q29sbGVjdGlvbnMgPSBhd2FpdCBjb2xsZWN0aW9ucy5maWx0ZXIoKGNvbGxlY3Rpb24pID0+XHJcbiAgICAgICAgICAgICAgICAgICAgY29sbGVjdGlvbi5uYW1lLmVuZHNXaXRoKCdfYWN0aXZpdGllcycpLFxyXG4gICAgICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBMb29wIHRocm91Z2ggYWN0aXZpdHkgY29sbGVjdGlvbnMgYW5kIHJldHJpZXZlIGFsbCBkb2N1bWVudHNcclxuICAgICAgICAgICAgICAgIGFjdGl2aXR5Q29sbGVjdGlvbnMuZm9yRWFjaChhc3luYyAoYWN0aXZpdHlDb2xsZWN0aW9uKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kYih1c2VyLmRlcClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oYWN0aXZpdHlDb2xsZWN0aW9uLm5hbWUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kZWxldGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogeyAkaW46IGRhdGEuY2xzX3JtYXR2IH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zZW5kU3RhdHVzKDIwMCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNDAzKTsgLy8gc2VuZCB1c2VyIHRvIDQwMyBwYWdlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1NZU1RFTSB8IERFTEVURV9URUFDSEVSIHwgRVJST1IgfCAnLCBlcnIpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNTAwKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBsb2FkIGJhbmcgZGllbSBjdWEgZ2lhbyB2aWVuLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICByb3V0ZXIuZ2V0KCcvdGVhY2hlci9sb2FkU2NvcmVzTGlzdCcsIGNoZWNrSWZVc2VyTG9naW5BUEksIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVzZXIgPSByZXEuc2Vzc2lvbi51c2VyO1xyXG4gICAgICAgICAgICBpZiAodXNlci5wb3dbMV0pIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSByZXEucXVlcnk7XHJcbiAgICAgICAgICAgICAgICAvL2RhdGEgPSB7eWVhcjogXCJISzFfMjAyMi0yMDIzXCIsIGNsczogXCIxXCJ9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzY2hvb2xfeWVhciA9IGRhdGEueWVhcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHllYXJfYXZhaWxhYmxlID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbignc2Nob29sX3llYXInKVxyXG4gICAgICAgICAgICAgICAgICAgIC5maW5kT25lKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7fSxcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvamVjdGlvbjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ZWFyOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0X2RheTogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmRfZGF5OiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IHN0dWRlbnRfbGlzdCA9IHNvcnRTdHVkZW50TmFtZShcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ3VzZXJfaW5mbycpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBjbGFzczogZGF0YS5jbHMsICdwb3dlci4wJzogeyAkZXhpc3RzOiB0cnVlIH0gfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9qZWN0aW9uOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0X25hbWU6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RfbmFtZTogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxfc2NvcmU6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnRvQXJyYXkoKSxcclxuICAgICAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gZ2V0IGFsbCBzdHVkZW50IHRvdGFsIHNjb3JlIGZyb20gdGhlbXNlbGY6XHJcbiAgICAgICAgICAgICAgICBsZXQgcmVzdWx0ID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHN0YWZmX25hbWU6IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgIHN0dWRlbnRfbGlzdDogc3R1ZGVudF9saXN0LFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHN0dWRlbnRfc2NvcmVzOiBbXSxcclxuICAgICAgICAgICAgICAgICAgICAvLyBzdGFmZl9zY29yZXM6IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGRlcGFydG1lbnRfc2NvcmVzOiBbXSxcclxuICAgICAgICAgICAgICAgICAgICB5ZWFyX2F2YWlsYWJsZTogeWVhcl9hdmFpbGFibGUsXHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbihyZXN1bHQpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gdXNlciBub3Qgc3RhZmYgbWVtYmVyc1xyXG4gICAgICAgICAgICAgICAgLy8gcmVkaXJlY3QgdG8gaG9tZSAocmV0dXJuIDQwMywgYXBpIGtob25nIHRoZSBjaHV5ZW5oIGh1b25nIHZlIHRyYW5nIGNodSBkdW9jKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zZW5kU3RhdHVzKDQwMyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1NZU1RFTSB8IEdJQU9fVklFTl9MT0FEX1NDT1JFX0xJU1QgfCBFUlJPUiB8ICcsIGVycik7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg1MDApO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8vIGFwaSBhZGQgYW5kIGVkaXQgbmV3IGNsYXNzXHJcbiAgICByb3V0ZXIucG9zdCgnL2FkZE9yRWRpdENsYXNzZXMnLCBjaGVja0lmVXNlckxvZ2luQVBJLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCB1c2VyID0gcmVxLnNlc3Npb24udXNlcjtcclxuICAgICAgICAgICAgY29uc3QgZGF0YSA9IHJlcS5ib2R5OyAvLyBkYXRhID0ge25ld19pZDogS1RQTTAxMjEsIG9sZF9pZDogQ05UVDAyMjEsIGJyYW5jaDogS1RQTSwgY3ZodDogMTgxMDE5MTF9XHJcblxyXG4gICAgICAgICAgICAvLyBtdXN0IGJlIGRlcGFydG1lbnQgdG8gdXNlIHRoaXMgYXBpXHJcbiAgICAgICAgICAgIGlmICh1c2VyLnBvd1s5XSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc2Nob29sX3llYXIgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdzY2hvb2xfeWVhcicpXHJcbiAgICAgICAgICAgICAgICAgICAgLmZpbmRPbmUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHt9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9qZWN0aW9uOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2lkOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHllYXI6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgY3Vycl95ZWFyID0gc2Nob29sX3llYXIueWVhci5zcGxpdCgnXycpWzFdO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIGZpbmQgeWVhciBvZiBvbGRfaWQgY2xhc3MgYmVmb3JlIHJlbW92ZSBpdFxyXG4gICAgICAgICAgICAgICAgY29uc3Qgb2xkX2NsYXNzID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbignY2xhc3NlcycpXHJcbiAgICAgICAgICAgICAgICAgICAgLmZpbmRPbmUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogZGF0YS5vbGRfaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2plY3Rpb246IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaWQ6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeWVhcnM6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3ZodDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAob2xkX2NsYXNzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gcmVtb3ZlIG9sZF9pZCBjbGFzc1xyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpLmNvbGxlY3Rpb24oJ2NsYXNzZXMnKS5kZWxldGVPbmUoeyBfaWQ6IGRhdGEub2xkX2lkIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBhZGQgKGVkaXQgb2xkX2lkIGNsYXNzKVxyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpLmNvbGxlY3Rpb24oJ2NsYXNzZXMnKS5pbnNlcnRPbmUoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfaWQ6IGRhdGEubmV3X2lkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB5ZWFyczogb2xkX2NsYXNzLnllYXJzLCAvLyB5ZWFycyBvZiBvbGRfaWQgY2xhc3NcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJhbmNoOiBkYXRhLmJyYW5jaCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3ZodDogZGF0YS5jdmh0LFxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyByZW1vdmUgY2xhc3MgZnJvbSBvbGQgdGVhY2hlcidzIGNsYXNzXHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCd1c2VyX2luZm8nKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudXBkYXRlT25lKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogb2xkX2NsYXNzLmN2aHQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRwdWxsOiB7IGNsYXNzOiBkYXRhLm9sZF9pZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gYWRkIG5ldyBjbGFzcyB0byBuZXcgdGVhY2hlcidzIGNsYXNzXHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCd1c2VyX2luZm8nKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudXBkYXRlT25lKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogZGF0YS5jdmh0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYWRkVG9TZXQ6IHsgY2xhc3M6IGRhdGEubmV3X2lkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBhZGQgbmV3X2lkIGNsYXNzXHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdjbGFzc2VzJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmluc2VydE9uZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaWQ6IGRhdGEubmV3X2lkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeWVhcnM6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbYCR7Y3Vycl95ZWFyfWBdOiBbMSwgMiwgM10sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJhbmNoOiBkYXRhLmJyYW5jaCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN2aHQ6IGRhdGEuY3ZodCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGFkZCBuZXcgY2xhc3MgdG8gdGVhY2hlcidzIGNsYXNzXHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCd1c2VyX2luZm8nKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudXBkYXRlT25lKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogZGF0YS5jdmh0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYWRkVG9TZXQ6IHsgY2xhc3M6IGRhdGEubmV3X2lkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zZW5kU3RhdHVzKDQwMyk7IC8vIGJhY2sgdG8gaG9tZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoMjAwKTtcclxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1NZU1RFTSB8IEFERF9FRElUX0NMQVNTIHwgRVJST1IgfCAnLCBlcnIpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNTAwKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBhcGkgZGVsZXRlIGNsYXNzZXMgY2hlY2tlZFxyXG4gICAgcm91dGVyLnBvc3QoJy9kZWxldGVDbGFzc2VzJywgY2hlY2tJZlVzZXJMb2dpbkFQSSwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgdXNlciA9IHJlcS5zZXNzaW9uLnVzZXI7XHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSByZXEuYm9keTsgLy8gZGF0YSA9IHtybV9jbHM6IFtcIktUUE0wMTIxXCIgKGNsYXNzX2lkKSwgLi4uXSwgcm1fdHM6IFtcIjE4MTAxOTExXCIgKHRlYWNoZXJfaWQpLCAuLi5dfVxyXG5cclxuICAgICAgICAgICAgLy8gbXVzdCBiZSBkZXBhcnRtZW50IHRvIHVzZSB0aGlzIGFwaVxyXG4gICAgICAgICAgICBpZiAodXNlci5wb3dbOV0pIHtcclxuICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBhbGwgY2hlY2tlZCBjbGFzc2VzIGluIHJlbW92ZSBicmFuY2hzIGzDrXN0IGluIHVzZXJfaW5mbyBhbmQgbG9naW5faW5mb1xyXG4gICAgICAgICAgICAgICAgLy8gcmVtb3ZlIGNsYXNzIGZyb20gdGVhY2hlcidzIGNsYXNzXHJcbiAgICAgICAgICAgICAgICBhd2FpdCBkZWxldGVDbGFzc0FwaShkYXRhLCB1c2VyKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg0MDMpOyAvLyBiYWNrIHRvIGhvbWVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoMjAwKTtcclxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1NZU1RFTSB8IERFTEVURV9DTEFTUyB8IEVSUk9SIHwgJywgZXJyKTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zZW5kU3RhdHVzKDUwMCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gYXBpIGxvYWQgY2xhc3Nlc1xyXG4gICAgcm91dGVyLnBvc3QoJy9sb2FkQ2xhc3NlcycsIGNoZWNrSWZVc2VyTG9naW5BUEksIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVzZXIgPSByZXEuc2Vzc2lvbi51c2VyO1xyXG4gICAgICAgICAgICBjb25zdCBkYXRhID0gcmVxLmJvZHk7IC8vIGRhdGEgPSB7Y3Vycl9sb2FkX2JyYW5jaDogMSAobmV4dCBpbmRleCB0byBsb2FkKSwgYnJhbmNoczogW0tUUE0sIENOVFQsIC4uLl0gKGFsbCBicmFuY2ggaW4gZGVwYXJ0bWVudCl9XHJcblxyXG4gICAgICAgICAgICAvLyBtdXN0IGJlIGRlcGFydG1lbnQgdG8gdXNlIHRoaXMgYXBpXHJcbiAgICAgICAgICAgIGlmICh1c2VyLnBvd1s5XSkge1xyXG4gICAgICAgICAgICAgICAgLy8gZ2V0IGFsbCBjbGFzc2VzIG9mIG5vdCBsb2FkIGJyYW5jaHM6XHJcbiAgICAgICAgICAgICAgICBsZXQgY2xhc3NlcyA9IHt9OyAvLyBjbGFzc2VzID0ge0tUUE06IFtLVFBNMDEyMSwgS1RQTTAxMDgsIC4uLl0sIENOVFQ6IFtDTlRUMDEwOSwgQ05UVDAyMDksIC4uLl0sIC4uLn1cclxuICAgICAgICAgICAgICAgIGxldCBjbGFzc190ZWFjaGVycyA9IFtdOyAvLyBjbGFzc190ZWFjaGVycyA9IFsxODEwMjAwMywgMTkxMTIwMDMsIC4uLl1cclxuICAgICAgICAgICAgICAgIGxldCBuZXdfY3Vycl9sb2FkX2JyYW5jaDsgLy8gbmV4dCBmaW5hbCBicmFuY2ggbG9hZGVkXHJcblxyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IGRhdGEuY3Vycl9sb2FkX2JyYW5jaDsgaSA8IGRhdGEuYnJhbmNocy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBkdW1teSA9IGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbignY2xhc3NlcycpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyYW5jaDogZGF0YS5icmFuY2hzW2ldLl9pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIC8vIGZpbmQgYWxsIGRhdGFcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9qZWN0aW9uOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN2aHQ6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnRvQXJyYXkoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY2xhc3Nlc1tkYXRhLmJyYW5jaHNbaV0uX2lkXSA9IGR1bW15Lm1hcCgoY2xzKSA9PiBjbHMuX2lkKTtcclxuICAgICAgICAgICAgICAgICAgICBjbGFzc190ZWFjaGVycy5wdXNoKC4uLmR1bW15Lm1hcCgoY2xzKSA9PiBjbHMuY3ZodCkpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBuZXdfY3Vycl9sb2FkX2JyYW5jaCA9IGkgKyAxO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGZpbmlzaCBsb2FkIG9uZSBicmFjaCB0aGVuIGNoZWNrIGRvZXMgbnVtYmVyIG9mIGNsYXNzZXMgb3ZlciAzMC5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoY2xhc3NfdGVhY2hlcnMubGVuZ3RoID49IDMwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAvLyBnZXQgYWxsIHRlYWNoZXIncyBuYW1lIG9mIGNsYXNzZXNcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY2xhc3NfdGVhY2hlcnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyByZXBsYWNlIGN1cnJlbnQgdGVhY2hlcidzIF9pZCB3aXRoIHRlYWNoZXIncyBuYW1lXHJcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NfdGVhY2hlcnNbaV0gPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ3VzZXJfaW5mbycpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kT25lKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogY2xhc3NfdGVhY2hlcnNbaV0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3Bvd2VyLjEnOiB7ICRleGlzdHM6IHRydWUgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAncG93ZXIuNCc6IHsgJGV4aXN0czogdHJ1ZSB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgLy8gdXNlciBpcyB0ZWFjaGVyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvamVjdGlvbjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJzdF9uYW1lOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0X25hbWU6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcclxuICAgICAgICAgICAgICAgICAgICBjbGFzc2VzOiBjbGFzc2VzLFxyXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzX3RlYWNoZXJzOiBjbGFzc190ZWFjaGVycyxcclxuICAgICAgICAgICAgICAgICAgICBuZXdfY3Vycl9sb2FkX2JyYW5jaDogbmV3X2N1cnJfbG9hZF9icmFuY2gsXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg0MDMpOyAvLyBiYWNrIHRvIGhvbWVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnU1lTVEVNIHwgREVMRVRFX0NMQVNTIHwgRVJST1IgfCAnLCBlcnIpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNTAwKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIHJvdXRlci5wb3N0KCcvZXhwb3J0YWNjb3VudCcsIHVwbG9hZC5zaW5nbGUoJ2ZpbGUnKSwgY2hlY2tJZlVzZXJMb2dpbkFQSSwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgdXNlciA9IHJlcS5zZXNzaW9uLnVzZXI7XHJcbiAgICAgICAgICAgIGNvbnN0IENsYXNzID0gcmVxLmJvZHkuY2xhc3M7XHJcbiAgICAgICAgICAgIGNvbnN0IHN0dWRlbnRMaXN0ID0gc29ydFN0dWRlbnROYW1lKFxyXG4gICAgICAgICAgICAgICAgYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbigndXNlcl9pbmZvJylcclxuICAgICAgICAgICAgICAgICAgICAuZmluZChcclxuICAgICAgICAgICAgICAgICAgICAgICAgeyBjbGFzczogQ2xhc3MsICdwb3dlci4wJzogeyAkZXhpc3RzOiB0cnVlIH0gfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvamVjdGlvbjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0X25hbWU6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RfbmFtZTogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgIC50b0FycmF5KCksXHJcbiAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB3b3JrYm9vayA9IGF3YWl0IFhsc3hQb3B1bGF0ZS5mcm9tRmlsZUFzeW5jKCcuL3NyYy9leGNlbFRlbXBsYXRlL0ZJTEVfVEFPX0FDQy54bHN4Jyk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBkYXRhUm93cyA9IFtdO1xyXG5cclxuICAgICAgICAgICAgZm9yIChjb25zdCBzdHVkZW50IG9mIHN0dWRlbnRMaXN0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBsb2dpbkluZm8gPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdsb2dpbl9pbmZvJylcclxuICAgICAgICAgICAgICAgICAgICAuZmluZE9uZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgeyBfaWQ6IHN0dWRlbnQuX2lkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2plY3Rpb246IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaWQ6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzc3dvcmQ6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICBpZiAobG9naW5JbmZvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0YVJvdyA9IFtzdHVkZW50Ll9pZCwgbG9naW5JbmZvLnBhc3N3b3JkLCBzdHVkZW50Lmxhc3RfbmFtZSwgc3R1ZGVudC5maXJzdF9uYW1lXTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YVJvd3MucHVzaChkYXRhUm93KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGRhdGFSb3dzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHdvcmtib29rLnNoZWV0KDApLmNlbGwoJ0EyJykudmFsdWUoZGF0YVJvd3MpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCB1dWlkID0gdXVpZHY0KCk7XHJcbiAgICAgICAgICAgIGNvbnN0IG91dHB1dEZpbGUgPSBwYXRoLmpvaW4oYC5kb3dubG9hZHMvJHt1dWlkfS54bHN4YCk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB3b3JrYm9vay50b0ZpbGVBc3luYyhvdXRwdXRGaWxlKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2cocGF0aC5qb2luKCcuZG93bmxvYWRzJywgdXVpZCArICcueGxzeCcpKTtcclxuICAgICAgICAgICAgc2NoZWR1bGVGaWxlRGVsZXRpb24ocGF0aC5qb2luKCcuZG93bmxvYWRzJywgdXVpZCArICcueGxzeCcpKTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5kb3dubG9hZChwYXRoLmpvaW4oJy5kb3dubG9hZHMnLCB1dWlkICsgJy54bHN4JykpO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnU1lTVEVNIHwgRVhQT1JUIEFDQ09VTlQgfCBFUlJPUiB8ICcsIGVycik7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg1MDApO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgLy8gYXBpIGdldCBpbWcgYWN0aSBzdHVkZW50XHJcbiAgICByb3V0ZXIucG9zdCgnL2dldEltZ0FjdGl2aXRpZXMnLCBjaGVja0lmVXNlckxvZ2luQVBJLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCB1c2VyID0gcmVxLnNlc3Npb24udXNlcjtcclxuICAgICAgICAgICAgY29uc3QgZGF0YSA9IHJlcS5ib2R5OyAvLyBkYXRhID0ge2N1cnJfbG9hZF9icmFuY2g6IDEgKG5leHQgaW5kZXggdG8gbG9hZCksIGJyYW5jaHM6IFtLVFBNLCBDTlRULCAuLi5dIChhbGwgYnJhbmNoIGluIGRlcGFydG1lbnQpfVxyXG5cclxuICAgICAgICAgICAgLy8gbXVzdCBiZSBkZXBhcnRtZW50IHRvIHVzZSB0aGlzIGFwaVxyXG4gICAgICAgICAgICBpZiAodXNlci5wb3dbM10pIHtcclxuICAgICAgICAgICAgICAgIGltZ2xpc3QgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAuZGIodXNlci5kZXApXHJcbiAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oZGF0YS5jbGFzcyArICdfc3RkX3RhYmxlJylcclxuICAgICAgICAgICAgICAgICAgICAuZmluZE9uZShcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbXNzdjogZGF0YS5faWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2hvb2xfeWVhcjogZGF0YS55ZWFyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9qZWN0aW9uOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW1nX2lkczogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIGlmIChkYXRhLmlkYWN0IGluIGltZ2xpc3QuaW1nX2lkcykge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBpbWdpbmZvID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIGltZ2xpc3QuaW1nX2lkc1tkYXRhLmlkYWN0XSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbWdpbmZvLnB1c2goYXdhaXQgc2VydmVyLmdldERyaXZlRmlsZUxpbmtBbmREZXNjcmlwdGlvbihpKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oaW1naW5mbyk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNDAzKTsgLy8gYmFjayB0byBob21lXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1NZU1RFTSB8IExPQURfSU1HX1NUVURFTlRTIHwgRVJST1IgfCAnLCBlcnIpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNTAwKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gcm91dGVyO1xyXG59XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGNyZWF0ZUFQSVJvdXRlcjtcclxuIl0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxPQUFPLEdBQUdDLE9BQU8sQ0FBQyxTQUFTLENBQUM7QUFDbEMsTUFBTUMsTUFBTSxHQUFHRixPQUFPLENBQUNHLE1BQU0sQ0FBQyxDQUFDO0FBQy9CLE1BQU1DLFlBQVksR0FBR0gsT0FBTyxDQUFDLGVBQWUsQ0FBQztBQUM3QyxNQUFNO0VBQUVJLEVBQUUsRUFBRUM7QUFBTyxDQUFDLEdBQUdMLE9BQU8sQ0FBQyxNQUFNLENBQUM7QUFDdEMsTUFBTU0sSUFBSSxHQUFHTixPQUFPLENBQUMsTUFBTSxDQUFDO0FBQzVCLE1BQU1PLEVBQUUsR0FBR1AsT0FBTyxDQUFDLElBQUksQ0FBQztBQUN4QixNQUFNUSxlQUFlLEdBQUdGLElBQUksQ0FBQ0csSUFBSSxDQUFDLG1CQUFtQixDQUFDO0FBQ3RELE1BQU1DLE1BQU0sR0FBR1YsT0FBTyxDQUFDLFFBQVEsQ0FBQztBQUNoQyxNQUFNVyxNQUFNLEdBQUdYLE9BQU8sQ0FBQyx3QkFBd0IsQ0FBQztBQUVo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Q0FBQ2UsT0FBTyxDQUFDRCxJQUFJO01BQzdCLE1BQU1GLElBQUksR0FBR1osR0FBRyxDQUFDYSxJQUFJLENBQUMsQ0FBQzs7TUFFdkI7TUFDQSxJQUFJQyxJQUFJLENBQUNpQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUU7UUFDYnVPLE9BQU8sR0FBRyxNQUFNOVEsTUFBTSxDQUNqQlEsRUFBRSxDQUFDRixJQUFJLENBQUMrQixHQUFHLENBQUMsQ0FDWjVCLFVBQVUsQ0FBQ0wsSUFBSSxDQUFDVSxLQUFLLEdBQUcsWUFBWSxDQUFDLENBQ3JDSixPQUFPLENBQ0o7VUFDSUUsSUFBSSxFQUFFUixJQUFJLENBQUNPLEdBQUc7VUFDZHlKLFdBQVcsRUFBRWhLLElBQUksQ0FBQ2lLO1FBQ3RCLENBQUMsRUFDRDtVQUNJbEksVUFBVSxFQUFFO1lBQ1J1RSxPQUFPLEVBQUU7VUFDYjtRQUNKLENBQ0osQ0FBQztRQUNMLElBQUl0RyxJQUFJLENBQUMyUSxLQUFLLElBQUlELE9BQU8sQ0FBQ3BLLE9BQU8sRUFBRTtVQUMvQixJQUFJc0ssT0FBTyxHQUFHLEVBQUU7VUFDaEIsS0FBSyxNQUFNckwsQ0FBQyxJQUFJbUwsT0FBTyxDQUFDcEssT0FBTyxDQUFDdEcsSUFBSSxDQUFDMlEsS0FBSyxDQUFDLEVBQUU7WUFDekNDLE9BQU8sQ0FBQ2pMLElBQUksQ0FBQyxNQUFNN0gsTUFBTSxDQUFDK1MsOEJBQThCLENBQUN0TCxDQUFDLENBQUMsQ0FBQztVQUNoRTtVQUVBLE9BQU94RixHQUFHLENBQUMyQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQ2lPLE9BQU8sQ0FBQztRQUN4QyxDQUFDLE1BQU0sT0FBTzdRLEdBQUcsQ0FBQzJDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLENBQUM7TUFDeEMsQ0FBQyxNQUFNO1FBQ0gsT0FBTzVDLEdBQUcsQ0FBQ2EsVUFBVSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7TUFDaEM7SUFDSixDQUFDLENBQUMsT0FBT2lDLEdBQUcsRUFBRTtNQUNWQyxPQUFPLENBQUNDLEdBQUcsQ0FBQyx1Q0FBdUMsRUFBRUYsR0FBRyxDQUFDO01BQ3pELE9BQU85QyxHQUFHLENBQUNhLFVBQVUsQ0FBQyxHQUFHLENBQUM7SUFDOUI7RUFDSixDQUFDLENBQUM7RUFFRixPQUFPeEQsTUFBTTtBQUNqQjtBQUVBMFQsTUFBTSxDQUFDQyxPQUFPLEdBQUdwUixlQUFlIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["express","require","router","Router","XlsxPopulate","v4","uuidv4","path","fs","uploadDirectory","join","multer","server","ObjectId","getNameGlobal","name_global_databases","comparePassword","hashPassword","sortStudentName","scheduleFileDeletion","mark","updateStudentTotalScore","sendEmail","randomPassword","checkIfUserLoginAPI","createId","get_full_id","deleteClassApi","createPdf","existsSync","mkdirSync","storage_file","diskStorage","destination","req","file","cb","filename","originalname","upload","storage","createAPIRouter","client","wss","post","res","data","body","user","session","db","collection","findOne","_id","mssv","user_info_check","class","deleteOne","sendStatus","password","seasionIDs","sessionId","existingDocs","find","$in","toArray","existingIDs","map","doc","idsToDelete","filter","id","includes","length","updateOne","$pull","cls","projection","power","dep","branch","pow","remember","cookie","maxAge","$push","upsert","first","status","json","check","err","console","log","get","destroy","processSessionIDs","redirect","error","result","listSeasionId","splice","indexOf","$ne","deleteMany","clients","forEach","ws","send","$set","displayName","avt","OTP","otp","otpcode","dataUser","email","OTPscode","expireAt","Date","now","old_pass","old_password","new_password","$unset","marker","last_name","first_name","marked","array","files","list_name","list_dep","i","fileName","fileDescription","descripts","push","writeHead","end","JSON","stringify","single","dummyScore","second","third","fourth","fifth","img_ids","total","fileStudents","generateEmail","str","s1","s0","newStr","listSpace","output","charAt","slice","replace","toLowerCase","workbook","fromFileAsync","sheet","values","usedRange","value","expectedValues","isCorrect","endCell","rowCount","rowNumber","columnCount","column","cell","havevalue","row","hasValue","maxWidthEmail","dataRows","pw","toString","dataInsertUser","total_score","dataInsertLogin","dataRow","range","style","border","width","uuid","toFileAsync","workbookacc","outputFile","download","studentIdToCheck","dataStudent","listDelete","dataDelete","info_search","updateMany","$exists","student_list","ai","query","school_year","year","scores","curr_score","curr_departmentt_score","j","stdlist","parse","type","name","std","stf","curr_students_score","curr_staff_score","temp_namefile","year_available","start_day","end_day","statusCode","std_list","std_table","parseInt","reqClass","limit","skip","transformedData","item","role","dang_vien","cham_diem","lap_hoat_dong","schoolYearParam","schoolYear","schoolYearsToSearch","studentTotalScores","Promise","all","studentTotalScore","old_name","insertOne","rm_bs","dummy_class","cvht","cls_rm_data","cvht_rm_data","requestData","rm_cls","rm_ts","createFromHexString","cy","sch_y","split","keyupdate","teacher_pass","old_id","curr_teacher","new_id","new_name","level","message","cls_id","atv_id","content","start_time","start_date","start_hour","createIndex","actId","curr_year","semester","school_atv","dep_atv","collections","listCollections","activityCollections","endsWith","cls_atvs","dummy","then","results","cls_atv","concat","final","catch","cls_act","Object","keys","dataUpdate","key","bonusDelete","school_rmatv","dep_rmatv","activityCollection","cls_rmatv","old_class","years","$addToSet","classes","class_teachers","new_curr_load_branch","curr_load_branch","branchs","Class","studentList","student","loginInfo","imglist","idact","imginfo","getDriveFileLinkAndDescription","module","exports"],"sourceRoot":"D:\\project\\web\\newCDRL-1\\backend\\router\\","sources":["apiRouters.js"],"sourcesContent":["const express = require('express');\r\nconst router = express.Router();\r\nconst XlsxPopulate = require('xlsx-populate');\r\nconst { v4: uuidv4 } = require('uuid');\r\nconst path = require('path');\r\nconst fs = require('fs');\r\nconst uploadDirectory = path.join('../../upload_temp');\r\nconst multer = require('multer');\r\nconst server = require('../lib/csdl_google_lib');\r\n\r\nconst { ObjectId } = require('mongodb');\r\nconst { getNameGlobal } = require('../lib/mogodb_lib');\r\nconst name_global_databases = getNameGlobal();\r\nconst {\r\n    comparePassword,\r\n    hashPassword,\r\n    sortStudentName,\r\n    scheduleFileDeletion,\r\n    mark,\r\n    updateStudentTotalScore,\r\n    sendEmail,\r\n    randomPassword,\r\n    checkIfUserLoginAPI,\r\n    createId,\r\n    get_full_id,\r\n    deleteClassApi,\r\n    createPdf,\r\n} = require('../lib/function_lib');\r\n\r\nif (!fs.existsSync(uploadDirectory)) {\r\n    fs.mkdirSync(uploadDirectory);\r\n}\r\nconst storage_file = multer.diskStorage({\r\n    destination: function (req, file, cb) {\r\n        cb(null, uploadDirectory);\r\n    },\r\n    filename: function (req, file, cb) {\r\n        cb(null, file.originalname);\r\n    },\r\n});\r\nconst upload = multer({ storage: storage_file });\r\n\r\n// API SPACE ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\nfunction createAPIRouter(client, wss) {\r\n    // Log in --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n    router.post('/login', async (req, res) => {\r\n        const data = req.body;\r\n        // 403: sai thong tin dang nhap\r\n        // data = {mssv: bbp, password: 1234567890, remember: true}\r\n        try {\r\n            const user = req.session.user;\r\n            if (!user) {\r\n                //(log in database)\r\n                let user = await client.db(name_global_databases).collection('login_info').findOne({ _id: data.mssv });\r\n                let user_info_check = await client\r\n                    .db(name_global_databases)\r\n                    .collection('user_info')\r\n                    .findOne({ _id: data.mssv });\r\n                if (user === null || user_info_check === null || user_info_check.class == []) {\r\n                    // kiểm tra nếu bên login có info mà bên user k có thì xoá bên login (ghost account)\r\n                    if (user) {\r\n                        await client.db(name_global_databases).collection('login_info').deleteOne({ _id: data.mssv });\r\n                    }\r\n                    if (user_info_check) {\r\n                        await client.db(name_global_databases).collection('user_info').deleteOne({ _id: data.mssv });\r\n                    }\r\n                    // Đăng nhập không thành công\r\n                    return res.sendStatus(403);\r\n                } else if (user._id === data.mssv && comparePassword(data.password, user.password)) {\r\n                    let seasionIDs = await client\r\n                        .db(name_global_databases)\r\n                        .collection('sessions_manager')\r\n                        .findOne({ _id: data.mssv });\r\n                    if (seasionIDs) {\r\n                        seasionIDs = seasionIDs.sessionId;\r\n                        const existingDocs = await client\r\n                            .db(name_global_databases)\r\n                            .collection('sessions')\r\n                            .find({ _id: { $in: seasionIDs } })\r\n                            .toArray();\r\n                        const existingIDs = existingDocs.map((doc) => doc._id);\r\n                        const idsToDelete = seasionIDs.filter((id) => !existingIDs.includes(id));\r\n                        if (idsToDelete.length > 0) {\r\n                            await client\r\n                                .db(name_global_databases)\r\n                                .collection('sessions_manager')\r\n                                .updateOne({ _id: data.mssv }, { $pull: { sessionId: { $in: idsToDelete } } });\r\n                        }\r\n                    }\r\n\r\n                    // get user class(cls), power and department(dep)\r\n                    const cls = await client\r\n                        .db(name_global_databases)\r\n                        .collection('user_info')\r\n                        .findOne({ _id: data.mssv }, { projection: { _id: 0, class: 1, power: 1, dep: 1 } });\r\n\r\n                    if (!cls.power[2]) {\r\n                        const branch = await client\r\n                            .db(name_global_databases)\r\n                            .collection('classes')\r\n                            .findOne({ _id: cls.class[0] }, { projection: { _id: 0, branch: 1 } });\r\n                        if (branch) {\r\n                            const dep = await client\r\n                                .db(name_global_databases)\r\n                                .collection('branchs')\r\n                                .findOne({ _id: branch.branch }, { projection: { _id: 0, dep: 1 } });\r\n\r\n                            user.dep = dep.dep;\r\n                        }\r\n                        user.cls = cls.class;\r\n                    } else {\r\n                        user.dep = cls.dep;\r\n                    }\r\n                    user.pow = cls.power;\r\n                    // Đăng nhập thành công, lưu thông tin người dùng vào phiên\r\n                    req.session.user = user;\r\n                    // Kiểm tra xem người dùng có chọn \"Remember me\" không\r\n                    if (data.remember) {\r\n                        // Thiết lập thời gian sống cookie lâu hơn để lưu thông tin đăng nhập trong 30 ngày\r\n                        req.session.cookie.maxAge = 30 * 24 * 60 * 60 * 1000; // 30 days\r\n                    } else {\r\n                        // Thiết lập thời gian sống cookie lại về mặc định (1 giờ)\r\n                        req.session.cookie.maxAge = 3600000; // 1 hour\r\n                    }\r\n                    const sessionId = req.session.id;\r\n                    await client\r\n                        .db(name_global_databases)\r\n                        .collection('sessions_manager')\r\n                        .updateOne({ _id: user._id }, { $push: { sessionId: sessionId } }, { upsert: true });\r\n\r\n                    if (user.first == 'new_user') {\r\n                        return res.status(200).json({ check: true });\r\n                    } else {\r\n                        return res.status(200).json({ check: false });\r\n                    }\r\n                } else {\r\n                    // Đăng nhập không thành công\r\n                    return res.sendStatus(403);\r\n                }\r\n            } else {\r\n                return res.sendStatus(404);\r\n            }\r\n        } catch (err) {\r\n            console.log('SYSTEM | LOG_IN | ERROR | ', err);\r\n            return res.sendStatus(500);\r\n        }\r\n    });\r\n\r\n    // Logout ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n    router.get('/logout', checkIfUserLoginAPI, async (req, res) => {\r\n        // Xóa thông tin phiên (session) của người dùng\r\n        const mssv = req.session.user._id;\r\n        req.session.destroy((err) => {\r\n            if (err) {\r\n                console.log('SYSTEM | LOG_OUT | Failed to logout:', err);\r\n                return res.sendStatus(500);\r\n            } else {\r\n                let seasionIDs;\r\n                async function processSessionIDs() {\r\n                    try {\r\n                        seasionIDs = await client\r\n                            .db(name_global_databases)\r\n                            .collection('sessions_manager')\r\n                            .findOne({ _id: mssv });\r\n                        if (seasionIDs) {\r\n                            seasionIDs = seasionIDs.sessionId;\r\n                            const existingDocs = await client\r\n                                .db(name_global_databases)\r\n                                .collection('sessions')\r\n                                .find({ _id: { $in: seasionIDs } })\r\n                                .toArray();\r\n                            const existingIDs = existingDocs.map((doc) => doc._id);\r\n                            const idsToDelete = seasionIDs.filter((id) => !existingIDs.includes(id));\r\n\r\n                            if (idsToDelete.length > 0) {\r\n                                await client\r\n                                    .db(name_global_databases)\r\n                                    .collection('sessions_manager')\r\n                                    .updateOne({ _id: mssv }, { $pull: { sessionId: { $in: idsToDelete } } });\r\n                            }\r\n                        }\r\n\r\n                        return res.redirect('/login'); // Chạy hàm dưới sau khi đã xử lý xong\r\n                    } catch (error) {\r\n                        console.log('SYSTEM | LOG_OUT | Failed to clean up sessions:', error);\r\n                        return res.sendStatus(500);\r\n                    }\r\n                }\r\n\r\n                processSessionIDs();\r\n            }\r\n        });\r\n    });\r\n\r\n    // Đăng xuất tất cả thiết bị\r\n    router.get('/logoutAlldevice', checkIfUserLoginAPI, async (req, res) => {\r\n        // Xóa thông tin phiên (session) của người dùng\r\n        const _id = req.session.user._id;\r\n        const result = await client.db(name_global_databases).collection('sessions_manager').findOne({ _id: _id });\r\n        const listSeasionId = result.sessionId;\r\n        listSeasionId.splice(listSeasionId.indexOf(req.session.id), 1);\r\n        await client\r\n            .db(name_global_databases)\r\n            .collection('sessions_manager')\r\n            .updateOne(\r\n                { _id: _id },\r\n\r\n                { $pull: { sessionId: { $ne: req.session.id } } },\r\n            );\r\n        await client\r\n            .db(name_global_databases)\r\n            .collection('sessions')\r\n            .deleteMany({ _id: { $in: listSeasionId } });\r\n        wss.clients.forEach((ws) => {\r\n            if (listSeasionId.includes(ws.id)) {\r\n                ws.send('reload');\r\n            }\r\n        });\r\n        return res.sendStatus(200);\r\n    });\r\n\r\n    // Đổi thông tin người dùng --------------------------------------------------------------------------------------------------------------------------------\r\n    router.post('/updateInfo', checkIfUserLoginAPI, async (req, res) => {\r\n        try {\r\n            const data = req.body;\r\n            await client\r\n                .db(name_global_databases)\r\n                .collection('user_info')\r\n                .updateOne(\r\n                    { _id: req.session.user._id },\r\n                    {\r\n                        $set: {\r\n                            displayName: data.displayName,\r\n                            avt: data.avt,\r\n                        },\r\n                    },\r\n                );\r\n            return res.sendStatus(200);\r\n        } catch (err) {\r\n            console.log('SYSTEM | UPDATE_INFO | ERROR | ', err);\r\n            return res.sendStatus(500);\r\n        }\r\n    });\r\n\r\n    // Reset pass ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n    router.post('/resetpassword', async (req, res) => {\r\n        try {\r\n            const data = req.body;\r\n            const OTP = await client\r\n                .db(name_global_databases)\r\n                .collection('OTP')\r\n                .findOne({ _id: data.mssv }, { projection: { _id: 0 } });\r\n            if (OTP && comparePassword(data.otp, OTP.otpcode)) {\r\n                await client\r\n                    .db(name_global_databases)\r\n                    .collection('login_info')\r\n                    .updateOne({ _id: data.mssv }, { $set: { first: 'otp' } });\r\n                //(log in database)\r\n                let user = await client.db(name_global_databases).collection('login_info').findOne({ _id: data.mssv });\r\n                await client.db(name_global_databases).collection('OTP').deleteOne({ _id: data.mssv });\r\n                let seasionIDs = await client\r\n                    .db(name_global_databases)\r\n                    .collection('sessions_manager')\r\n                    .findOne({ _id: data.mssv });\r\n                if (seasionIDs) {\r\n                    seasionIDs = seasionIDs.sessionId;\r\n                    const existingDocs = await client\r\n                        .db(name_global_databases)\r\n                        .collection('sessions')\r\n                        .find({ _id: { $in: seasionIDs } })\r\n                        .toArray();\r\n                    const existingIDs = existingDocs.map((doc) => doc._id);\r\n                    const idsToDelete = seasionIDs.filter((id) => !existingIDs.includes(id));\r\n                    if (idsToDelete.length > 0) {\r\n                        await client\r\n                            .db(name_global_databases)\r\n                            .collection('sessions_manager')\r\n                            .updateOne({ _id: data.mssv }, { $pull: { sessionId: { $in: idsToDelete } } });\r\n                    }\r\n                }\r\n\r\n                // get user class(cls), power and department(dep)\r\n                const cls = await client\r\n                    .db(name_global_databases)\r\n                    .collection('user_info')\r\n                    .findOne({ _id: data.mssv }, { projection: { _id: 0, class: 1, power: 1, dep: 1 } });\r\n\r\n                if (!cls.power[2]) {\r\n                    const branch = await client\r\n                        .db(name_global_databases)\r\n                        .collection('classes')\r\n                        .findOne({ _id: cls.class[0] }, { projection: { _id: 0, branch: 1 } });\r\n                    if (branch) {\r\n                        const dep = await client\r\n                            .db(name_global_databases)\r\n                            .collection('branchs')\r\n                            .findOne({ _id: branch.branch }, { projection: { _id: 0, dep: 1 } });\r\n\r\n                        user.dep = dep.dep;\r\n                    }\r\n                    user.cls = cls.class;\r\n                } else {\r\n                    user.dep = cls.dep;\r\n                }\r\n                user.pow = cls.power;\r\n                // Đăng nhập thành công, lưu thông tin người dùng vào phiên\r\n                req.session.user = user;\r\n                // Kiểm tra xem người dùng có chọn \"Remember me\" không\r\n                if (data.remember) {\r\n                    // Thiết lập thời gian sống cookie lâu hơn để lưu thông tin đăng nhập trong 30 ngày\r\n                    req.session.cookie.maxAge = 30 * 24 * 60 * 60 * 1000; // 30 days\r\n                } else {\r\n                    // Thiết lập thời gian sống cookie lại về mặc định (1 giờ)\r\n                    req.session.cookie.maxAge = 3600000; // 1 hour\r\n                }\r\n                const sessionId = req.session.id;\r\n                await client\r\n                    .db(name_global_databases)\r\n                    .collection('sessions_manager')\r\n                    .updateOne({ _id: user._id }, { $push: { sessionId: sessionId } }, { upsert: true });\r\n                return res.sendStatus(200);\r\n            } else {\r\n                res.sendStatus(403);\r\n            }\r\n        } catch (err) {\r\n            console.log('SYSTEM | RESET_PASSWORD | ERROR | ', err);\r\n            return res.sendStatus(500);\r\n        }\r\n    });\r\n\r\n    // Resent OTP ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n    router.post('/resendotp', async (req, res) => {\r\n        try {\r\n            const mssv = req.body.mssv;\r\n            const dataUser = await client\r\n                .db(name_global_databases)\r\n                .collection('user_info')\r\n                .findOne({ _id: mssv }, { projection: { _id: 0, email: 1 } });\r\n            // Thêm tài liệu mới có thời gian hết hạn sau 1 phút\r\n            const OTPscode = await randomPassword();\r\n            await client\r\n                .db(name_global_databases)\r\n                .collection('OTP')\r\n                .updateOne(\r\n                    { _id: mssv },\r\n                    {\r\n                        $set: {\r\n                            otpcode: hashPassword(OTPscode),\r\n                            expireAt: new Date(Date.now() + 60 * 5 * 1000), // Hết hạn sau 5 phút\r\n                        },\r\n                    },\r\n                    { upsert: true },\r\n                );\r\n            if (dataUser) {\r\n                const email = dataUser.email;\r\n                await sendEmail(OTPscode, email);\r\n            }\r\n            return res.sendStatus(200);\r\n        } catch (err) {\r\n            console.log('SYSTEM | RESEND_OTP | ERROR | ', err);\r\n            return res.sendStatus(500);\r\n        }\r\n    });\r\n\r\n    // Đổi pass ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n    router.post('/change_pass', checkIfUserLoginAPI, async (req, res) => {\r\n        try {\r\n            const data = req.body;\r\n            const old_pass = await client\r\n                .db(name_global_databases)\r\n                .collection('login_info')\r\n                .findOne({ _id: req.session.user._id }, { projection: { _id: 0, password: 1 } });\r\n            if (comparePassword(data.old_password, old_pass.password)) {\r\n                if (!comparePassword(data.new_password, old_pass.password)) {\r\n                    await client\r\n                        .db(name_global_databases)\r\n                        .collection('login_info')\r\n                        .updateOne(\r\n                            { _id: req.session.user._id },\r\n                            { $set: { password: hashPassword(data.new_password) } },\r\n                        );\r\n                    return res.sendStatus(200);\r\n                } else {\r\n                    return res.sendStatus(403);\r\n                }\r\n            } else {\r\n                res.sendStatus(404);\r\n            }\r\n        } catch (err) {\r\n            console.log('SYSTEM | CHANGE_PASSWORD | ERROR | ', err);\r\n            return res.sendStatus(500);\r\n        }\r\n    });\r\n\r\n    // Đổi pass lần đầu đăng nhập -------------------------------------------------------------------------------------------------------------------------------\r\n    router.post('/first_login', checkIfUserLoginAPI, async (req, res) => {\r\n        try {\r\n            const data = req.body;\r\n            const old_pass = await client\r\n                .db(name_global_databases)\r\n                .collection('login_info')\r\n                .findOne({ _id: req.session.user._id }, { projection: { _id: 0, password: 1 } });\r\n\r\n            if (comparePassword(data.new_password, old_pass.password)) {\r\n                return res.sendStatus(403);\r\n            } else {\r\n                delete req.session.user.first;\r\n                await client\r\n                    .db(name_global_databases)\r\n                    .collection('login_info')\r\n                    .updateOne({ _id: req.session.user._id }, { $unset: { first: '' } });\r\n                await client\r\n                    .db(name_global_databases)\r\n                    .collection('login_info')\r\n                    .updateOne({ _id: req.session.user._id }, { $set: { password: hashPassword(data.new_password) } });\r\n                return res.sendStatus(200);\r\n            }\r\n        } catch (err) {\r\n            console.log('SYSTEM | CHANGE_PASSWORD | ERROR | ', err);\r\n            return res.sendStatus(500);\r\n        }\r\n    });\r\n\r\n    // Save table and update old table std------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n    router.post('/std_mark', checkIfUserLoginAPI, async (req, res) => {\r\n        try {\r\n            const user = req.session.user;\r\n            if (user.pow[0]) {\r\n                const data = req.body;\r\n                const marker = await client\r\n                    .db(name_global_databases)\r\n                    .collection('user_info')\r\n                    .findOne(\r\n                        { _id: user._id },\r\n                        {\r\n                            projection: {\r\n                                _id: 0,\r\n                                last_name: 1,\r\n                                first_name: 1,\r\n                            },\r\n                        },\r\n                    );\r\n\r\n                const marked = await mark('_std_table', user, user._id, data, marker, user.cls[0]);\r\n\r\n                switch (marked) {\r\n                    case 0:\r\n                        return res.sendStatus(200);\r\n                    case 1:\r\n                        return res.sendStatus(203);\r\n                    case 2:\r\n                        return res.sendStatus(205);\r\n                }\r\n            } else {\r\n                return res.sendStatus(403);\r\n            }\r\n        } catch (err) {\r\n            console.log('SYSTEM | STD_MARK | ERROR | ', err);\r\n            return res.sendStatus(500);\r\n        }\r\n    });\r\n\r\n    // Save table and update old table stf------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n    router.post('/stf_mark', checkIfUserLoginAPI, async (req, res) => {\r\n        const user = req.session.user;\r\n        if (user.pow[1]) {\r\n            try {\r\n                const data = req.body;\r\n                const marker = await client\r\n                    .db(name_global_databases)\r\n                    .collection('user_info')\r\n                    .findOne(\r\n                        { _id: user._id },\r\n                        {\r\n                            projection: {\r\n                                _id: 0,\r\n                                last_name: 1,\r\n                                first_name: 1,\r\n                            },\r\n                        },\r\n                    );\r\n\r\n                const marked = await mark('_stf_table', user, data.mssv, data, marker, data.class);\r\n\r\n                switch (marked) {\r\n                    case 0:\r\n                        return res.sendStatus(200);\r\n                    case 1:\r\n                        return res.sendStatus(203);\r\n                    case 2:\r\n                        return res.sendStatus(205);\r\n                }\r\n            } catch (err) {\r\n                console.log('SYSTEM | STF_MARK | ERROR | ', err);\r\n                return res.sendStatus(500);\r\n            }\r\n        } else if (user.pow[4]) {\r\n            try {\r\n                const data = req.body;\r\n                const marker = await client\r\n                    .db(name_global_databases)\r\n                    .collection('user_info')\r\n                    .findOne(\r\n                        { _id: user._id },\r\n                        {\r\n                            projection: {\r\n                                _id: 0,\r\n                                last_name: 1,\r\n                                first_name: 1,\r\n                            },\r\n                        },\r\n                    );\r\n\r\n                const marked = await mark('_stf_table', user, data.mssv, data, marker, user.cls[0]);\r\n\r\n                switch (marked) {\r\n                    case 0:\r\n                        return res.sendStatus(200);\r\n                    case 1:\r\n                        return res.sendStatus(203);\r\n                    case 2:\r\n                        return res.sendStatus(205);\r\n                }\r\n            } catch (err) {\r\n                console.log('SYSTEM | STF_MARK | ERROR | ', err);\r\n                return res.sendStatus(500);\r\n            }\r\n        } else {\r\n            return res.sendStatus(403);\r\n        }\r\n    });\r\n\r\n    // Save table and update old table dep------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n    router.post('/dep_mark', checkIfUserLoginAPI, async (req, res) => {\r\n        const user = req.session.user;\r\n        if (user.pow[2]) {\r\n            try {\r\n                const data = req.body;\r\n                const marker = await client\r\n                    .db(name_global_databases)\r\n                    .collection('user_info')\r\n                    .findOne(\r\n                        { _id: user._id },\r\n                        {\r\n                            projection: {\r\n                                _id: 0,\r\n                                last_name: 1,\r\n                                first_name: 1,\r\n                            },\r\n                        },\r\n                    );\r\n\r\n                const marked = await mark('_dep_table', user, data.mssv, data, marker, data.class);\r\n\r\n                switch (marked) {\r\n                    case 0:\r\n                        return res.sendStatus(200);\r\n                    case 1:\r\n                        return res.sendStatus(203);\r\n                }\r\n\r\n                return res.sendStatus(200);\r\n            } catch (err) {\r\n                console.log('SYSTEM | STF_MARK | ERROR | ', err);\r\n                return res.sendStatus(500);\r\n            }\r\n        } else {\r\n            return res.sendStatus(403);\r\n        }\r\n    });\r\n\r\n    // Upload file -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n    router.post('/uploadFile', upload.array('files[]'), checkIfUserLoginAPI, async function (req, res) {\r\n        if (!req.files) {\r\n            return res.status(400).send('No file uploaded.');\r\n        }\r\n        let list_name = [];\r\n        let list_dep = [];\r\n        // Kiểm tra kiểu dữ liệu của các tệp\r\n        for (let i = 0; i < req.files.length; i++) {\r\n            const fileName = req.files[i].originalname;\r\n            const fileDescription = req.body.descripts[i]; // Trích xuất mô tả tương ứng từ danh sách descripts[]\r\n            list_dep.push(fileDescription);\r\n            list_name.push(fileName);\r\n        }\r\n\r\n        // Xử lý các tệp đã tải lên ở đây\r\n        res.writeHead(200, { 'Content-Type': 'applicaiton/json' });\r\n        return res.end(JSON.stringify(await get_full_id(uploadDirectory, list_name, list_dep)));\r\n    });\r\n\r\n    // Create new account -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n    router.post('/createAccount', upload.single('file'), checkIfUserLoginAPI, async (req, res) => {\r\n        const user = req.session.user;\r\n        const dummyScore = {\r\n            first: [0, 0, 0, 0, 0],\r\n            second: [0, 0],\r\n            third: [0, 0, 0],\r\n            fourth: [0, 0, 0],\r\n            fifth: [0, 0, 0, 0],\r\n            img_ids: [],\r\n            total: 0,\r\n        };\r\n\r\n        if (user.pow[4] || user.pow[7]) {\r\n            const fileStudents = req.file;\r\n            async function generateEmail(str) {\r\n                let s1 =\r\n                    'ÀÁÂÃÈÉÊÌÍÒÓÔÕÙÚÝàáâãèéêìíòóôõùúýĂăĐđĨĩŨũƠơƯưẠạẢảẤấẦầẨẩẪẫẬậẮắẰằẲẳẴẵẶặẸẹẺẻẼẽẾếỀềỂểỄễỆệỈỉỊịỌọỎỏỐốỒồỔổỖỗỘộỚớỜờỞởỠỡỢợỤụỦủỨứỪừỬửỮữỰựỲỳỴỵỶỷỸỹ';\r\n                let s0 =\r\n                    'AAAAEEEIIOOOOUUYaaaaeeeiioooouuyAaDdIiUuOoUuAaAaAaAaAaAaAaAaAaAaAaAaEeEeEeEeEeEeEeEeEeIiIiOoOoOoOoOoOoOoOoOoOoOoUuUuUuUuUuUuUuYyYyYyYy';\r\n                let newStr = '';\r\n                let listSpace = [];\r\n                for (let i = 0; i < str.length; i++) {\r\n                    if (s1.indexOf(str[i]) != -1) {\r\n                        newStr += s0[s1.indexOf(str[i])];\r\n                    } else {\r\n                        newStr += str[i];\r\n                    }\r\n                    if (str[i] == ' ') {\r\n                        listSpace.push(i);\r\n                    }\r\n                }\r\n                let output = newStr[0];\r\n                for (let i = 0; i < listSpace.length - 2; i++) {\r\n                    output += newStr.charAt(listSpace[i] + 1);\r\n                }\r\n                output += newStr.slice(listSpace[listSpace.length - 2] + 1).replace(/\\s/g, '');\r\n                return output.toLowerCase() + '@student.ctuet.edu.vn';\r\n            }\r\n\r\n            if (fileStudents) {\r\n                const workbook = await XlsxPopulate.fromFileAsync(fileStudents.path);\r\n                const sheet = workbook.sheet(0);\r\n                // const sheetCount = workbook.sheetCount();\r\n                const values = sheet.usedRange().value();\r\n                const usedRange = sheet.usedRange();\r\n\r\n                const expectedValues = ['MSSV', 'HỌ', 'TÊN'];\r\n                // const columnCount = expectedValues.length;\r\n                let isCorrect = true;\r\n                const endCell = usedRange.endCell();\r\n                const rowCount = endCell.rowNumber();\r\n                const columnCount = 3;\r\n\r\n                for (let column = 1; column <= columnCount; column++) {\r\n                    const cell = sheet.cell(1, column); // Ô đầu tiên trên hàng 1 và cột column\r\n                    const value = cell.value();\r\n\r\n                    if (value !== expectedValues[column - 1]) {\r\n                        isCorrect = false;\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                if (isCorrect) {\r\n                    let havevalue = true;\r\n\r\n                    for (let row = 2; row <= 5; row++) {\r\n                        let hasValue = false;\r\n                        for (let column = 1; column <= columnCount; column++) {\r\n                            const cell = sheet.cell(row, column);\r\n                            const value = cell.value();\r\n\r\n                            if (value) {\r\n                                hasValue = true;\r\n                                break;\r\n                            }\r\n                        }\r\n\r\n                        if (hasValue) {\r\n                            break;\r\n                        } else {\r\n                            havevalue = false;\r\n                            break;\r\n                        }\r\n                    }\r\n                    if (havevalue) {\r\n                        if (req.body.status == 'true') {\r\n                            try {\r\n                                // read excel file:\r\n                                // create all account\r\n\r\n                                let maxWidthEmail = 0;\r\n                                //[['MSSV', 'Họ', 'Tên' ]]\r\n                                sheet.cell('D1').value('Email');\r\n                                sheet.cell('E1').value('Password');\r\n                                const dataRows = [];\r\n                                for (let i = 1; i < values.length; i++) {\r\n                                    let pw = await randomPassword();\r\n                                    let email = await generateEmail(\r\n                                        `${values[i][1].toString()} ${values[i][2].toString()} ${values[\r\n                                            i\r\n                                        ][0].toString()}`,\r\n                                    );\r\n                                    let dataInsertUser = {\r\n                                        _id: values[i][0].toString(),\r\n                                        first_name: values[i][2].toString(),\r\n                                        last_name: values[i][1].toString(),\r\n                                        avt: 'https://i.pinimg.com/236x/89/08/3b/89083bba40545a72fa15321af5fab760--chibi-girl-zero.jpg',\r\n                                        power: { 0: true },\r\n                                        class: [req.body.cls],\r\n                                        displayName: `${values[i][1].toString()} ${values[i][2].toString()}`,\r\n                                        email: email,\r\n                                        total_score: {},\r\n                                    };\r\n                                    let dataInsertLogin = {\r\n                                        _id: values[i][0].toString(),\r\n                                        password: hashPassword(pw),\r\n                                        first: 'new_user',\r\n                                    };\r\n\r\n                                    const dataRow = [\r\n                                        dataInsertUser._id,\r\n                                        pw,\r\n                                        dataInsertUser.last_name,\r\n                                        dataInsertUser.first_name,\r\n                                    ];\r\n                                    dataRows.push(dataRow);\r\n\r\n                                    client.db('global').collection('user_info').updateOne(\r\n                                        {\r\n                                            _id: dataInsertUser._id,\r\n                                        },\r\n                                        {\r\n                                            $set: dataInsertUser,\r\n                                        },\r\n                                        {\r\n                                            upsert: true,\r\n                                        },\r\n                                    );\r\n                                    client.db('global').collection('login_info').updateOne(\r\n                                        {\r\n                                            _id: dataInsertLogin._id,\r\n                                        },\r\n                                        {\r\n                                            $set: dataInsertLogin,\r\n                                        },\r\n                                        {\r\n                                            upsert: true,\r\n                                        },\r\n                                    );\r\n                                    await mark(\r\n                                        '_std_table',\r\n                                        user,\r\n                                        dataInsertUser._id,\r\n                                        dummyScore,\r\n                                        {\r\n                                            first_name: dataInsertUser.first_name,\r\n                                            last_name: dataInsertUser.last_name,\r\n                                        },\r\n                                        dataInsertUser.class[0],\r\n                                    );\r\n                                    await sheet.cell(`D${i + 1}`).value(email);\r\n                                    await sheet.cell(`E${i + 1}`).value(pw);\r\n                                    const range = sheet.range(`D${i + 1}:E${i + 1}`);\r\n                                    range.style({ border: true });\r\n                                    if (email.length > maxWidthEmail) {\r\n                                        maxWidthEmail = email.length;\r\n                                    }\r\n                                }\r\n                                // Write to file.\r\n                                sheet.column('D').width(maxWidthEmail);\r\n                                const uuid = uuidv4();\r\n                                await workbook.toFileAsync(path.join('.downloads', uuid + '.xlsx'));\r\n                                // xoa file sau khi xu ly\r\n                                scheduleFileDeletion(path.join('.downloads', uuid + '.xlsx'));\r\n                                const workbookacc = await XlsxPopulate.fromFileAsync(\r\n                                    './src/excelTemplate/FILE_TAO_ACC.xlsx',\r\n                                );\r\n\r\n                                if (dataRows.length > 0) {\r\n                                    await workbookacc.sheet(0).cell('A2').value(dataRows);\r\n                                }\r\n                                const outputFile = path.join(`.downloads/${uuid}.xlsx`);\r\n\r\n                                await workbookacc.toFileAsync(outputFile);\r\n                                scheduleFileDeletion(path.join('.downloads', uuid + '.xlsx'));\r\n                                return res.download(path.join('.downloads', uuid + '.xlsx'));\r\n                            } catch (err) {\r\n                                console.log('SYSTEM | CREATE_ACCOUNT | ERROR | ', err);\r\n                                return res.sendStatus(500);\r\n                            }\r\n                        } else {\r\n                            try {\r\n                                // read excel file:\r\n                                // create all account\r\n                                const workbook = await XlsxPopulate.fromFileAsync(fileStudents.path);\r\n                                const sheet = workbook.sheet(0);\r\n\r\n                                const values = sheet.usedRange().value();\r\n                                let maxWidthEmail = 0;\r\n                                //[['MSSV', 'Họ', 'Tên' ]]\r\n                                sheet.cell('D1').value('Email');\r\n                                sheet.cell('E1').value('Password');\r\n                                for (let i = 1; i < values.length; i++) {\r\n                                    let studentIdToCheck = values[i][0].toString(); // Mã số sinh viên cần kiểm tra\r\n\r\n                                    const marker = await client\r\n                                        .db(name_global_databases)\r\n                                        .collection('user_info')\r\n                                        .findOne(\r\n                                            { _id: studentIdToCheck },\r\n                                            {\r\n                                                projection: {\r\n                                                    _id: 0,\r\n                                                    last_name: 1,\r\n                                                    first_name: 1,\r\n                                                },\r\n                                            },\r\n                                        );\r\n                                    if (!marker) {\r\n                                        let pw = await randomPassword();\r\n                                        let email = await generateEmail(\r\n                                            `${values[i][1]} ${values[i][2]} ${values[i][0].toString()}`,\r\n                                        );\r\n                                        let dataInsertUser = {\r\n                                            _id: values[i][0].toString(),\r\n                                            first_name: values[i][2].toString(),\r\n                                            last_name: values[i][1].toString(),\r\n                                            avt: 'https://i.pinimg.com/236x/89/08/3b/89083bba40545a72fa15321af5fab760--chibi-girl-zero.jpg',\r\n                                            power: { 0: true },\r\n                                            class: [req.body.cls],\r\n                                            displayName: `${values[i][1].toString()} ${values[i][2].toString()}`,\r\n                                            email: email,\r\n                                            total_score: {},\r\n                                        };\r\n                                        let dataInsertLogin = {\r\n                                            _id: values[i][0].toString(),\r\n                                            password: hashPassword(pw),\r\n                                            first: 'new_user',\r\n                                        };\r\n                                        client.db('global').collection('user_info').updateOne(\r\n                                            {\r\n                                                _id: dataInsertUser._id,\r\n                                            },\r\n                                            {\r\n                                                $set: dataInsertUser,\r\n                                            },\r\n                                            {\r\n                                                upsert: true,\r\n                                            },\r\n                                        );\r\n                                        client.db('global').collection('login_info').updateOne(\r\n                                            {\r\n                                                _id: dataInsertLogin._id,\r\n                                            },\r\n                                            {\r\n                                                $set: dataInsertLogin,\r\n                                            },\r\n                                            {\r\n                                                upsert: true,\r\n                                            },\r\n                                        );\r\n                                        await mark(\r\n                                            '_std_table',\r\n                                            user,\r\n                                            dataInsertUser._id,\r\n                                            dummyScore,\r\n                                            {\r\n                                                first_name: dataInsertUser.first_name,\r\n                                                last_name: dataInsertUser.last_name,\r\n                                            },\r\n                                            dataInsertUser.class[0],\r\n                                        );\r\n                                        await sheet.cell(`D${i + 1}`).value(email);\r\n                                        await sheet.cell(`E${i + 1}`).value(pw);\r\n                                        const range = sheet.range(`D${i + 1}:E${i + 1}`);\r\n                                        range.style({ border: true });\r\n                                        if (email.length > maxWidthEmail) {\r\n                                            maxWidthEmail = email.length;\r\n                                        }\r\n\r\n                                        // Write to file.\r\n                                        sheet.column('D').width(maxWidthEmail);\r\n                                        const uuid = uuidv4();\r\n                                        await workbook.toFileAsync(path.join('.downloads', uuid + '.xlsx'));\r\n                                        res.download(path.join('.downloads', uuid + '.xlsx'));\r\n                                        // xoa file sau khi xu ly\r\n                                        scheduleFileDeletion(path.join('.downloads', uuid + '.xlsx'));\r\n                                    }\r\n                                }\r\n                            } catch (err) {\r\n                                console.log('SYSTEM | CREATE_ACCOUNT | ERROR | ', err);\r\n                                return res.sendStatus(500);\r\n                            }\r\n                        }\r\n                    } else {\r\n                        return res.sendStatus(404);\r\n                    }\r\n                } else {\r\n                    return res.sendStatus(405);\r\n                }\r\n            } else {\r\n                const dataStudent = req.body;\r\n                let pw = await randomPassword();\r\n                let email = await generateEmail(\r\n                    `${dataStudent['ho']} ${dataStudent['ten']} ${dataStudent['mssv'].toString()}`,\r\n                );\r\n                let power;\r\n\r\n                power = {\r\n                    0: true,\r\n                    1: dataStudent['chamdiem'],\r\n                    3: dataStudent['lbhd'],\r\n                    10: dataStudent['dangvien'],\r\n                };\r\n\r\n                let dataInsertUser = {\r\n                    _id: dataStudent['mssv'].toString(),\r\n                    first_name: dataStudent['ten'],\r\n                    last_name: dataStudent['ho'],\r\n                    avt: 'https://i.pinimg.com/236x/89/08/3b/89083bba40545a72fa15321af5fab760--chibi-girl-zero.jpg',\r\n                    power: power,\r\n                    class: [dataStudent['cls']],\r\n                    displayName: `${dataStudent['ho']} ${dataStudent['ten']}`,\r\n                    email: email,\r\n                    total_score: {},\r\n                };\r\n                let dataInsertLogin = {\r\n                    _id: dataStudent['mssv'].toString(),\r\n                    password: hashPassword(pw),\r\n                    first: 'new_user',\r\n                };\r\n                client.db('global').collection('user_info').updateOne(\r\n                    {\r\n                        _id: dataInsertUser._id,\r\n                    },\r\n                    {\r\n                        $set: dataInsertUser,\r\n                    },\r\n                    {\r\n                        upsert: true,\r\n                    },\r\n                );\r\n                client.db('global').collection('login_info').updateOne(\r\n                    {\r\n                        _id: dataInsertLogin._id,\r\n                    },\r\n                    {\r\n                        $set: dataInsertLogin,\r\n                    },\r\n                    {\r\n                        upsert: true,\r\n                    },\r\n                );\r\n                await mark(\r\n                    '_std_table',\r\n                    user,\r\n                    dataInsertUser._id,\r\n                    dummyScore,\r\n                    { first_name: dataInsertUser.first_name, last_name: dataInsertUser.last_name },\r\n                    dataInsertUser.class[0],\r\n                );\r\n                // xu ly sau khi them sinh vien\r\n                const uuid = uuidv4();\r\n                const workbook = await XlsxPopulate.fromFileAsync('./src/excelTemplate/Tao_danh_sach_lop_moi.xlsx');\r\n                const sheet = workbook.sheet(0);\r\n                await sheet.cell(`A2`).value(dataStudent['mssv'].toString());\r\n                await sheet.cell(`B2`).value(dataStudent['ho']);\r\n                await sheet.cell(`C2`).value(dataStudent['ten']);\r\n                await sheet.cell(`D1`).value('Email');\r\n                await sheet.cell(`E1`).value('Password');\r\n                await sheet.cell(`D2`).value(email);\r\n                await sheet.cell(`E2`).value(pw);\r\n                let range = sheet.range(`D2:E2`);\r\n                range.style({ border: true });\r\n                sheet.column('D').width(email.length);\r\n                await workbook.toFileAsync(path.join('.downloads', uuid + '.xlsx'));\r\n                res.download(path.join('.downloads', uuid + '.xlsx'));\r\n                // xoa file sau khi xu ly\r\n                scheduleFileDeletion(path.join('.downloads', uuid + '.xlsx'));\r\n\r\n                // return res.sendStatus(200);\r\n            }\r\n        } else {\r\n            return res.sendStatus(403);\r\n        }\r\n    });\r\n\r\n    // Update student\r\n    router.post('/updateAccount', checkIfUserLoginAPI, async (req, res) => {\r\n        const user = req.session.user;\r\n        if (user.pow[4] || user.pow[7]) {\r\n            const dataStudent = req.body;\r\n            let power = {\r\n                0: true,\r\n                1: dataStudent['chamdiem'],\r\n                3: dataStudent['lbhd'],\r\n                10: dataStudent['dangvien'],\r\n            };\r\n\r\n            let dataInsertUser = {\r\n                _id: dataStudent['mssv'].toString(),\r\n                first_name: dataStudent['ten'],\r\n                last_name: dataStudent['ho'],\r\n                power: power,\r\n                displayName: `${dataStudent['ho']} ${dataStudent['ten']}`,\r\n            };\r\n\r\n            client.db('global').collection('user_info').updateOne(\r\n                {\r\n                    _id: dataInsertUser._id,\r\n                },\r\n                {\r\n                    $set: dataInsertUser,\r\n                },\r\n                {\r\n                    upsert: true,\r\n                },\r\n            );\r\n\r\n            return res.sendStatus(200);\r\n        } else {\r\n            return res.sendStatus(403);\r\n        }\r\n    });\r\n\r\n    router.get('/getTemplateAddStudent', upload.single('file'), checkIfUserLoginAPI, async (req, res) => {\r\n        const user = req.session.user;\r\n        if (user.pow[4] || user.pow[7]) {\r\n            return res.download('./src/excelTemplate/Tao_danh_sach_lop_moi.xlsx');\r\n        } else {\r\n            return res.sendStatus(403);\r\n        }\r\n    });\r\n\r\n    router.post('/deleteAccount', checkIfUserLoginAPI, async (req, res) => {\r\n        const user = req.session.user;\r\n        if (user.pow[4] || user.pow[7]) {\r\n            try {\r\n                const cls = req.body.cls;\r\n                const listDelete = req.body.dataDelete;\r\n                for (let i = 0; i < listDelete.length; i++) {\r\n                    await client.db('global').collection('user_info').deleteOne({ _id: listDelete[i] });\r\n                    let info_search = `student_list.${listDelete[i]}`;\r\n                    await client\r\n                        .db(user.dep)\r\n                        .collection(`${cls}_activities`)\r\n                        .updateMany(\r\n                            {\r\n                                [info_search]: { $exists: true },\r\n                            },\r\n                            {\r\n                                $pull: { student_list: user._id, ai: user._id },\r\n                            },\r\n                        );\r\n\r\n                    await client\r\n                        .db(user.dep)\r\n                        .collection('activities')\r\n                        .updateMany(\r\n                            {\r\n                                [info_search]: { $exists: true },\r\n                            },\r\n                            {\r\n                                $pull: { student_list: user._id, ai: user._id },\r\n                            },\r\n                        );\r\n\r\n                    await client\r\n                        .db(name_global_databases)\r\n                        .collection('activities')\r\n                        .updateMany(\r\n                            {\r\n                                [info_search]: { $exists: true },\r\n                            },\r\n                            {\r\n                                $pull: { student_list: user._id, ai: user._id },\r\n                            },\r\n                        );\r\n                }\r\n                return res.sendStatus(200);\r\n            } catch (err) {\r\n                console.log('SYSTEM | DELETE_ACCOUNT | ERROR | ', err);\r\n                return res.sendStatus(500);\r\n            }\r\n        } else {\r\n            return res.sendStatus(403);\r\n        }\r\n    });\r\n    // Export class score report --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n    router.get('/exportClassScore', checkIfUserLoginAPI, async (req, res) => {\r\n        try {\r\n            const user = req.session.user;\r\n            if (user.pow[1] || user.pow[2]) {\r\n                const data = req.query;\r\n                //data = {year: \"HK1_2022-2023\", cls: '1'}\r\n                const school_year = data.year;\r\n                let cls = data.cls;\r\n                // create uuid for download file\r\n                const uuid = uuidv4();\r\n\r\n                // check for post data.cls if class define this mean they choose class so that must\r\n\r\n                let student_list = [];\r\n                if (user.pow[1]) {\r\n                    student_list = sortStudentName(\r\n                        await client\r\n                            .db(name_global_databases)\r\n                            .collection('user_info')\r\n                            .find(\r\n                                { class: user.cls[0], 'power.0': { $exists: true } },\r\n                                { projection: { first_name: 1, last_name: 1 } },\r\n                            )\r\n                            .toArray(),\r\n                    );\r\n                } else {\r\n                    student_list = sortStudentName(\r\n                        await client\r\n                            .db(name_global_databases)\r\n                            .collection('user_info')\r\n                            .find(\r\n                                { class: cls, 'power.0': { $exists: true } },\r\n                                { projection: { first_name: 1, last_name: 1 } },\r\n                            )\r\n                            .toArray(),\r\n                    );\r\n                }\r\n\r\n                // get all student total score from themself:\r\n                let scores = [];\r\n\r\n                if (student_list.length !== 0) {\r\n                    for (let i = 0; i < student_list.length; i++) {\r\n                        // [stt, mssv. ho, ten, lop,\r\n                        // 1.0, 1.1, 1.2, 1.3, 1.4,\r\n                        // 2.0, 2.1,\r\n                        // 3.0, 3.1, 3.2,\r\n                        // 4.0, 4.1, 4.2,\r\n                        // 5.0, 5.1, 5.2, 5.3,\r\n                        // \"\", total, conduct, \"\"]\r\n                        let curr_score = [\r\n                            i + 1,\r\n                            student_list[i]._id,\r\n                            student_list[i].last_name,\r\n                            student_list[i].first_name,\r\n                            cls,\r\n                        ];\r\n\r\n                        const curr_departmentt_score = await client\r\n                            .db(user.dep)\r\n                            .collection(cls + '_dep_table')\r\n                            .findOne(\r\n                                {\r\n                                    mssv: student_list[i]._id,\r\n                                    school_year: school_year,\r\n                                },\r\n                                {\r\n                                    projection: {\r\n                                        first: 1,\r\n                                        second: 1,\r\n                                        third: 1,\r\n                                        fourth: 1,\r\n                                        fifth: 1,\r\n                                        total: 1,\r\n                                    },\r\n                                },\r\n                            );\r\n\r\n                        if (curr_departmentt_score) {\r\n                            curr_score.push(...curr_departmentt_score.first);\r\n                            curr_score.push(...curr_departmentt_score.second);\r\n                            curr_score.push(...curr_departmentt_score.third);\r\n                            curr_score.push(...curr_departmentt_score.fourth);\r\n                            curr_score.push(...curr_departmentt_score.fifth);\r\n                        } else {\r\n                            for (let j = 0; j < 17; j++) {\r\n                                curr_score.push(null);\r\n                            }\r\n                        }\r\n\r\n                        curr_score.push(null);\r\n\r\n                        if (curr_departmentt_score) {\r\n                            curr_score.push(curr_departmentt_score.total);\r\n                            // set kind of conduct:\r\n                            if (curr_departmentt_score.total >= 90) {\r\n                                curr_score.push('xuất sắc');\r\n                            } else if (curr_departmentt_score.total >= 80) {\r\n                                curr_score.push('tốt');\r\n                            } else if (curr_departmentt_score.total >= 65) {\r\n                                curr_score.push('khá');\r\n                            } else if (curr_departmentt_score.total >= 50) {\r\n                                curr_score.push('trung bình');\r\n                            } else if (curr_departmentt_score.total >= 35) {\r\n                                curr_score.push('yếu');\r\n                            } else {\r\n                                curr_score.push('kém');\r\n                            }\r\n                        } else {\r\n                            curr_score.push(null);\r\n                            curr_score.push(null);\r\n                        }\r\n\r\n                        // add curr_score to scores\r\n                        scores.push(curr_score);\r\n                    }\r\n                } else {\r\n                }\r\n\r\n                // Load an existing workbook\r\n                const workbook = await XlsxPopulate.fromFileAsync(\r\n                    './src/excelTemplate/Bang_diem_ca_lop_xuat_tu_he_thong.xlsx',\r\n                );\r\n\r\n                if (scores.length != 0) {\r\n                    await workbook.sheet(0).cell('A7').value(scores);\r\n                }\r\n                // Write to file.\r\n\r\n                await workbook.toFileAsync(path.join('.downloads', uuid + '.xlsx'));\r\n\r\n                // tải file xlsx về máy người dùng\r\n                // res.download(path.join('.downloads', uuid + \".xlsx\"));\r\n\r\n                res.download(path.join('.downloads', uuid + '.xlsx'));\r\n\r\n                // delete file after 12 hours\r\n                scheduleFileDeletion(path.join('.downloads', uuid + '.xlsx'));\r\n            } else {\r\n                return res.sendStatus(403);\r\n            }\r\n        } catch (err) {\r\n            console.log('SYSTEM | EXPORT_CLASS_SCORE | ERROR | ', err);\r\n            return res.sendStatus(500);\r\n        }\r\n    });\r\n    // Export students score report --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n    router.get('/exportStudentsScore', checkIfUserLoginAPI, async (req, res) => {\r\n        try {\r\n            const user = req.session.user;\r\n            const data = req.query;\r\n            let cls = data.cls;\r\n            let stdlist = [];\r\n            if (data.stdlist) {\r\n                stdlist = JSON.parse(data.stdlist);\r\n            }\r\n            const school_year = data.year;\r\n\r\n            if (user.pow[0] || user.pow[1] || user.pow[2]) {\r\n                if ((data.type === 'singe') & user.pow[0]) {\r\n                    cls = user.cls[0];\r\n                    stdlist = [user._id];\r\n                }\r\n                //data = {year: \"HK1_2022-2023\", cls: '1', stdlist: []}\r\n                // create uuid for download file\r\n                const uuid = uuidv4();\r\n                // check for post data.cls if class define this mean they choose class so that must\r\n                let student_list = [];\r\n\r\n                student_list = sortStudentName(\r\n                    await client\r\n                        .db(name_global_databases)\r\n                        .collection('user_info')\r\n                        .find(\r\n                            {\r\n                                class: cls,\r\n                                'power.0': { $exists: true },\r\n                                _id: { $in: stdlist },\r\n                            },\r\n                            { projection: { first_name: 1, last_name: 1 } },\r\n                        )\r\n                        .toArray(),\r\n                );\r\n                // get all student total score from themself:\r\n                let scores = [];\r\n\r\n                if (student_list.length !== 0) {\r\n                    for (let i = 0; i < student_list.length; i++) {\r\n                        // [stt, mssv. ho, ten, lop,\r\n                        // 1.0, 1.1, 1.2, 1.3, 1.4,\r\n                        // 2.0, 2.1,\r\n                        // 3.0, 3.1, 3.2,\r\n                        // 4.0, 4.1, 4.2,\r\n                        // 5.0, 5.1, 5.2, 5.3,\r\n                        // \"\", total, conduct, \"\"]\r\n                        let curr_score = {\r\n                            year: school_year,\r\n                            mssv: student_list[i]._id,\r\n                            name: student_list[i].last_name + ' ' + student_list[i].first_name,\r\n                            class: cls,\r\n                            std: [],\r\n                            stf: [],\r\n                            dep: [],\r\n                        };\r\n\r\n                        const curr_students_score = await client\r\n                            .db(user.dep)\r\n                            .collection(cls + '_std_table')\r\n                            .findOne(\r\n                                {\r\n                                    mssv: student_list[i]._id,\r\n                                    school_year: school_year,\r\n                                },\r\n                                {\r\n                                    projection: {\r\n                                        first: 1,\r\n                                        second: 1,\r\n                                        third: 1,\r\n                                        fourth: 1,\r\n                                        fifth: 1,\r\n                                        total: 1,\r\n                                    },\r\n                                },\r\n                            );\r\n\r\n                        const curr_staff_score = await client\r\n                            .db(user.dep)\r\n                            .collection(cls + '_stf_table')\r\n                            .findOne(\r\n                                {\r\n                                    mssv: student_list[i]._id,\r\n                                    school_year: school_year,\r\n                                },\r\n                                {\r\n                                    projection: {\r\n                                        first: 1,\r\n                                        second: 1,\r\n                                        third: 1,\r\n                                        fourth: 1,\r\n                                        fifth: 1,\r\n                                        total: 1,\r\n                                    },\r\n                                },\r\n                            );\r\n\r\n                        const curr_departmentt_score = await client\r\n                            .db(user.dep)\r\n                            .collection(cls + '_dep_table')\r\n                            .findOne(\r\n                                {\r\n                                    mssv: student_list[i]._id,\r\n                                    school_year: school_year,\r\n                                },\r\n                                {\r\n                                    projection: {\r\n                                        first: 1,\r\n                                        second: 1,\r\n                                        third: 1,\r\n                                        fourth: 1,\r\n                                        fifth: 1,\r\n                                        total: 1,\r\n                                    },\r\n                                },\r\n                            );\r\n\r\n                        if (curr_students_score) {\r\n                            curr_score.std.push(...curr_students_score.first);\r\n                            curr_score.std.push(...curr_students_score.second);\r\n                            curr_score.std.push(...curr_students_score.third);\r\n                            curr_score.std.push(...curr_students_score.fourth);\r\n                            curr_score.std.push(...curr_students_score.fifth);\r\n                            curr_score.std.push(curr_students_score.total);\r\n                        } else {\r\n                            for (let j = 0; j < 18; j++) {\r\n                                curr_score.std.push('N/A');\r\n                            }\r\n                        }\r\n                        if (curr_staff_score) {\r\n                            curr_score.stf.push(...curr_staff_score.first);\r\n                            curr_score.stf.push(...curr_staff_score.second);\r\n                            curr_score.stf.push(...curr_staff_score.third);\r\n                            curr_score.stf.push(...curr_staff_score.fourth);\r\n                            curr_score.stf.push(...curr_staff_score.fifth);\r\n                            curr_score.stf.push(curr_staff_score.total);\r\n                        } else {\r\n                            for (let j = 0; j < 18; j++) {\r\n                                curr_score.stf.push('N/A');\r\n                            }\r\n                        }\r\n\r\n                        if (curr_departmentt_score) {\r\n                            curr_score.dep.push(...curr_departmentt_score.first);\r\n                            curr_score.dep.push(...curr_departmentt_score.second);\r\n                            curr_score.dep.push(...curr_departmentt_score.third);\r\n                            curr_score.dep.push(...curr_departmentt_score.fourth);\r\n                            curr_score.dep.push(...curr_departmentt_score.fifth);\r\n                            curr_score.dep.push(curr_departmentt_score.total);\r\n                        } else {\r\n                            for (let j = 0; j < 18; j++) {\r\n                                curr_score.dep.push('N/A');\r\n                            }\r\n                        }\r\n\r\n                        scores.push(curr_score);\r\n                    }\r\n                } else {\r\n                    return res.sendStatus(402);\r\n                }\r\n\r\n                const temp_namefile = await createPdf('.downloads', scores);\r\n                // tải file xlsx về máy người dùng\r\n                res.download(path.join('.downloads', temp_namefile));\r\n\r\n                // delete file after 12 hours\r\n\r\n                scheduleFileDeletion(path.join('.downloads', temp_namefile));\r\n            } else {\r\n                return res.sendStatus(403);\r\n            }\r\n        } catch (err) {\r\n            console.log('SYSTEM | EXPORT_STUDENTS_SCORE | ERROR | ', err);\r\n            return res.sendStatus(500);\r\n        }\r\n    });\r\n    // Load score list of student in specific class at specific time ---------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n    router.get('/loadScoresList', checkIfUserLoginAPI, async (req, res) => {\r\n        try {\r\n            const user = req.session.user;\r\n            if (user.pow[1]) {\r\n                const data = req.query;\r\n                //data = {year: \"HK1_2022-2023\", cls: \"1\"}\r\n                const school_year = data.year;\r\n                const year_available = await client\r\n                    .db(name_global_databases)\r\n                    .collection('school_year')\r\n                    .findOne(\r\n                        {},\r\n                        {\r\n                            projection: {\r\n                                _id: 0,\r\n                                year: 1,\r\n                                start_day: 1,\r\n                                end_day: 1,\r\n                            },\r\n                        },\r\n                    );\r\n\r\n                const student_list = sortStudentName(\r\n                    await client\r\n                        .db(name_global_databases)\r\n                        .collection('user_info')\r\n                        .find(\r\n                            { class: user.cls[0], 'power.0': { $exists: true } },\r\n                            {\r\n                                projection: {\r\n                                    first_name: 1,\r\n                                    last_name: 1,\r\n                                    total_score: 1,\r\n                                },\r\n                            },\r\n                        )\r\n                        .toArray(),\r\n                );\r\n\r\n                // get all student total score from themself:\r\n                let result = {\r\n                    // staff_name: [],\r\n                    student_list: student_list,\r\n                    // student_scores: [],\r\n                    // staff_scores: [],\r\n                    // department_scores: [],\r\n                    year_available: year_available,\r\n                };\r\n\r\n                return res.status(200).json(result);\r\n            } else {\r\n                // user not staff members\r\n                // redirect to home (return 403, api khong the chuyenh huong ve trang chu duoc)\r\n                return res.sendStatus(403);\r\n            }\r\n        } catch (err) {\r\n            console.log('SYSTEM | LOAD_SCORE_LIST | ERROR | ', err);\r\n            return res.sendStatus(500);\r\n        }\r\n    });\r\n    // doan khoa load scores\r\n    router.get('/doan_khoa/loadScoresList', checkIfUserLoginAPI, async (req, res) => {\r\n        try {\r\n            const user = req.session.user;\r\n            if (user.pow[2]) {\r\n                const data = req.query;\r\n                //data = {year: \"HK1_2022-2023\", cls: \"1\"}\r\n                const school_year = data.year;\r\n                let cls = data.class;\r\n                // const bo_mon = data.bo_mon;\r\n                // check for post data.cls if class define this mean they choose class so that must\r\n                if (!cls) {\r\n                    cls = 0;\r\n                }\r\n\r\n                const year_available = await client\r\n                    .db(name_global_databases)\r\n                    .collection('school_year')\r\n                    .findOne(\r\n                        {},\r\n                        {\r\n                            projection: {\r\n                                _id: 0,\r\n                                year: 1,\r\n                                start_day: 1,\r\n                                end_day: 1,\r\n                            },\r\n                        },\r\n                    );\r\n\r\n                const student_list = sortStudentName(\r\n                    await client\r\n                        .db(name_global_databases)\r\n                        .collection('user_info')\r\n                        .find(\r\n                            { class: cls, 'power.0': { $exists: true } },\r\n                            {\r\n                                projection: {\r\n                                    first_name: 1,\r\n                                    last_name: 1,\r\n                                    total_score: 1,\r\n                                },\r\n                            },\r\n                        )\r\n                        .toArray(),\r\n                );\r\n\r\n                // get all student total score from themself:\r\n                let result = {\r\n                    // staff_name: [],\r\n                    student_list: student_list,\r\n                    // student_scores: [],\r\n                    // staff_scores: [],\r\n                    // department_scores: [],\r\n                    year_available: year_available,\r\n                };\r\n\r\n                return res.status(200).json(result);\r\n            } else {\r\n                // user not staff members\r\n                // redirect to home\r\n                return res.statusCode(403);\r\n            }\r\n        } catch (err) {\r\n            console.log('SYSTEM | DOAN_KHOA_LOAD_SCORE_LIST | ERROR | ', err);\r\n            return res.sendStatus(500);\r\n        }\r\n    });\r\n    // Auto mark (copy student mark to staff mark)\r\n    router.post('/autoMark', checkIfUserLoginAPI, async (req, res) => {\r\n        try {\r\n            const user = req.session.user;\r\n            if (user.pow[1]) {\r\n                const data = req.body;\r\n                let cls = data.cls;\r\n                //data = {year: \"HK1_2022-2023\", cls: \"1\", std_list = []}\r\n\r\n                // get staff member info :\r\n                const marker = await client\r\n                    .db(name_global_databases)\r\n                    .collection('user_info')\r\n                    .findOne(\r\n                        { _id: user._id },\r\n                        {\r\n                            projection: {\r\n                                _id: 0,\r\n                                last_name: 1,\r\n                                first_name: 1,\r\n                            },\r\n                        },\r\n                    );\r\n                // check for post data.cls if class define this mean they choose class so that must\r\n                if (!cls) {\r\n                    cls = 0;\r\n                }\r\n\r\n                // check if table is exist or not\r\n                // update or add new table copy from std_table to staff_table\r\n                for (let i = 0; i < data.std_list.length; i++) {\r\n                    const std_table = await client\r\n                        .db(user.dep)\r\n                        .collection(user.cls[parseInt(cls)] + '_std_table')\r\n                        .findOne({\r\n                            mssv: data.std_list[i],\r\n                            school_year: data.year,\r\n                        });\r\n\r\n                    // update old table if exist else insert new one\r\n                    // copy from student table and add marker name\r\n                    if (std_table) {\r\n                        std_table.marker = marker.last_name + ' ' + marker.first_name;\r\n                        delete std_table._id;\r\n                        await client\r\n                            .db(user.dep)\r\n                            .collection(user.cls[parseInt(cls)] + '_stf_table')\r\n                            .updateOne(\r\n                                {\r\n                                    mssv: data.std_list[i],\r\n                                    school_year: data.year,\r\n                                },\r\n                                {\r\n                                    $set: std_table,\r\n                                },\r\n                                { upsert: true },\r\n                            );\r\n                    }\r\n\r\n                    await updateStudentTotalScore(\r\n                        '_stf_table',\r\n                        std_table.school_year,\r\n                        std_table.mssv,\r\n                        std_table.total,\r\n                        std_table.marker,\r\n                    );\r\n                }\r\n\r\n                return res.sendStatus(200);\r\n            } else {\r\n                return res.sendStatus(403);\r\n            }\r\n        } catch (err) {\r\n            console.log('SYSTEM | AUTO_MARK | ERROR | ', err);\r\n            return res.sendStatus(500);\r\n        }\r\n    });\r\n\r\n    router.post('/doan_khoa/autoMark', checkIfUserLoginAPI, async (req, res) => {\r\n        try {\r\n            const user = req.session.user;\r\n            if (user.pow[2]) {\r\n                const data = req.body;\r\n                let cls = data.cls;\r\n                //data = {year: \"HK1_2022-2023\", cls: \"1\", std_list = []}\r\n\r\n                // get staff member info :\r\n                const marker = await client\r\n                    .db(name_global_databases)\r\n                    .collection('user_info')\r\n                    .findOne(\r\n                        { _id: user._id },\r\n                        {\r\n                            projection: {\r\n                                _id: 0,\r\n                                last_name: 1,\r\n                                first_name: 1,\r\n                            },\r\n                        },\r\n                    );\r\n\r\n                // check if table is exist or not\r\n                // update or add new table copy from std_table to staff_table\r\n                for (let i = 0; i < data.std_list.length; i++) {\r\n                    const std_table = await client\r\n                        .db(user.dep)\r\n                        .collection(cls + '_stf_table')\r\n                        .findOne({\r\n                            mssv: data.std_list[i],\r\n                            school_year: data.year,\r\n                        });\r\n\r\n                    // update old table if exist else insert new one\r\n                    // copy from student table and add marker name\r\n                    if (std_table) {\r\n                        std_table.marker = marker.last_name + ' ' + marker.first_name;\r\n                        delete std_table._id;\r\n                        await client\r\n                            .db(user.dep)\r\n                            .collection(cls + '_dep_table')\r\n                            .updateOne(\r\n                                {\r\n                                    mssv: data.std_list[i],\r\n                                    school_year: data.year,\r\n                                },\r\n                                {\r\n                                    $set: std_table,\r\n                                },\r\n                                { upsert: true },\r\n                            );\r\n                    }\r\n\r\n                    await updateStudentTotalScore(\r\n                        '_dep_table',\r\n                        std_table.school_year,\r\n                        std_table.mssv,\r\n                        std_table.total,\r\n                        std_table.marker,\r\n                    );\r\n                }\r\n\r\n                return res.sendStatus(200);\r\n            } else {\r\n                return res.sendStatus(403);\r\n            }\r\n        } catch (err) {\r\n            console.log('SYSTEM | AUTO_MARK | ERROR | ', err);\r\n            return res.sendStatus(500);\r\n        }\r\n    });\r\n\r\n    // api danh sach sinh vien\r\n    router.post('/getStudentList', checkIfUserLoginAPI, async (req, res) => {\r\n        const user = req.session.user;\r\n\r\n        const data = req.body; // data = {class: KTPM0121 (class id), skip: 1 // time load befour}\r\n        let reqClass = data.class;\r\n        // if (!reqClass) {\r\n        //   reqClass = user.cls[0];\r\n        // }\r\n        if (reqClass) {\r\n            if (user.pow[1] || user.pow[2]) {\r\n                const student_list = sortStudentName(\r\n                    await client\r\n                        .db(name_global_databases)\r\n                        .collection('user_info')\r\n                        .find(\r\n                            { class: reqClass, 'power.0': { $exists: true } },\r\n                            { projection: { first_name: 1, last_name: 1, power: 1 } },\r\n                        )\r\n                        .limit(30)\r\n                        .skip(30 * data.skip)\r\n                        .toArray(),\r\n                );\r\n                const transformedData = student_list.map((item) => {\r\n                    let role = 'UnKnow'; // Giả định giá trị mặc định là 'unknow'\r\n                    let dang_vien = false;\r\n                    let cham_diem = false;\r\n                    let lap_hoat_dong = false;\r\n                    dang_vien = item.power['10'] ? true : false;\r\n                    cham_diem = item.power['1'] ? true : false;\r\n                    lap_hoat_dong = item.power['3'] ? true : false;\r\n                    if (item.power['1'] || item.power['3']) {\r\n                        role = 'Ban cán sự';\r\n                    } else if (item.power['0']) {\r\n                        role = 'Sinh viên';\r\n                    }\r\n\r\n                    return {\r\n                        _id: item._id,\r\n                        first_name: item.first_name,\r\n                        last_name: item.last_name,\r\n                        role,\r\n                        dang_vien,\r\n                        cham_diem,\r\n                        lap_hoat_dong,\r\n                    };\r\n                });\r\n                return res.status(200).json(transformedData);\r\n            } else {\r\n                return res.sendStatus(403);\r\n            }\r\n        } else {\r\n            return res.sendStatus(404);\r\n        }\r\n    });\r\n\r\n    router.get('/getStudentInfoMark', checkIfUserLoginAPI, async (req, res) => {\r\n        const user = req.session.user;\r\n        let result = {\r\n            dang_vien: user.pow[10] ? true : false,\r\n            cham_diem: user.pow[1] ? true : false,\r\n            lap_hoat_dong: user.pow[3] ? true : false,\r\n        };\r\n        return res.status(200).json(result);\r\n    });\r\n\r\n    router.get('/getuserscore', checkIfUserLoginAPI, async (req, res) => {\r\n        try {\r\n            const user = req.session.user;\r\n            if (user.pow[0]) {\r\n                const schoolYearParam = req.query.schoolYear;\r\n\r\n                const schoolYearsToSearch = ['HK1_' + schoolYearParam, 'HK2_' + schoolYearParam];\r\n                const studentTotalScores = await Promise.all(\r\n                    schoolYearsToSearch.map(async (year) => {\r\n                        const studentTotalScore = await client\r\n                            .db(user.dep)\r\n                            .collection(user.cls[0] + '_std_table')\r\n                            .findOne(\r\n                                {\r\n                                    mssv: user._id,\r\n                                    school_year: year,\r\n                                },\r\n                                {\r\n                                    projection: { _id: 0, total: 1 },\r\n                                },\r\n                            );\r\n                        return {\r\n                            year: year.slice(0, 3),\r\n                            total: studentTotalScore ? studentTotalScore.total : 'Chưa có điểm',\r\n                        };\r\n                    }),\r\n                );\r\n                return res.status(200).json(studentTotalScores);\r\n            } else {\r\n                return res.sendStatus(403);\r\n            }\r\n        } catch (err) {\r\n            console.log('SYSTEM | GET_USER_SCORE | ERROR | ', err);\r\n            return res.sendStatus(500);\r\n        }\r\n    });\r\n\r\n    // api add or edit branch of department base on it exist or not\r\n    router.post('/addOrEditBranchs', checkIfUserLoginAPI, async (req, res) => {\r\n        try {\r\n            const user = req.session.user;\r\n            const data = req.body; // data = {old_name: \"Hệ thống thông tin\", name: \"Kỹ Thuật Phần Mềm\"}\r\n\r\n            // must be department to use this api\r\n            if (user.pow[5]) {\r\n                // remove old branch\r\n                await client\r\n                    .db(name_global_databases)\r\n                    .collection('branchs')\r\n                    .deleteOne({\r\n                        _id: createId(data.old_name),\r\n                    });\r\n                // add new branch\r\n                await client\r\n                    .db(name_global_databases)\r\n                    .collection('branchs')\r\n                    .insertOne({\r\n                        _id: createId(data.name),\r\n                        name: data.name,\r\n                        dep: user.dep,\r\n                    });\r\n            } else {\r\n                return res.sendStatus(403); // back to home\r\n            }\r\n\r\n            return res.sendStatus(200);\r\n        } catch (err) {\r\n            console.log('SYSTEM | ADD_OR_EDIT_BRANCHS | ERROR | ', err);\r\n            return res.sendStatus(500);\r\n        }\r\n    });\r\n\r\n    // api delete cheked branchs\r\n    router.post('/deleteBranchs', checkIfUserLoginAPI, async (req, res) => {\r\n        try {\r\n            const user = req.session.user;\r\n            const data = req.body; // data = {rm_bs: [\"Kỹ Thuật Phần Mềm\", ...]}\r\n\r\n            // must be department to use this api\r\n            if (user.pow[5]) {\r\n                // remove all cheked branch in remove branchs líst\r\n                for (let i = 0; i < data.rm_bs.length; i++) {\r\n                    await client\r\n                        .db(name_global_databases)\r\n                        .collection('branchs')\r\n                        .deleteOne({\r\n                            _id: createId(data.rm_bs[i]),\r\n                        });\r\n                    const dummy_class = await client\r\n                        .db(name_global_databases)\r\n                        .collection('classes')\r\n                        .find({ branch: createId(data.rm_bs[i]) }, { projection: { cvht: 1 } })\r\n                        .toArray();\r\n                    const cls_rm_data = dummy_class.map((cls) => cls._id);\r\n                    const cvht_rm_data = dummy_class.map((cls) => cls.cvht);\r\n                    const requestData = { rm_cls: cls_rm_data, rm_ts: cvht_rm_data };\r\n\r\n                    // // Gọi API bằng axios với phương thức POST\r\n                    await deleteClassApi(requestData, user);\r\n                    await client\r\n                        .db(name_global_databases)\r\n                        .collection('user_info')\r\n                        .updateMany(\r\n                            {\r\n                                _id: { $in: cvht_rm_data },\r\n                            },\r\n                            {\r\n                                $set: {\r\n                                    branch: ObjectId.createFromHexString('650985a345e2e896b37efd4f'),\r\n                                },\r\n                            },\r\n                        );\r\n                }\r\n                return res.sendStatus(200);\r\n            } else {\r\n                return res.sendStatus(403); // back to home\r\n            }\r\n        } catch (err) {\r\n            console.log('SYSTEM | DELETE_BRANCHS | ERROR | ', err);\r\n            return res.sendStatus(500);\r\n        }\r\n    });\r\n\r\n    // change mark deadline\r\n    router.post('/changeDeadLine', checkIfUserLoginAPI, async (req, res) => {\r\n        try {\r\n            const user = req.session.user;\r\n            // must be department to use this api\r\n            if (user.pow[6]) {\r\n                const data = req.body; // data = {sch_y: \"HK1_2022-2023\", start_day: '18/10/2023', end_day: '19/11/999999999999999999']}\r\n                const cy = data.sch_y.split('_');\r\n\r\n                console.log(data);\r\n                // set end day to special date if it is ''\r\n                if (!data.end_day) {\r\n                    data.end_day = '2003-10-18'; // special date\r\n                }\r\n\r\n                await client\r\n                    .db(name_global_databases)\r\n                    .collection('school_year')\r\n                    .updateOne(\r\n                        {},\r\n                        {\r\n                            $set: {\r\n                                year: data.sch_y,\r\n                                start_day: new Date(data.start_day), // change string to Date\r\n                                end_day: new Date(data.end_day),\r\n                            },\r\n                        },\r\n                    );\r\n                const keyupdate = `years.${cy[1]}`;\r\n                await client\r\n                    .db(name_global_databases)\r\n                    .collection('classes')\r\n                    .updateMany(\r\n                        {},\r\n                        {\r\n                            $set: {\r\n                                [keyupdate]: [1, 2, 3],\r\n                            },\r\n                        },\r\n                    );\r\n\r\n                return res.sendStatus(200);\r\n            } else {\r\n                return res.sendStatus(403); // back to home\r\n            }\r\n        } catch (err) {\r\n            console.log('SYSTEM | CHANGE_DEADLINE | ERROR | ', err);\r\n            return res.sendStatus(500);\r\n        }\r\n    });\r\n\r\n    // api add or edit teacher of department base on it exist or not\r\n    router.post('/addOrEditTeachers', checkIfUserLoginAPI, async (req, res) => {\r\n        try {\r\n            const user = req.session.user;\r\n            const data = req.body; // data = {old_id: \"19112003\", new_id: \"18102003\", new_name: \"Nguyễn Văn A\", branch: \"KTPM\"}\r\n\r\n            // must be department to use this api\r\n            if (user.pow[8]) {\r\n                // find to get old pass of teacher before remove it\r\n                const teacher_pass = await client\r\n                    .db(name_global_databases)\r\n                    .collection('login_info')\r\n                    .findOne(\r\n                        {\r\n                            _id: data.old_id,\r\n                        },\r\n                        {\r\n                            projection: {\r\n                                password: 1,\r\n                            },\r\n                        },\r\n                    );\r\n                // find to get curr classes\r\n                const curr_teacher = await client\r\n                    .db(name_global_databases)\r\n                    .collection('user_info')\r\n                    .findOne(\r\n                        {\r\n                            _id: data.old_id,\r\n                        },\r\n                        {\r\n                            projection: {\r\n                                class: 1,\r\n                                avt: 1,\r\n                                email: 1,\r\n                            },\r\n                        },\r\n                    );\r\n\r\n                if (curr_teacher) {\r\n                    // remove old teachers\r\n                    await client.db(name_global_databases).collection('user_info').deleteOne({\r\n                        _id: data.old_id,\r\n                    });\r\n\r\n                    // edit old one\r\n                    await client\r\n                        .db(name_global_databases)\r\n                        .collection('user_info')\r\n                        .insertOne({\r\n                            _id: data.new_id,\r\n                            first_name: data.new_name.split(' ').slice(-1).join(' '),\r\n                            last_name: data.new_name.split(' ').slice(0, -1).join(' '),\r\n                            avt: curr_teacher.avt,\r\n                            power: {\r\n                                1: true,\r\n                                3: true,\r\n                                4: true,\r\n                            },\r\n                            class: curr_teacher.class,\r\n                            displayName: data.new_name, // here before pop\r\n                            branch: data.branch,\r\n                            email: curr_teacher.email,\r\n                        });\r\n                } else {\r\n                    // add new one\r\n                    await client\r\n                        .db(name_global_databases)\r\n                        .collection('user_info')\r\n                        .insertOne({\r\n                            _id: data.new_id,\r\n                            first_name: data.new_name.split(' ').slice(-1).join(' '),\r\n                            last_name: data.new_name.split(' ').slice(0, -1).join(' '),\r\n                            avt: 'https://i.pinimg.com/236x/89/08/3b/89083bba40545a72fa15321af5fab760--chibi-girl-zero.jpg',\r\n                            power: {\r\n                                1: true,\r\n                                3: true,\r\n                                4: true,\r\n                            },\r\n                            class: [],\r\n                            displayName: data.new_name, // here before pop\r\n                            branch: data.branch,\r\n                            email: '',\r\n                        });\r\n                }\r\n\r\n                if (teacher_pass) {\r\n                    await client.db(name_global_databases).collection('login_info').deleteOne({\r\n                        _id: data.old_id,\r\n                    });\r\n                    // edit old one\r\n                    await client\r\n                        .db(name_global_databases)\r\n                        .collection('login_info')\r\n                        .insertOne({\r\n                            _id: data.new_id,\r\n                            password: hashPassword(teacher_pass.password),\r\n                        });\r\n                } else {\r\n                    // add new one\r\n                    await client\r\n                        .db(name_global_databases)\r\n                        .collection('login_info')\r\n                        .insertOne({\r\n                            _id: data.new_id,\r\n                            password: hashPassword(data.new_id),\r\n                        });\r\n                }\r\n            } else {\r\n                return res.sendStatus(403); // back to home\r\n            }\r\n\r\n            return res.sendStatus(200);\r\n        } catch (err) {\r\n            console.log('SYSTEM | ADD_OR_EDIT_BRANCHS | ERROR | ', err);\r\n            return res.sendStatus(500);\r\n        }\r\n    });\r\n\r\n    // api delete teachers checked\r\n    router.post('/deleteTeachers', checkIfUserLoginAPI, async (req, res) => {\r\n        try {\r\n            const user = req.session.user;\r\n            const data = req.body; // data = {rm_ts: [\"19112003\" (teacher_id), ...]}\r\n\r\n            // must be department to use this api\r\n            if (user.pow[8]) {\r\n                // remove all cheked teacher in remove teachers líst in user_info and login_info\r\n                await client\r\n                    .db(name_global_databases)\r\n                    .collection('user_info')\r\n                    .deleteMany({\r\n                        _id: { $in: data.rm_ts },\r\n                    });\r\n\r\n                await client\r\n                    .db(name_global_databases)\r\n                    .collection('login_info')\r\n                    .deleteMany({\r\n                        _id: { $in: data.rm_ts },\r\n                    });\r\n\r\n                await client\r\n                    .db(name_global_databases)\r\n                    .collection('classes')\r\n                    .updateMany(\r\n                        { cvht: { $in: data.rm_ts } }, // Điều kiện để xác định tài liệu cần cập nhật\r\n                        {\r\n                            $set: {\r\n                                cvht: ObjectId.createFromHexString('650985a345e2e896b37efd4f'),\r\n                            },\r\n                        }, // Sử dụng $pull để xoá các giá trị trong mảng cvht\r\n                    );\r\n            } else {\r\n                return res.sendStatus(403); // back to home\r\n            }\r\n\r\n            return res.sendStatus(200);\r\n        } catch (err) {\r\n            console.log('SYSTEM | DELETE_TEACHER | ERROR | ', err);\r\n            return res.sendStatus(500);\r\n        }\r\n    });\r\n\r\n    // api checkin students to activity\r\n    router.post('/CheckinActivities', checkIfUserLoginAPI, async (req, res) => {\r\n        try {\r\n            const user = req.session.user;\r\n            const data = req.body; // data = {id: '19181011' (activity's id), level: (Lớp/Khoa/Trường);\r\n            if (user.pow[0]) {\r\n                switch (data.level) {\r\n                    case 'Lớp':\r\n                        await client\r\n                            .db(user.dep)\r\n                            .collection(`${user.cls[0]}_activities`)\r\n                            .updateOne(\r\n                                {\r\n                                    _id: data.id,\r\n                                },\r\n                                {\r\n                                    $set: {\r\n                                        [`student_list.${user._id}`]: 0,\r\n                                    },\r\n                                    // $push: {\r\n                                    //   bonus_list: user._id,\r\n                                    // },\r\n                                },\r\n                                {\r\n                                    upsert: true,\r\n                                },\r\n                            );\r\n                        return res.status(200).json({ id: user._id, cls: user.cls });\r\n                    case 'Khoa':\r\n                        // save activity in activities collection in 'Dep name' database\r\n                        await client\r\n                            .db(user.dep)\r\n                            .collection('activities')\r\n                            .updateOne(\r\n                                {\r\n                                    _id: data.id,\r\n                                },\r\n                                {\r\n                                    $set: {\r\n                                        [`student_list.${user._id}`]: 0,\r\n                                    },\r\n                                    // $push: {\r\n                                    //   bonus_list: user._id,\r\n                                    // },\r\n                                },\r\n                                {\r\n                                    upsert: true,\r\n                                },\r\n                            );\r\n                        return res.status(200).json({ id: user._id, cls: user.cls });\r\n                    case 'Trường':\r\n                        await client\r\n                            .db(name_global_databases)\r\n                            .collection('activities')\r\n                            .updateOne(\r\n                                {\r\n                                    _id: data.id,\r\n                                },\r\n                                {\r\n                                    $set: {\r\n                                        [`student_list.${user._id}`]: 0,\r\n                                    },\r\n                                    // $push: {\r\n                                    //   bonus_list: user._id,\r\n                                    // },\r\n                                },\r\n                                {\r\n                                    upsert: true,\r\n                                },\r\n                            );\r\n                        return res.status(200).json({ id: user._id, cls: user.cls });\r\n                }\r\n                return res.status(404).json({ message: 'Thông tin xác thực sai!' });\r\n            } else {\r\n                return res.sendStatus(403);\r\n            }\r\n\r\n            // use later to update student joining inside activities database\r\n            // student_list: {}, // change later to list of student with value is boolean (true for joining and false for not joining)\r\n            // bonus_list: [], // list of student's id that have bonus.\r\n        } catch (err) {\r\n            console.log('SYSTEM | CHECK_IN_ACTIVITIES | ERROR | ', err);\r\n            return res.sendStatus(500);\r\n        }\r\n    });\r\n\r\n    // api 出席 gakusei to activity\r\n    router.post('/muster', checkIfUserLoginAPI, async (req, res) => {\r\n        try {\r\n            const user = req.session.user;\r\n            const data = req.body; // data = {id: '19181011' (activity's id), level: (Lớp/Khoa/Trường);\r\n            if (user.pow[0]) {\r\n                switch (data.level) {\r\n                    case 'Lớp':\r\n                        await client\r\n                            .db(user.dep)\r\n                            .collection(`${user.cls[0]}_activities`)\r\n                            .updateOne(\r\n                                {\r\n                                    _id: data.id,\r\n                                },\r\n                                {\r\n                                    $set: {\r\n                                        [`ai.${user._id}`]: true,\r\n                                    },\r\n                                    // $push: {\r\n                                    //   bonus_list: user._id,\r\n                                    // },\r\n                                },\r\n                                {\r\n                                    upsert: true,\r\n                                },\r\n                            );\r\n                        break;\r\n                    case 'Khoa':\r\n                        // save activity in activities collection in 'Dep name' database\r\n                        await client\r\n                            .db(user.dep)\r\n                            .collection('activities')\r\n                            .updateOne(\r\n                                {\r\n                                    _id: data.id,\r\n                                },\r\n                                {\r\n                                    $set: {\r\n                                        [`ai.${user._id}`]: true,\r\n                                    },\r\n                                    // $push: {\r\n                                    //   bonus_list: user._id,\r\n                                    // },\r\n                                },\r\n                                {\r\n                                    upsert: true,\r\n                                },\r\n                            );\r\n                        break;\r\n                    case 'Trường':\r\n                        await client\r\n                            .db(name_global_databases)\r\n                            .collection('activities')\r\n                            .updateOne(\r\n                                {\r\n                                    _id: data.id,\r\n                                },\r\n                                {\r\n                                    $set: {\r\n                                        [`ai.${user._id}`]: true,\r\n                                    },\r\n                                    // $push: {\r\n                                    //   bonus_list: user._id,\r\n                                    // },\r\n                                },\r\n                                {\r\n                                    upsert: true,\r\n                                },\r\n                            );\r\n                        break;\r\n                }\r\n\r\n                await client\r\n                    .db(user.dep)\r\n                    .collection(user.cls[0] + '_std_table')\r\n                    .updateOne(\r\n                        {\r\n                            mssv: user._id,\r\n                            school_year: data.year,\r\n                        },\r\n                        {\r\n                            $set: { [`img_ids.${data.id}`]: data.img_ids },\r\n                        },\r\n                        { upsert: true },\r\n                    );\r\n\r\n                return res.status(200).json({ id: user._id, cls: user.cls });\r\n            } else {\r\n                return res.sendStatus(403);\r\n            }\r\n\r\n            // use later to update student joining inside activities database\r\n            // student_list: {}, // change later to list of student with value is boolean (true for joining and false for not joining)\r\n            // bonus_list: [], // list of student's id that have bonus.\r\n        } catch (err) {\r\n            console.log('SYSTEM | CHECK_IN_ACTIVITIES | ERROR | ', err);\r\n            return res.sendStatus(500);\r\n        }\r\n    });\r\n\r\n    // api add and edit activities -------------------------------------------------------------------------------------------------------------------------------\r\n    router.post('/addOrEditActivities', checkIfUserLoginAPI, async (req, res) => {\r\n        try {\r\n            const user = req.session.user;\r\n            const data = req.body; // data = {atv_id: '19181011' (activity's id);\r\n            // name: 'Hoat dong hay nha';\r\n            // content: 'Di du thu noi';\r\n            // 'level': 'khoa';\r\n            // cls_id:'KTPM';\r\n            // start_date: '2020-05-18';\r\n            // start_hour: '14:10:30'}\r\n\r\n            if (user.pow[3] && user.pow[11]) {\r\n                // get curr school year\r\n                const school_year = await client\r\n                    .db(name_global_databases)\r\n                    .collection('school_year')\r\n                    .findOne({}, { projection: { _id: 0, year: 1 } });\r\n                // if it is a new one Send fake id and sure that not exist in database\r\n                switch (data.level) {\r\n                    case 'lop':\r\n                        // save activity in 'Class name' + _activities collection in 'Department name' database\r\n                        await client\r\n                            .db(user.dep)\r\n                            .collection(data.cls_id + '_activities')\r\n                            .updateOne(\r\n                                {\r\n                                    _id: data.atv_id,\r\n                                },\r\n                                {\r\n                                    $set: {\r\n                                        name: data.name,\r\n                                        content: data.content,\r\n                                        level: 'Lớp',\r\n                                        cls: data.cls_id,\r\n                                        year: school_year.year,\r\n                                        start_time: new Date([data.start_date, data.start_hour]),\r\n                                        end: false,\r\n                                    },\r\n                                },\r\n                                {\r\n                                    upsert: true,\r\n                                },\r\n                            );\r\n\r\n                        // check other databases if this activities in thoese collection remove it\r\n                        await client.db(name_global_databases).collection('activities').deleteOne({ _id: data.atv_id }); // school\r\n\r\n                        await client.db(user.dep).collection('activities').deleteOne({ _id: data.atv_id }); // department\r\n\r\n                        // create index for new table has just created\r\n                        await await client\r\n                            .db(user.dep)\r\n                            .collection(data.cls_id + '_activities')\r\n                            .createIndex(\r\n                                {\r\n                                    year: 1,\r\n                                },\r\n                                {\r\n                                    name: '_year',\r\n                                },\r\n                            );\r\n\r\n                        break;\r\n                    case 'khoa':\r\n                        // save activity in activities collection in 'Dep name' database\r\n                        await client\r\n                            .db(user.dep)\r\n                            .collection('activities')\r\n                            .updateOne(\r\n                                {\r\n                                    _id: data.atv_id,\r\n                                },\r\n                                {\r\n                                    $set: {\r\n                                        name: data.name,\r\n                                        content: data.content,\r\n                                        level: 'Khoa',\r\n                                        year: school_year.year,\r\n                                        start_time: new Date([data.start_date, data.start_hour]),\r\n                                        end: false,\r\n                                    },\r\n                                },\r\n                                {\r\n                                    upsert: true,\r\n                                },\r\n                            );\r\n\r\n                        // check other databases if this activities in thoese collection remove it\r\n                        await client.db(name_global_databases).collection('activities').deleteOne({ _id: data.atv_id }); // school\r\n                        await client\r\n                            .db(user.dep)\r\n                            .collection(data.cls_id + '_activities')\r\n                            .deleteOne({ _id: data.atv_id }); // class\r\n\r\n                        // create index for new table has just created\r\n                        await client.db(user.dep).collection('activities').createIndex(\r\n                            {\r\n                                year: 1,\r\n                            },\r\n                            {\r\n                                name: '_year',\r\n                            },\r\n                        );\r\n\r\n                        break;\r\n                    case 'truong':\r\n                        // save activity in activities collection in global database\r\n                        await client\r\n                            .db(name_global_databases)\r\n                            .collection('activities')\r\n                            .updateOne(\r\n                                {\r\n                                    _id: data.atv_id,\r\n                                },\r\n                                {\r\n                                    $set: {\r\n                                        name: data.name,\r\n                                        content: data.content,\r\n                                        level: 'Trường',\r\n                                        year: school_year.year,\r\n                                        start_time: new Date([data.start_date, data.start_hour]),\r\n                                        end: false,\r\n                                    },\r\n                                },\r\n                                {\r\n                                    upsert: true,\r\n                                },\r\n                            );\r\n\r\n                        // check other databases if this activities in thoese collection remove it\r\n                        await client.db(user.dep).collection('activities').deleteOne({ _id: data.atv_id }); // department\r\n                        await client\r\n                            .db(user.dep)\r\n                            .collection(data.cls_id + '_activities')\r\n                            .deleteOne({ _id: data.atv_id }); // class\r\n\r\n                        // school database do not need create index because it already have it\r\n                        break;\r\n                }\r\n                wss.clients.forEach((ws) => {\r\n                    if (ws.actId == data.atv_id) {\r\n                        ws.send('reload');\r\n                    }\r\n                });\r\n                return res.status(200).json({ message: 'Success' });\r\n            } else {\r\n                return res.sendStatus(403);\r\n            }\r\n\r\n            // use later to update student joining inside activities database\r\n            // student_list: {}, // change later to list of student with value is boolean (true for joining and false for not joining)\r\n            // bonus_list: [], // list of student's id that have bonus.\r\n        } catch (err) {\r\n            console.log('SYSTEM | ADD_EDIT_ACTIVITIES | ERROR | ', err);\r\n            return res.sendStatus(500);\r\n        }\r\n    });\r\n\r\n    // api load activities base on years -------------------------------------------------------------------------------------------------------------------------------\r\n    router.post('/loadYearActivities', checkIfUserLoginAPI, async (req, res) => {\r\n        try {\r\n            const user = req.session.user;\r\n            const data = req.body; // data = {year: '2022-2023', semester: '1'}\r\n            const curr_year = 'HK' + data.semester + '_' + data.year;\r\n            if (user.pow[3]) {\r\n                // find all activities in this year:\r\n                // get all activities of school\r\n                const school_atv = await client\r\n                    .db(name_global_databases)\r\n                    .collection('activities')\r\n                    .find(\r\n                        {\r\n                            year: curr_year,\r\n                        },\r\n                        {\r\n                            projection: {\r\n                                name: 1,\r\n                                content: 1,\r\n                                year: 1,\r\n                            },\r\n                        },\r\n                    )\r\n                    .toArray();\r\n\r\n                // get all activities of dep\r\n                const dep_atv = await client\r\n                    .db(user.dep)\r\n                    .collection('activities')\r\n                    .find(\r\n                        {\r\n                            year: curr_year,\r\n                        },\r\n                        {\r\n                            projection: {\r\n                                name: 1,\r\n                                content: 1,\r\n                                year: 1,\r\n                            },\r\n                        },\r\n                    )\r\n                    .toArray();\r\n\r\n                // get all activities of class of department\r\n                const collections = await client.db(user.dep).listCollections().toArray();\r\n\r\n                // Filter collections ending with '_activities'\r\n                const activityCollections = collections.filter((collection) => collection.name.endsWith('_activities'));\r\n\r\n                // Loop through activity collections and retrieve all documents\r\n                const cls_atvs = await activityCollections.map(async (collection) => {\r\n                    if (user.pow[1]) {\r\n                        const dummy = await client\r\n                            .db(user.dep)\r\n                            .collection(collection.name)\r\n                            .find(\r\n                                {\r\n                                    year: curr_year,\r\n                                    cls: user.cls[0],\r\n                                },\r\n                                {\r\n                                    projection: {\r\n                                        name: 1,\r\n                                        content: 1,\r\n                                        cls: 1,\r\n                                        year: 1,\r\n                                    },\r\n                                },\r\n                            )\r\n                            .toArray();\r\n                        return dummy;\r\n                    } else {\r\n                        const dummy = await client\r\n                            .db(user.dep)\r\n                            .collection(collection.name)\r\n                            .find(\r\n                                {\r\n                                    year: curr_year,\r\n                                },\r\n                                {\r\n                                    projection: {\r\n                                        name: 1,\r\n                                        content: 1,\r\n                                        cls: 1,\r\n                                        year: 1,\r\n                                    },\r\n                                },\r\n                            )\r\n                            .toArray();\r\n                        return dummy;\r\n                    }\r\n                });\r\n                Promise.all(cls_atvs)\r\n                    .then((results) => {\r\n                        // Khi tất cả các promise đã hoàn thành, results sẽ là một mảng chứa kết quả từ mỗi truy vấn.\r\n                        // Bạn có thể làm gì đó với kết quả ở đây.\r\n                        const cls_atv = [].concat(...results); // Kết hợp kết quả từ các truy vấn vào một mảng duy nhất\r\n\r\n                        const final = {\r\n                            school_atv: school_atv,\r\n                            dep_atv: dep_atv,\r\n                            cls_atv: cls_atv,\r\n                        };\r\n                        return res.status(200).json(final);\r\n                    })\r\n                    .catch((error) => {\r\n                        // Xử lý lỗi nếu có\r\n                        console.log('SYSTEM | LOAD_YEAR_ACTIVITIES | ERROR |', error);\r\n                    });\r\n            } else {\r\n                return res.sendStatus(403);\r\n            }\r\n        } catch (err) {\r\n            console.log('SYSTEM | LOAD_YEAR_ACTIVITIES | ERROR | ', err);\r\n            return res.sendStatus(500);\r\n        }\r\n    });\r\n\r\n    // api load activities base on class -------------------------------------------------------------------------------------------------------------------------------\r\n    router.post('/loadClassActivities', checkIfUserLoginAPI, async (req, res) => {\r\n        try {\r\n            const user = req.session.user;\r\n            const data = req.body; // data = {cls: 'KTPM0121'}\r\n            if (user.pow[3]) {\r\n                // get all activities in that class:\r\n                const cls_act = await client\r\n                    .db(user.dep)\r\n                    .collection(data.cls + '_activities')\r\n                    .find({})\r\n                    .toArray();\r\n\r\n                return res.status(200).json(cls_act);\r\n            } else {\r\n                return res.sendStatus(403);\r\n            }\r\n        } catch (err) {\r\n            console.log('SYSTEM | LOAD_CLASS_ACTIVITIES | ERROR | ', err);\r\n            return res.sendStatus(500);\r\n        }\r\n    });\r\n\r\n    // api end activities\r\n    router.post('/updateActivitiesStatus', checkIfUserLoginAPI, async (req, res) => {\r\n        try {\r\n            const user = req.session.user;\r\n            const data = req.body; // data = {_id: 18102003 (activities' id), level: 'Truong', status: '1' (1: đang diễn ra, 0: đã kết thúc)}\r\n            // must be department to use this api\r\n            if (user.pow[3]) {\r\n                if (data.level == 'Truong') {\r\n                    // update status of current activity\r\n                    await client\r\n                        .db(name_global_databases)\r\n                        .collection('activities')\r\n                        .updateOne(\r\n                            {\r\n                                _id: data._id,\r\n                            },\r\n                            {\r\n                                $set: { end: data.status == '1' },\r\n                            },\r\n                        );\r\n                } else if (data.level == 'Khoa') {\r\n                    // update status of current activity\r\n                    await client\r\n                        .db(user.dep)\r\n                        .collection('activities')\r\n                        .updateOne(\r\n                            {\r\n                                _id: data._id,\r\n                            },\r\n                            {\r\n                                $set: { end: data.status == '1' },\r\n                            },\r\n                        );\r\n                } else {\r\n                    // update status of current activity\r\n                    await client\r\n                        .db(user.dep)\r\n                        .collection(data.level + '_activities')\r\n                        .updateOne(\r\n                            {\r\n                                _id: data._id,\r\n                            },\r\n                            {\r\n                                $set: { end: data.status == '1' },\r\n                            },\r\n                        );\r\n                }\r\n                wss.clients.forEach((ws) => {\r\n                    if (ws.actId == data._id) {\r\n                        ws.send('reload');\r\n                    }\r\n                });\r\n                return res.sendStatus(200);\r\n            } else {\r\n                return res.sendStatus(403); // send user to 403 page\r\n            }\r\n        } catch (err) {\r\n            console.log('SYSTEM | DELETE_TEACHER | ERROR | ', err);\r\n            return res.sendStatus(500);\r\n        }\r\n    });\r\n\r\n    // api approval students join in activity\r\n    router.post('/approvalActivityStudent', checkIfUserLoginAPI, async (req, res) => {\r\n        try {\r\n            const user = req.session.user;\r\n            const data = req.body; // data = {_id: _id, level: level, dataUpdate: list of update students, defaultApproval: old student list}\r\n            // must be department to use this api\r\n            const ai = {};\r\n            Object.keys(data.dataUpdate).forEach((key) => {\r\n                ai[key] = data.dataUpdate[key] === 1 ? true : false;\r\n            });\r\n            if (user.pow[3]) {\r\n                if (data.level == 'Truong') {\r\n                    // update status of current activity\r\n                    await client\r\n                        .db(name_global_databases)\r\n                        .collection('activities')\r\n                        .updateOne(\r\n                            {\r\n                                _id: data._id,\r\n                            },\r\n                            {\r\n                                $set: { student_list: data.dataUpdate, ai: ai },\r\n                            },\r\n                        );\r\n                } else if (data.level == 'Khoa') {\r\n                    // update status of current activity\r\n                    await client\r\n                        .db(user.dep)\r\n                        .collection('activities')\r\n                        .updateOne(\r\n                            {\r\n                                _id: data._id,\r\n                            },\r\n                            {\r\n                                $set: { student_list: data.dataUpdate, ai: ai },\r\n                            },\r\n                        );\r\n                } else {\r\n                    // update status of current activity\r\n                    await client\r\n                        .db(user.dep)\r\n                        .collection(data.level + '_activities')\r\n                        .updateOne(\r\n                            {\r\n                                _id: data._id,\r\n                            },\r\n                            {\r\n                                $set: { student_list: data.dataUpdate, ai: ai },\r\n                            },\r\n                        );\r\n                }\r\n\r\n                return res.sendStatus(200);\r\n            } else {\r\n                return res.sendStatus(403); // send user to 403 page\r\n            }\r\n        } catch (err) {\r\n            console.log('SYSTEM | APPROVAL ACTIVITY STUDENTS | ERROR | ', err);\r\n            return res.sendStatus(500);\r\n        }\r\n    });\r\n\r\n    // api delete student join in activity\r\n    router.post('/deleteActivityStudent', checkIfUserLoginAPI, async (req, res) => {\r\n        try {\r\n            const user = req.session.user;\r\n            const data = req.body; // data = {_id: _id, level: level, dataDelete: dataDelete }\r\n\r\n            // must be department to use this api\r\n            if (user.pow[3]) {\r\n                if (data.level == 'Truong') {\r\n                    // update status of current activity\r\n                    await client.db(name_global_databases).collection('activities').updateOne(\r\n                        {\r\n                            _id: data._id,\r\n                        },\r\n                        {\r\n                            $unset: data.dataDelete,\r\n                        },\r\n                    );\r\n                } else if (data.level == 'Khoa') {\r\n                    // update status of current activity\r\n                    await client.db(user.dep).collection('activities').updateOne(\r\n                        {\r\n                            _id: data._id,\r\n                        },\r\n                        {\r\n                            $unset: data.bonusDelete,\r\n                        },\r\n                    );\r\n                } else {\r\n                    // update status of current activity\r\n                    await client\r\n                        .db(user.dep)\r\n                        .collection(data.level + '_activities')\r\n                        .updateOne(\r\n                            {\r\n                                _id: data._id,\r\n                            },\r\n                            {\r\n                                $unset: data.bonusDelete,\r\n                            },\r\n                        );\r\n                }\r\n\r\n                return res.sendStatus(200);\r\n            } else {\r\n                return res.sendStatus(403); // send user to 403 page\r\n            }\r\n        } catch (err) {\r\n            console.log('SYSTEM | DELETE ACTIVITY STUDENTS | ERROR | ', err);\r\n            return res.sendStatus(500);\r\n        }\r\n    });\r\n\r\n    // api delete activities checked\r\n    router.post('/deleteActivities', checkIfUserLoginAPI, async (req, res) => {\r\n        try {\r\n            const user = req.session.user;\r\n            const data = req.body; // data = {school_rmatv: [\"19112003\" (school_activity_id), ...], dep_rmatv: [\"28091978\" (dep_activity_id), ...], cls_rmatv: [\"18102003\" (cls_activity_id), ...]}\r\n\r\n            // must be department to use this api\r\n            if (user.pow[3] && user.pow[11]) {\r\n                // remove all checked school activities\r\n                await client\r\n                    .db(name_global_databases)\r\n                    .collection('activities')\r\n                    .deleteMany({\r\n                        _id: { $in: data.school_rmatv },\r\n                    });\r\n\r\n                // remove all checked dep activities\r\n                await client\r\n                    .db(user.dep)\r\n                    .collection('activities')\r\n                    .deleteMany({\r\n                        _id: { $in: data.dep_rmatv },\r\n                    });\r\n\r\n                // remove all checked class activities\r\n                // get all activities of class of department\r\n                const collections = await client.db(user.dep).listCollections().toArray();\r\n\r\n                // Filter collections ending with '_activities'\r\n                const activityCollections = await collections.filter((collection) =>\r\n                    collection.name.endsWith('_activities'),\r\n                );\r\n\r\n                // Loop through activity collections and retrieve all documents\r\n                activityCollections.forEach(async (activityCollection) => {\r\n                    await client\r\n                        .db(user.dep)\r\n                        .collection(activityCollection.name)\r\n                        .deleteMany({\r\n                            _id: { $in: data.cls_rmatv },\r\n                        });\r\n                });\r\n\r\n                return res.sendStatus(200);\r\n            } else {\r\n                return res.sendStatus(403); // send user to 403 page\r\n            }\r\n        } catch (err) {\r\n            console.log('SYSTEM | DELETE_TEACHER | ERROR | ', err);\r\n            return res.sendStatus(500);\r\n        }\r\n    });\r\n\r\n    // load bang diem cua giao vien------------------------------------------------------------------------------------------------------------------\r\n    router.get('/teacher/loadScoresList', checkIfUserLoginAPI, async (req, res) => {\r\n        try {\r\n            const user = req.session.user;\r\n            if (user.pow[1]) {\r\n                const data = req.query;\r\n                //data = {year: \"HK1_2022-2023\", cls: \"1\"}\r\n                const school_year = data.year;\r\n                const year_available = await client\r\n                    .db(name_global_databases)\r\n                    .collection('school_year')\r\n                    .findOne(\r\n                        {},\r\n                        {\r\n                            projection: {\r\n                                _id: 0,\r\n                                year: 1,\r\n                                start_day: 1,\r\n                                end_day: 1,\r\n                            },\r\n                        },\r\n                    );\r\n\r\n                const student_list = sortStudentName(\r\n                    await client\r\n                        .db(name_global_databases)\r\n                        .collection('user_info')\r\n                        .find(\r\n                            { class: data.cls, 'power.0': { $exists: true } },\r\n                            {\r\n                                projection: {\r\n                                    first_name: 1,\r\n                                    last_name: 1,\r\n                                    total_score: 1,\r\n                                },\r\n                            },\r\n                        )\r\n                        .toArray(),\r\n                );\r\n\r\n                // get all student total score from themself:\r\n                let result = {\r\n                    // staff_name: [],\r\n                    student_list: student_list,\r\n                    // student_scores: [],\r\n                    // staff_scores: [],\r\n                    // department_scores: [],\r\n                    year_available: year_available,\r\n                };\r\n\r\n                return res.status(200).json(result);\r\n            } else {\r\n                // user not staff members\r\n                // redirect to home (return 403, api khong the chuyenh huong ve trang chu duoc)\r\n                return res.sendStatus(403);\r\n            }\r\n        } catch (err) {\r\n            console.log('SYSTEM | GIAO_VIEN_LOAD_SCORE_LIST | ERROR | ', err);\r\n            return res.sendStatus(500);\r\n        }\r\n    });\r\n\r\n    // api add and edit new class\r\n    router.post('/addOrEditClasses', checkIfUserLoginAPI, async (req, res) => {\r\n        try {\r\n            const user = req.session.user;\r\n            const data = req.body; // data = {new_id: KTPM0121, old_id: CNTT0221, branch: KTPM, cvht: 18101911}\r\n\r\n            // must be department to use this api\r\n            if (user.pow[9]) {\r\n                const school_year = await client\r\n                    .db(name_global_databases)\r\n                    .collection('school_year')\r\n                    .findOne(\r\n                        {},\r\n                        {\r\n                            projection: {\r\n                                _id: 0,\r\n                                year: 1,\r\n                            },\r\n                        },\r\n                    );\r\n\r\n                const curr_year = school_year.year.split('_')[1];\r\n\r\n                // find year of old_id class before remove it\r\n                const old_class = await client\r\n                    .db(name_global_databases)\r\n                    .collection('classes')\r\n                    .findOne(\r\n                        {\r\n                            _id: data.old_id,\r\n                        },\r\n                        {\r\n                            projection: {\r\n                                _id: 0,\r\n                                years: 1,\r\n                                cvht: 1,\r\n                            },\r\n                        },\r\n                    );\r\n\r\n                if (old_class) {\r\n                    // remove old_id class\r\n                    await client.db(name_global_databases).collection('classes').deleteOne({ _id: data.old_id });\r\n\r\n                    // add (edit old_id class)\r\n                    await client.db(name_global_databases).collection('classes').insertOne({\r\n                        _id: data.new_id,\r\n                        years: old_class.years, // years of old_id class\r\n                        branch: data.branch,\r\n                        cvht: data.cvht,\r\n                    });\r\n\r\n                    // remove class from old teacher's class\r\n                    await client\r\n                        .db(name_global_databases)\r\n                        .collection('user_info')\r\n                        .updateOne(\r\n                            {\r\n                                _id: old_class.cvht,\r\n                            },\r\n                            {\r\n                                $pull: { class: data.old_id },\r\n                            },\r\n                        );\r\n\r\n                    // add new class to new teacher's class\r\n                    await client\r\n                        .db(name_global_databases)\r\n                        .collection('user_info')\r\n                        .updateOne(\r\n                            {\r\n                                _id: data.cvht,\r\n                            },\r\n                            {\r\n                                $addToSet: { class: data.new_id },\r\n                            },\r\n                        );\r\n                } else {\r\n                    // add new_id class\r\n                    await client\r\n                        .db(name_global_databases)\r\n                        .collection('classes')\r\n                        .insertOne({\r\n                            _id: data.new_id,\r\n                            years: {\r\n                                [`${curr_year}`]: [1, 2, 3],\r\n                            },\r\n                            branch: data.branch,\r\n                            cvht: data.cvht,\r\n                        });\r\n\r\n                    // add new class to teacher's class\r\n                    await client\r\n                        .db(name_global_databases)\r\n                        .collection('user_info')\r\n                        .updateOne(\r\n                            {\r\n                                _id: data.cvht,\r\n                            },\r\n                            {\r\n                                $addToSet: { class: data.new_id },\r\n                            },\r\n                        );\r\n                }\r\n            } else {\r\n                return res.sendStatus(403); // back to home\r\n            }\r\n\r\n            return res.sendStatus(200);\r\n        } catch (err) {\r\n            console.log('SYSTEM | ADD_EDIT_CLASS | ERROR | ', err);\r\n            return res.sendStatus(500);\r\n        }\r\n    });\r\n\r\n    // api delete classes checked\r\n    router.post('/deleteClasses', checkIfUserLoginAPI, async (req, res) => {\r\n        try {\r\n            const user = req.session.user;\r\n            const data = req.body; // data = {rm_cls: [\"KTPM0121\" (class_id), ...], rm_ts: [\"18101911\" (teacher_id), ...]}\r\n\r\n            // must be department to use this api\r\n            if (user.pow[9]) {\r\n                // remove all checked classes in remove branchs líst in user_info and login_info\r\n                // remove class from teacher's class\r\n                await deleteClassApi(data, user);\r\n            } else {\r\n                return res.sendStatus(403); // back to home\r\n            }\r\n            return res.sendStatus(200);\r\n        } catch (err) {\r\n            console.log('SYSTEM | DELETE_CLASS | ERROR | ', err);\r\n            return res.sendStatus(500);\r\n        }\r\n    });\r\n\r\n    // api load classes\r\n    router.post('/loadClasses', checkIfUserLoginAPI, async (req, res) => {\r\n        try {\r\n            const user = req.session.user;\r\n            const data = req.body; // data = {curr_load_branch: 1 (next index to load), branchs: [KTPM, CNTT, ...] (all branch in department)}\r\n\r\n            // must be department to use this api\r\n            if (user.pow[9]) {\r\n                // get all classes of not load branchs:\r\n                let classes = {}; // classes = {KTPM: [KTPM0121, KTPM0108, ...], CNTT: [CNTT0109, CNTT0209, ...], ...}\r\n                let class_teachers = []; // class_teachers = [18102003, 19112003, ...]\r\n                let new_curr_load_branch; // next final branch loaded\r\n\r\n                for (let i = data.curr_load_branch; i < data.branchs.length; i++) {\r\n                    let dummy = await client\r\n                        .db(name_global_databases)\r\n                        .collection('classes')\r\n                        .find(\r\n                            {\r\n                                branch: data.branchs[i]._id,\r\n                            }, // find all data\r\n                            {\r\n                                projection: {\r\n                                    cvht: 1,\r\n                                },\r\n                            },\r\n                        )\r\n                        .toArray();\r\n\r\n                    classes[data.branchs[i]._id] = dummy.map((cls) => cls._id);\r\n                    class_teachers.push(...dummy.map((cls) => cls.cvht));\r\n\r\n                    new_curr_load_branch = i + 1;\r\n                    // finish load one brach then check does number of classes over 30.\r\n                    if (class_teachers.length >= 30) {\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                // get all teacher's name of classes\r\n                for (let i = 0; i < class_teachers.length; i++) {\r\n                    // replace current teacher's _id with teacher's name\r\n                    class_teachers[i] = await client\r\n                        .db(name_global_databases)\r\n                        .collection('user_info')\r\n                        .findOne(\r\n                            {\r\n                                _id: class_teachers[i],\r\n                                'power.1': { $exists: true },\r\n                                'power.4': { $exists: true },\r\n                            }, // user is teacher\r\n                            {\r\n                                projection: {\r\n                                    first_name: 1,\r\n                                    last_name: 1,\r\n                                },\r\n                            },\r\n                        );\r\n                }\r\n\r\n                return res.status(200).json({\r\n                    classes: classes,\r\n                    class_teachers: class_teachers,\r\n                    new_curr_load_branch: new_curr_load_branch,\r\n                });\r\n            } else {\r\n                return res.sendStatus(403); // back to home\r\n            }\r\n        } catch (err) {\r\n            console.log('SYSTEM | DELETE_CLASS | ERROR | ', err);\r\n            return res.sendStatus(500);\r\n        }\r\n    });\r\n    router.post('/exportaccount', upload.single('file'), checkIfUserLoginAPI, async (req, res) => {\r\n        try {\r\n            const user = req.session.user;\r\n            const Class = req.body.class;\r\n            const studentList = sortStudentName(\r\n                await client\r\n                    .db(name_global_databases)\r\n                    .collection('user_info')\r\n                    .find(\r\n                        { class: Class, 'power.0': { $exists: true } },\r\n                        {\r\n                            projection: {\r\n                                _id: 1,\r\n                                last_name: 1,\r\n                                first_name: 1,\r\n                            },\r\n                        },\r\n                    )\r\n                    .toArray(),\r\n            );\r\n\r\n            const workbook = await XlsxPopulate.fromFileAsync('./src/excelTemplate/FILE_TAO_ACC.xlsx');\r\n\r\n            const dataRows = [];\r\n\r\n            for (const student of studentList) {\r\n                const loginInfo = await client\r\n                    .db(name_global_databases)\r\n                    .collection('login_info')\r\n                    .findOne(\r\n                        { _id: student._id },\r\n                        {\r\n                            projection: {\r\n                                _id: 1,\r\n                                password: 1,\r\n                            },\r\n                        },\r\n                    );\r\n                if (loginInfo) {\r\n                    const dataRow = [student._id, loginInfo.password, student.last_name, student.first_name];\r\n\r\n                    dataRows.push(dataRow);\r\n                }\r\n            }\r\n\r\n            if (dataRows.length > 0) {\r\n                await workbook.sheet(0).cell('A2').value(dataRows);\r\n            }\r\n\r\n            const uuid = uuidv4();\r\n            const outputFile = path.join(`.downloads/${uuid}.xlsx`);\r\n\r\n            await workbook.toFileAsync(outputFile);\r\n            console.log(path.join('.downloads', uuid + '.xlsx'));\r\n            scheduleFileDeletion(path.join('.downloads', uuid + '.xlsx'));\r\n            return res.download(path.join('.downloads', uuid + '.xlsx'));\r\n        } catch (err) {\r\n            console.log('SYSTEM | EXPORT ACCOUNT | ERROR | ', err);\r\n            return res.sendStatus(500);\r\n        }\r\n    });\r\n    // api get img acti student\r\n    router.post('/getImgActivities', checkIfUserLoginAPI, async (req, res) => {\r\n        try {\r\n            const user = req.session.user;\r\n            const data = req.body; // data = {curr_load_branch: 1 (next index to load), branchs: [KTPM, CNTT, ...] (all branch in department)}\r\n\r\n            // must be department to use this api\r\n            if (user.pow[3]) {\r\n                imglist = await client\r\n                    .db(user.dep)\r\n                    .collection(data.class + '_std_table')\r\n                    .findOne(\r\n                        {\r\n                            mssv: data._id,\r\n                            school_year: data.year,\r\n                        },\r\n                        {\r\n                            projection: {\r\n                                img_ids: 1,\r\n                            },\r\n                        },\r\n                    );\r\n                if (data.idact in imglist.img_ids) {\r\n                    let imginfo = [];\r\n                    for (const i of imglist.img_ids[data.idact]) {\r\n                        imginfo.push(await server.getDriveFileLinkAndDescription(i));\r\n                    }\r\n\r\n                    return res.status(200).json(imginfo);\r\n                } else return res.status(404).json();\r\n            } else {\r\n                return res.sendStatus(403); // back to home\r\n            }\r\n        } catch (err) {\r\n            console.log('SYSTEM | LOAD_IMG_STUDENTS | ERROR | ', err);\r\n            return res.sendStatus(500);\r\n        }\r\n    });\r\n\r\n    return router;\r\n}\r\n\r\nmodule.exports = createAPIRouter;\r\n"],"mappings":"AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAC,SAAS,CAAC;AAClC,MAAMC,MAAM,GAAGF,OAAO,CAACG,MAAM,CAAC,CAAC;AAC/B,MAAMC,YAAY,GAAGH,OAAO,CAAC,eAAe,CAAC;AAC7C,MAAM;EAAEI,EAAE,EAAEC;AAAO,CAAC,GAAGL,OAAO,CAAC,MAAM,CAAC;AACtC,MAAMM,IAAI,GAAGN,OAAO,CAAC,MAAM,CAAC;AAC5B,MAAMO,EAAE,GAAGP,OAAO,CAAC,IAAI,CAAC;AACxB,MAAMQ,eAAe,GAAGF,IAAI,CAACG,IAAI,CAAC,mBAAmB,CAAC;AACtD,MAAMC,MAAM,GAAGV,OAAO,CAAC,QAAQ,CAAC;AAChC,MAAMW,MAAM,GAAGX,OAAO,CAAC,wBAAwB,CAAC;AAEhD,MAAM;EAAEY;AAAS,CAAC,GAAGZ,OAAO,CAAC,SAAS,CAAC;AACvC,MAAM;EAAEa;AAAc,CAAC,GAAGb,OAAO,CAAC,mBAAmB,CAAC;AACtD,MAAMc,qBAAqB,GAAGD,aAAa,CAAC,CAAC;AAC7C,MAAM;EACFE,eAAe;EACfC,YAAY;EACZC,eAAe;EACfC,oBAAoB;EACpBC,IAAI;EACJC,uBAAuB;EACvBC,SAAS;EACTC,cAAc;EACdC,mBAAmB;EACnBC,QAAQ;EACRC,WAAW;EACXC,cAAc;EACdC;AACJ,CAAC,GAAG3B,OAAO,CAAC,qBAAqB,CAAC;AAElC,IAAI,CAACO,EAAE,CAACqB,UAAU,CAACpB,eAAe,CAAC,EAAE;EACjCD,EAAE,CAACsB,SAAS,CAACrB,eAAe,CAAC;AACjC;AACA,MAAMsB,YAAY,GAAGpB,MAAM,CAACqB,WAAW,CAAC;EACpCC,WAAW,EAAE,SAAAA,CAAUC,GAAG,EAAEC,IAAI,EAAEC,EAAE,EAAE;IAClCA,EAAE,CAAC,IAAI,EAAE3B,eAAe,CAAC;EAC7B,CAAC;EACD4B,QAAQ,EAAE,SAAAA,CAAUH,GAAG,EAAEC,IAAI,EAAEC,EAAE,EAAE;IAC/BA,EAAE,CAAC,IAAI,EAAED,IAAI,CAACG,YAAY,CAAC;EAC/B;AACJ,CAAC,CAAC;AACF,MAAMC,MAAM,GAAG5B,MAAM,CAAC;EAAE6B,OAAO,EAAET;AAAa,CAAC,CAAC;;AAEhD;AACA,SAASU,eAAeA,CAACC,MAAM,EAAEC,GAAG,EAAE;EAClC;EACAzC,MAAM,CAAC0C,IAAI,CAAC,QAAQ,EAAE,OAAOV,GAAG,EAAEW,GAAG,KAAK;IACtC,MAAMC,IAAI,GAAGZ,GAAG,CAACa,IAAI;IACrB;IACA;IACA,IAAI;MACA,MAAMC,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;MAC7B,IAAI,CAACA,IAAI,EAAE;QACP;QACA,IAAIA,IAAI,GAAG,MAAMN,MAAM,CAACQ,EAAE,CAACnC,qBAAqB,CAAC,CAACoC,UAAU,CAAC,YAAY,CAAC,CAACC,OAAO,CAAC;UAAEC,GAAG,EAAEP,IAAI,CAACQ;QAAK,CAAC,CAAC;QACtG,IAAIC,eAAe,GAAG,MAAMb,MAAM,CAC7BQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,WAAW,CAAC,CACvBC,OAAO,CAAC;UAAEC,GAAG,EAAEP,IAAI,CAACQ;QAAK,CAAC,CAAC;QAChC,IAAIN,IAAI,KAAK,IAAI,IAAIO,eAAe,KAAK,IAAI,IAAIA,eAAe,CAACC,KAAK,IAAI,EAAE,EAAE;UAC1E;UACA,IAAIR,IAAI,EAAE;YACN,MAAMN,MAAM,CAACQ,EAAE,CAACnC,qBAAqB,CAAC,CAACoC,UAAU,CAAC,YAAY,CAAC,CAACM,SAAS,CAAC;cAAEJ,GAAG,EAAEP,IAAI,CAACQ;YAAK,CAAC,CAAC;UACjG;UACA,IAAIC,eAAe,EAAE;YACjB,MAAMb,MAAM,CAACQ,EAAE,CAACnC,qBAAqB,CAAC,CAACoC,UAAU,CAAC,WAAW,CAAC,CAACM,SAAS,CAAC;cAAEJ,GAAG,EAAEP,IAAI,CAACQ;YAAK,CAAC,CAAC;UAChG;UACA;UACA,OAAOT,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;QAC9B,CAAC,MAAM,IAAIV,IAAI,CAACK,GAAG,KAAKP,IAAI,CAACQ,IAAI,IAAItC,eAAe,CAAC8B,IAAI,CAACa,QAAQ,EAAEX,IAAI,CAACW,QAAQ,CAAC,EAAE;UAChF,IAAIC,UAAU,GAAG,MAAMlB,MAAM,CACxBQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,kBAAkB,CAAC,CAC9BC,OAAO,CAAC;YAAEC,GAAG,EAAEP,IAAI,CAACQ;UAAK,CAAC,CAAC;UAChC,IAAIM,UAAU,EAAE;YACZA,UAAU,GAAGA,UAAU,CAACC,SAAS;YACjC,MAAMC,YAAY,GAAG,MAAMpB,MAAM,CAC5BQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,UAAU,CAAC,CACtBY,IAAI,CAAC;cAAEV,GAAG,EAAE;gBAAEW,GAAG,EAAEJ;cAAW;YAAE,CAAC,CAAC,CAClCK,OAAO,CAAC,CAAC;YACd,MAAMC,WAAW,GAAGJ,YAAY,CAACK,GAAG,CAAEC,GAAG,IAAKA,GAAG,CAACf,GAAG,CAAC;YACtD,MAAMgB,WAAW,GAAGT,UAAU,CAACU,MAAM,CAAEC,EAAE,IAAK,CAACL,WAAW,CAACM,QAAQ,CAACD,EAAE,CAAC,CAAC;YACxE,IAAIF,WAAW,CAACI,MAAM,GAAG,CAAC,EAAE;cACxB,MAAM/B,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,kBAAkB,CAAC,CAC9BuB,SAAS,CAAC;gBAAErB,GAAG,EAAEP,IAAI,CAACQ;cAAK,CAAC,EAAE;gBAAEqB,KAAK,EAAE;kBAAEd,SAAS,EAAE;oBAAEG,GAAG,EAAEK;kBAAY;gBAAE;cAAE,CAAC,CAAC;YACtF;UACJ;;UAEA;UACA,MAAMO,GAAG,GAAG,MAAMlC,MAAM,CACnBQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,WAAW,CAAC,CACvBC,OAAO,CAAC;YAAEC,GAAG,EAAEP,IAAI,CAACQ;UAAK,CAAC,EAAE;YAAEuB,UAAU,EAAE;cAAExB,GAAG,EAAE,CAAC;cAAEG,KAAK,EAAE,CAAC;cAAEsB,KAAK,EAAE,CAAC;cAAEC,GAAG,EAAE;YAAE;UAAE,CAAC,CAAC;UAExF,IAAI,CAACH,GAAG,CAACE,KAAK,CAAC,CAAC,CAAC,EAAE;YACf,MAAME,MAAM,GAAG,MAAMtC,MAAM,CACtBQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,SAAS,CAAC,CACrBC,OAAO,CAAC;cAAEC,GAAG,EAAEuB,GAAG,CAACpB,KAAK,CAAC,CAAC;YAAE,CAAC,EAAE;cAAEqB,UAAU,EAAE;gBAAExB,GAAG,EAAE,CAAC;gBAAE2B,MAAM,EAAE;cAAE;YAAE,CAAC,CAAC;YAC1E,IAAIA,MAAM,EAAE;cACR,MAAMD,GAAG,GAAG,MAAMrC,MAAM,CACnBQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,SAAS,CAAC,CACrBC,OAAO,CAAC;gBAAEC,GAAG,EAAE2B,MAAM,CAACA;cAAO,CAAC,EAAE;gBAAEH,UAAU,EAAE;kBAAExB,GAAG,EAAE,CAAC;kBAAE0B,GAAG,EAAE;gBAAE;cAAE,CAAC,CAAC;cAExE/B,IAAI,CAAC+B,GAAG,GAAGA,GAAG,CAACA,GAAG;YACtB;YACA/B,IAAI,CAAC4B,GAAG,GAAGA,GAAG,CAACpB,KAAK;UACxB,CAAC,MAAM;YACHR,IAAI,CAAC+B,GAAG,GAAGH,GAAG,CAACG,GAAG;UACtB;UACA/B,IAAI,CAACiC,GAAG,GAAGL,GAAG,CAACE,KAAK;UACpB;UACA5C,GAAG,CAACe,OAAO,CAACD,IAAI,GAAGA,IAAI;UACvB;UACA,IAAIF,IAAI,CAACoC,QAAQ,EAAE;YACf;YACAhD,GAAG,CAACe,OAAO,CAACkC,MAAM,CAACC,MAAM,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI,CAAC,CAAC;UAC1D,CAAC,MAAM;YACH;YACAlD,GAAG,CAACe,OAAO,CAACkC,MAAM,CAACC,MAAM,GAAG,OAAO,CAAC,CAAC;UACzC;UACA,MAAMvB,SAAS,GAAG3B,GAAG,CAACe,OAAO,CAACsB,EAAE;UAChC,MAAM7B,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,kBAAkB,CAAC,CAC9BuB,SAAS,CAAC;YAAErB,GAAG,EAAEL,IAAI,CAACK;UAAI,CAAC,EAAE;YAAEgC,KAAK,EAAE;cAAExB,SAAS,EAAEA;YAAU;UAAE,CAAC,EAAE;YAAEyB,MAAM,EAAE;UAAK,CAAC,CAAC;UAExF,IAAItC,IAAI,CAACuC,KAAK,IAAI,UAAU,EAAE;YAC1B,OAAO1C,GAAG,CAAC2C,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;cAAEC,KAAK,EAAE;YAAK,CAAC,CAAC;UAChD,CAAC,MAAM;YACH,OAAO7C,GAAG,CAAC2C,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;cAAEC,KAAK,EAAE;YAAM,CAAC,CAAC;UACjD;QACJ,CAAC,MAAM;UACH;UACA,OAAO7C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;QAC9B;MACJ,CAAC,MAAM;QACH,OAAOb,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;MAC9B;IACJ,CAAC,CAAC,OAAOiC,GAAG,EAAE;MACVC,OAAO,CAACC,GAAG,CAAC,4BAA4B,EAAEF,GAAG,CAAC;MAC9C,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;;EAEF;EACAxD,MAAM,CAAC4F,GAAG,CAAC,SAAS,EAAEtE,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IAC3D;IACA,MAAMS,IAAI,GAAGpB,GAAG,CAACe,OAAO,CAACD,IAAI,CAACK,GAAG;IACjCnB,GAAG,CAACe,OAAO,CAAC8C,OAAO,CAAEJ,GAAG,IAAK;MACzB,IAAIA,GAAG,EAAE;QACLC,OAAO,CAACC,GAAG,CAAC,sCAAsC,EAAEF,GAAG,CAAC;QACxD,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;MAC9B,CAAC,MAAM;QACH,IAAIE,UAAU;QACd,eAAeoC,iBAAiBA,CAAA,EAAG;UAC/B,IAAI;YACApC,UAAU,GAAG,MAAMlB,MAAM,CACpBQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,kBAAkB,CAAC,CAC9BC,OAAO,CAAC;cAAEC,GAAG,EAAEC;YAAK,CAAC,CAAC;YAC3B,IAAIM,UAAU,EAAE;cACZA,UAAU,GAAGA,UAAU,CAACC,SAAS;cACjC,MAAMC,YAAY,GAAG,MAAMpB,MAAM,CAC5BQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,UAAU,CAAC,CACtBY,IAAI,CAAC;gBAAEV,GAAG,EAAE;kBAAEW,GAAG,EAAEJ;gBAAW;cAAE,CAAC,CAAC,CAClCK,OAAO,CAAC,CAAC;cACd,MAAMC,WAAW,GAAGJ,YAAY,CAACK,GAAG,CAAEC,GAAG,IAAKA,GAAG,CAACf,GAAG,CAAC;cACtD,MAAMgB,WAAW,GAAGT,UAAU,CAACU,MAAM,CAAEC,EAAE,IAAK,CAACL,WAAW,CAACM,QAAQ,CAACD,EAAE,CAAC,CAAC;cAExE,IAAIF,WAAW,CAACI,MAAM,GAAG,CAAC,EAAE;gBACxB,MAAM/B,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,kBAAkB,CAAC,CAC9BuB,SAAS,CAAC;kBAAErB,GAAG,EAAEC;gBAAK,CAAC,EAAE;kBAAEqB,KAAK,EAAE;oBAAEd,SAAS,EAAE;sBAAEG,GAAG,EAAEK;oBAAY;kBAAE;gBAAE,CAAC,CAAC;cACjF;YACJ;YAEA,OAAOxB,GAAG,CAACoD,QAAQ,CAAC,QAAQ,CAAC,CAAC,CAAC;UACnC,CAAC,CAAC,OAAOC,KAAK,EAAE;YACZN,OAAO,CAACC,GAAG,CAAC,iDAAiD,EAAEK,KAAK,CAAC;YACrE,OAAOrD,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;UAC9B;QACJ;QAEAsC,iBAAiB,CAAC,CAAC;MACvB;IACJ,CAAC,CAAC;EACN,CAAC,CAAC;;EAEF;EACA9F,MAAM,CAAC4F,GAAG,CAAC,kBAAkB,EAAEtE,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IACpE;IACA,MAAMQ,GAAG,GAAGnB,GAAG,CAACe,OAAO,CAACD,IAAI,CAACK,GAAG;IAChC,MAAM8C,MAAM,GAAG,MAAMzD,MAAM,CAACQ,EAAE,CAACnC,qBAAqB,CAAC,CAACoC,UAAU,CAAC,kBAAkB,CAAC,CAACC,OAAO,CAAC;MAAEC,GAAG,EAAEA;IAAI,CAAC,CAAC;IAC1G,MAAM+C,aAAa,GAAGD,MAAM,CAACtC,SAAS;IACtCuC,aAAa,CAACC,MAAM,CAACD,aAAa,CAACE,OAAO,CAACpE,GAAG,CAACe,OAAO,CAACsB,EAAE,CAAC,EAAE,CAAC,CAAC;IAC9D,MAAM7B,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,kBAAkB,CAAC,CAC9BuB,SAAS,CACN;MAAErB,GAAG,EAAEA;IAAI,CAAC,EAEZ;MAAEsB,KAAK,EAAE;QAAEd,SAAS,EAAE;UAAE0C,GAAG,EAAErE,GAAG,CAACe,OAAO,CAACsB;QAAG;MAAE;IAAE,CACpD,CAAC;IACL,MAAM7B,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,UAAU,CAAC,CACtBqD,UAAU,CAAC;MAAEnD,GAAG,EAAE;QAAEW,GAAG,EAAEoC;MAAc;IAAE,CAAC,CAAC;IAChDzD,GAAG,CAAC8D,OAAO,CAACC,OAAO,CAAEC,EAAE,IAAK;MACxB,IAAIP,aAAa,CAAC5B,QAAQ,CAACmC,EAAE,CAACpC,EAAE,CAAC,EAAE;QAC/BoC,EAAE,CAACC,IAAI,CAAC,QAAQ,CAAC;MACrB;IACJ,CAAC,CAAC;IACF,OAAO/D,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;EAC9B,CAAC,CAAC;;EAEF;EACAxD,MAAM,CAAC0C,IAAI,CAAC,aAAa,EAAEpB,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IAChE,IAAI;MACA,MAAMC,IAAI,GAAGZ,GAAG,CAACa,IAAI;MACrB,MAAML,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,WAAW,CAAC,CACvBuB,SAAS,CACN;QAAErB,GAAG,EAAEnB,GAAG,CAACe,OAAO,CAACD,IAAI,CAACK;MAAI,CAAC,EAC7B;QACIwD,IAAI,EAAE;UACFC,WAAW,EAAEhE,IAAI,CAACgE,WAAW;UAC7BC,GAAG,EAAEjE,IAAI,CAACiE;QACd;MACJ,CACJ,CAAC;MACL,OAAOlE,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B,CAAC,CAAC,OAAOiC,GAAG,EAAE;MACVC,OAAO,CAACC,GAAG,CAAC,iCAAiC,EAAEF,GAAG,CAAC;MACnD,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;;EAEF;EACAxD,MAAM,CAAC0C,IAAI,CAAC,gBAAgB,EAAE,OAAOV,GAAG,EAAEW,GAAG,KAAK;IAC9C,IAAI;MACA,MAAMC,IAAI,GAAGZ,GAAG,CAACa,IAAI;MACrB,MAAMiE,GAAG,GAAG,MAAMtE,MAAM,CACnBQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,KAAK,CAAC,CACjBC,OAAO,CAAC;QAAEC,GAAG,EAAEP,IAAI,CAACQ;MAAK,CAAC,EAAE;QAAEuB,UAAU,EAAE;UAAExB,GAAG,EAAE;QAAE;MAAE,CAAC,CAAC;MAC5D,IAAI2D,GAAG,IAAIhG,eAAe,CAAC8B,IAAI,CAACmE,GAAG,EAAED,GAAG,CAACE,OAAO,CAAC,EAAE;QAC/C,MAAMxE,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,YAAY,CAAC,CACxBuB,SAAS,CAAC;UAAErB,GAAG,EAAEP,IAAI,CAACQ;QAAK,CAAC,EAAE;UAAEuD,IAAI,EAAE;YAAEtB,KAAK,EAAE;UAAM;QAAE,CAAC,CAAC;QAC9D;QACA,IAAIvC,IAAI,GAAG,MAAMN,MAAM,CAACQ,EAAE,CAACnC,qBAAqB,CAAC,CAACoC,UAAU,CAAC,YAAY,CAAC,CAACC,OAAO,CAAC;UAAEC,GAAG,EAAEP,IAAI,CAACQ;QAAK,CAAC,CAAC;QACtG,MAAMZ,MAAM,CAACQ,EAAE,CAACnC,qBAAqB,CAAC,CAACoC,UAAU,CAAC,KAAK,CAAC,CAACM,SAAS,CAAC;UAAEJ,GAAG,EAAEP,IAAI,CAACQ;QAAK,CAAC,CAAC;QACtF,IAAIM,UAAU,GAAG,MAAMlB,MAAM,CACxBQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,kBAAkB,CAAC,CAC9BC,OAAO,CAAC;UAAEC,GAAG,EAAEP,IAAI,CAACQ;QAAK,CAAC,CAAC;QAChC,IAAIM,UAAU,EAAE;UACZA,UAAU,GAAGA,UAAU,CAACC,SAAS;UACjC,MAAMC,YAAY,GAAG,MAAMpB,MAAM,CAC5BQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,UAAU,CAAC,CACtBY,IAAI,CAAC;YAAEV,GAAG,EAAE;cAAEW,GAAG,EAAEJ;YAAW;UAAE,CAAC,CAAC,CAClCK,OAAO,CAAC,CAAC;UACd,MAAMC,WAAW,GAAGJ,YAAY,CAACK,GAAG,CAAEC,GAAG,IAAKA,GAAG,CAACf,GAAG,CAAC;UACtD,MAAMgB,WAAW,GAAGT,UAAU,CAACU,MAAM,CAAEC,EAAE,IAAK,CAACL,WAAW,CAACM,QAAQ,CAACD,EAAE,CAAC,CAAC;UACxE,IAAIF,WAAW,CAACI,MAAM,GAAG,CAAC,EAAE;YACxB,MAAM/B,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,kBAAkB,CAAC,CAC9BuB,SAAS,CAAC;cAAErB,GAAG,EAAEP,IAAI,CAACQ;YAAK,CAAC,EAAE;cAAEqB,KAAK,EAAE;gBAAEd,SAAS,EAAE;kBAAEG,GAAG,EAAEK;gBAAY;cAAE;YAAE,CAAC,CAAC;UACtF;QACJ;;QAEA;QACA,MAAMO,GAAG,GAAG,MAAMlC,MAAM,CACnBQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,WAAW,CAAC,CACvBC,OAAO,CAAC;UAAEC,GAAG,EAAEP,IAAI,CAACQ;QAAK,CAAC,EAAE;UAAEuB,UAAU,EAAE;YAAExB,GAAG,EAAE,CAAC;YAAEG,KAAK,EAAE,CAAC;YAAEsB,KAAK,EAAE,CAAC;YAAEC,GAAG,EAAE;UAAE;QAAE,CAAC,CAAC;QAExF,IAAI,CAACH,GAAG,CAACE,KAAK,CAAC,CAAC,CAAC,EAAE;UACf,MAAME,MAAM,GAAG,MAAMtC,MAAM,CACtBQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,SAAS,CAAC,CACrBC,OAAO,CAAC;YAAEC,GAAG,EAAEuB,GAAG,CAACpB,KAAK,CAAC,CAAC;UAAE,CAAC,EAAE;YAAEqB,UAAU,EAAE;cAAExB,GAAG,EAAE,CAAC;cAAE2B,MAAM,EAAE;YAAE;UAAE,CAAC,CAAC;UAC1E,IAAIA,MAAM,EAAE;YACR,MAAMD,GAAG,GAAG,MAAMrC,MAAM,CACnBQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,SAAS,CAAC,CACrBC,OAAO,CAAC;cAAEC,GAAG,EAAE2B,MAAM,CAACA;YAAO,CAAC,EAAE;cAAEH,UAAU,EAAE;gBAAExB,GAAG,EAAE,CAAC;gBAAE0B,GAAG,EAAE;cAAE;YAAE,CAAC,CAAC;YAExE/B,IAAI,CAAC+B,GAAG,GAAGA,GAAG,CAACA,GAAG;UACtB;UACA/B,IAAI,CAAC4B,GAAG,GAAGA,GAAG,CAACpB,KAAK;QACxB,CAAC,MAAM;UACHR,IAAI,CAAC+B,GAAG,GAAGH,GAAG,CAACG,GAAG;QACtB;QACA/B,IAAI,CAACiC,GAAG,GAAGL,GAAG,CAACE,KAAK;QACpB;QACA5C,GAAG,CAACe,OAAO,CAACD,IAAI,GAAGA,IAAI;QACvB;QACA,IAAIF,IAAI,CAACoC,QAAQ,EAAE;UACf;UACAhD,GAAG,CAACe,OAAO,CAACkC,MAAM,CAACC,MAAM,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI,CAAC,CAAC;QAC1D,CAAC,MAAM;UACH;UACAlD,GAAG,CAACe,OAAO,CAACkC,MAAM,CAACC,MAAM,GAAG,OAAO,CAAC,CAAC;QACzC;QACA,MAAMvB,SAAS,GAAG3B,GAAG,CAACe,OAAO,CAACsB,EAAE;QAChC,MAAM7B,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,kBAAkB,CAAC,CAC9BuB,SAAS,CAAC;UAAErB,GAAG,EAAEL,IAAI,CAACK;QAAI,CAAC,EAAE;UAAEgC,KAAK,EAAE;YAAExB,SAAS,EAAEA;UAAU;QAAE,CAAC,EAAE;UAAEyB,MAAM,EAAE;QAAK,CAAC,CAAC;QACxF,OAAOzC,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;MAC9B,CAAC,MAAM;QACHb,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;MACvB;IACJ,CAAC,CAAC,OAAOiC,GAAG,EAAE;MACVC,OAAO,CAACC,GAAG,CAAC,oCAAoC,EAAEF,GAAG,CAAC;MACtD,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;;EAEF;EACAxD,MAAM,CAAC0C,IAAI,CAAC,YAAY,EAAE,OAAOV,GAAG,EAAEW,GAAG,KAAK;IAC1C,IAAI;MACA,MAAMS,IAAI,GAAGpB,GAAG,CAACa,IAAI,CAACO,IAAI;MAC1B,MAAM6D,QAAQ,GAAG,MAAMzE,MAAM,CACxBQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,WAAW,CAAC,CACvBC,OAAO,CAAC;QAAEC,GAAG,EAAEC;MAAK,CAAC,EAAE;QAAEuB,UAAU,EAAE;UAAExB,GAAG,EAAE,CAAC;UAAE+D,KAAK,EAAE;QAAE;MAAE,CAAC,CAAC;MACjE;MACA,MAAMC,QAAQ,GAAG,MAAM9F,cAAc,CAAC,CAAC;MACvC,MAAMmB,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,KAAK,CAAC,CACjBuB,SAAS,CACN;QAAErB,GAAG,EAAEC;MAAK,CAAC,EACb;QACIuD,IAAI,EAAE;UACFK,OAAO,EAAEjG,YAAY,CAACoG,QAAQ,CAAC;UAC/BC,QAAQ,EAAE,IAAIC,IAAI,CAACA,IAAI,CAACC,GAAG,CAAC,CAAC,GAAG,EAAE,GAAG,CAAC,GAAG,IAAI,CAAC,CAAE;QACpD;MACJ,CAAC,EACD;QAAElC,MAAM,EAAE;MAAK,CACnB,CAAC;MACL,IAAI6B,QAAQ,EAAE;QACV,MAAMC,KAAK,GAAGD,QAAQ,CAACC,KAAK;QAC5B,MAAM9F,SAAS,CAAC+F,QAAQ,EAAED,KAAK,CAAC;MACpC;MACA,OAAOvE,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B,CAAC,CAAC,OAAOiC,GAAG,EAAE;MACVC,OAAO,CAACC,GAAG,CAAC,gCAAgC,EAAEF,GAAG,CAAC;MAClD,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;;EAEF;EACAxD,MAAM,CAAC0C,IAAI,CAAC,cAAc,EAAEpB,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IACjE,IAAI;MACA,MAAMC,IAAI,GAAGZ,GAAG,CAACa,IAAI;MACrB,MAAM0E,QAAQ,GAAG,MAAM/E,MAAM,CACxBQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,YAAY,CAAC,CACxBC,OAAO,CAAC;QAAEC,GAAG,EAAEnB,GAAG,CAACe,OAAO,CAACD,IAAI,CAACK;MAAI,CAAC,EAAE;QAAEwB,UAAU,EAAE;UAAExB,GAAG,EAAE,CAAC;UAAEM,QAAQ,EAAE;QAAE;MAAE,CAAC,CAAC;MACpF,IAAI3C,eAAe,CAAC8B,IAAI,CAAC4E,YAAY,EAAED,QAAQ,CAAC9D,QAAQ,CAAC,EAAE;QACvD,IAAI,CAAC3C,eAAe,CAAC8B,IAAI,CAAC6E,YAAY,EAAEF,QAAQ,CAAC9D,QAAQ,CAAC,EAAE;UACxD,MAAMjB,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,YAAY,CAAC,CACxBuB,SAAS,CACN;YAAErB,GAAG,EAAEnB,GAAG,CAACe,OAAO,CAACD,IAAI,CAACK;UAAI,CAAC,EAC7B;YAAEwD,IAAI,EAAE;cAAElD,QAAQ,EAAE1C,YAAY,CAAC6B,IAAI,CAAC6E,YAAY;YAAE;UAAE,CAC1D,CAAC;UACL,OAAO9E,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;QAC9B,CAAC,MAAM;UACH,OAAOb,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;QAC9B;MACJ,CAAC,MAAM;QACHb,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;MACvB;IACJ,CAAC,CAAC,OAAOiC,GAAG,EAAE;MACVC,OAAO,CAACC,GAAG,CAAC,qCAAqC,EAAEF,GAAG,CAAC;MACvD,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;;EAEF;EACAxD,MAAM,CAAC0C,IAAI,CAAC,cAAc,EAAEpB,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IACjE,IAAI;MACA,MAAMC,IAAI,GAAGZ,GAAG,CAACa,IAAI;MACrB,MAAM0E,QAAQ,GAAG,MAAM/E,MAAM,CACxBQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,YAAY,CAAC,CACxBC,OAAO,CAAC;QAAEC,GAAG,EAAEnB,GAAG,CAACe,OAAO,CAACD,IAAI,CAACK;MAAI,CAAC,EAAE;QAAEwB,UAAU,EAAE;UAAExB,GAAG,EAAE,CAAC;UAAEM,QAAQ,EAAE;QAAE;MAAE,CAAC,CAAC;MAEpF,IAAI3C,eAAe,CAAC8B,IAAI,CAAC6E,YAAY,EAAEF,QAAQ,CAAC9D,QAAQ,CAAC,EAAE;QACvD,OAAOd,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;MAC9B,CAAC,MAAM;QACH,OAAOxB,GAAG,CAACe,OAAO,CAACD,IAAI,CAACuC,KAAK;QAC7B,MAAM7C,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,YAAY,CAAC,CACxBuB,SAAS,CAAC;UAAErB,GAAG,EAAEnB,GAAG,CAACe,OAAO,CAACD,IAAI,CAACK;QAAI,CAAC,EAAE;UAAEuE,MAAM,EAAE;YAAErC,KAAK,EAAE;UAAG;QAAE,CAAC,CAAC;QACxE,MAAM7C,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,YAAY,CAAC,CACxBuB,SAAS,CAAC;UAAErB,GAAG,EAAEnB,GAAG,CAACe,OAAO,CAACD,IAAI,CAACK;QAAI,CAAC,EAAE;UAAEwD,IAAI,EAAE;YAAElD,QAAQ,EAAE1C,YAAY,CAAC6B,IAAI,CAAC6E,YAAY;UAAE;QAAE,CAAC,CAAC;QACtG,OAAO9E,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;MAC9B;IACJ,CAAC,CAAC,OAAOiC,GAAG,EAAE;MACVC,OAAO,CAACC,GAAG,CAAC,qCAAqC,EAAEF,GAAG,CAAC;MACvD,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;;EAEF;EACAxD,MAAM,CAAC0C,IAAI,CAAC,WAAW,EAAEpB,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IAC9D,IAAI;MACA,MAAMG,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;MAC7B,IAAIA,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,EAAE;QACb,MAAMnC,IAAI,GAAGZ,GAAG,CAACa,IAAI;QACrB,MAAM8E,MAAM,GAAG,MAAMnF,MAAM,CACtBQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,WAAW,CAAC,CACvBC,OAAO,CACJ;UAAEC,GAAG,EAAEL,IAAI,CAACK;QAAI,CAAC,EACjB;UACIwB,UAAU,EAAE;YACRxB,GAAG,EAAE,CAAC;YACNyE,SAAS,EAAE,CAAC;YACZC,UAAU,EAAE;UAChB;QACJ,CACJ,CAAC;QAEL,MAAMC,MAAM,GAAG,MAAM5G,IAAI,CAAC,YAAY,EAAE4B,IAAI,EAAEA,IAAI,CAACK,GAAG,EAAEP,IAAI,EAAE+E,MAAM,EAAE7E,IAAI,CAAC4B,GAAG,CAAC,CAAC,CAAC,CAAC;QAElF,QAAQoD,MAAM;UACV,KAAK,CAAC;YACF,OAAOnF,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;UAC9B,KAAK,CAAC;YACF,OAAOb,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;UAC9B,KAAK,CAAC;YACF,OAAOb,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;QAClC;MACJ,CAAC,MAAM;QACH,OAAOb,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;MAC9B;IACJ,CAAC,CAAC,OAAOiC,GAAG,EAAE;MACVC,OAAO,CAACC,GAAG,CAAC,8BAA8B,EAAEF,GAAG,CAAC;MAChD,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;;EAEF;EACAxD,MAAM,CAAC0C,IAAI,CAAC,WAAW,EAAEpB,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IAC9D,MAAMG,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;IAC7B,IAAIA,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,EAAE;MACb,IAAI;QACA,MAAMnC,IAAI,GAAGZ,GAAG,CAACa,IAAI;QACrB,MAAM8E,MAAM,GAAG,MAAMnF,MAAM,CACtBQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,WAAW,CAAC,CACvBC,OAAO,CACJ;UAAEC,GAAG,EAAEL,IAAI,CAACK;QAAI,CAAC,EACjB;UACIwB,UAAU,EAAE;YACRxB,GAAG,EAAE,CAAC;YACNyE,SAAS,EAAE,CAAC;YACZC,UAAU,EAAE;UAChB;QACJ,CACJ,CAAC;QAEL,MAAMC,MAAM,GAAG,MAAM5G,IAAI,CAAC,YAAY,EAAE4B,IAAI,EAAEF,IAAI,CAACQ,IAAI,EAAER,IAAI,EAAE+E,MAAM,EAAE/E,IAAI,CAACU,KAAK,CAAC;QAElF,QAAQwE,MAAM;UACV,KAAK,CAAC;YACF,OAAOnF,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;UAC9B,KAAK,CAAC;YACF,OAAOb,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;UAC9B,KAAK,CAAC;YACF,OAAOb,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;QAClC;MACJ,CAAC,CAAC,OAAOiC,GAAG,EAAE;QACVC,OAAO,CAACC,GAAG,CAAC,8BAA8B,EAAEF,GAAG,CAAC;QAChD,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;MAC9B;IACJ,CAAC,MAAM,IAAIV,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,EAAE;MACpB,IAAI;QACA,MAAMnC,IAAI,GAAGZ,GAAG,CAACa,IAAI;QACrB,MAAM8E,MAAM,GAAG,MAAMnF,MAAM,CACtBQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,WAAW,CAAC,CACvBC,OAAO,CACJ;UAAEC,GAAG,EAAEL,IAAI,CAACK;QAAI,CAAC,EACjB;UACIwB,UAAU,EAAE;YACRxB,GAAG,EAAE,CAAC;YACNyE,SAAS,EAAE,CAAC;YACZC,UAAU,EAAE;UAChB;QACJ,CACJ,CAAC;QAEL,MAAMC,MAAM,GAAG,MAAM5G,IAAI,CAAC,YAAY,EAAE4B,IAAI,EAAEF,IAAI,CAACQ,IAAI,EAAER,IAAI,EAAE+E,MAAM,EAAE7E,IAAI,CAAC4B,GAAG,CAAC,CAAC,CAAC,CAAC;QAEnF,QAAQoD,MAAM;UACV,KAAK,CAAC;YACF,OAAOnF,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;UAC9B,KAAK,CAAC;YACF,OAAOb,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;UAC9B,KAAK,CAAC;YACF,OAAOb,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;QAClC;MACJ,CAAC,CAAC,OAAOiC,GAAG,EAAE;QACVC,OAAO,CAACC,GAAG,CAAC,8BAA8B,EAAEF,GAAG,CAAC;QAChD,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;MAC9B;IACJ,CAAC,MAAM;MACH,OAAOb,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;;EAEF;EACAxD,MAAM,CAAC0C,IAAI,CAAC,WAAW,EAAEpB,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IAC9D,MAAMG,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;IAC7B,IAAIA,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,EAAE;MACb,IAAI;QACA,MAAMnC,IAAI,GAAGZ,GAAG,CAACa,IAAI;QACrB,MAAM8E,MAAM,GAAG,MAAMnF,MAAM,CACtBQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,WAAW,CAAC,CACvBC,OAAO,CACJ;UAAEC,GAAG,EAAEL,IAAI,CAACK;QAAI,CAAC,EACjB;UACIwB,UAAU,EAAE;YACRxB,GAAG,EAAE,CAAC;YACNyE,SAAS,EAAE,CAAC;YACZC,UAAU,EAAE;UAChB;QACJ,CACJ,CAAC;QAEL,MAAMC,MAAM,GAAG,MAAM5G,IAAI,CAAC,YAAY,EAAE4B,IAAI,EAAEF,IAAI,CAACQ,IAAI,EAAER,IAAI,EAAE+E,MAAM,EAAE/E,IAAI,CAACU,KAAK,CAAC;QAElF,QAAQwE,MAAM;UACV,KAAK,CAAC;YACF,OAAOnF,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;UAC9B,KAAK,CAAC;YACF,OAAOb,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;QAClC;QAEA,OAAOb,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;MAC9B,CAAC,CAAC,OAAOiC,GAAG,EAAE;QACVC,OAAO,CAACC,GAAG,CAAC,8BAA8B,EAAEF,GAAG,CAAC;QAChD,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;MAC9B;IACJ,CAAC,MAAM;MACH,OAAOb,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;;EAEF;EACAxD,MAAM,CAAC0C,IAAI,CAAC,aAAa,EAAEL,MAAM,CAAC0F,KAAK,CAAC,SAAS,CAAC,EAAEzG,mBAAmB,EAAE,gBAAgBU,GAAG,EAAEW,GAAG,EAAE;IAC/F,IAAI,CAACX,GAAG,CAACgG,KAAK,EAAE;MACZ,OAAOrF,GAAG,CAAC2C,MAAM,CAAC,GAAG,CAAC,CAACoB,IAAI,CAAC,mBAAmB,CAAC;IACpD;IACA,IAAIuB,SAAS,GAAG,EAAE;IAClB,IAAIC,QAAQ,GAAG,EAAE;IACjB;IACA,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGnG,GAAG,CAACgG,KAAK,CAACzD,MAAM,EAAE4D,CAAC,EAAE,EAAE;MACvC,MAAMC,QAAQ,GAAGpG,GAAG,CAACgG,KAAK,CAACG,CAAC,CAAC,CAAC/F,YAAY;MAC1C,MAAMiG,eAAe,GAAGrG,GAAG,CAACa,IAAI,CAACyF,SAAS,CAACH,CAAC,CAAC,CAAC,CAAC;MAC/CD,QAAQ,CAACK,IAAI,CAACF,eAAe,CAAC;MAC9BJ,SAAS,CAACM,IAAI,CAACH,QAAQ,CAAC;IAC5B;;IAEA;IACAzF,GAAG,CAAC6F,SAAS,CAAC,GAAG,EAAE;MAAE,cAAc,EAAE;IAAmB,CAAC,CAAC;IAC1D,OAAO7F,GAAG,CAAC8F,GAAG,CAACC,IAAI,CAACC,SAAS,CAAC,MAAMnH,WAAW,CAACjB,eAAe,EAAE0H,SAAS,EAAEC,QAAQ,CAAC,CAAC,CAAC;EAC3F,CAAC,CAAC;;EAEF;EACAlI,MAAM,CAAC0C,IAAI,CAAC,gBAAgB,EAAEL,MAAM,CAACuG,MAAM,CAAC,MAAM,CAAC,EAAEtH,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IAC1F,MAAMG,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;IAC7B,MAAM+F,UAAU,GAAG;MACfxD,KAAK,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;MACtByD,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC;MACdC,KAAK,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;MAChBC,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;MACjBC,KAAK,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;MACnBC,OAAO,EAAE,EAAE;MACXC,KAAK,EAAE;IACX,CAAC;IAED,IAAIrG,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,IAAIjC,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,EAAE;MAC5B,MAAMqE,YAAY,GAAGpH,GAAG,CAACC,IAAI;MAC7B,eAAeoH,aAAaA,CAACC,GAAG,EAAE;QAC9B,IAAIC,EAAE,GACF,wIAAwI;QAC5I,IAAIC,EAAE,GACF,wIAAwI;QAC5I,IAAIC,MAAM,GAAG,EAAE;QACf,IAAIC,SAAS,GAAG,EAAE;QAClB,KAAK,IAAIvB,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGmB,GAAG,CAAC/E,MAAM,EAAE4D,CAAC,EAAE,EAAE;UACjC,IAAIoB,EAAE,CAACnD,OAAO,CAACkD,GAAG,CAACnB,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,EAAE;YAC1BsB,MAAM,IAAID,EAAE,CAACD,EAAE,CAACnD,OAAO,CAACkD,GAAG,CAACnB,CAAC,CAAC,CAAC,CAAC;UACpC,CAAC,MAAM;YACHsB,MAAM,IAAIH,GAAG,CAACnB,CAAC,CAAC;UACpB;UACA,IAAImB,GAAG,CAACnB,CAAC,CAAC,IAAI,GAAG,EAAE;YACfuB,SAAS,CAACnB,IAAI,CAACJ,CAAC,CAAC;UACrB;QACJ;QACA,IAAIwB,MAAM,GAAGF,MAAM,CAAC,CAAC,CAAC;QACtB,KAAK,IAAItB,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGuB,SAAS,CAACnF,MAAM,GAAG,CAAC,EAAE4D,CAAC,EAAE,EAAE;UAC3CwB,MAAM,IAAIF,MAAM,CAACG,MAAM,CAACF,SAAS,CAACvB,CAAC,CAAC,GAAG,CAAC,CAAC;QAC7C;QACAwB,MAAM,IAAIF,MAAM,CAACI,KAAK,CAACH,SAAS,CAACA,SAAS,CAACnF,MAAM,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,CAACuF,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC;QAC9E,OAAOH,MAAM,CAACI,WAAW,CAAC,CAAC,GAAG,uBAAuB;MACzD;MAEA,IAAIX,YAAY,EAAE;QACd,MAAMY,QAAQ,GAAG,MAAM9J,YAAY,CAAC+J,aAAa,CAACb,YAAY,CAAC/I,IAAI,CAAC;QACpE,MAAM6J,KAAK,GAAGF,QAAQ,CAACE,KAAK,CAAC,CAAC,CAAC;QAC/B;QACA,MAAMC,MAAM,GAAGD,KAAK,CAACE,SAAS,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC;QACxC,MAAMD,SAAS,GAAGF,KAAK,CAACE,SAAS,CAAC,CAAC;QAEnC,MAAME,cAAc,GAAG,CAAC,MAAM,EAAE,IAAI,EAAE,KAAK,CAAC;QAC5C;QACA,IAAIC,SAAS,GAAG,IAAI;QACpB,MAAMC,OAAO,GAAGJ,SAAS,CAACI,OAAO,CAAC,CAAC;QACnC,MAAMC,QAAQ,GAAGD,OAAO,CAACE,SAAS,CAAC,CAAC;QACpC,MAAMC,WAAW,GAAG,CAAC;QAErB,KAAK,IAAIC,MAAM,GAAG,CAAC,EAAEA,MAAM,IAAID,WAAW,EAAEC,MAAM,EAAE,EAAE;UAClD,MAAMC,IAAI,GAAGX,KAAK,CAACW,IAAI,CAAC,CAAC,EAAED,MAAM,CAAC,CAAC,CAAC;UACpC,MAAMP,KAAK,GAAGQ,IAAI,CAACR,KAAK,CAAC,CAAC;UAE1B,IAAIA,KAAK,KAAKC,cAAc,CAACM,MAAM,GAAG,CAAC,CAAC,EAAE;YACtCL,SAAS,GAAG,KAAK;YACjB;UACJ;QACJ;QAEA,IAAIA,SAAS,EAAE;UACX,IAAIO,SAAS,GAAG,IAAI;UAEpB,KAAK,IAAIC,GAAG,GAAG,CAAC,EAAEA,GAAG,IAAI,CAAC,EAAEA,GAAG,EAAE,EAAE;YAC/B,IAAIC,QAAQ,GAAG,KAAK;YACpB,KAAK,IAAIJ,MAAM,GAAG,CAAC,EAAEA,MAAM,IAAID,WAAW,EAAEC,MAAM,EAAE,EAAE;cAClD,MAAMC,IAAI,GAAGX,KAAK,CAACW,IAAI,CAACE,GAAG,EAAEH,MAAM,CAAC;cACpC,MAAMP,KAAK,GAAGQ,IAAI,CAACR,KAAK,CAAC,CAAC;cAE1B,IAAIA,KAAK,EAAE;gBACPW,QAAQ,GAAG,IAAI;gBACf;cACJ;YACJ;YAEA,IAAIA,QAAQ,EAAE;cACV;YACJ,CAAC,MAAM;cACHF,SAAS,GAAG,KAAK;cACjB;YACJ;UACJ;UACA,IAAIA,SAAS,EAAE;YACX,IAAI9I,GAAG,CAACa,IAAI,CAACyC,MAAM,IAAI,MAAM,EAAE;cAC3B,IAAI;gBACA;gBACA;;gBAEA,IAAI2F,aAAa,GAAG,CAAC;gBACrB;gBACAf,KAAK,CAACW,IAAI,CAAC,IAAI,CAAC,CAACR,KAAK,CAAC,OAAO,CAAC;gBAC/BH,KAAK,CAACW,IAAI,CAAC,IAAI,CAAC,CAACR,KAAK,CAAC,UAAU,CAAC;gBAClC,MAAMa,QAAQ,GAAG,EAAE;gBACnB,KAAK,IAAI/C,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGgC,MAAM,CAAC5F,MAAM,EAAE4D,CAAC,EAAE,EAAE;kBACpC,IAAIgD,EAAE,GAAG,MAAM9J,cAAc,CAAC,CAAC;kBAC/B,IAAI6F,KAAK,GAAG,MAAMmC,aAAa,CAC1B,GAAEc,MAAM,CAAChC,CAAC,CAAC,CAAC,CAAC,CAAC,CAACiD,QAAQ,CAAC,CAAE,IAAGjB,MAAM,CAAChC,CAAC,CAAC,CAAC,CAAC,CAAC,CAACiD,QAAQ,CAAC,CAAE,IAAGjB,MAAM,CAC3DhC,CAAC,CACJ,CAAC,CAAC,CAAC,CAACiD,QAAQ,CAAC,CAAE,EACpB,CAAC;kBACD,IAAIC,cAAc,GAAG;oBACjBlI,GAAG,EAAEgH,MAAM,CAAChC,CAAC,CAAC,CAAC,CAAC,CAAC,CAACiD,QAAQ,CAAC,CAAC;oBAC5BvD,UAAU,EAAEsC,MAAM,CAAChC,CAAC,CAAC,CAAC,CAAC,CAAC,CAACiD,QAAQ,CAAC,CAAC;oBACnCxD,SAAS,EAAEuC,MAAM,CAAChC,CAAC,CAAC,CAAC,CAAC,CAAC,CAACiD,QAAQ,CAAC,CAAC;oBAClCvE,GAAG,EAAE,0FAA0F;oBAC/FjC,KAAK,EAAE;sBAAE,CAAC,EAAE;oBAAK,CAAC;oBAClBtB,KAAK,EAAE,CAACtB,GAAG,CAACa,IAAI,CAAC6B,GAAG,CAAC;oBACrBkC,WAAW,EAAG,GAAEuD,MAAM,CAAChC,CAAC,CAAC,CAAC,CAAC,CAAC,CAACiD,QAAQ,CAAC,CAAE,IAAGjB,MAAM,CAAChC,CAAC,CAAC,CAAC,CAAC,CAAC,CAACiD,QAAQ,CAAC,CAAE,EAAC;oBACpElE,KAAK,EAAEA,KAAK;oBACZoE,WAAW,EAAE,CAAC;kBAClB,CAAC;kBACD,IAAIC,eAAe,GAAG;oBAClBpI,GAAG,EAAEgH,MAAM,CAAChC,CAAC,CAAC,CAAC,CAAC,CAAC,CAACiD,QAAQ,CAAC,CAAC;oBAC5B3H,QAAQ,EAAE1C,YAAY,CAACoK,EAAE,CAAC;oBAC1B9F,KAAK,EAAE;kBACX,CAAC;kBAED,MAAMmG,OAAO,GAAG,CACZH,cAAc,CAAClI,GAAG,EAClBgI,EAAE,EACFE,cAAc,CAACzD,SAAS,EACxByD,cAAc,CAACxD,UAAU,CAC5B;kBACDqD,QAAQ,CAAC3C,IAAI,CAACiD,OAAO,CAAC;kBAEtBhJ,MAAM,CAACQ,EAAE,CAAC,QAAQ,CAAC,CAACC,UAAU,CAAC,WAAW,CAAC,CAACuB,SAAS,CACjD;oBACIrB,GAAG,EAAEkI,cAAc,CAAClI;kBACxB,CAAC,EACD;oBACIwD,IAAI,EAAE0E;kBACV,CAAC,EACD;oBACIjG,MAAM,EAAE;kBACZ,CACJ,CAAC;kBACD5C,MAAM,CAACQ,EAAE,CAAC,QAAQ,CAAC,CAACC,UAAU,CAAC,YAAY,CAAC,CAACuB,SAAS,CAClD;oBACIrB,GAAG,EAAEoI,eAAe,CAACpI;kBACzB,CAAC,EACD;oBACIwD,IAAI,EAAE4E;kBACV,CAAC,EACD;oBACInG,MAAM,EAAE;kBACZ,CACJ,CAAC;kBACD,MAAMlE,IAAI,CACN,YAAY,EACZ4B,IAAI,EACJuI,cAAc,CAAClI,GAAG,EAClB0F,UAAU,EACV;oBACIhB,UAAU,EAAEwD,cAAc,CAACxD,UAAU;oBACrCD,SAAS,EAAEyD,cAAc,CAACzD;kBAC9B,CAAC,EACDyD,cAAc,CAAC/H,KAAK,CAAC,CAAC,CAC1B,CAAC;kBACD,MAAM4G,KAAK,CAACW,IAAI,CAAE,IAAG1C,CAAC,GAAG,CAAE,EAAC,CAAC,CAACkC,KAAK,CAACnD,KAAK,CAAC;kBAC1C,MAAMgD,KAAK,CAACW,IAAI,CAAE,IAAG1C,CAAC,GAAG,CAAE,EAAC,CAAC,CAACkC,KAAK,CAACc,EAAE,CAAC;kBACvC,MAAMM,KAAK,GAAGvB,KAAK,CAACuB,KAAK,CAAE,IAAGtD,CAAC,GAAG,CAAE,KAAIA,CAAC,GAAG,CAAE,EAAC,CAAC;kBAChDsD,KAAK,CAACC,KAAK,CAAC;oBAAEC,MAAM,EAAE;kBAAK,CAAC,CAAC;kBAC7B,IAAIzE,KAAK,CAAC3C,MAAM,GAAG0G,aAAa,EAAE;oBAC9BA,aAAa,GAAG/D,KAAK,CAAC3C,MAAM;kBAChC;gBACJ;gBACA;gBACA2F,KAAK,CAACU,MAAM,CAAC,GAAG,CAAC,CAACgB,KAAK,CAACX,aAAa,CAAC;gBACtC,MAAMY,IAAI,GAAGzL,MAAM,CAAC,CAAC;gBACrB,MAAM4J,QAAQ,CAAC8B,WAAW,CAACzL,IAAI,CAACG,IAAI,CAAC,YAAY,EAAEqL,IAAI,GAAG,OAAO,CAAC,CAAC;gBACnE;gBACA5K,oBAAoB,CAACZ,IAAI,CAACG,IAAI,CAAC,YAAY,EAAEqL,IAAI,GAAG,OAAO,CAAC,CAAC;gBAC7D,MAAME,WAAW,GAAG,MAAM7L,YAAY,CAAC+J,aAAa,CAChD,uCACJ,CAAC;gBAED,IAAIiB,QAAQ,CAAC3G,MAAM,GAAG,CAAC,EAAE;kBACrB,MAAMwH,WAAW,CAAC7B,KAAK,CAAC,CAAC,CAAC,CAACW,IAAI,CAAC,IAAI,CAAC,CAACR,KAAK,CAACa,QAAQ,CAAC;gBACzD;gBACA,MAAMc,UAAU,GAAG3L,IAAI,CAACG,IAAI,CAAE,cAAaqL,IAAK,OAAM,CAAC;gBAEvD,MAAME,WAAW,CAACD,WAAW,CAACE,UAAU,CAAC;gBACzC/K,oBAAoB,CAACZ,IAAI,CAACG,IAAI,CAAC,YAAY,EAAEqL,IAAI,GAAG,OAAO,CAAC,CAAC;gBAC7D,OAAOlJ,GAAG,CAACsJ,QAAQ,CAAC5L,IAAI,CAACG,IAAI,CAAC,YAAY,EAAEqL,IAAI,GAAG,OAAO,CAAC,CAAC;cAChE,CAAC,CAAC,OAAOpG,GAAG,EAAE;gBACVC,OAAO,CAACC,GAAG,CAAC,oCAAoC,EAAEF,GAAG,CAAC;gBACtD,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;cAC9B;YACJ,CAAC,MAAM;cACH,IAAI;gBACA;gBACA;gBACA,MAAMwG,QAAQ,GAAG,MAAM9J,YAAY,CAAC+J,aAAa,CAACb,YAAY,CAAC/I,IAAI,CAAC;gBACpE,MAAM6J,KAAK,GAAGF,QAAQ,CAACE,KAAK,CAAC,CAAC,CAAC;gBAE/B,MAAMC,MAAM,GAAGD,KAAK,CAACE,SAAS,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC;gBACxC,IAAIY,aAAa,GAAG,CAAC;gBACrB;gBACAf,KAAK,CAACW,IAAI,CAAC,IAAI,CAAC,CAACR,KAAK,CAAC,OAAO,CAAC;gBAC/BH,KAAK,CAACW,IAAI,CAAC,IAAI,CAAC,CAACR,KAAK,CAAC,UAAU,CAAC;gBAClC,KAAK,IAAIlC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGgC,MAAM,CAAC5F,MAAM,EAAE4D,CAAC,EAAE,EAAE;kBACpC,IAAI+D,gBAAgB,GAAG/B,MAAM,CAAChC,CAAC,CAAC,CAAC,CAAC,CAAC,CAACiD,QAAQ,CAAC,CAAC,CAAC,CAAC;;kBAEhD,MAAMzD,MAAM,GAAG,MAAMnF,MAAM,CACtBQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,WAAW,CAAC,CACvBC,OAAO,CACJ;oBAAEC,GAAG,EAAE+I;kBAAiB,CAAC,EACzB;oBACIvH,UAAU,EAAE;sBACRxB,GAAG,EAAE,CAAC;sBACNyE,SAAS,EAAE,CAAC;sBACZC,UAAU,EAAE;oBAChB;kBACJ,CACJ,CAAC;kBACL,IAAI,CAACF,MAAM,EAAE;oBACT,IAAIwD,EAAE,GAAG,MAAM9J,cAAc,CAAC,CAAC;oBAC/B,IAAI6F,KAAK,GAAG,MAAMmC,aAAa,CAC1B,GAAEc,MAAM,CAAChC,CAAC,CAAC,CAAC,CAAC,CAAE,IAAGgC,MAAM,CAAChC,CAAC,CAAC,CAAC,CAAC,CAAE,IAAGgC,MAAM,CAAChC,CAAC,CAAC,CAAC,CAAC,CAAC,CAACiD,QAAQ,CAAC,CAAE,EAC/D,CAAC;oBACD,IAAIC,cAAc,GAAG;sBACjBlI,GAAG,EAAEgH,MAAM,CAAChC,CAAC,CAAC,CAAC,CAAC,CAAC,CAACiD,QAAQ,CAAC,CAAC;sBAC5BvD,UAAU,EAAEsC,MAAM,CAAChC,CAAC,CAAC,CAAC,CAAC,CAAC,CAACiD,QAAQ,CAAC,CAAC;sBACnCxD,SAAS,EAAEuC,MAAM,CAAChC,CAAC,CAAC,CAAC,CAAC,CAAC,CAACiD,QAAQ,CAAC,CAAC;sBAClCvE,GAAG,EAAE,0FAA0F;sBAC/FjC,KAAK,EAAE;wBAAE,CAAC,EAAE;sBAAK,CAAC;sBAClBtB,KAAK,EAAE,CAACtB,GAAG,CAACa,IAAI,CAAC6B,GAAG,CAAC;sBACrBkC,WAAW,EAAG,GAAEuD,MAAM,CAAChC,CAAC,CAAC,CAAC,CAAC,CAAC,CAACiD,QAAQ,CAAC,CAAE,IAAGjB,MAAM,CAAChC,CAAC,CAAC,CAAC,CAAC,CAAC,CAACiD,QAAQ,CAAC,CAAE,EAAC;sBACpElE,KAAK,EAAEA,KAAK;sBACZoE,WAAW,EAAE,CAAC;oBAClB,CAAC;oBACD,IAAIC,eAAe,GAAG;sBAClBpI,GAAG,EAAEgH,MAAM,CAAChC,CAAC,CAAC,CAAC,CAAC,CAAC,CAACiD,QAAQ,CAAC,CAAC;sBAC5B3H,QAAQ,EAAE1C,YAAY,CAACoK,EAAE,CAAC;sBAC1B9F,KAAK,EAAE;oBACX,CAAC;oBACD7C,MAAM,CAACQ,EAAE,CAAC,QAAQ,CAAC,CAACC,UAAU,CAAC,WAAW,CAAC,CAACuB,SAAS,CACjD;sBACIrB,GAAG,EAAEkI,cAAc,CAAClI;oBACxB,CAAC,EACD;sBACIwD,IAAI,EAAE0E;oBACV,CAAC,EACD;sBACIjG,MAAM,EAAE;oBACZ,CACJ,CAAC;oBACD5C,MAAM,CAACQ,EAAE,CAAC,QAAQ,CAAC,CAACC,UAAU,CAAC,YAAY,CAAC,CAACuB,SAAS,CAClD;sBACIrB,GAAG,EAAEoI,eAAe,CAACpI;oBACzB,CAAC,EACD;sBACIwD,IAAI,EAAE4E;oBACV,CAAC,EACD;sBACInG,MAAM,EAAE;oBACZ,CACJ,CAAC;oBACD,MAAMlE,IAAI,CACN,YAAY,EACZ4B,IAAI,EACJuI,cAAc,CAAClI,GAAG,EAClB0F,UAAU,EACV;sBACIhB,UAAU,EAAEwD,cAAc,CAACxD,UAAU;sBACrCD,SAAS,EAAEyD,cAAc,CAACzD;oBAC9B,CAAC,EACDyD,cAAc,CAAC/H,KAAK,CAAC,CAAC,CAC1B,CAAC;oBACD,MAAM4G,KAAK,CAACW,IAAI,CAAE,IAAG1C,CAAC,GAAG,CAAE,EAAC,CAAC,CAACkC,KAAK,CAACnD,KAAK,CAAC;oBAC1C,MAAMgD,KAAK,CAACW,IAAI,CAAE,IAAG1C,CAAC,GAAG,CAAE,EAAC,CAAC,CAACkC,KAAK,CAACc,EAAE,CAAC;oBACvC,MAAMM,KAAK,GAAGvB,KAAK,CAACuB,KAAK,CAAE,IAAGtD,CAAC,GAAG,CAAE,KAAIA,CAAC,GAAG,CAAE,EAAC,CAAC;oBAChDsD,KAAK,CAACC,KAAK,CAAC;sBAAEC,MAAM,EAAE;oBAAK,CAAC,CAAC;oBAC7B,IAAIzE,KAAK,CAAC3C,MAAM,GAAG0G,aAAa,EAAE;sBAC9BA,aAAa,GAAG/D,KAAK,CAAC3C,MAAM;oBAChC;;oBAEA;oBACA2F,KAAK,CAACU,MAAM,CAAC,GAAG,CAAC,CAACgB,KAAK,CAACX,aAAa,CAAC;oBACtC,MAAMY,IAAI,GAAGzL,MAAM,CAAC,CAAC;oBACrB,MAAM4J,QAAQ,CAAC8B,WAAW,CAACzL,IAAI,CAACG,IAAI,CAAC,YAAY,EAAEqL,IAAI,GAAG,OAAO,CAAC,CAAC;oBACnElJ,GAAG,CAACsJ,QAAQ,CAAC5L,IAAI,CAACG,IAAI,CAAC,YAAY,EAAEqL,IAAI,GAAG,OAAO,CAAC,CAAC;oBACrD;oBACA5K,oBAAoB,CAACZ,IAAI,CAACG,IAAI,CAAC,YAAY,EAAEqL,IAAI,GAAG,OAAO,CAAC,CAAC;kBACjE;gBACJ;cACJ,CAAC,CAAC,OAAOpG,GAAG,EAAE;gBACVC,OAAO,CAACC,GAAG,CAAC,oCAAoC,EAAEF,GAAG,CAAC;gBACtD,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;cAC9B;YACJ;UACJ,CAAC,MAAM;YACH,OAAOb,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;UAC9B;QACJ,CAAC,MAAM;UACH,OAAOb,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;QAC9B;MACJ,CAAC,MAAM;QACH,MAAM2I,WAAW,GAAGnK,GAAG,CAACa,IAAI;QAC5B,IAAIsI,EAAE,GAAG,MAAM9J,cAAc,CAAC,CAAC;QAC/B,IAAI6F,KAAK,GAAG,MAAMmC,aAAa,CAC1B,GAAE8C,WAAW,CAAC,IAAI,CAAE,IAAGA,WAAW,CAAC,KAAK,CAAE,IAAGA,WAAW,CAAC,MAAM,CAAC,CAACf,QAAQ,CAAC,CAAE,EACjF,CAAC;QACD,IAAIxG,KAAK;QAETA,KAAK,GAAG;UACJ,CAAC,EAAE,IAAI;UACP,CAAC,EAAEuH,WAAW,CAAC,UAAU,CAAC;UAC1B,CAAC,EAAEA,WAAW,CAAC,MAAM,CAAC;UACtB,EAAE,EAAEA,WAAW,CAAC,UAAU;QAC9B,CAAC;QAED,IAAId,cAAc,GAAG;UACjBlI,GAAG,EAAEgJ,WAAW,CAAC,MAAM,CAAC,CAACf,QAAQ,CAAC,CAAC;UACnCvD,UAAU,EAAEsE,WAAW,CAAC,KAAK,CAAC;UAC9BvE,SAAS,EAAEuE,WAAW,CAAC,IAAI,CAAC;UAC5BtF,GAAG,EAAE,0FAA0F;UAC/FjC,KAAK,EAAEA,KAAK;UACZtB,KAAK,EAAE,CAAC6I,WAAW,CAAC,KAAK,CAAC,CAAC;UAC3BvF,WAAW,EAAG,GAAEuF,WAAW,CAAC,IAAI,CAAE,IAAGA,WAAW,CAAC,KAAK,CAAE,EAAC;UACzDjF,KAAK,EAAEA,KAAK;UACZoE,WAAW,EAAE,CAAC;QAClB,CAAC;QACD,IAAIC,eAAe,GAAG;UAClBpI,GAAG,EAAEgJ,WAAW,CAAC,MAAM,CAAC,CAACf,QAAQ,CAAC,CAAC;UACnC3H,QAAQ,EAAE1C,YAAY,CAACoK,EAAE,CAAC;UAC1B9F,KAAK,EAAE;QACX,CAAC;QACD7C,MAAM,CAACQ,EAAE,CAAC,QAAQ,CAAC,CAACC,UAAU,CAAC,WAAW,CAAC,CAACuB,SAAS,CACjD;UACIrB,GAAG,EAAEkI,cAAc,CAAClI;QACxB,CAAC,EACD;UACIwD,IAAI,EAAE0E;QACV,CAAC,EACD;UACIjG,MAAM,EAAE;QACZ,CACJ,CAAC;QACD5C,MAAM,CAACQ,EAAE,CAAC,QAAQ,CAAC,CAACC,UAAU,CAAC,YAAY,CAAC,CAACuB,SAAS,CAClD;UACIrB,GAAG,EAAEoI,eAAe,CAACpI;QACzB,CAAC,EACD;UACIwD,IAAI,EAAE4E;QACV,CAAC,EACD;UACInG,MAAM,EAAE;QACZ,CACJ,CAAC;QACD,MAAMlE,IAAI,CACN,YAAY,EACZ4B,IAAI,EACJuI,cAAc,CAAClI,GAAG,EAClB0F,UAAU,EACV;UAAEhB,UAAU,EAAEwD,cAAc,CAACxD,UAAU;UAAED,SAAS,EAAEyD,cAAc,CAACzD;QAAU,CAAC,EAC9EyD,cAAc,CAAC/H,KAAK,CAAC,CAAC,CAC1B,CAAC;QACD;QACA,MAAMuI,IAAI,GAAGzL,MAAM,CAAC,CAAC;QACrB,MAAM4J,QAAQ,GAAG,MAAM9J,YAAY,CAAC+J,aAAa,CAAC,gDAAgD,CAAC;QACnG,MAAMC,KAAK,GAAGF,QAAQ,CAACE,KAAK,CAAC,CAAC,CAAC;QAC/B,MAAMA,KAAK,CAACW,IAAI,CAAE,IAAG,CAAC,CAACR,KAAK,CAAC8B,WAAW,CAAC,MAAM,CAAC,CAACf,QAAQ,CAAC,CAAC,CAAC;QAC5D,MAAMlB,KAAK,CAACW,IAAI,CAAE,IAAG,CAAC,CAACR,KAAK,CAAC8B,WAAW,CAAC,IAAI,CAAC,CAAC;QAC/C,MAAMjC,KAAK,CAACW,IAAI,CAAE,IAAG,CAAC,CAACR,KAAK,CAAC8B,WAAW,CAAC,KAAK,CAAC,CAAC;QAChD,MAAMjC,KAAK,CAACW,IAAI,CAAE,IAAG,CAAC,CAACR,KAAK,CAAC,OAAO,CAAC;QACrC,MAAMH,KAAK,CAACW,IAAI,CAAE,IAAG,CAAC,CAACR,KAAK,CAAC,UAAU,CAAC;QACxC,MAAMH,KAAK,CAACW,IAAI,CAAE,IAAG,CAAC,CAACR,KAAK,CAACnD,KAAK,CAAC;QACnC,MAAMgD,KAAK,CAACW,IAAI,CAAE,IAAG,CAAC,CAACR,KAAK,CAACc,EAAE,CAAC;QAChC,IAAIM,KAAK,GAAGvB,KAAK,CAACuB,KAAK,CAAE,OAAM,CAAC;QAChCA,KAAK,CAACC,KAAK,CAAC;UAAEC,MAAM,EAAE;QAAK,CAAC,CAAC;QAC7BzB,KAAK,CAACU,MAAM,CAAC,GAAG,CAAC,CAACgB,KAAK,CAAC1E,KAAK,CAAC3C,MAAM,CAAC;QACrC,MAAMyF,QAAQ,CAAC8B,WAAW,CAACzL,IAAI,CAACG,IAAI,CAAC,YAAY,EAAEqL,IAAI,GAAG,OAAO,CAAC,CAAC;QACnElJ,GAAG,CAACsJ,QAAQ,CAAC5L,IAAI,CAACG,IAAI,CAAC,YAAY,EAAEqL,IAAI,GAAG,OAAO,CAAC,CAAC;QACrD;QACA5K,oBAAoB,CAACZ,IAAI,CAACG,IAAI,CAAC,YAAY,EAAEqL,IAAI,GAAG,OAAO,CAAC,CAAC;;QAE7D;MACJ;IACJ,CAAC,MAAM;MACH,OAAOlJ,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;;EAEF;EACAxD,MAAM,CAAC0C,IAAI,CAAC,gBAAgB,EAAEpB,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IACnE,MAAMG,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;IAC7B,IAAIA,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,IAAIjC,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,EAAE;MAC5B,MAAMoH,WAAW,GAAGnK,GAAG,CAACa,IAAI;MAC5B,IAAI+B,KAAK,GAAG;QACR,CAAC,EAAE,IAAI;QACP,CAAC,EAAEuH,WAAW,CAAC,UAAU,CAAC;QAC1B,CAAC,EAAEA,WAAW,CAAC,MAAM,CAAC;QACtB,EAAE,EAAEA,WAAW,CAAC,UAAU;MAC9B,CAAC;MAED,IAAId,cAAc,GAAG;QACjBlI,GAAG,EAAEgJ,WAAW,CAAC,MAAM,CAAC,CAACf,QAAQ,CAAC,CAAC;QACnCvD,UAAU,EAAEsE,WAAW,CAAC,KAAK,CAAC;QAC9BvE,SAAS,EAAEuE,WAAW,CAAC,IAAI,CAAC;QAC5BvH,KAAK,EAAEA,KAAK;QACZgC,WAAW,EAAG,GAAEuF,WAAW,CAAC,IAAI,CAAE,IAAGA,WAAW,CAAC,KAAK,CAAE;MAC5D,CAAC;MAED3J,MAAM,CAACQ,EAAE,CAAC,QAAQ,CAAC,CAACC,UAAU,CAAC,WAAW,CAAC,CAACuB,SAAS,CACjD;QACIrB,GAAG,EAAEkI,cAAc,CAAClI;MACxB,CAAC,EACD;QACIwD,IAAI,EAAE0E;MACV,CAAC,EACD;QACIjG,MAAM,EAAE;MACZ,CACJ,CAAC;MAED,OAAOzC,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B,CAAC,MAAM;MACH,OAAOb,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;EAEFxD,MAAM,CAAC4F,GAAG,CAAC,wBAAwB,EAAEvD,MAAM,CAACuG,MAAM,CAAC,MAAM,CAAC,EAAEtH,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IACjG,MAAMG,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;IAC7B,IAAIA,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,IAAIjC,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,EAAE;MAC5B,OAAOpC,GAAG,CAACsJ,QAAQ,CAAC,gDAAgD,CAAC;IACzE,CAAC,MAAM;MACH,OAAOtJ,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;EAEFxD,MAAM,CAAC0C,IAAI,CAAC,gBAAgB,EAAEpB,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IACnE,MAAMG,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;IAC7B,IAAIA,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,IAAIjC,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,EAAE;MAC5B,IAAI;QACA,MAAML,GAAG,GAAG1C,GAAG,CAACa,IAAI,CAAC6B,GAAG;QACxB,MAAM0H,UAAU,GAAGpK,GAAG,CAACa,IAAI,CAACwJ,UAAU;QACtC,KAAK,IAAIlE,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGiE,UAAU,CAAC7H,MAAM,EAAE4D,CAAC,EAAE,EAAE;UACxC,MAAM3F,MAAM,CAACQ,EAAE,CAAC,QAAQ,CAAC,CAACC,UAAU,CAAC,WAAW,CAAC,CAACM,SAAS,CAAC;YAAEJ,GAAG,EAAEiJ,UAAU,CAACjE,CAAC;UAAE,CAAC,CAAC;UACnF,IAAImE,WAAW,GAAI,gBAAeF,UAAU,CAACjE,CAAC,CAAE,EAAC;UACjD,MAAM3F,MAAM,CACPQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CACZ5B,UAAU,CAAE,GAAEyB,GAAI,aAAY,CAAC,CAC/B6H,UAAU,CACP;YACI,CAACD,WAAW,GAAG;cAAEE,OAAO,EAAE;YAAK;UACnC,CAAC,EACD;YACI/H,KAAK,EAAE;cAAEgI,YAAY,EAAE3J,IAAI,CAACK,GAAG;cAAEuJ,EAAE,EAAE5J,IAAI,CAACK;YAAI;UAClD,CACJ,CAAC;UAEL,MAAMX,MAAM,CACPQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CACZ5B,UAAU,CAAC,YAAY,CAAC,CACxBsJ,UAAU,CACP;YACI,CAACD,WAAW,GAAG;cAAEE,OAAO,EAAE;YAAK;UACnC,CAAC,EACD;YACI/H,KAAK,EAAE;cAAEgI,YAAY,EAAE3J,IAAI,CAACK,GAAG;cAAEuJ,EAAE,EAAE5J,IAAI,CAACK;YAAI;UAClD,CACJ,CAAC;UAEL,MAAMX,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,YAAY,CAAC,CACxBsJ,UAAU,CACP;YACI,CAACD,WAAW,GAAG;cAAEE,OAAO,EAAE;YAAK;UACnC,CAAC,EACD;YACI/H,KAAK,EAAE;cAAEgI,YAAY,EAAE3J,IAAI,CAACK,GAAG;cAAEuJ,EAAE,EAAE5J,IAAI,CAACK;YAAI;UAClD,CACJ,CAAC;QACT;QACA,OAAOR,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;MAC9B,CAAC,CAAC,OAAOiC,GAAG,EAAE;QACVC,OAAO,CAACC,GAAG,CAAC,oCAAoC,EAAEF,GAAG,CAAC;QACtD,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;MAC9B;IACJ,CAAC,MAAM;MACH,OAAOb,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;EACF;EACAxD,MAAM,CAAC4F,GAAG,CAAC,mBAAmB,EAAEtE,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IACrE,IAAI;MACA,MAAMG,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;MAC7B,IAAIA,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,IAAIjC,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,EAAE;QAC5B,MAAMnC,IAAI,GAAGZ,GAAG,CAAC2K,KAAK;QACtB;QACA,MAAMC,WAAW,GAAGhK,IAAI,CAACiK,IAAI;QAC7B,IAAInI,GAAG,GAAG9B,IAAI,CAAC8B,GAAG;QAClB;QACA,MAAMmH,IAAI,GAAGzL,MAAM,CAAC,CAAC;;QAErB;;QAEA,IAAIqM,YAAY,GAAG,EAAE;QACrB,IAAI3J,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,EAAE;UACb0H,YAAY,GAAGzL,eAAe,CAC1B,MAAMwB,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,WAAW,CAAC,CACvBY,IAAI,CACD;YAAEP,KAAK,EAAER,IAAI,CAAC4B,GAAG,CAAC,CAAC,CAAC;YAAE,SAAS,EAAE;cAAE8H,OAAO,EAAE;YAAK;UAAE,CAAC,EACpD;YAAE7H,UAAU,EAAE;cAAEkD,UAAU,EAAE,CAAC;cAAED,SAAS,EAAE;YAAE;UAAE,CAClD,CAAC,CACA7D,OAAO,CAAC,CACjB,CAAC;QACL,CAAC,MAAM;UACH0I,YAAY,GAAGzL,eAAe,CAC1B,MAAMwB,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,WAAW,CAAC,CACvBY,IAAI,CACD;YAAEP,KAAK,EAAEoB,GAAG;YAAE,SAAS,EAAE;cAAE8H,OAAO,EAAE;YAAK;UAAE,CAAC,EAC5C;YAAE7H,UAAU,EAAE;cAAEkD,UAAU,EAAE,CAAC;cAAED,SAAS,EAAE;YAAE;UAAE,CAClD,CAAC,CACA7D,OAAO,CAAC,CACjB,CAAC;QACL;;QAEA;QACA,IAAI+I,MAAM,GAAG,EAAE;QAEf,IAAIL,YAAY,CAAClI,MAAM,KAAK,CAAC,EAAE;UAC3B,KAAK,IAAI4D,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGsE,YAAY,CAAClI,MAAM,EAAE4D,CAAC,EAAE,EAAE;YAC1C;YACA;YACA;YACA;YACA;YACA;YACA;YACA,IAAI4E,UAAU,GAAG,CACb5E,CAAC,GAAG,CAAC,EACLsE,YAAY,CAACtE,CAAC,CAAC,CAAChF,GAAG,EACnBsJ,YAAY,CAACtE,CAAC,CAAC,CAACP,SAAS,EACzB6E,YAAY,CAACtE,CAAC,CAAC,CAACN,UAAU,EAC1BnD,GAAG,CACN;YAED,MAAMsI,sBAAsB,GAAG,MAAMxK,MAAM,CACtCQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CACZ5B,UAAU,CAACyB,GAAG,GAAG,YAAY,CAAC,CAC9BxB,OAAO,CACJ;cACIE,IAAI,EAAEqJ,YAAY,CAACtE,CAAC,CAAC,CAAChF,GAAG;cACzByJ,WAAW,EAAEA;YACjB,CAAC,EACD;cACIjI,UAAU,EAAE;gBACRU,KAAK,EAAE,CAAC;gBACRyD,MAAM,EAAE,CAAC;gBACTC,KAAK,EAAE,CAAC;gBACRC,MAAM,EAAE,CAAC;gBACTC,KAAK,EAAE,CAAC;gBACRE,KAAK,EAAE;cACX;YACJ,CACJ,CAAC;YAEL,IAAI6D,sBAAsB,EAAE;cACxBD,UAAU,CAACxE,IAAI,CAAC,GAAGyE,sBAAsB,CAAC3H,KAAK,CAAC;cAChD0H,UAAU,CAACxE,IAAI,CAAC,GAAGyE,sBAAsB,CAAClE,MAAM,CAAC;cACjDiE,UAAU,CAACxE,IAAI,CAAC,GAAGyE,sBAAsB,CAACjE,KAAK,CAAC;cAChDgE,UAAU,CAACxE,IAAI,CAAC,GAAGyE,sBAAsB,CAAChE,MAAM,CAAC;cACjD+D,UAAU,CAACxE,IAAI,CAAC,GAAGyE,sBAAsB,CAAC/D,KAAK,CAAC;YACpD,CAAC,MAAM;cACH,KAAK,IAAIgE,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,EAAE,EAAEA,CAAC,EAAE,EAAE;gBACzBF,UAAU,CAACxE,IAAI,CAAC,IAAI,CAAC;cACzB;YACJ;YAEAwE,UAAU,CAACxE,IAAI,CAAC,IAAI,CAAC;YAErB,IAAIyE,sBAAsB,EAAE;cACxBD,UAAU,CAACxE,IAAI,CAACyE,sBAAsB,CAAC7D,KAAK,CAAC;cAC7C;cACA,IAAI6D,sBAAsB,CAAC7D,KAAK,IAAI,EAAE,EAAE;gBACpC4D,UAAU,CAACxE,IAAI,CAAC,UAAU,CAAC;cAC/B,CAAC,MAAM,IAAIyE,sBAAsB,CAAC7D,KAAK,IAAI,EAAE,EAAE;gBAC3C4D,UAAU,CAACxE,IAAI,CAAC,KAAK,CAAC;cAC1B,CAAC,MAAM,IAAIyE,sBAAsB,CAAC7D,KAAK,IAAI,EAAE,EAAE;gBAC3C4D,UAAU,CAACxE,IAAI,CAAC,KAAK,CAAC;cAC1B,CAAC,MAAM,IAAIyE,sBAAsB,CAAC7D,KAAK,IAAI,EAAE,EAAE;gBAC3C4D,UAAU,CAACxE,IAAI,CAAC,YAAY,CAAC;cACjC,CAAC,MAAM,IAAIyE,sBAAsB,CAAC7D,KAAK,IAAI,EAAE,EAAE;gBAC3C4D,UAAU,CAACxE,IAAI,CAAC,KAAK,CAAC;cAC1B,CAAC,MAAM;gBACHwE,UAAU,CAACxE,IAAI,CAAC,KAAK,CAAC;cAC1B;YACJ,CAAC,MAAM;cACHwE,UAAU,CAACxE,IAAI,CAAC,IAAI,CAAC;cACrBwE,UAAU,CAACxE,IAAI,CAAC,IAAI,CAAC;YACzB;;YAEA;YACAuE,MAAM,CAACvE,IAAI,CAACwE,UAAU,CAAC;UAC3B;QACJ,CAAC,MAAM,CACP;;QAEA;QACA,MAAM/C,QAAQ,GAAG,MAAM9J,YAAY,CAAC+J,aAAa,CAC7C,4DACJ,CAAC;QAED,IAAI6C,MAAM,CAACvI,MAAM,IAAI,CAAC,EAAE;UACpB,MAAMyF,QAAQ,CAACE,KAAK,CAAC,CAAC,CAAC,CAACW,IAAI,CAAC,IAAI,CAAC,CAACR,KAAK,CAACyC,MAAM,CAAC;QACpD;QACA;;QAEA,MAAM9C,QAAQ,CAAC8B,WAAW,CAACzL,IAAI,CAACG,IAAI,CAAC,YAAY,EAAEqL,IAAI,GAAG,OAAO,CAAC,CAAC;;QAEnE;QACA;;QAEAlJ,GAAG,CAACsJ,QAAQ,CAAC5L,IAAI,CAACG,IAAI,CAAC,YAAY,EAAEqL,IAAI,GAAG,OAAO,CAAC,CAAC;;QAErD;QACA5K,oBAAoB,CAACZ,IAAI,CAACG,IAAI,CAAC,YAAY,EAAEqL,IAAI,GAAG,OAAO,CAAC,CAAC;MACjE,CAAC,MAAM;QACH,OAAOlJ,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;MAC9B;IACJ,CAAC,CAAC,OAAOiC,GAAG,EAAE;MACVC,OAAO,CAACC,GAAG,CAAC,wCAAwC,EAAEF,GAAG,CAAC;MAC1D,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;EACF;EACAxD,MAAM,CAAC4F,GAAG,CAAC,sBAAsB,EAAEtE,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IACxE,IAAI;MACA,MAAMG,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;MAC7B,MAAMF,IAAI,GAAGZ,GAAG,CAAC2K,KAAK;MACtB,IAAIjI,GAAG,GAAG9B,IAAI,CAAC8B,GAAG;MAClB,IAAIwI,OAAO,GAAG,EAAE;MAChB,IAAItK,IAAI,CAACsK,OAAO,EAAE;QACdA,OAAO,GAAGxE,IAAI,CAACyE,KAAK,CAACvK,IAAI,CAACsK,OAAO,CAAC;MACtC;MACA,MAAMN,WAAW,GAAGhK,IAAI,CAACiK,IAAI;MAE7B,IAAI/J,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,IAAIjC,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,IAAIjC,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,EAAE;QAC3C,IAAKnC,IAAI,CAACwK,IAAI,KAAK,OAAO,GAAItK,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,EAAE;UACvCL,GAAG,GAAG5B,IAAI,CAAC4B,GAAG,CAAC,CAAC,CAAC;UACjBwI,OAAO,GAAG,CAACpK,IAAI,CAACK,GAAG,CAAC;QACxB;QACA;QACA;QACA,MAAM0I,IAAI,GAAGzL,MAAM,CAAC,CAAC;QACrB;QACA,IAAIqM,YAAY,GAAG,EAAE;QAErBA,YAAY,GAAGzL,eAAe,CAC1B,MAAMwB,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,WAAW,CAAC,CACvBY,IAAI,CACD;UACIP,KAAK,EAAEoB,GAAG;UACV,SAAS,EAAE;YAAE8H,OAAO,EAAE;UAAK,CAAC;UAC5BrJ,GAAG,EAAE;YAAEW,GAAG,EAAEoJ;UAAQ;QACxB,CAAC,EACD;UAAEvI,UAAU,EAAE;YAAEkD,UAAU,EAAE,CAAC;YAAED,SAAS,EAAE;UAAE;QAAE,CAClD,CAAC,CACA7D,OAAO,CAAC,CACjB,CAAC;QACD;QACA,IAAI+I,MAAM,GAAG,EAAE;QAEf,IAAIL,YAAY,CAAClI,MAAM,KAAK,CAAC,EAAE;UAC3B,KAAK,IAAI4D,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGsE,YAAY,CAAClI,MAAM,EAAE4D,CAAC,EAAE,EAAE;YAC1C;YACA;YACA;YACA;YACA;YACA;YACA;YACA,IAAI4E,UAAU,GAAG;cACbF,IAAI,EAAED,WAAW;cACjBxJ,IAAI,EAAEqJ,YAAY,CAACtE,CAAC,CAAC,CAAChF,GAAG;cACzBkK,IAAI,EAAEZ,YAAY,CAACtE,CAAC,CAAC,CAACP,SAAS,GAAG,GAAG,GAAG6E,YAAY,CAACtE,CAAC,CAAC,CAACN,UAAU;cAClEvE,KAAK,EAAEoB,GAAG;cACV4I,GAAG,EAAE,EAAE;cACPC,GAAG,EAAE,EAAE;cACP1I,GAAG,EAAE;YACT,CAAC;YAED,MAAM2I,mBAAmB,GAAG,MAAMhL,MAAM,CACnCQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CACZ5B,UAAU,CAACyB,GAAG,GAAG,YAAY,CAAC,CAC9BxB,OAAO,CACJ;cACIE,IAAI,EAAEqJ,YAAY,CAACtE,CAAC,CAAC,CAAChF,GAAG;cACzByJ,WAAW,EAAEA;YACjB,CAAC,EACD;cACIjI,UAAU,EAAE;gBACRU,KAAK,EAAE,CAAC;gBACRyD,MAAM,EAAE,CAAC;gBACTC,KAAK,EAAE,CAAC;gBACRC,MAAM,EAAE,CAAC;gBACTC,KAAK,EAAE,CAAC;gBACRE,KAAK,EAAE;cACX;YACJ,CACJ,CAAC;YAEL,MAAMsE,gBAAgB,GAAG,MAAMjL,MAAM,CAChCQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CACZ5B,UAAU,CAACyB,GAAG,GAAG,YAAY,CAAC,CAC9BxB,OAAO,CACJ;cACIE,IAAI,EAAEqJ,YAAY,CAACtE,CAAC,CAAC,CAAChF,GAAG;cACzByJ,WAAW,EAAEA;YACjB,CAAC,EACD;cACIjI,UAAU,EAAE;gBACRU,KAAK,EAAE,CAAC;gBACRyD,MAAM,EAAE,CAAC;gBACTC,KAAK,EAAE,CAAC;gBACRC,MAAM,EAAE,CAAC;gBACTC,KAAK,EAAE,CAAC;gBACRE,KAAK,EAAE;cACX;YACJ,CACJ,CAAC;YAEL,MAAM6D,sBAAsB,GAAG,MAAMxK,MAAM,CACtCQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CACZ5B,UAAU,CAACyB,GAAG,GAAG,YAAY,CAAC,CAC9BxB,OAAO,CACJ;cACIE,IAAI,EAAEqJ,YAAY,CAACtE,CAAC,CAAC,CAAChF,GAAG;cACzByJ,WAAW,EAAEA;YACjB,CAAC,EACD;cACIjI,UAAU,EAAE;gBACRU,KAAK,EAAE,CAAC;gBACRyD,MAAM,EAAE,CAAC;gBACTC,KAAK,EAAE,CAAC;gBACRC,MAAM,EAAE,CAAC;gBACTC,KAAK,EAAE,CAAC;gBACRE,KAAK,EAAE;cACX;YACJ,CACJ,CAAC;YAEL,IAAIqE,mBAAmB,EAAE;cACrBT,UAAU,CAACO,GAAG,CAAC/E,IAAI,CAAC,GAAGiF,mBAAmB,CAACnI,KAAK,CAAC;cACjD0H,UAAU,CAACO,GAAG,CAAC/E,IAAI,CAAC,GAAGiF,mBAAmB,CAAC1E,MAAM,CAAC;cAClDiE,UAAU,CAACO,GAAG,CAAC/E,IAAI,CAAC,GAAGiF,mBAAmB,CAACzE,KAAK,CAAC;cACjDgE,UAAU,CAACO,GAAG,CAAC/E,IAAI,CAAC,GAAGiF,mBAAmB,CAACxE,MAAM,CAAC;cAClD+D,UAAU,CAACO,GAAG,CAAC/E,IAAI,CAAC,GAAGiF,mBAAmB,CAACvE,KAAK,CAAC;cACjD8D,UAAU,CAACO,GAAG,CAAC/E,IAAI,CAACiF,mBAAmB,CAACrE,KAAK,CAAC;YAClD,CAAC,MAAM;cACH,KAAK,IAAI8D,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,EAAE,EAAEA,CAAC,EAAE,EAAE;gBACzBF,UAAU,CAACO,GAAG,CAAC/E,IAAI,CAAC,KAAK,CAAC;cAC9B;YACJ;YACA,IAAIkF,gBAAgB,EAAE;cAClBV,UAAU,CAACQ,GAAG,CAAChF,IAAI,CAAC,GAAGkF,gBAAgB,CAACpI,KAAK,CAAC;cAC9C0H,UAAU,CAACQ,GAAG,CAAChF,IAAI,CAAC,GAAGkF,gBAAgB,CAAC3E,MAAM,CAAC;cAC/CiE,UAAU,CAACQ,GAAG,CAAChF,IAAI,CAAC,GAAGkF,gBAAgB,CAAC1E,KAAK,CAAC;cAC9CgE,UAAU,CAACQ,GAAG,CAAChF,IAAI,CAAC,GAAGkF,gBAAgB,CAACzE,MAAM,CAAC;cAC/C+D,UAAU,CAACQ,GAAG,CAAChF,IAAI,CAAC,GAAGkF,gBAAgB,CAACxE,KAAK,CAAC;cAC9C8D,UAAU,CAACQ,GAAG,CAAChF,IAAI,CAACkF,gBAAgB,CAACtE,KAAK,CAAC;YAC/C,CAAC,MAAM;cACH,KAAK,IAAI8D,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,EAAE,EAAEA,CAAC,EAAE,EAAE;gBACzBF,UAAU,CAACQ,GAAG,CAAChF,IAAI,CAAC,KAAK,CAAC;cAC9B;YACJ;YAEA,IAAIyE,sBAAsB,EAAE;cACxBD,UAAU,CAAClI,GAAG,CAAC0D,IAAI,CAAC,GAAGyE,sBAAsB,CAAC3H,KAAK,CAAC;cACpD0H,UAAU,CAAClI,GAAG,CAAC0D,IAAI,CAAC,GAAGyE,sBAAsB,CAAClE,MAAM,CAAC;cACrDiE,UAAU,CAAClI,GAAG,CAAC0D,IAAI,CAAC,GAAGyE,sBAAsB,CAACjE,KAAK,CAAC;cACpDgE,UAAU,CAAClI,GAAG,CAAC0D,IAAI,CAAC,GAAGyE,sBAAsB,CAAChE,MAAM,CAAC;cACrD+D,UAAU,CAAClI,GAAG,CAAC0D,IAAI,CAAC,GAAGyE,sBAAsB,CAAC/D,KAAK,CAAC;cACpD8D,UAAU,CAAClI,GAAG,CAAC0D,IAAI,CAACyE,sBAAsB,CAAC7D,KAAK,CAAC;YACrD,CAAC,MAAM;cACH,KAAK,IAAI8D,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,EAAE,EAAEA,CAAC,EAAE,EAAE;gBACzBF,UAAU,CAAClI,GAAG,CAAC0D,IAAI,CAAC,KAAK,CAAC;cAC9B;YACJ;YAEAuE,MAAM,CAACvE,IAAI,CAACwE,UAAU,CAAC;UAC3B;QACJ,CAAC,MAAM;UACH,OAAOpK,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;QAC9B;QAEA,MAAMkK,aAAa,GAAG,MAAMhM,SAAS,CAAC,YAAY,EAAEoL,MAAM,CAAC;QAC3D;QACAnK,GAAG,CAACsJ,QAAQ,CAAC5L,IAAI,CAACG,IAAI,CAAC,YAAY,EAAEkN,aAAa,CAAC,CAAC;;QAEpD;;QAEAzM,oBAAoB,CAACZ,IAAI,CAACG,IAAI,CAAC,YAAY,EAAEkN,aAAa,CAAC,CAAC;MAChE,CAAC,MAAM;QACH,OAAO/K,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;MAC9B;IACJ,CAAC,CAAC,OAAOiC,GAAG,EAAE;MACVC,OAAO,CAACC,GAAG,CAAC,2CAA2C,EAAEF,GAAG,CAAC;MAC7D,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;EACF;EACAxD,MAAM,CAAC4F,GAAG,CAAC,iBAAiB,EAAEtE,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IACnE,IAAI;MACA,MAAMG,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;MAC7B,IAAIA,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,EAAE;QACb,MAAMnC,IAAI,GAAGZ,GAAG,CAAC2K,KAAK;QACtB;QACA,MAAMC,WAAW,GAAGhK,IAAI,CAACiK,IAAI;QAC7B,MAAMc,cAAc,GAAG,MAAMnL,MAAM,CAC9BQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,aAAa,CAAC,CACzBC,OAAO,CACJ,CAAC,CAAC,EACF;UACIyB,UAAU,EAAE;YACRxB,GAAG,EAAE,CAAC;YACN0J,IAAI,EAAE,CAAC;YACPe,SAAS,EAAE,CAAC;YACZC,OAAO,EAAE;UACb;QACJ,CACJ,CAAC;QAEL,MAAMpB,YAAY,GAAGzL,eAAe,CAChC,MAAMwB,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,WAAW,CAAC,CACvBY,IAAI,CACD;UAAEP,KAAK,EAAER,IAAI,CAAC4B,GAAG,CAAC,CAAC,CAAC;UAAE,SAAS,EAAE;YAAE8H,OAAO,EAAE;UAAK;QAAE,CAAC,EACpD;UACI7H,UAAU,EAAE;YACRkD,UAAU,EAAE,CAAC;YACbD,SAAS,EAAE,CAAC;YACZ0D,WAAW,EAAE;UACjB;QACJ,CACJ,CAAC,CACAvH,OAAO,CAAC,CACjB,CAAC;;QAED;QACA,IAAIkC,MAAM,GAAG;UACT;UACAwG,YAAY,EAAEA,YAAY;UAC1B;UACA;UACA;UACAkB,cAAc,EAAEA;QACpB,CAAC;QAED,OAAOhL,GAAG,CAAC2C,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAACU,MAAM,CAAC;MACvC,CAAC,MAAM;QACH;QACA;QACA,OAAOtD,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;MAC9B;IACJ,CAAC,CAAC,OAAOiC,GAAG,EAAE;MACVC,OAAO,CAACC,GAAG,CAAC,qCAAqC,EAAEF,GAAG,CAAC;MACvD,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;EACF;EACAxD,MAAM,CAAC4F,GAAG,CAAC,2BAA2B,EAAEtE,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IAC7E,IAAI;MACA,MAAMG,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;MAC7B,IAAIA,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,EAAE;QACb,MAAMnC,IAAI,GAAGZ,GAAG,CAAC2K,KAAK;QACtB;QACA,MAAMC,WAAW,GAAGhK,IAAI,CAACiK,IAAI;QAC7B,IAAInI,GAAG,GAAG9B,IAAI,CAACU,KAAK;QACpB;QACA;QACA,IAAI,CAACoB,GAAG,EAAE;UACNA,GAAG,GAAG,CAAC;QACX;QAEA,MAAMiJ,cAAc,GAAG,MAAMnL,MAAM,CAC9BQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,aAAa,CAAC,CACzBC,OAAO,CACJ,CAAC,CAAC,EACF;UACIyB,UAAU,EAAE;YACRxB,GAAG,EAAE,CAAC;YACN0J,IAAI,EAAE,CAAC;YACPe,SAAS,EAAE,CAAC;YACZC,OAAO,EAAE;UACb;QACJ,CACJ,CAAC;QAEL,MAAMpB,YAAY,GAAGzL,eAAe,CAChC,MAAMwB,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,WAAW,CAAC,CACvBY,IAAI,CACD;UAAEP,KAAK,EAAEoB,GAAG;UAAE,SAAS,EAAE;YAAE8H,OAAO,EAAE;UAAK;QAAE,CAAC,EAC5C;UACI7H,UAAU,EAAE;YACRkD,UAAU,EAAE,CAAC;YACbD,SAAS,EAAE,CAAC;YACZ0D,WAAW,EAAE;UACjB;QACJ,CACJ,CAAC,CACAvH,OAAO,CAAC,CACjB,CAAC;;QAED;QACA,IAAIkC,MAAM,GAAG;UACT;UACAwG,YAAY,EAAEA,YAAY;UAC1B;UACA;UACA;UACAkB,cAAc,EAAEA;QACpB,CAAC;QAED,OAAOhL,GAAG,CAAC2C,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAACU,MAAM,CAAC;MACvC,CAAC,MAAM;QACH;QACA;QACA,OAAOtD,GAAG,CAACmL,UAAU,CAAC,GAAG,CAAC;MAC9B;IACJ,CAAC,CAAC,OAAOrI,GAAG,EAAE;MACVC,OAAO,CAACC,GAAG,CAAC,+CAA+C,EAAEF,GAAG,CAAC;MACjE,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;EACF;EACAxD,MAAM,CAAC0C,IAAI,CAAC,WAAW,EAAEpB,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IAC9D,IAAI;MACA,MAAMG,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;MAC7B,IAAIA,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,EAAE;QACb,MAAMnC,IAAI,GAAGZ,GAAG,CAACa,IAAI;QACrB,IAAI6B,GAAG,GAAG9B,IAAI,CAAC8B,GAAG;QAClB;;QAEA;QACA,MAAMiD,MAAM,GAAG,MAAMnF,MAAM,CACtBQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,WAAW,CAAC,CACvBC,OAAO,CACJ;UAAEC,GAAG,EAAEL,IAAI,CAACK;QAAI,CAAC,EACjB;UACIwB,UAAU,EAAE;YACRxB,GAAG,EAAE,CAAC;YACNyE,SAAS,EAAE,CAAC;YACZC,UAAU,EAAE;UAChB;QACJ,CACJ,CAAC;QACL;QACA,IAAI,CAACnD,GAAG,EAAE;UACNA,GAAG,GAAG,CAAC;QACX;;QAEA;QACA;QACA,KAAK,IAAIyD,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGvF,IAAI,CAACmL,QAAQ,CAACxJ,MAAM,EAAE4D,CAAC,EAAE,EAAE;UAC3C,MAAM6F,SAAS,GAAG,MAAMxL,MAAM,CACzBQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CACZ5B,UAAU,CAACH,IAAI,CAAC4B,GAAG,CAACuJ,QAAQ,CAACvJ,GAAG,CAAC,CAAC,GAAG,YAAY,CAAC,CAClDxB,OAAO,CAAC;YACLE,IAAI,EAAER,IAAI,CAACmL,QAAQ,CAAC5F,CAAC,CAAC;YACtByE,WAAW,EAAEhK,IAAI,CAACiK;UACtB,CAAC,CAAC;;UAEN;UACA;UACA,IAAImB,SAAS,EAAE;YACXA,SAAS,CAACrG,MAAM,GAAGA,MAAM,CAACC,SAAS,GAAG,GAAG,GAAGD,MAAM,CAACE,UAAU;YAC7D,OAAOmG,SAAS,CAAC7K,GAAG;YACpB,MAAMX,MAAM,CACPQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CACZ5B,UAAU,CAACH,IAAI,CAAC4B,GAAG,CAACuJ,QAAQ,CAACvJ,GAAG,CAAC,CAAC,GAAG,YAAY,CAAC,CAClDF,SAAS,CACN;cACIpB,IAAI,EAAER,IAAI,CAACmL,QAAQ,CAAC5F,CAAC,CAAC;cACtByE,WAAW,EAAEhK,IAAI,CAACiK;YACtB,CAAC,EACD;cACIlG,IAAI,EAAEqH;YACV,CAAC,EACD;cAAE5I,MAAM,EAAE;YAAK,CACnB,CAAC;UACT;UAEA,MAAMjE,uBAAuB,CACzB,YAAY,EACZ6M,SAAS,CAACpB,WAAW,EACrBoB,SAAS,CAAC5K,IAAI,EACd4K,SAAS,CAAC7E,KAAK,EACf6E,SAAS,CAACrG,MACd,CAAC;QACL;QAEA,OAAOhF,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;MAC9B,CAAC,MAAM;QACH,OAAOb,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;MAC9B;IACJ,CAAC,CAAC,OAAOiC,GAAG,EAAE;MACVC,OAAO,CAACC,GAAG,CAAC,+BAA+B,EAAEF,GAAG,CAAC;MACjD,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;EAEFxD,MAAM,CAAC0C,IAAI,CAAC,qBAAqB,EAAEpB,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IACxE,IAAI;MACA,MAAMG,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;MAC7B,IAAIA,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,EAAE;QACb,MAAMnC,IAAI,GAAGZ,GAAG,CAACa,IAAI;QACrB,IAAI6B,GAAG,GAAG9B,IAAI,CAAC8B,GAAG;QAClB;;QAEA;QACA,MAAMiD,MAAM,GAAG,MAAMnF,MAAM,CACtBQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,WAAW,CAAC,CACvBC,OAAO,CACJ;UAAEC,GAAG,EAAEL,IAAI,CAACK;QAAI,CAAC,EACjB;UACIwB,UAAU,EAAE;YACRxB,GAAG,EAAE,CAAC;YACNyE,SAAS,EAAE,CAAC;YACZC,UAAU,EAAE;UAChB;QACJ,CACJ,CAAC;;QAEL;QACA;QACA,KAAK,IAAIM,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGvF,IAAI,CAACmL,QAAQ,CAACxJ,MAAM,EAAE4D,CAAC,EAAE,EAAE;UAC3C,MAAM6F,SAAS,GAAG,MAAMxL,MAAM,CACzBQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CACZ5B,UAAU,CAACyB,GAAG,GAAG,YAAY,CAAC,CAC9BxB,OAAO,CAAC;YACLE,IAAI,EAAER,IAAI,CAACmL,QAAQ,CAAC5F,CAAC,CAAC;YACtByE,WAAW,EAAEhK,IAAI,CAACiK;UACtB,CAAC,CAAC;;UAEN;UACA;UACA,IAAImB,SAAS,EAAE;YACXA,SAAS,CAACrG,MAAM,GAAGA,MAAM,CAACC,SAAS,GAAG,GAAG,GAAGD,MAAM,CAACE,UAAU;YAC7D,OAAOmG,SAAS,CAAC7K,GAAG;YACpB,MAAMX,MAAM,CACPQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CACZ5B,UAAU,CAACyB,GAAG,GAAG,YAAY,CAAC,CAC9BF,SAAS,CACN;cACIpB,IAAI,EAAER,IAAI,CAACmL,QAAQ,CAAC5F,CAAC,CAAC;cACtByE,WAAW,EAAEhK,IAAI,CAACiK;YACtB,CAAC,EACD;cACIlG,IAAI,EAAEqH;YACV,CAAC,EACD;cAAE5I,MAAM,EAAE;YAAK,CACnB,CAAC;UACT;UAEA,MAAMjE,uBAAuB,CACzB,YAAY,EACZ6M,SAAS,CAACpB,WAAW,EACrBoB,SAAS,CAAC5K,IAAI,EACd4K,SAAS,CAAC7E,KAAK,EACf6E,SAAS,CAACrG,MACd,CAAC;QACL;QAEA,OAAOhF,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;MAC9B,CAAC,MAAM;QACH,OAAOb,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;MAC9B;IACJ,CAAC,CAAC,OAAOiC,GAAG,EAAE;MACVC,OAAO,CAACC,GAAG,CAAC,+BAA+B,EAAEF,GAAG,CAAC;MACjD,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;;EAEF;EACAxD,MAAM,CAAC0C,IAAI,CAAC,iBAAiB,EAAEpB,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IACpE,MAAMG,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;IAE7B,MAAMF,IAAI,GAAGZ,GAAG,CAACa,IAAI,CAAC,CAAC;IACvB,IAAIqL,QAAQ,GAAGtL,IAAI,CAACU,KAAK;IACzB;IACA;IACA;IACA,IAAI4K,QAAQ,EAAE;MACV,IAAIpL,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,IAAIjC,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,EAAE;QAC5B,MAAM0H,YAAY,GAAGzL,eAAe,CAChC,MAAMwB,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,WAAW,CAAC,CACvBY,IAAI,CACD;UAAEP,KAAK,EAAE4K,QAAQ;UAAE,SAAS,EAAE;YAAE1B,OAAO,EAAE;UAAK;QAAE,CAAC,EACjD;UAAE7H,UAAU,EAAE;YAAEkD,UAAU,EAAE,CAAC;YAAED,SAAS,EAAE,CAAC;YAAEhD,KAAK,EAAE;UAAE;QAAE,CAC5D,CAAC,CACAuJ,KAAK,CAAC,EAAE,CAAC,CACTC,IAAI,CAAC,EAAE,GAAGxL,IAAI,CAACwL,IAAI,CAAC,CACpBrK,OAAO,CAAC,CACjB,CAAC;QACD,MAAMsK,eAAe,GAAG5B,YAAY,CAACxI,GAAG,CAAEqK,IAAI,IAAK;UAC/C,IAAIC,IAAI,GAAG,QAAQ,CAAC,CAAC;UACrB,IAAIC,SAAS,GAAG,KAAK;UACrB,IAAIC,SAAS,GAAG,KAAK;UACrB,IAAIC,aAAa,GAAG,KAAK;UACzBF,SAAS,GAAGF,IAAI,CAAC1J,KAAK,CAAC,IAAI,CAAC,GAAG,IAAI,GAAG,KAAK;UAC3C6J,SAAS,GAAGH,IAAI,CAAC1J,KAAK,CAAC,GAAG,CAAC,GAAG,IAAI,GAAG,KAAK;UAC1C8J,aAAa,GAAGJ,IAAI,CAAC1J,KAAK,CAAC,GAAG,CAAC,GAAG,IAAI,GAAG,KAAK;UAC9C,IAAI0J,IAAI,CAAC1J,KAAK,CAAC,GAAG,CAAC,IAAI0J,IAAI,CAAC1J,KAAK,CAAC,GAAG,CAAC,EAAE;YACpC2J,IAAI,GAAG,YAAY;UACvB,CAAC,MAAM,IAAID,IAAI,CAAC1J,KAAK,CAAC,GAAG,CAAC,EAAE;YACxB2J,IAAI,GAAG,WAAW;UACtB;UAEA,OAAO;YACHpL,GAAG,EAAEmL,IAAI,CAACnL,GAAG;YACb0E,UAAU,EAAEyG,IAAI,CAACzG,UAAU;YAC3BD,SAAS,EAAE0G,IAAI,CAAC1G,SAAS;YACzB2G,IAAI;YACJC,SAAS;YACTC,SAAS;YACTC;UACJ,CAAC;QACL,CAAC,CAAC;QACF,OAAO/L,GAAG,CAAC2C,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC8I,eAAe,CAAC;MAChD,CAAC,MAAM;QACH,OAAO1L,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;MAC9B;IACJ,CAAC,MAAM;MACH,OAAOb,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;EAEFxD,MAAM,CAAC4F,GAAG,CAAC,qBAAqB,EAAEtE,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IACvE,MAAMG,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;IAC7B,IAAImD,MAAM,GAAG;MACTuI,SAAS,EAAE1L,IAAI,CAACiC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,GAAG,KAAK;MACtC0J,SAAS,EAAE3L,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,GAAG,KAAK;MACrC2J,aAAa,EAAE5L,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,GAAG;IACxC,CAAC;IACD,OAAOpC,GAAG,CAAC2C,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAACU,MAAM,CAAC;EACvC,CAAC,CAAC;EAEFjG,MAAM,CAAC4F,GAAG,CAAC,eAAe,EAAEtE,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IACjE,IAAI;MACA,MAAMG,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;MAC7B,IAAIA,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,EAAE;QACb,MAAM4J,eAAe,GAAG3M,GAAG,CAAC2K,KAAK,CAACiC,UAAU;QAE5C,MAAMC,mBAAmB,GAAG,CAAC,MAAM,GAAGF,eAAe,EAAE,MAAM,GAAGA,eAAe,CAAC;QAChF,MAAMG,kBAAkB,GAAG,MAAMC,OAAO,CAACC,GAAG,CACxCH,mBAAmB,CAAC5K,GAAG,CAAC,MAAO4I,IAAI,IAAK;UACpC,MAAMoC,iBAAiB,GAAG,MAAMzM,MAAM,CACjCQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CACZ5B,UAAU,CAACH,IAAI,CAAC4B,GAAG,CAAC,CAAC,CAAC,GAAG,YAAY,CAAC,CACtCxB,OAAO,CACJ;YACIE,IAAI,EAAEN,IAAI,CAACK,GAAG;YACdyJ,WAAW,EAAEC;UACjB,CAAC,EACD;YACIlI,UAAU,EAAE;cAAExB,GAAG,EAAE,CAAC;cAAEgG,KAAK,EAAE;YAAE;UACnC,CACJ,CAAC;UACL,OAAO;YACH0D,IAAI,EAAEA,IAAI,CAAChD,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC;YACtBV,KAAK,EAAE8F,iBAAiB,GAAGA,iBAAiB,CAAC9F,KAAK,GAAG;UACzD,CAAC;QACL,CAAC,CACL,CAAC;QACD,OAAOxG,GAAG,CAAC2C,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAACuJ,kBAAkB,CAAC;MACnD,CAAC,MAAM;QACH,OAAOnM,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;MAC9B;IACJ,CAAC,CAAC,OAAOiC,GAAG,EAAE;MACVC,OAAO,CAACC,GAAG,CAAC,oCAAoC,EAAEF,GAAG,CAAC;MACtD,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;;EAEF;EACAxD,MAAM,CAAC0C,IAAI,CAAC,mBAAmB,EAAEpB,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IACtE,IAAI;MACA,MAAMG,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;MAC7B,MAAMF,IAAI,GAAGZ,GAAG,CAACa,IAAI,CAAC,CAAC;;MAEvB;MACA,IAAIC,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,EAAE;QACb;QACA,MAAMvC,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,SAAS,CAAC,CACrBM,SAAS,CAAC;UACPJ,GAAG,EAAE5B,QAAQ,CAACqB,IAAI,CAACsM,QAAQ;QAC/B,CAAC,CAAC;QACN;QACA,MAAM1M,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,SAAS,CAAC,CACrBkM,SAAS,CAAC;UACPhM,GAAG,EAAE5B,QAAQ,CAACqB,IAAI,CAACyK,IAAI,CAAC;UACxBA,IAAI,EAAEzK,IAAI,CAACyK,IAAI;UACfxI,GAAG,EAAE/B,IAAI,CAAC+B;QACd,CAAC,CAAC;MACV,CAAC,MAAM;QACH,OAAOlC,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC;MAChC;MAEA,OAAOb,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B,CAAC,CAAC,OAAOiC,GAAG,EAAE;MACVC,OAAO,CAACC,GAAG,CAAC,yCAAyC,EAAEF,GAAG,CAAC;MAC3D,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;;EAEF;EACAxD,MAAM,CAAC0C,IAAI,CAAC,gBAAgB,EAAEpB,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IACnE,IAAI;MACA,MAAMG,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;MAC7B,MAAMF,IAAI,GAAGZ,GAAG,CAACa,IAAI,CAAC,CAAC;;MAEvB;MACA,IAAIC,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,EAAE;QACb;QACA,KAAK,IAAIoD,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGvF,IAAI,CAACwM,KAAK,CAAC7K,MAAM,EAAE4D,CAAC,EAAE,EAAE;UACxC,MAAM3F,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,SAAS,CAAC,CACrBM,SAAS,CAAC;YACPJ,GAAG,EAAE5B,QAAQ,CAACqB,IAAI,CAACwM,KAAK,CAACjH,CAAC,CAAC;UAC/B,CAAC,CAAC;UACN,MAAMkH,WAAW,GAAG,MAAM7M,MAAM,CAC3BQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,SAAS,CAAC,CACrBY,IAAI,CAAC;YAAEiB,MAAM,EAAEvD,QAAQ,CAACqB,IAAI,CAACwM,KAAK,CAACjH,CAAC,CAAC;UAAE,CAAC,EAAE;YAAExD,UAAU,EAAE;cAAE2K,IAAI,EAAE;YAAE;UAAE,CAAC,CAAC,CACtEvL,OAAO,CAAC,CAAC;UACd,MAAMwL,WAAW,GAAGF,WAAW,CAACpL,GAAG,CAAES,GAAG,IAAKA,GAAG,CAACvB,GAAG,CAAC;UACrD,MAAMqM,YAAY,GAAGH,WAAW,CAACpL,GAAG,CAAES,GAAG,IAAKA,GAAG,CAAC4K,IAAI,CAAC;UACvD,MAAMG,WAAW,GAAG;YAAEC,MAAM,EAAEH,WAAW;YAAEI,KAAK,EAAEH;UAAa,CAAC;;UAEhE;UACA,MAAM/N,cAAc,CAACgO,WAAW,EAAE3M,IAAI,CAAC;UACvC,MAAMN,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,WAAW,CAAC,CACvBsJ,UAAU,CACP;YACIpJ,GAAG,EAAE;cAAEW,GAAG,EAAE0L;YAAa;UAC7B,CAAC,EACD;YACI7I,IAAI,EAAE;cACF7B,MAAM,EAAEnE,QAAQ,CAACiP,mBAAmB,CAAC,0BAA0B;YACnE;UACJ,CACJ,CAAC;QACT;QACA,OAAOjN,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;MAC9B,CAAC,MAAM;QACH,OAAOb,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC;MAChC;IACJ,CAAC,CAAC,OAAOiC,GAAG,EAAE;MACVC,OAAO,CAACC,GAAG,CAAC,oCAAoC,EAAEF,GAAG,CAAC;MACtD,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;;EAEF;EACAxD,MAAM,CAAC0C,IAAI,CAAC,iBAAiB,EAAEpB,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IACpE,IAAI;MACA,MAAMG,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;MAC7B;MACA,IAAIA,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,EAAE;QACb,MAAMnC,IAAI,GAAGZ,GAAG,CAACa,IAAI,CAAC,CAAC;QACvB,MAAMgN,EAAE,GAAGjN,IAAI,CAACkN,KAAK,CAACC,KAAK,CAAC,GAAG,CAAC;QAEhCrK,OAAO,CAACC,GAAG,CAAC/C,IAAI,CAAC;QACjB;QACA,IAAI,CAACA,IAAI,CAACiL,OAAO,EAAE;UACfjL,IAAI,CAACiL,OAAO,GAAG,YAAY,CAAC,CAAC;QACjC;QAEA,MAAMrL,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,aAAa,CAAC,CACzBuB,SAAS,CACN,CAAC,CAAC,EACF;UACImC,IAAI,EAAE;YACFkG,IAAI,EAAEjK,IAAI,CAACkN,KAAK;YAChBlC,SAAS,EAAE,IAAIvG,IAAI,CAACzE,IAAI,CAACgL,SAAS,CAAC;YAAE;YACrCC,OAAO,EAAE,IAAIxG,IAAI,CAACzE,IAAI,CAACiL,OAAO;UAClC;QACJ,CACJ,CAAC;QACL,MAAMmC,SAAS,GAAI,SAAQH,EAAE,CAAC,CAAC,CAAE,EAAC;QAClC,MAAMrN,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,SAAS,CAAC,CACrBsJ,UAAU,CACP,CAAC,CAAC,EACF;UACI5F,IAAI,EAAE;YACF,CAACqJ,SAAS,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC;UACzB;QACJ,CACJ,CAAC;QAEL,OAAOrN,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;MAC9B,CAAC,MAAM;QACH,OAAOb,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC;MAChC;IACJ,CAAC,CAAC,OAAOiC,GAAG,EAAE;MACVC,OAAO,CAACC,GAAG,CAAC,qCAAqC,EAAEF,GAAG,CAAC;MACvD,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;;EAEF;EACAxD,MAAM,CAAC0C,IAAI,CAAC,oBAAoB,EAAEpB,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IACvE,IAAI;MACA,MAAMG,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;MAC7B,MAAMF,IAAI,GAAGZ,GAAG,CAACa,IAAI,CAAC,CAAC;;MAEvB;MACA,IAAIC,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,EAAE;QACb;QACA,MAAMkL,YAAY,GAAG,MAAMzN,MAAM,CAC5BQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,YAAY,CAAC,CACxBC,OAAO,CACJ;UACIC,GAAG,EAAEP,IAAI,CAACsN;QACd,CAAC,EACD;UACIvL,UAAU,EAAE;YACRlB,QAAQ,EAAE;UACd;QACJ,CACJ,CAAC;QACL;QACA,MAAM0M,YAAY,GAAG,MAAM3N,MAAM,CAC5BQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,WAAW,CAAC,CACvBC,OAAO,CACJ;UACIC,GAAG,EAAEP,IAAI,CAACsN;QACd,CAAC,EACD;UACIvL,UAAU,EAAE;YACRrB,KAAK,EAAE,CAAC;YACRuD,GAAG,EAAE,CAAC;YACNK,KAAK,EAAE;UACX;QACJ,CACJ,CAAC;QAEL,IAAIiJ,YAAY,EAAE;UACd;UACA,MAAM3N,MAAM,CAACQ,EAAE,CAACnC,qBAAqB,CAAC,CAACoC,UAAU,CAAC,WAAW,CAAC,CAACM,SAAS,CAAC;YACrEJ,GAAG,EAAEP,IAAI,CAACsN;UACd,CAAC,CAAC;;UAEF;UACA,MAAM1N,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,WAAW,CAAC,CACvBkM,SAAS,CAAC;YACPhM,GAAG,EAAEP,IAAI,CAACwN,MAAM;YAChBvI,UAAU,EAAEjF,IAAI,CAACyN,QAAQ,CAACN,KAAK,CAAC,GAAG,CAAC,CAAClG,KAAK,CAAC,CAAC,CAAC,CAAC,CAACrJ,IAAI,CAAC,GAAG,CAAC;YACxDoH,SAAS,EAAEhF,IAAI,CAACyN,QAAQ,CAACN,KAAK,CAAC,GAAG,CAAC,CAAClG,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAACrJ,IAAI,CAAC,GAAG,CAAC;YAC1DqG,GAAG,EAAEsJ,YAAY,CAACtJ,GAAG;YACrBjC,KAAK,EAAE;cACH,CAAC,EAAE,IAAI;cACP,CAAC,EAAE,IAAI;cACP,CAAC,EAAE;YACP,CAAC;YACDtB,KAAK,EAAE6M,YAAY,CAAC7M,KAAK;YACzBsD,WAAW,EAAEhE,IAAI,CAACyN,QAAQ;YAAE;YAC5BvL,MAAM,EAAElC,IAAI,CAACkC,MAAM;YACnBoC,KAAK,EAAEiJ,YAAY,CAACjJ;UACxB,CAAC,CAAC;QACV,CAAC,MAAM;UACH;UACA,MAAM1E,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,WAAW,CAAC,CACvBkM,SAAS,CAAC;YACPhM,GAAG,EAAEP,IAAI,CAACwN,MAAM;YAChBvI,UAAU,EAAEjF,IAAI,CAACyN,QAAQ,CAACN,KAAK,CAAC,GAAG,CAAC,CAAClG,KAAK,CAAC,CAAC,CAAC,CAAC,CAACrJ,IAAI,CAAC,GAAG,CAAC;YACxDoH,SAAS,EAAEhF,IAAI,CAACyN,QAAQ,CAACN,KAAK,CAAC,GAAG,CAAC,CAAClG,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAACrJ,IAAI,CAAC,GAAG,CAAC;YAC1DqG,GAAG,EAAE,0FAA0F;YAC/FjC,KAAK,EAAE;cACH,CAAC,EAAE,IAAI;cACP,CAAC,EAAE,IAAI;cACP,CAAC,EAAE;YACP,CAAC;YACDtB,KAAK,EAAE,EAAE;YACTsD,WAAW,EAAEhE,IAAI,CAACyN,QAAQ;YAAE;YAC5BvL,MAAM,EAAElC,IAAI,CAACkC,MAAM;YACnBoC,KAAK,EAAE;UACX,CAAC,CAAC;QACV;QAEA,IAAI+I,YAAY,EAAE;UACd,MAAMzN,MAAM,CAACQ,EAAE,CAACnC,qBAAqB,CAAC,CAACoC,UAAU,CAAC,YAAY,CAAC,CAACM,SAAS,CAAC;YACtEJ,GAAG,EAAEP,IAAI,CAACsN;UACd,CAAC,CAAC;UACF;UACA,MAAM1N,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,YAAY,CAAC,CACxBkM,SAAS,CAAC;YACPhM,GAAG,EAAEP,IAAI,CAACwN,MAAM;YAChB3M,QAAQ,EAAE1C,YAAY,CAACkP,YAAY,CAACxM,QAAQ;UAChD,CAAC,CAAC;QACV,CAAC,MAAM;UACH;UACA,MAAMjB,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,YAAY,CAAC,CACxBkM,SAAS,CAAC;YACPhM,GAAG,EAAEP,IAAI,CAACwN,MAAM;YAChB3M,QAAQ,EAAE1C,YAAY,CAAC6B,IAAI,CAACwN,MAAM;UACtC,CAAC,CAAC;QACV;MACJ,CAAC,MAAM;QACH,OAAOzN,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC;MAChC;MAEA,OAAOb,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B,CAAC,CAAC,OAAOiC,GAAG,EAAE;MACVC,OAAO,CAACC,GAAG,CAAC,yCAAyC,EAAEF,GAAG,CAAC;MAC3D,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;;EAEF;EACAxD,MAAM,CAAC0C,IAAI,CAAC,iBAAiB,EAAEpB,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IACpE,IAAI;MACA,MAAMG,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;MAC7B,MAAMF,IAAI,GAAGZ,GAAG,CAACa,IAAI,CAAC,CAAC;;MAEvB;MACA,IAAIC,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,EAAE;QACb;QACA,MAAMvC,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,WAAW,CAAC,CACvBqD,UAAU,CAAC;UACRnD,GAAG,EAAE;YAAEW,GAAG,EAAElB,IAAI,CAAC+M;UAAM;QAC3B,CAAC,CAAC;QAEN,MAAMnN,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,YAAY,CAAC,CACxBqD,UAAU,CAAC;UACRnD,GAAG,EAAE;YAAEW,GAAG,EAAElB,IAAI,CAAC+M;UAAM;QAC3B,CAAC,CAAC;QAEN,MAAMnN,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,SAAS,CAAC,CACrBsJ,UAAU,CACP;UAAE+C,IAAI,EAAE;YAAExL,GAAG,EAAElB,IAAI,CAAC+M;UAAM;QAAE,CAAC;QAAE;QAC/B;UACIhJ,IAAI,EAAE;YACF2I,IAAI,EAAE3O,QAAQ,CAACiP,mBAAmB,CAAC,0BAA0B;UACjE;QACJ,CAAC,CAAE;QACP,CAAC;MACT,CAAC,MAAM;QACH,OAAOjN,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC;MAChC;MAEA,OAAOb,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B,CAAC,CAAC,OAAOiC,GAAG,EAAE;MACVC,OAAO,CAACC,GAAG,CAAC,oCAAoC,EAAEF,GAAG,CAAC;MACtD,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;;EAEF;EACAxD,MAAM,CAAC0C,IAAI,CAAC,oBAAoB,EAAEpB,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IACvE,IAAI;MACA,MAAMG,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;MAC7B,MAAMF,IAAI,GAAGZ,GAAG,CAACa,IAAI,CAAC,CAAC;MACvB,IAAIC,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,EAAE;QACb,QAAQnC,IAAI,CAAC0N,KAAK;UACd,KAAK,KAAK;YACN,MAAM9N,MAAM,CACPQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CACZ5B,UAAU,CAAE,GAAEH,IAAI,CAAC4B,GAAG,CAAC,CAAC,CAAE,aAAY,CAAC,CACvCF,SAAS,CACN;cACIrB,GAAG,EAAEP,IAAI,CAACyB;YACd,CAAC,EACD;cACIsC,IAAI,EAAE;gBACF,CAAE,gBAAe7D,IAAI,CAACK,GAAI,EAAC,GAAG;cAClC;cACA;cACA;cACA;YACJ,CAAC,EACD;cACIiC,MAAM,EAAE;YACZ,CACJ,CAAC;YACL,OAAOzC,GAAG,CAAC2C,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;cAAElB,EAAE,EAAEvB,IAAI,CAACK,GAAG;cAAEuB,GAAG,EAAE5B,IAAI,CAAC4B;YAAI,CAAC,CAAC;UAChE,KAAK,MAAM;YACP;YACA,MAAMlC,MAAM,CACPQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CACZ5B,UAAU,CAAC,YAAY,CAAC,CACxBuB,SAAS,CACN;cACIrB,GAAG,EAAEP,IAAI,CAACyB;YACd,CAAC,EACD;cACIsC,IAAI,EAAE;gBACF,CAAE,gBAAe7D,IAAI,CAACK,GAAI,EAAC,GAAG;cAClC;cACA;cACA;cACA;YACJ,CAAC,EACD;cACIiC,MAAM,EAAE;YACZ,CACJ,CAAC;YACL,OAAOzC,GAAG,CAAC2C,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;cAAElB,EAAE,EAAEvB,IAAI,CAACK,GAAG;cAAEuB,GAAG,EAAE5B,IAAI,CAAC4B;YAAI,CAAC,CAAC;UAChE,KAAK,QAAQ;YACT,MAAMlC,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,YAAY,CAAC,CACxBuB,SAAS,CACN;cACIrB,GAAG,EAAEP,IAAI,CAACyB;YACd,CAAC,EACD;cACIsC,IAAI,EAAE;gBACF,CAAE,gBAAe7D,IAAI,CAACK,GAAI,EAAC,GAAG;cAClC;cACA;cACA;cACA;YACJ,CAAC,EACD;cACIiC,MAAM,EAAE;YACZ,CACJ,CAAC;YACL,OAAOzC,GAAG,CAAC2C,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;cAAElB,EAAE,EAAEvB,IAAI,CAACK,GAAG;cAAEuB,GAAG,EAAE5B,IAAI,CAAC4B;YAAI,CAAC,CAAC;QACpE;QACA,OAAO/B,GAAG,CAAC2C,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAAEgL,OAAO,EAAE;QAA0B,CAAC,CAAC;MACvE,CAAC,MAAM;QACH,OAAO5N,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;MAC9B;;MAEA;MACA;MACA;IACJ,CAAC,CAAC,OAAOiC,GAAG,EAAE;MACVC,OAAO,CAACC,GAAG,CAAC,yCAAyC,EAAEF,GAAG,CAAC;MAC3D,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;;EAEF;EACAxD,MAAM,CAAC0C,IAAI,CAAC,SAAS,EAAEpB,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IAC5D,IAAI;MACA,MAAMG,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;MAC7B,MAAMF,IAAI,GAAGZ,GAAG,CAACa,IAAI,CAAC,CAAC;MACvB,IAAIC,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,EAAE;QACb,QAAQnC,IAAI,CAAC0N,KAAK;UACd,KAAK,KAAK;YACN,MAAM9N,MAAM,CACPQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CACZ5B,UAAU,CAAE,GAAEH,IAAI,CAAC4B,GAAG,CAAC,CAAC,CAAE,aAAY,CAAC,CACvCF,SAAS,CACN;cACIrB,GAAG,EAAEP,IAAI,CAACyB;YACd,CAAC,EACD;cACIsC,IAAI,EAAE;gBACF,CAAE,MAAK7D,IAAI,CAACK,GAAI,EAAC,GAAG;cACxB;cACA;cACA;cACA;YACJ,CAAC,EACD;cACIiC,MAAM,EAAE;YACZ,CACJ,CAAC;YACL;UACJ,KAAK,MAAM;YACP;YACA,MAAM5C,MAAM,CACPQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CACZ5B,UAAU,CAAC,YAAY,CAAC,CACxBuB,SAAS,CACN;cACIrB,GAAG,EAAEP,IAAI,CAACyB;YACd,CAAC,EACD;cACIsC,IAAI,EAAE;gBACF,CAAE,MAAK7D,IAAI,CAACK,GAAI,EAAC,GAAG;cACxB;cACA;cACA;cACA;YACJ,CAAC,EACD;cACIiC,MAAM,EAAE;YACZ,CACJ,CAAC;YACL;UACJ,KAAK,QAAQ;YACT,MAAM5C,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,YAAY,CAAC,CACxBuB,SAAS,CACN;cACIrB,GAAG,EAAEP,IAAI,CAACyB;YACd,CAAC,EACD;cACIsC,IAAI,EAAE;gBACF,CAAE,MAAK7D,IAAI,CAACK,GAAI,EAAC,GAAG;cACxB;cACA;cACA;cACA;YACJ,CAAC,EACD;cACIiC,MAAM,EAAE;YACZ,CACJ,CAAC;YACL;QACR;QAEA,MAAM5C,MAAM,CACPQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CACZ5B,UAAU,CAACH,IAAI,CAAC4B,GAAG,CAAC,CAAC,CAAC,GAAG,YAAY,CAAC,CACtCF,SAAS,CACN;UACIpB,IAAI,EAAEN,IAAI,CAACK,GAAG;UACdyJ,WAAW,EAAEhK,IAAI,CAACiK;QACtB,CAAC,EACD;UACIlG,IAAI,EAAE;YAAE,CAAE,WAAU/D,IAAI,CAACyB,EAAG,EAAC,GAAGzB,IAAI,CAACsG;UAAQ;QACjD,CAAC,EACD;UAAE9D,MAAM,EAAE;QAAK,CACnB,CAAC;QAEL,OAAOzC,GAAG,CAAC2C,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAAElB,EAAE,EAAEvB,IAAI,CAACK,GAAG;UAAEuB,GAAG,EAAE5B,IAAI,CAAC4B;QAAI,CAAC,CAAC;MAChE,CAAC,MAAM;QACH,OAAO/B,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;MAC9B;;MAEA;MACA;MACA;IACJ,CAAC,CAAC,OAAOiC,GAAG,EAAE;MACVC,OAAO,CAACC,GAAG,CAAC,yCAAyC,EAAEF,GAAG,CAAC;MAC3D,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;;EAEF;EACAxD,MAAM,CAAC0C,IAAI,CAAC,sBAAsB,EAAEpB,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IACzE,IAAI;MACA,MAAMG,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;MAC7B,MAAMF,IAAI,GAAGZ,GAAG,CAACa,IAAI,CAAC,CAAC;MACvB;MACA;MACA;MACA;MACA;MACA;;MAEA,IAAIC,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,IAAIjC,IAAI,CAACiC,GAAG,CAAC,EAAE,CAAC,EAAE;QAC7B;QACA,MAAM6H,WAAW,GAAG,MAAMpK,MAAM,CAC3BQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,aAAa,CAAC,CACzBC,OAAO,CAAC,CAAC,CAAC,EAAE;UAAEyB,UAAU,EAAE;YAAExB,GAAG,EAAE,CAAC;YAAE0J,IAAI,EAAE;UAAE;QAAE,CAAC,CAAC;QACrD;QACA,QAAQjK,IAAI,CAAC0N,KAAK;UACd,KAAK,KAAK;YACN;YACA,MAAM9N,MAAM,CACPQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CACZ5B,UAAU,CAACL,IAAI,CAAC4N,MAAM,GAAG,aAAa,CAAC,CACvChM,SAAS,CACN;cACIrB,GAAG,EAAEP,IAAI,CAAC6N;YACd,CAAC,EACD;cACI9J,IAAI,EAAE;gBACF0G,IAAI,EAAEzK,IAAI,CAACyK,IAAI;gBACfqD,OAAO,EAAE9N,IAAI,CAAC8N,OAAO;gBACrBJ,KAAK,EAAE,KAAK;gBACZ5L,GAAG,EAAE9B,IAAI,CAAC4N,MAAM;gBAChB3D,IAAI,EAAED,WAAW,CAACC,IAAI;gBACtB8D,UAAU,EAAE,IAAItJ,IAAI,CAAC,CAACzE,IAAI,CAACgO,UAAU,EAAEhO,IAAI,CAACiO,UAAU,CAAC,CAAC;gBACxDpI,GAAG,EAAE;cACT;YACJ,CAAC,EACD;cACIrD,MAAM,EAAE;YACZ,CACJ,CAAC;;YAEL;YACA,MAAM5C,MAAM,CAACQ,EAAE,CAACnC,qBAAqB,CAAC,CAACoC,UAAU,CAAC,YAAY,CAAC,CAACM,SAAS,CAAC;cAAEJ,GAAG,EAAEP,IAAI,CAAC6N;YAAO,CAAC,CAAC,CAAC,CAAC;;YAEjG,MAAMjO,MAAM,CAACQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CAAC5B,UAAU,CAAC,YAAY,CAAC,CAACM,SAAS,CAAC;cAAEJ,GAAG,EAAEP,IAAI,CAAC6N;YAAO,CAAC,CAAC,CAAC,CAAC;;YAEpF;YACA,MAAM,MAAMjO,MAAM,CACbQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CACZ5B,UAAU,CAACL,IAAI,CAAC4N,MAAM,GAAG,aAAa,CAAC,CACvCM,WAAW,CACR;cACIjE,IAAI,EAAE;YACV,CAAC,EACD;cACIQ,IAAI,EAAE;YACV,CACJ,CAAC;YAEL;UACJ,KAAK,MAAM;YACP;YACA,MAAM7K,MAAM,CACPQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CACZ5B,UAAU,CAAC,YAAY,CAAC,CACxBuB,SAAS,CACN;cACIrB,GAAG,EAAEP,IAAI,CAAC6N;YACd,CAAC,EACD;cACI9J,IAAI,EAAE;gBACF0G,IAAI,EAAEzK,IAAI,CAACyK,IAAI;gBACfqD,OAAO,EAAE9N,IAAI,CAAC8N,OAAO;gBACrBJ,KAAK,EAAE,MAAM;gBACbzD,IAAI,EAAED,WAAW,CAACC,IAAI;gBACtB8D,UAAU,EAAE,IAAItJ,IAAI,CAAC,CAACzE,IAAI,CAACgO,UAAU,EAAEhO,IAAI,CAACiO,UAAU,CAAC,CAAC;gBACxDpI,GAAG,EAAE;cACT;YACJ,CAAC,EACD;cACIrD,MAAM,EAAE;YACZ,CACJ,CAAC;;YAEL;YACA,MAAM5C,MAAM,CAACQ,EAAE,CAACnC,qBAAqB,CAAC,CAACoC,UAAU,CAAC,YAAY,CAAC,CAACM,SAAS,CAAC;cAAEJ,GAAG,EAAEP,IAAI,CAAC6N;YAAO,CAAC,CAAC,CAAC,CAAC;YACjG,MAAMjO,MAAM,CACPQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CACZ5B,UAAU,CAACL,IAAI,CAAC4N,MAAM,GAAG,aAAa,CAAC,CACvCjN,SAAS,CAAC;cAAEJ,GAAG,EAAEP,IAAI,CAAC6N;YAAO,CAAC,CAAC,CAAC,CAAC;;YAEtC;YACA,MAAMjO,MAAM,CAACQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CAAC5B,UAAU,CAAC,YAAY,CAAC,CAAC6N,WAAW,CAC1D;cACIjE,IAAI,EAAE;YACV,CAAC,EACD;cACIQ,IAAI,EAAE;YACV,CACJ,CAAC;YAED;UACJ,KAAK,QAAQ;YACT;YACA,MAAM7K,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,YAAY,CAAC,CACxBuB,SAAS,CACN;cACIrB,GAAG,EAAEP,IAAI,CAAC6N;YACd,CAAC,EACD;cACI9J,IAAI,EAAE;gBACF0G,IAAI,EAAEzK,IAAI,CAACyK,IAAI;gBACfqD,OAAO,EAAE9N,IAAI,CAAC8N,OAAO;gBACrBJ,KAAK,EAAE,QAAQ;gBACfzD,IAAI,EAAED,WAAW,CAACC,IAAI;gBACtB8D,UAAU,EAAE,IAAItJ,IAAI,CAAC,CAACzE,IAAI,CAACgO,UAAU,EAAEhO,IAAI,CAACiO,UAAU,CAAC,CAAC;gBACxDpI,GAAG,EAAE;cACT;YACJ,CAAC,EACD;cACIrD,MAAM,EAAE;YACZ,CACJ,CAAC;;YAEL;YACA,MAAM5C,MAAM,CAACQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CAAC5B,UAAU,CAAC,YAAY,CAAC,CAACM,SAAS,CAAC;cAAEJ,GAAG,EAAEP,IAAI,CAAC6N;YAAO,CAAC,CAAC,CAAC,CAAC;YACpF,MAAMjO,MAAM,CACPQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CACZ5B,UAAU,CAACL,IAAI,CAAC4N,MAAM,GAAG,aAAa,CAAC,CACvCjN,SAAS,CAAC;cAAEJ,GAAG,EAAEP,IAAI,CAAC6N;YAAO,CAAC,CAAC,CAAC,CAAC;;YAEtC;YACA;QACR;QACAhO,GAAG,CAAC8D,OAAO,CAACC,OAAO,CAAEC,EAAE,IAAK;UACxB,IAAIA,EAAE,CAACsK,KAAK,IAAInO,IAAI,CAAC6N,MAAM,EAAE;YACzBhK,EAAE,CAACC,IAAI,CAAC,QAAQ,CAAC;UACrB;QACJ,CAAC,CAAC;QACF,OAAO/D,GAAG,CAAC2C,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAAEgL,OAAO,EAAE;QAAU,CAAC,CAAC;MACvD,CAAC,MAAM;QACH,OAAO5N,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;MAC9B;;MAEA;MACA;MACA;IACJ,CAAC,CAAC,OAAOiC,GAAG,EAAE;MACVC,OAAO,CAACC,GAAG,CAAC,yCAAyC,EAAEF,GAAG,CAAC;MAC3D,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;;EAEF;EACAxD,MAAM,CAAC0C,IAAI,CAAC,qBAAqB,EAAEpB,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IACxE,IAAI;MACA,MAAMG,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;MAC7B,MAAMF,IAAI,GAAGZ,GAAG,CAACa,IAAI,CAAC,CAAC;MACvB,MAAMmO,SAAS,GAAG,IAAI,GAAGpO,IAAI,CAACqO,QAAQ,GAAG,GAAG,GAAGrO,IAAI,CAACiK,IAAI;MACxD,IAAI/J,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,EAAE;QACb;QACA;QACA,MAAMmM,UAAU,GAAG,MAAM1O,MAAM,CAC1BQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,YAAY,CAAC,CACxBY,IAAI,CACD;UACIgJ,IAAI,EAAEmE;QACV,CAAC,EACD;UACIrM,UAAU,EAAE;YACR0I,IAAI,EAAE,CAAC;YACPqD,OAAO,EAAE,CAAC;YACV7D,IAAI,EAAE;UACV;QACJ,CACJ,CAAC,CACA9I,OAAO,CAAC,CAAC;;QAEd;QACA,MAAMoN,OAAO,GAAG,MAAM3O,MAAM,CACvBQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CACZ5B,UAAU,CAAC,YAAY,CAAC,CACxBY,IAAI,CACD;UACIgJ,IAAI,EAAEmE;QACV,CAAC,EACD;UACIrM,UAAU,EAAE;YACR0I,IAAI,EAAE,CAAC;YACPqD,OAAO,EAAE,CAAC;YACV7D,IAAI,EAAE;UACV;QACJ,CACJ,CAAC,CACA9I,OAAO,CAAC,CAAC;;QAEd;QACA,MAAMqN,WAAW,GAAG,MAAM5O,MAAM,CAACQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CAACwM,eAAe,CAAC,CAAC,CAACtN,OAAO,CAAC,CAAC;;QAEzE;QACA,MAAMuN,mBAAmB,GAAGF,WAAW,CAAChN,MAAM,CAAEnB,UAAU,IAAKA,UAAU,CAACoK,IAAI,CAACkE,QAAQ,CAAC,aAAa,CAAC,CAAC;;QAEvG;QACA,MAAMC,QAAQ,GAAG,MAAMF,mBAAmB,CAACrN,GAAG,CAAC,MAAOhB,UAAU,IAAK;UACjE,IAAIH,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,EAAE;YACb,MAAM0M,KAAK,GAAG,MAAMjP,MAAM,CACrBQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CACZ5B,UAAU,CAACA,UAAU,CAACoK,IAAI,CAAC,CAC3BxJ,IAAI,CACD;cACIgJ,IAAI,EAAEmE,SAAS;cACftM,GAAG,EAAE5B,IAAI,CAAC4B,GAAG,CAAC,CAAC;YACnB,CAAC,EACD;cACIC,UAAU,EAAE;gBACR0I,IAAI,EAAE,CAAC;gBACPqD,OAAO,EAAE,CAAC;gBACVhM,GAAG,EAAE,CAAC;gBACNmI,IAAI,EAAE;cACV;YACJ,CACJ,CAAC,CACA9I,OAAO,CAAC,CAAC;YACd,OAAO0N,KAAK;UAChB,CAAC,MAAM;YACH,MAAMA,KAAK,GAAG,MAAMjP,MAAM,CACrBQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CACZ5B,UAAU,CAACA,UAAU,CAACoK,IAAI,CAAC,CAC3BxJ,IAAI,CACD;cACIgJ,IAAI,EAAEmE;YACV,CAAC,EACD;cACIrM,UAAU,EAAE;gBACR0I,IAAI,EAAE,CAAC;gBACPqD,OAAO,EAAE,CAAC;gBACVhM,GAAG,EAAE,CAAC;gBACNmI,IAAI,EAAE;cACV;YACJ,CACJ,CAAC,CACA9I,OAAO,CAAC,CAAC;YACd,OAAO0N,KAAK;UAChB;QACJ,CAAC,CAAC;QACF1C,OAAO,CAACC,GAAG,CAACwC,QAAQ,CAAC,CAChBE,IAAI,CAAEC,OAAO,IAAK;UACf;UACA;UACA,MAAMC,OAAO,GAAG,EAAE,CAACC,MAAM,CAAC,GAAGF,OAAO,CAAC,CAAC,CAAC;;UAEvC,MAAMG,KAAK,GAAG;YACVZ,UAAU,EAAEA,UAAU;YACtBC,OAAO,EAAEA,OAAO;YAChBS,OAAO,EAAEA;UACb,CAAC;UACD,OAAOjP,GAAG,CAAC2C,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAACuM,KAAK,CAAC;QACtC,CAAC,CAAC,CACDC,KAAK,CAAE/L,KAAK,IAAK;UACd;UACAN,OAAO,CAACC,GAAG,CAAC,yCAAyC,EAAEK,KAAK,CAAC;QACjE,CAAC,CAAC;MACV,CAAC,MAAM;QACH,OAAOrD,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;MAC9B;IACJ,CAAC,CAAC,OAAOiC,GAAG,EAAE;MACVC,OAAO,CAACC,GAAG,CAAC,0CAA0C,EAAEF,GAAG,CAAC;MAC5D,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;;EAEF;EACAxD,MAAM,CAAC0C,IAAI,CAAC,sBAAsB,EAAEpB,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IACzE,IAAI;MACA,MAAMG,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;MAC7B,MAAMF,IAAI,GAAGZ,GAAG,CAACa,IAAI,CAAC,CAAC;MACvB,IAAIC,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,EAAE;QACb;QACA,MAAMiN,OAAO,GAAG,MAAMxP,MAAM,CACvBQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CACZ5B,UAAU,CAACL,IAAI,CAAC8B,GAAG,GAAG,aAAa,CAAC,CACpCb,IAAI,CAAC,CAAC,CAAC,CAAC,CACRE,OAAO,CAAC,CAAC;QAEd,OAAOpB,GAAG,CAAC2C,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAACyM,OAAO,CAAC;MACxC,CAAC,MAAM;QACH,OAAOrP,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;MAC9B;IACJ,CAAC,CAAC,OAAOiC,GAAG,EAAE;MACVC,OAAO,CAACC,GAAG,CAAC,2CAA2C,EAAEF,GAAG,CAAC;MAC7D,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;;EAEF;EACAxD,MAAM,CAAC0C,IAAI,CAAC,yBAAyB,EAAEpB,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IAC5E,IAAI;MACA,MAAMG,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;MAC7B,MAAMF,IAAI,GAAGZ,GAAG,CAACa,IAAI,CAAC,CAAC;MACvB;MACA,IAAIC,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,EAAE;QACb,IAAInC,IAAI,CAAC0N,KAAK,IAAI,QAAQ,EAAE;UACxB;UACA,MAAM9N,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,YAAY,CAAC,CACxBuB,SAAS,CACN;YACIrB,GAAG,EAAEP,IAAI,CAACO;UACd,CAAC,EACD;YACIwD,IAAI,EAAE;cAAE8B,GAAG,EAAE7F,IAAI,CAAC0C,MAAM,IAAI;YAAI;UACpC,CACJ,CAAC;QACT,CAAC,MAAM,IAAI1C,IAAI,CAAC0N,KAAK,IAAI,MAAM,EAAE;UAC7B;UACA,MAAM9N,MAAM,CACPQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CACZ5B,UAAU,CAAC,YAAY,CAAC,CACxBuB,SAAS,CACN;YACIrB,GAAG,EAAEP,IAAI,CAACO;UACd,CAAC,EACD;YACIwD,IAAI,EAAE;cAAE8B,GAAG,EAAE7F,IAAI,CAAC0C,MAAM,IAAI;YAAI;UACpC,CACJ,CAAC;QACT,CAAC,MAAM;UACH;UACA,MAAM9C,MAAM,CACPQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CACZ5B,UAAU,CAACL,IAAI,CAAC0N,KAAK,GAAG,aAAa,CAAC,CACtC9L,SAAS,CACN;YACIrB,GAAG,EAAEP,IAAI,CAACO;UACd,CAAC,EACD;YACIwD,IAAI,EAAE;cAAE8B,GAAG,EAAE7F,IAAI,CAAC0C,MAAM,IAAI;YAAI;UACpC,CACJ,CAAC;QACT;QACA7C,GAAG,CAAC8D,OAAO,CAACC,OAAO,CAAEC,EAAE,IAAK;UACxB,IAAIA,EAAE,CAACsK,KAAK,IAAInO,IAAI,CAACO,GAAG,EAAE;YACtBsD,EAAE,CAACC,IAAI,CAAC,QAAQ,CAAC;UACrB;QACJ,CAAC,CAAC;QACF,OAAO/D,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;MAC9B,CAAC,MAAM;QACH,OAAOb,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC;MAChC;IACJ,CAAC,CAAC,OAAOiC,GAAG,EAAE;MACVC,OAAO,CAACC,GAAG,CAAC,oCAAoC,EAAEF,GAAG,CAAC;MACtD,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;;EAEF;EACAxD,MAAM,CAAC0C,IAAI,CAAC,0BAA0B,EAAEpB,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IAC7E,IAAI;MACA,MAAMG,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;MAC7B,MAAMF,IAAI,GAAGZ,GAAG,CAACa,IAAI,CAAC,CAAC;MACvB;MACA,MAAM6J,EAAE,GAAG,CAAC,CAAC;MACbuF,MAAM,CAACC,IAAI,CAACtP,IAAI,CAACuP,UAAU,CAAC,CAAC3L,OAAO,CAAE4L,GAAG,IAAK;QAC1C1F,EAAE,CAAC0F,GAAG,CAAC,GAAGxP,IAAI,CAACuP,UAAU,CAACC,GAAG,CAAC,KAAK,CAAC,GAAG,IAAI,GAAG,KAAK;MACvD,CAAC,CAAC;MACF,IAAItP,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,EAAE;QACb,IAAInC,IAAI,CAAC0N,KAAK,IAAI,QAAQ,EAAE;UACxB;UACA,MAAM9N,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,YAAY,CAAC,CACxBuB,SAAS,CACN;YACIrB,GAAG,EAAEP,IAAI,CAACO;UACd,CAAC,EACD;YACIwD,IAAI,EAAE;cAAE8F,YAAY,EAAE7J,IAAI,CAACuP,UAAU;cAAEzF,EAAE,EAAEA;YAAG;UAClD,CACJ,CAAC;QACT,CAAC,MAAM,IAAI9J,IAAI,CAAC0N,KAAK,IAAI,MAAM,EAAE;UAC7B;UACA,MAAM9N,MAAM,CACPQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CACZ5B,UAAU,CAAC,YAAY,CAAC,CACxBuB,SAAS,CACN;YACIrB,GAAG,EAAEP,IAAI,CAACO;UACd,CAAC,EACD;YACIwD,IAAI,EAAE;cAAE8F,YAAY,EAAE7J,IAAI,CAACuP,UAAU;cAAEzF,EAAE,EAAEA;YAAG;UAClD,CACJ,CAAC;QACT,CAAC,MAAM;UACH;UACA,MAAMlK,MAAM,CACPQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CACZ5B,UAAU,CAACL,IAAI,CAAC0N,KAAK,GAAG,aAAa,CAAC,CACtC9L,SAAS,CACN;YACIrB,GAAG,EAAEP,IAAI,CAACO;UACd,CAAC,EACD;YACIwD,IAAI,EAAE;cAAE8F,YAAY,EAAE7J,IAAI,CAACuP,UAAU;cAAEzF,EAAE,EAAEA;YAAG;UAClD,CACJ,CAAC;QACT;QAEA,OAAO/J,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;MAC9B,CAAC,MAAM;QACH,OAAOb,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC;MAChC;IACJ,CAAC,CAAC,OAAOiC,GAAG,EAAE;MACVC,OAAO,CAACC,GAAG,CAAC,gDAAgD,EAAEF,GAAG,CAAC;MAClE,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;;EAEF;EACAxD,MAAM,CAAC0C,IAAI,CAAC,wBAAwB,EAAEpB,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IAC3E,IAAI;MACA,MAAMG,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;MAC7B,MAAMF,IAAI,GAAGZ,GAAG,CAACa,IAAI,CAAC,CAAC;;MAEvB;MACA,IAAIC,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,EAAE;QACb,IAAInC,IAAI,CAAC0N,KAAK,IAAI,QAAQ,EAAE;UACxB;UACA,MAAM9N,MAAM,CAACQ,EAAE,CAACnC,qBAAqB,CAAC,CAACoC,UAAU,CAAC,YAAY,CAAC,CAACuB,SAAS,CACrE;YACIrB,GAAG,EAAEP,IAAI,CAACO;UACd,CAAC,EACD;YACIuE,MAAM,EAAE9E,IAAI,CAACyJ;UACjB,CACJ,CAAC;QACL,CAAC,MAAM,IAAIzJ,IAAI,CAAC0N,KAAK,IAAI,MAAM,EAAE;UAC7B;UACA,MAAM9N,MAAM,CAACQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CAAC5B,UAAU,CAAC,YAAY,CAAC,CAACuB,SAAS,CACxD;YACIrB,GAAG,EAAEP,IAAI,CAACO;UACd,CAAC,EACD;YACIuE,MAAM,EAAE9E,IAAI,CAACyP;UACjB,CACJ,CAAC;QACL,CAAC,MAAM;UACH;UACA,MAAM7P,MAAM,CACPQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CACZ5B,UAAU,CAACL,IAAI,CAAC0N,KAAK,GAAG,aAAa,CAAC,CACtC9L,SAAS,CACN;YACIrB,GAAG,EAAEP,IAAI,CAACO;UACd,CAAC,EACD;YACIuE,MAAM,EAAE9E,IAAI,CAACyP;UACjB,CACJ,CAAC;QACT;QAEA,OAAO1P,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;MAC9B,CAAC,MAAM;QACH,OAAOb,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC;MAChC;IACJ,CAAC,CAAC,OAAOiC,GAAG,EAAE;MACVC,OAAO,CAACC,GAAG,CAAC,8CAA8C,EAAEF,GAAG,CAAC;MAChE,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;;EAEF;EACAxD,MAAM,CAAC0C,IAAI,CAAC,mBAAmB,EAAEpB,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IACtE,IAAI;MACA,MAAMG,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;MAC7B,MAAMF,IAAI,GAAGZ,GAAG,CAACa,IAAI,CAAC,CAAC;;MAEvB;MACA,IAAIC,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,IAAIjC,IAAI,CAACiC,GAAG,CAAC,EAAE,CAAC,EAAE;QAC7B;QACA,MAAMvC,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,YAAY,CAAC,CACxBqD,UAAU,CAAC;UACRnD,GAAG,EAAE;YAAEW,GAAG,EAAElB,IAAI,CAAC0P;UAAa;QAClC,CAAC,CAAC;;QAEN;QACA,MAAM9P,MAAM,CACPQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CACZ5B,UAAU,CAAC,YAAY,CAAC,CACxBqD,UAAU,CAAC;UACRnD,GAAG,EAAE;YAAEW,GAAG,EAAElB,IAAI,CAAC2P;UAAU;QAC/B,CAAC,CAAC;;QAEN;QACA;QACA,MAAMnB,WAAW,GAAG,MAAM5O,MAAM,CAACQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CAACwM,eAAe,CAAC,CAAC,CAACtN,OAAO,CAAC,CAAC;;QAEzE;QACA,MAAMuN,mBAAmB,GAAG,MAAMF,WAAW,CAAChN,MAAM,CAAEnB,UAAU,IAC5DA,UAAU,CAACoK,IAAI,CAACkE,QAAQ,CAAC,aAAa,CAC1C,CAAC;;QAED;QACAD,mBAAmB,CAAC9K,OAAO,CAAC,MAAOgM,kBAAkB,IAAK;UACtD,MAAMhQ,MAAM,CACPQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CACZ5B,UAAU,CAACuP,kBAAkB,CAACnF,IAAI,CAAC,CACnC/G,UAAU,CAAC;YACRnD,GAAG,EAAE;cAAEW,GAAG,EAAElB,IAAI,CAAC6P;YAAU;UAC/B,CAAC,CAAC;QACV,CAAC,CAAC;QAEF,OAAO9P,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;MAC9B,CAAC,MAAM;QACH,OAAOb,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC;MAChC;IACJ,CAAC,CAAC,OAAOiC,GAAG,EAAE;MACVC,OAAO,CAACC,GAAG,CAAC,oCAAoC,EAAEF,GAAG,CAAC;MACtD,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;;EAEF;EACAxD,MAAM,CAAC4F,GAAG,CAAC,yBAAyB,EAAEtE,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IAC3E,IAAI;MACA,MAAMG,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;MAC7B,IAAIA,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,EAAE;QACb,MAAMnC,IAAI,GAAGZ,GAAG,CAAC2K,KAAK;QACtB;QACA,MAAMC,WAAW,GAAGhK,IAAI,CAACiK,IAAI;QAC7B,MAAMc,cAAc,GAAG,MAAMnL,MAAM,CAC9BQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,aAAa,CAAC,CACzBC,OAAO,CACJ,CAAC,CAAC,EACF;UACIyB,UAAU,EAAE;YACRxB,GAAG,EAAE,CAAC;YACN0J,IAAI,EAAE,CAAC;YACPe,SAAS,EAAE,CAAC;YACZC,OAAO,EAAE;UACb;QACJ,CACJ,CAAC;QAEL,MAAMpB,YAAY,GAAGzL,eAAe,CAChC,MAAMwB,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,WAAW,CAAC,CACvBY,IAAI,CACD;UAAEP,KAAK,EAAEV,IAAI,CAAC8B,GAAG;UAAE,SAAS,EAAE;YAAE8H,OAAO,EAAE;UAAK;QAAE,CAAC,EACjD;UACI7H,UAAU,EAAE;YACRkD,UAAU,EAAE,CAAC;YACbD,SAAS,EAAE,CAAC;YACZ0D,WAAW,EAAE;UACjB;QACJ,CACJ,CAAC,CACAvH,OAAO,CAAC,CACjB,CAAC;;QAED;QACA,IAAIkC,MAAM,GAAG;UACT;UACAwG,YAAY,EAAEA,YAAY;UAC1B;UACA;UACA;UACAkB,cAAc,EAAEA;QACpB,CAAC;QAED,OAAOhL,GAAG,CAAC2C,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAACU,MAAM,CAAC;MACvC,CAAC,MAAM;QACH;QACA;QACA,OAAOtD,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;MAC9B;IACJ,CAAC,CAAC,OAAOiC,GAAG,EAAE;MACVC,OAAO,CAACC,GAAG,CAAC,+CAA+C,EAAEF,GAAG,CAAC;MACjE,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;;EAEF;EACAxD,MAAM,CAAC0C,IAAI,CAAC,mBAAmB,EAAEpB,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IACtE,IAAI;MACA,MAAMG,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;MAC7B,MAAMF,IAAI,GAAGZ,GAAG,CAACa,IAAI,CAAC,CAAC;;MAEvB;MACA,IAAIC,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,EAAE;QACb,MAAM6H,WAAW,GAAG,MAAMpK,MAAM,CAC3BQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,aAAa,CAAC,CACzBC,OAAO,CACJ,CAAC,CAAC,EACF;UACIyB,UAAU,EAAE;YACRxB,GAAG,EAAE,CAAC;YACN0J,IAAI,EAAE;UACV;QACJ,CACJ,CAAC;QAEL,MAAMmE,SAAS,GAAGpE,WAAW,CAACC,IAAI,CAACkD,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;;QAEhD;QACA,MAAM2C,SAAS,GAAG,MAAMlQ,MAAM,CACzBQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,SAAS,CAAC,CACrBC,OAAO,CACJ;UACIC,GAAG,EAAEP,IAAI,CAACsN;QACd,CAAC,EACD;UACIvL,UAAU,EAAE;YACRxB,GAAG,EAAE,CAAC;YACNwP,KAAK,EAAE,CAAC;YACRrD,IAAI,EAAE;UACV;QACJ,CACJ,CAAC;QAEL,IAAIoD,SAAS,EAAE;UACX;UACA,MAAMlQ,MAAM,CAACQ,EAAE,CAACnC,qBAAqB,CAAC,CAACoC,UAAU,CAAC,SAAS,CAAC,CAACM,SAAS,CAAC;YAAEJ,GAAG,EAAEP,IAAI,CAACsN;UAAO,CAAC,CAAC;;UAE5F;UACA,MAAM1N,MAAM,CAACQ,EAAE,CAACnC,qBAAqB,CAAC,CAACoC,UAAU,CAAC,SAAS,CAAC,CAACkM,SAAS,CAAC;YACnEhM,GAAG,EAAEP,IAAI,CAACwN,MAAM;YAChBuC,KAAK,EAAED,SAAS,CAACC,KAAK;YAAE;YACxB7N,MAAM,EAAElC,IAAI,CAACkC,MAAM;YACnBwK,IAAI,EAAE1M,IAAI,CAAC0M;UACf,CAAC,CAAC;;UAEF;UACA,MAAM9M,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,WAAW,CAAC,CACvBuB,SAAS,CACN;YACIrB,GAAG,EAAEuP,SAAS,CAACpD;UACnB,CAAC,EACD;YACI7K,KAAK,EAAE;cAAEnB,KAAK,EAAEV,IAAI,CAACsN;YAAO;UAChC,CACJ,CAAC;;UAEL;UACA,MAAM1N,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,WAAW,CAAC,CACvBuB,SAAS,CACN;YACIrB,GAAG,EAAEP,IAAI,CAAC0M;UACd,CAAC,EACD;YACIsD,SAAS,EAAE;cAAEtP,KAAK,EAAEV,IAAI,CAACwN;YAAO;UACpC,CACJ,CAAC;QACT,CAAC,MAAM;UACH;UACA,MAAM5N,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,SAAS,CAAC,CACrBkM,SAAS,CAAC;YACPhM,GAAG,EAAEP,IAAI,CAACwN,MAAM;YAChBuC,KAAK,EAAE;cACH,CAAE,GAAE3B,SAAU,EAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC;YAC9B,CAAC;YACDlM,MAAM,EAAElC,IAAI,CAACkC,MAAM;YACnBwK,IAAI,EAAE1M,IAAI,CAAC0M;UACf,CAAC,CAAC;;UAEN;UACA,MAAM9M,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,WAAW,CAAC,CACvBuB,SAAS,CACN;YACIrB,GAAG,EAAEP,IAAI,CAAC0M;UACd,CAAC,EACD;YACIsD,SAAS,EAAE;cAAEtP,KAAK,EAAEV,IAAI,CAACwN;YAAO;UACpC,CACJ,CAAC;QACT;MACJ,CAAC,MAAM;QACH,OAAOzN,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC;MAChC;MAEA,OAAOb,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B,CAAC,CAAC,OAAOiC,GAAG,EAAE;MACVC,OAAO,CAACC,GAAG,CAAC,oCAAoC,EAAEF,GAAG,CAAC;MACtD,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;;EAEF;EACAxD,MAAM,CAAC0C,IAAI,CAAC,gBAAgB,EAAEpB,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IACnE,IAAI;MACA,MAAMG,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;MAC7B,MAAMF,IAAI,GAAGZ,GAAG,CAACa,IAAI,CAAC,CAAC;;MAEvB;MACA,IAAIC,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,EAAE;QACb;QACA;QACA,MAAMtD,cAAc,CAACmB,IAAI,EAAEE,IAAI,CAAC;MACpC,CAAC,MAAM;QACH,OAAOH,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC;MAChC;MACA,OAAOb,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B,CAAC,CAAC,OAAOiC,GAAG,EAAE;MACVC,OAAO,CAACC,GAAG,CAAC,kCAAkC,EAAEF,GAAG,CAAC;MACpD,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;;EAEF;EACAxD,MAAM,CAAC0C,IAAI,CAAC,cAAc,EAAEpB,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IACjE,IAAI;MACA,MAAMG,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;MAC7B,MAAMF,IAAI,GAAGZ,GAAG,CAACa,IAAI,CAAC,CAAC;;MAEvB;MACA,IAAIC,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,EAAE;QACb;QACA,IAAI8N,OAAO,GAAG,CAAC,CAAC,CAAC,CAAC;QAClB,IAAIC,cAAc,GAAG,EAAE,CAAC,CAAC;QACzB,IAAIC,oBAAoB,CAAC,CAAC;;QAE1B,KAAK,IAAI5K,CAAC,GAAGvF,IAAI,CAACoQ,gBAAgB,EAAE7K,CAAC,GAAGvF,IAAI,CAACqQ,OAAO,CAAC1O,MAAM,EAAE4D,CAAC,EAAE,EAAE;UAC9D,IAAIsJ,KAAK,GAAG,MAAMjP,MAAM,CACnBQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,SAAS,CAAC,CACrBY,IAAI,CACD;YACIiB,MAAM,EAAElC,IAAI,CAACqQ,OAAO,CAAC9K,CAAC,CAAC,CAAChF;UAC5B,CAAC;UAAE;UACH;YACIwB,UAAU,EAAE;cACR2K,IAAI,EAAE;YACV;UACJ,CACJ,CAAC,CACAvL,OAAO,CAAC,CAAC;UAEd8O,OAAO,CAACjQ,IAAI,CAACqQ,OAAO,CAAC9K,CAAC,CAAC,CAAChF,GAAG,CAAC,GAAGsO,KAAK,CAACxN,GAAG,CAAES,GAAG,IAAKA,GAAG,CAACvB,GAAG,CAAC;UAC1D2P,cAAc,CAACvK,IAAI,CAAC,GAAGkJ,KAAK,CAACxN,GAAG,CAAES,GAAG,IAAKA,GAAG,CAAC4K,IAAI,CAAC,CAAC;UAEpDyD,oBAAoB,GAAG5K,CAAC,GAAG,CAAC;UAC5B;UACA,IAAI2K,cAAc,CAACvO,MAAM,IAAI,EAAE,EAAE;YAC7B;UACJ;QACJ;;QAEA;QACA,KAAK,IAAI4D,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG2K,cAAc,CAACvO,MAAM,EAAE4D,CAAC,EAAE,EAAE;UAC5C;UACA2K,cAAc,CAAC3K,CAAC,CAAC,GAAG,MAAM3F,MAAM,CAC3BQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,WAAW,CAAC,CACvBC,OAAO,CACJ;YACIC,GAAG,EAAE2P,cAAc,CAAC3K,CAAC,CAAC;YACtB,SAAS,EAAE;cAAEqE,OAAO,EAAE;YAAK,CAAC;YAC5B,SAAS,EAAE;cAAEA,OAAO,EAAE;YAAK;UAC/B,CAAC;UAAE;UACH;YACI7H,UAAU,EAAE;cACRkD,UAAU,EAAE,CAAC;cACbD,SAAS,EAAE;YACf;UACJ,CACJ,CAAC;QACT;QAEA,OAAOjF,GAAG,CAAC2C,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UACxBsN,OAAO,EAAEA,OAAO;UAChBC,cAAc,EAAEA,cAAc;UAC9BC,oBAAoB,EAAEA;QAC1B,CAAC,CAAC;MACN,CAAC,MAAM;QACH,OAAOpQ,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC;MAChC;IACJ,CAAC,CAAC,OAAOiC,GAAG,EAAE;MACVC,OAAO,CAACC,GAAG,CAAC,kCAAkC,EAAEF,GAAG,CAAC;MACpD,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;EACFxD,MAAM,CAAC0C,IAAI,CAAC,gBAAgB,EAAEL,MAAM,CAACuG,MAAM,CAAC,MAAM,CAAC,EAAEtH,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IAC1F,IAAI;MACA,MAAMG,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;MAC7B,MAAMoQ,KAAK,GAAGlR,GAAG,CAACa,IAAI,CAACS,KAAK;MAC5B,MAAM6P,WAAW,GAAGnS,eAAe,CAC/B,MAAMwB,MAAM,CACPQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,WAAW,CAAC,CACvBY,IAAI,CACD;QAAEP,KAAK,EAAE4P,KAAK;QAAE,SAAS,EAAE;UAAE1G,OAAO,EAAE;QAAK;MAAE,CAAC,EAC9C;QACI7H,UAAU,EAAE;UACRxB,GAAG,EAAE,CAAC;UACNyE,SAAS,EAAE,CAAC;UACZC,UAAU,EAAE;QAChB;MACJ,CACJ,CAAC,CACA9D,OAAO,CAAC,CACjB,CAAC;MAED,MAAMiG,QAAQ,GAAG,MAAM9J,YAAY,CAAC+J,aAAa,CAAC,uCAAuC,CAAC;MAE1F,MAAMiB,QAAQ,GAAG,EAAE;MAEnB,KAAK,MAAMkI,OAAO,IAAID,WAAW,EAAE;QAC/B,MAAME,SAAS,GAAG,MAAM7Q,MAAM,CACzBQ,EAAE,CAACnC,qBAAqB,CAAC,CACzBoC,UAAU,CAAC,YAAY,CAAC,CACxBC,OAAO,CACJ;UAAEC,GAAG,EAAEiQ,OAAO,CAACjQ;QAAI,CAAC,EACpB;UACIwB,UAAU,EAAE;YACRxB,GAAG,EAAE,CAAC;YACNM,QAAQ,EAAE;UACd;QACJ,CACJ,CAAC;QACL,IAAI4P,SAAS,EAAE;UACX,MAAM7H,OAAO,GAAG,CAAC4H,OAAO,CAACjQ,GAAG,EAAEkQ,SAAS,CAAC5P,QAAQ,EAAE2P,OAAO,CAACxL,SAAS,EAAEwL,OAAO,CAACvL,UAAU,CAAC;UAExFqD,QAAQ,CAAC3C,IAAI,CAACiD,OAAO,CAAC;QAC1B;MACJ;MAEA,IAAIN,QAAQ,CAAC3G,MAAM,GAAG,CAAC,EAAE;QACrB,MAAMyF,QAAQ,CAACE,KAAK,CAAC,CAAC,CAAC,CAACW,IAAI,CAAC,IAAI,CAAC,CAACR,KAAK,CAACa,QAAQ,CAAC;MACtD;MAEA,MAAMW,IAAI,GAAGzL,MAAM,CAAC,CAAC;MACrB,MAAM4L,UAAU,GAAG3L,IAAI,CAACG,IAAI,CAAE,cAAaqL,IAAK,OAAM,CAAC;MAEvD,MAAM7B,QAAQ,CAAC8B,WAAW,CAACE,UAAU,CAAC;MACtCtG,OAAO,CAACC,GAAG,CAACtF,IAAI,CAACG,IAAI,CAAC,YAAY,EAAEqL,IAAI,GAAG,OAAO,CAAC,CAAC;MACpD5K,oBAAoB,CAACZ,IAAI,CAACG,IAAI,CAAC,YAAY,EAAEqL,IAAI,GAAG,OAAO,CAAC,CAAC;MAC7D,OAAOlJ,GAAG,CAACsJ,QAAQ,CAAC5L,IAAI,CAACG,IAAI,CAAC,YAAY,EAAEqL,IAAI,GAAG,OAAO,CAAC,CAAC;IAChE,CAAC,CAAC,OAAOpG,GAAG,EAAE;MACVC,OAAO,CAACC,GAAG,CAAC,oCAAoC,EAAEF,GAAG,CAAC;MACtD,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;EACF;EACAxD,MAAM,CAAC0C,IAAI,CAAC,mBAAmB,EAAEpB,mBAAmB,EAAE,OAAOU,GAAG,EAAEW,GAAG,KAAK;IACtE,IAAI;MACA,MAAMG,IAAI,GAAGd,GAAG,CAACe,OAAO,CAACD,IAAI;MAC7B,MAAMF,IAAI,GAAGZ,GAAG,CAACa,IAAI,CAAC,CAAC;;MAEvB;MACA,IAAIC,IAAI,CAACiC,GAAG,CAAC,CAAC,CAAC,EAAE;QACbuO,OAAO,GAAG,MAAM9Q,MAAM,CACjBQ,EAAE,CAACF,IAAI,CAAC+B,GAAG,CAAC,CACZ5B,UAAU,CAACL,IAAI,CAACU,KAAK,GAAG,YAAY,CAAC,CACrCJ,OAAO,CACJ;UACIE,IAAI,EAAER,IAAI,CAACO,GAAG;UACdyJ,WAAW,EAAEhK,IAAI,CAACiK;QACtB,CAAC,EACD;UACIlI,UAAU,EAAE;YACRuE,OAAO,EAAE;UACb;QACJ,CACJ,CAAC;QACL,IAAItG,IAAI,CAAC2Q,KAAK,IAAID,OAAO,CAACpK,OAAO,EAAE;UAC/B,IAAIsK,OAAO,GAAG,EAAE;UAChB,KAAK,MAAMrL,CAAC,IAAImL,OAAO,CAACpK,OAAO,CAACtG,IAAI,CAAC2Q,KAAK,CAAC,EAAE;YACzCC,OAAO,CAACjL,IAAI,CAAC,MAAM7H,MAAM,CAAC+S,8BAA8B,CAACtL,CAAC,CAAC,CAAC;UAChE;UAEA,OAAOxF,GAAG,CAAC2C,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAACiO,OAAO,CAAC;QACxC,CAAC,MAAM,OAAO7Q,GAAG,CAAC2C,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC,CAAC;MACxC,CAAC,MAAM;QACH,OAAO5C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC;MAChC;IACJ,CAAC,CAAC,OAAOiC,GAAG,EAAE;MACVC,OAAO,CAACC,GAAG,CAAC,uCAAuC,EAAEF,GAAG,CAAC;MACzD,OAAO9C,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC;IAC9B;EACJ,CAAC,CAAC;EAEF,OAAOxD,MAAM;AACjB;AAEA0T,MAAM,CAACC,OAAO,GAAGpR,eAAe","ignoreList":[]}},"mtime":1719560456458},"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\project\\\\web\\\\newCDRL-1\\\\backend\\\\router\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\project\\\\web\\\\newCDRL-1\",\"filename\":\"D:\\\\project\\\\web\\\\newCDRL-1\\\\backend\\\\router\\\\depRouters.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\project\\\\web\\\\newCDRL-1\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.24.3:development":{"value":{"code":"const express = require('express');\nconst router = express.Router();\nconst server = require('../lib/csdl_google_lib');\nconst {\n  checkIfUserLoginRoute,\n  sortStudentName\n} = require('../lib/function_lib');\nconst {\n  getNameGlobal\n} = require('../lib/mogodb_lib');\nconst {\n  ObjectId\n} = require('mongodb');\nconst name_global_databases = getNameGlobal();\n// doan khoa route\nfunction createDepRouter(client) {\n  // quan li bo mon - doan khoa route\n  router.get('/quanlibomon', checkIfUserLoginRoute, async (req, res) => {\n    const user = req.session.user;\n\n    // get all branch of department:\n    const branchs = await client.db(name_global_databases).collection('branchs').find({\n      dep: user.dep\n    },\n    // find all data\n    {\n      projection: {\n        _id: 0,\n        name: 1\n      }\n    }).toArray();\n\n    // get department name:\n    const dep_name = await client.db(name_global_databases).collection('deps').findOne({\n      _id: user.dep\n    },\n    // find all data\n    {\n      projection: {\n        _id: 0,\n        name: 1\n      }\n    });\n    return res.render('doankhoa-manage-departments', {\n      header: 'global-header',\n      footer: 'global-footer',\n      menu: 'doankhoa-menu',\n      thongbao: 'global-notifications',\n      dep: dep_name.name,\n      // every branch have same department\n      branchs: branchs\n    });\n  });\n\n  // quan li lop - doan khoa route\n  router.get('/quanlilop', checkIfUserLoginRoute, async (req, res) => {\n    const user = req.session.user;\n\n    // get all branch of department:\n    const branchs = await client.db(name_global_databases).collection('branchs').find({\n      dep: user.dep\n    },\n    // find all data\n    {\n      projection: {\n        name: 1\n      }\n    }).toArray();\n    let curr_load_branch;\n    // get all classes of branchs:\n    let classes = {}; // classes = {KTPM: [KTPM0121, KTPM0108, ...], CNTT: [CNTT0109, CNTT0209, ...], ...}\n    let class_teachers = []; // class_teachers = [18102003, 19112003, ...]\n    for (let i = 0; i < branchs.length; i++) {\n      let dummy = await client.db(name_global_databases).collection('classes').find({\n        branch: branchs[i]._id\n      },\n      // find all data\n      {\n        projection: {\n          cvht: 1\n        }\n      }).toArray();\n      classes[branchs[i]._id] = dummy.map(cls => cls._id);\n      class_teachers.push(...dummy.map(cls => cls.cvht));\n\n      // set current load branch to i\n      curr_load_branch = i + 1;\n      // finish load one brach then check does number of classes over 30.\n      if (class_teachers.length >= 30) {\n        break;\n      }\n    }\n    // get all teacher's name in current department\n    const teachers = await client.db(name_global_databases).collection('user_info').find({\n      'power.1': {\n        $exists: true\n      },\n      'power.4': {\n        $exists: true\n      },\n      $or: [{\n        branch: {\n          $in: branchs.map(branch => branch._id)\n        }\n      }, {\n        branch: ObjectId.createFromHexString('650985a345e2e896b37efd4f')\n      }]\n    },\n    // user is teacher\n    {\n      projection: {\n        first_name: 1,\n        last_name: 1\n      }\n    }).toArray();\n\n    // get all teacher's name of classes\n    for (let i = 0; i < class_teachers.length; i++) {\n      // replace current teacher's _id with teacher's name\n      class_teachers[i] = await client.db(name_global_databases).collection('user_info').findOne({\n        _id: class_teachers[i],\n        'power.1': {\n          $exists: true\n        },\n        'power.4': {\n          $exists: true\n        }\n      },\n      // user is teacher\n      {\n        projection: {\n          first_name: 1,\n          last_name: 1\n        }\n      });\n    }\n    return res.render('doankhoa-manage-classes', {\n      header: 'global-header',\n      footer: 'global-footer',\n      menu: 'doankhoa-menu',\n      thongbao: 'global-notifications',\n      dep_name: user.dep,\n      branchs: branchs,\n      classes: classes,\n      teachers: teachers.map(teacher => teacher.last_name + ' ' + teacher.first_name),\n      teachers_id: teachers.map(teacher => teacher._id),\n      class_teachers: class_teachers,\n      curr_load_branch: curr_load_branch\n    });\n  });\n\n  // danh sach bang diem khoa route\n  router.get('/danhsachbangdiem', checkIfUserLoginRoute, async (req, res) => {\n    try {\n      const user = req.session.user;\n      const school_year = await client.db(name_global_databases).collection('school_year').findOne({}, {\n        projection: {\n          _id: 0,\n          year: 1\n        }\n      });\n      // check user login:\n      if (user.pow[2]) {\n        // get all branch of department:\n        let branch_list = await client.db(name_global_databases).collection('branchs').find({\n          dep: user.dep\n        }, {\n          projection: {\n            _id: 1,\n            name: 1\n          }\n        }).toArray();\n        const classlist = await client.db(name_global_databases).collection('classes').find({\n          branch: {\n            $in: branch_list.map(branch => branch._id)\n          }\n        }, {\n          projection: {\n            _id: 1,\n            branch: 1\n          }\n        }).toArray();\n        const years = await client.db(name_global_databases).collection('classes').findOne({\n          _id: classlist[0]._id\n        }, {\n          projection: {\n            _id: 0,\n            years: 1\n          }\n        });\n        console.log(years);\n        // get all student in staff member class:\n        let student_list = await client.db(name_global_databases).collection('user_info').find({\n          class: classlist[0]._id,\n          'power.0': {\n            $exists: true\n          }\n        }, {\n          projection: {\n            first_name: 1,\n            last_name: 1,\n            total_score: 1\n          }\n        }).toArray();\n        student_list = sortStudentName(student_list);\n        console.log('curr', classlist[0]._id);\n        // get all student total score from themself:\n        let render = {\n          header: 'global-header',\n          footer: 'global-footer',\n          thongbao: 'global-notifications',\n          menu: 'doankhoa-menu',\n          staff_name: [],\n          student_list: student_list,\n          cls: classlist,\n          years: years.years,\n          curr_year: school_year.year,\n          curr_clss: classlist[0]._id,\n          branch: branch_list\n        };\n        return res.render('doankhoa-grade-list', render);\n      } else {\n        // user not staff members\n        // redirect to home\n        return res.redirect('/');\n      }\n    } catch (e) {\n      console.log('SYSTEM | DOAN_KHOA_DANH_SACH_BANG_DIEM | ERROR | ', e);\n    }\n  });\n\n  //quan li co van - doan khoa route\n  router.get('/quanlicv', checkIfUserLoginRoute, async (req, res) => {\n    try {\n      const user = req.session.user;\n\n      // get all branch of department\n      const all_branchs = await client.db(name_global_databases).collection('branchs').find({\n        dep: user.dep\n      }, {\n        projection: {\n          name: 1\n        }\n      }).toArray();\n      // get user name and class in dep\n      const teachers = await client.db(name_global_databases).collection('user_info').find({\n        'power.1': {\n          $exists: true\n        },\n        'power.4': {\n          $exists: true\n        },\n        'power.999': {\n          $exists: false\n        },\n        $or: [{\n          branch: {\n            $in: all_branchs.map(branch => branch._id)\n          }\n        }, {\n          branch: ObjectId.createFromHexString('650985a345e2e896b37efd4f')\n        }]\n      },\n      // user is teacher\n      {\n        projection: {\n          first_name: 1,\n          last_name: 1,\n          class: 1,\n          branch: 1\n        }\n      }).toArray();\n      let branch_list = [];\n      for (let i = 0; i < teachers.length; i++) {\n        const branch = await client.db(name_global_databases).collection('branchs').findOne({\n          _id: teachers[i].branch\n        }, {\n          projection: {\n            _id: 0,\n            name: 1\n          }\n        });\n        branch_list.push(branch.name);\n      }\n      return res.render('doankhoa-manage-teacher', {\n        header: 'global-header',\n        footer: 'global-footer',\n        thongbao: 'global-notifications',\n        menu: 'doankhoa-menu',\n        teachers: teachers,\n        branchs: branch_list,\n        all_branchs: all_branchs\n      });\n    } catch (err) {\n      console.log('SYSTEM | DOAN_KHOA_QUAN_LY_CO_VAN_ROUTE | ERROR | ', err);\n      return res.sendStatus(500);\n    }\n  });\n\n  // Quan li hoat dong khoa route\n  router.get('/quanlihoatdongkhoa', checkIfUserLoginRoute, async (req, res) => {\n    const user = req.session.user;\n    const school_year = await client.db(name_global_databases).collection('school_year').findOne({}, {\n      projection: {\n        _id: 0,\n        year: 1\n      }\n    });\n    // check user login:\n    if (user.pow[3] && user.pow[11]) {\n      let branch_list = await client.db(name_global_databases).collection('branchs').find({\n        dep: user.dep\n      }, {\n        projection: {\n          _id: 1,\n          name: 1\n        }\n      }).toArray();\n      const classlist = await client.db(name_global_databases).collection('classes').find({\n        branch: {\n          $in: branch_list.map(branch => branch._id)\n        }\n      }, {\n        projection: {\n          _id: 1,\n          branch: 1\n        }\n      }).toArray();\n      const years = await client.db(name_global_databases).collection('classes').findOne({\n        _id: classlist[0]._id\n      }, {\n        projection: {\n          _id: 0,\n          years: 1\n        }\n      });\n\n      // get all activities of school\n      const school_atv = await client.db(name_global_databases).collection('activities').find({\n        year: school_year.year\n      }, {\n        projection: {\n          name: 1,\n          content: 1,\n          year: 1,\n          start_time: 1\n        }\n      }).limit(10).toArray();\n\n      // get all activities of dep\n      const dep_atv = await client.db(user.dep).collection('activities').find({\n        year: school_year.year\n      }, {\n        projection: {\n          name: 1,\n          content: 1,\n          year: 1,\n          start_time: 1\n        }\n      }).limit(10).toArray();\n\n      // get all activities of class of department\n      const collections = await client.db(user.dep).listCollections().toArray();\n\n      // Filter collections ending with '_activities'\n      const activityCollections = collections.filter(collection => collection.name.endsWith('_activities'));\n\n      // Loop through activity collections and retrieve all documents\n      const cls_atvs = await activityCollections.map(async collection => {\n        const dummy = await client.db(user.dep).collection(collection.name).find({\n          year: school_year.year\n        }, {\n          projection: {\n            name: 1,\n            content: 1,\n            cls: 1,\n            year: 1,\n            start_time: 1\n          }\n        }).limit(10).toArray();\n        return dummy;\n      });\n      Promise.all(cls_atvs).then(results => {\n        // Khi tất cả các promise đã hoàn thành, results sẽ là một mảng chứa kết quả từ mỗi truy vấn.\n        // Bạn có thể làm gì đó với kết quả ở đây.\n        const cls_atv = [].concat(...results); // Kết hợp kết quả từ các truy vấn vào một mảng duy nhất\n        return res.render('doankhoa-manage-activities', {\n          header: 'global-header',\n          footer: 'global-footer',\n          thongbao: 'global-notifications',\n          menu: 'doankhoa-menu',\n          cls: classlist,\n          years: years.years,\n          curr_year: school_year.year,\n          branch: branch_list,\n          school_atv: school_atv,\n          dep_atv: dep_atv,\n          cls_atv: cls_atv\n        });\n      }).catch(error => {\n        // Xử lý lỗi nếu có\n        console.log(error);\n      });\n    } else {\n      return res.sendStatus(403);\n    }\n  });\n\n  // danh sach sinh vien route\n  router.get('/danhsachsinhvien', checkIfUserLoginRoute, async (req, res) => {\n    const user = req.session.user;\n    if (user.pow[4] || user.pow[7]) {\n      // get all branch of department:\n      const branchs = await client.db(name_global_databases).collection('branchs').find({\n        dep: user.dep\n      },\n      // find all data\n      {\n        projection: {\n          _id: 1\n        }\n      }).toArray();\n\n      // get all classes of department\n      let classes = []; // class_teachers = [18102003, 19112003, (class_ids) ...]\n      for (let i = 0; i < branchs.length; i++) {\n        let dummy = await client.db(name_global_databases).collection('classes').find({\n          branch: branchs[i]._id\n        },\n        // find all data\n        {\n          projection: {\n            _id: 1\n          }\n        }).toArray();\n        classes.push(...dummy.map(cls => cls._id));\n      }\n      return res.render('doankhoa-student-list', {\n        header: 'global-header',\n        footer: 'global-footer',\n        thongbao: 'global-notifications',\n        menu: 'doankhoa-menu',\n        classes: classes\n      });\n    } else {\n      return res.redirect('/');\n    }\n  });\n\n  // doan khoa nhap diem route\n  router.get('/nhapdiemdanhgia', checkIfUserLoginRoute, async (req, res) => {\n    try {\n      const user = req.session.user;\n      const mssv = req.query.studentId;\n      const cls = req.query.class;\n      const schoolYearParam = req.query.schoolYear;\n      const studentTotalScore = await client.db(user.dep).collection(cls + '_std_table').findOne({\n        mssv: mssv,\n        school_year: schoolYearParam\n      }, {\n        projection: {\n          _id: 0,\n          first: 1,\n          second: 1,\n          third: 1,\n          fourth: 1,\n          fifth: 1,\n          total: 1,\n          img_ids: 1\n        }\n      });\n      let stfTotalScore = await client.db(user.dep).collection(cls + '_stf_table').findOne({\n        mssv: mssv,\n        school_year: schoolYearParam\n      }, {\n        projection: {\n          _id: 0,\n          first: 1,\n          second: 1,\n          third: 1,\n          fourth: 1,\n          fifth: 1,\n          total: 1\n        }\n      });\n      let depTotalScore = await client.db(user.dep).collection(cls + '_dep_table').findOne({\n        mssv: mssv,\n        school_year: schoolYearParam\n      }, {\n        projection: {\n          _id: 0,\n          first: 1,\n          second: 1,\n          third: 1,\n          fourth: 1,\n          fifth: 1,\n          total: 1\n        }\n      });\n      nulltable = {\n        fifth: [0, 0, 0, 0],\n        first: [0, 0, 0, 0, 0],\n        fourth: [0, 0, 0],\n        second: [0, 0],\n        third: [0, 0, 0],\n        total: 0\n      };\n      if (!stfTotalScore) {\n        stfTotalScore = nulltable;\n      }\n      if (!depTotalScore) {\n        depTotalScore = nulltable;\n      }\n      let link_img = [];\n      if (studentTotalScore && studentTotalScore.img_ids) {\n        for (const [key, value] of Object.entries(studentTotalScore.img_ids)) {\n          if (key == 'global') {\n            for (const i of value) {\n              link_img.push(await server.getDriveFileLinkAndDescription(i));\n            }\n          } else {\n            let activitie_info;\n            activitie_info = await client.db(user.dep).collection(`${cls}_activities`).findOne({\n              _id: key\n            }, {\n              projection: {\n                name: 1\n              }\n            });\n            if (!activitie_info) {\n              activitie_info = await client.db(user.dep).collection('activities').findOne({\n                _id: key\n              }, {\n                projection: {\n                  name: 1\n                }\n              });\n              if (!activitie_info) {\n                activitie_info = await client.db(name_global_databases).collection('activities').findOne({\n                  _id: key\n                }, {\n                  projection: {\n                    name: 1\n                  }\n                });\n              }\n            }\n            for (const i of value) {\n              let imginfo = await server.getDriveFileLinkAndDescription(i);\n              if (imginfo) {\n                imginfo.fileDescription = activitie_info.name + '-' + imginfo.fileDescription;\n                link_img.push(imginfo);\n              }\n            }\n          }\n        }\n        return res.render('doankhoa-manage-grades', {\n          header: 'global-header',\n          thongbao: 'global-notifications',\n          footer: 'global-footer',\n          menu: 'doankhoa-menu',\n          img: link_img,\n          Scorestd: studentTotalScore,\n          Score: stfTotalScore,\n          Scorek: depTotalScore\n        });\n      } else {\n        return res.sendStatus(404);\n      }\n    } catch (err) {\n      console.log('SYSTEM | DOAN_KHOA_NHAP_DIEM_ROUTE | ERROR | ', err);\n      return res.status(500).json({\n        error: 'Lỗi hệ thống'\n      });\n    }\n  });\n\n  // doan khoa thoi han cham diem route\n  router.get('/thoihan', checkIfUserLoginRoute, async (req, res) => {\n    const curr_date = new Date();\n    const school_year = await client.db(name_global_databases).collection('school_year').findOne({}, {\n      projection: {\n        year: 1,\n        start_day: 1,\n        end_day: 1\n      }\n    });\n\n    // set cbx text\n    let cbx = 'Đang diễn ra';\n    if (school_year.start_day <= curr_date && (curr_date <= school_year.end_day || school_year.end_day.toISOString() == '2003-10-18T00:00:00.000Z')) {\n      cbx = 'Đang diễn ra';\n    } else if (school_year.start_day > curr_date) {\n      cbx = 'Sắp diễn ra';\n    } else if (curr_date > school_year.end_day) {\n      cbx = 'Đã kết thúc';\n    }\n\n    // check if end day is forever or not\n    if (school_year.end_day.toISOString() == '2003-10-18T00:00:00.000Z') {\n      school_year.end_day = undefined;\n    }\n    return res.render('doankhoa-time', {\n      header: 'global-header',\n      footer: 'global-footer',\n      thongbao: 'global-notifications',\n      menu: 'doankhoa-menu',\n      school_year: school_year,\n      cbx: cbx\n    });\n  });\n\n  // chi tiet hoat dong ------------------------------------------------------------------------------------------\n  // school\n  router.get('/quanlihoatdong/:level/:id', checkIfUserLoginRoute, async (req, res) => {\n    const user = req.session.user;\n    try {\n      if (user.pow[3]) {\n        // get id by req.params.id\n        // identify current activity of school activities\n        let curr_act;\n        switch (req.params.level) {\n          case 'Truong':\n            curr_act = await client.db(name_global_databases).collection('activities').findOne({\n              _id: req.params.id\n            });\n            break;\n          case 'Khoa':\n            curr_act = await client.db(user.dep).collection('activities').findOne({\n              _id: req.params.id\n            });\n            break;\n          default:\n            curr_act = await client.db(user.dep).collection(req.params.level + '_activities').findOne({\n              _id: req.params.id\n            });\n            break;\n        }\n        // get all students information joined current activity\n        let students_data = [];\n        let bonus_true;\n        let all_true = true; // check does all student is yes or not\n        if (curr_act.student_list) {\n          for (const [key, value] of Object.entries(curr_act.student_list)) {\n            const data = await client.db(name_global_databases).collection('user_info').findOne({\n              _id: key\n            }, {\n              projection: {\n                displayName: 1,\n                class: 1\n              }\n            });\n            if (data) {\n              students_data.push(data);\n            } else {\n              students_data.push({\n                _id: 'none',\n                displayName: 'none',\n                class: ['none']\n              });\n            }\n            if (value == 1) {\n              // have one student not have bonus\n              bonus_true = false;\n            }\n            if (value == 0) {\n              // have one student not aproval yet\n              all_true = false;\n              bonus_true = false;\n            }\n          }\n        }\n        return res.render('doankhoa-activity-assessment', {\n          header: 'global-header',\n          thongbao: 'global-notifications',\n          footer: 'global-footer',\n          menu: 'doankhoa-menu',\n          curr_act: curr_act,\n          students_data: students_data,\n          all_true: all_true,\n          bonus_true: bonus_true,\n          idact: req.params.id\n        });\n      } else {\n        return res.redirect('/');\n      }\n    } catch (err) {\n      console.log('SYSTEM | REVIEWS_ACTIVITY | ERROR | ', err);\n      res.sendStatus(500);\n    }\n  });\n  // -------------------------------------------------------------------------------------------\n\n  return router;\n}\nmodule.exports = createDepRouter;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIlJvdXRlciIsInNlcnZlciIsImNoZWNrSWZVc2VyTG9naW5Sb3V0ZSIsInNvcnRTdHVkZW50TmFtZSIsImdldE5hbWVHbG9iYWwiLCJPYmplY3RJZCIsIm5hbWVfZ2xvYmFsX2RhdGFiYXNlcyIsImNyZWF0ZURlcFJvdXRlciIsImNsaWVudCIsImdldCIsInJlcSIsInJlcyIsInVzZXIiLCJzZXNzaW9uIiwiYnJhbmNocyIsImRiIiwiY29sbGVjdGlvbiIsImZpbmQiLCJkZXAiLCJwcm9qZWN0aW9uIiwiX2lkIiwibmFtZSIsInRvQXJyYXkiLCJkZXBfbmFtZSIsImZpbmRPbmUiLCJyZW5kZXIiLCJoZWFkZXIiLCJmb290ZXIiLCJtZW51IiwidGhvbmdiYW8iLCJjdXJyX2xvYWRfYnJhbmNoIiwiY2xhc3NlcyIsImNsYXNzX3RlYWNoZXJzIiwiaSIsImxlbmd0aCIsImR1bW15IiwiYnJhbmNoIiwiY3ZodCIsIm1hcCIsImNscyIsInB1c2giLCJ0ZWFjaGVycyIsIiRleGlzdHMiLCIkb3IiLCIkaW4iLCJjcmVhdGVGcm9tSGV4U3RyaW5nIiwiZmlyc3RfbmFtZSIsImxhc3RfbmFtZSIsInRlYWNoZXIiLCJ0ZWFjaGVyc19pZCIsInNjaG9vbF95ZWFyIiwieWVhciIsInBvdyIsImJyYW5jaF9saXN0IiwiY2xhc3NsaXN0IiwieWVhcnMiLCJjb25zb2xlIiwibG9nIiwic3R1ZGVudF9saXN0IiwiY2xhc3MiLCJ0b3RhbF9zY29yZSIsInN0YWZmX25hbWUiLCJjdXJyX3llYXIiLCJjdXJyX2Nsc3MiLCJyZWRpcmVjdCIsImUiLCJhbGxfYnJhbmNocyIsImVyciIsInNlbmRTdGF0dXMiLCJzY2hvb2xfYXR2IiwiY29udGVudCIsInN0YXJ0X3RpbWUiLCJsaW1pdCIsImRlcF9hdHYiLCJjb2xsZWN0aW9ucyIsImxpc3RDb2xsZWN0aW9ucyIsImFjdGl2aXR5Q29sbGVjdGlvbnMiLCJmaWx0ZXIiLCJlbmRzV2l0aCIsImNsc19hdHZzIiwiUHJvbWlzZSIsImFsbCIsInRoZW4iLCJyZXN1bHRzIiwiY2xzX2F0diIsImNvbmNhdCIsImNhdGNoIiwiZXJyb3IiLCJtc3N2IiwicXVlcnkiLCJzdHVkZW50SWQiLCJzY2hvb2xZZWFyUGFyYW0iLCJzY2hvb2xZZWFyIiwic3R1ZGVudFRvdGFsU2NvcmUiLCJmaXJzdCIsInNlY29uZCIsInRoaXJkIiwiZm91cnRoIiwiZmlmdGgiLCJ0b3RhbCIsImltZ19pZHMiLCJzdGZUb3RhbFNjb3JlIiwiZGVwVG90YWxTY29yZSIsIm51bGx0YWJsZSIsImxpbmtfaW1nIiwia2V5IiwidmFsdWUiLCJPYmplY3QiLCJlbnRyaWVzIiwiZ2V0RHJpdmVGaWxlTGlua0FuZERlc2NyaXB0aW9uIiwiYWN0aXZpdGllX2luZm8iLCJpbWdpbmZvIiwiZmlsZURlc2NyaXB0aW9uIiwiaW1nIiwiU2NvcmVzdGQiLCJTY29yZSIsIlNjb3JlayIsInN0YXR1cyIsImpzb24iLCJjdXJyX2RhdGUiLCJEYXRlIiwic3RhcnRfZGF5IiwiZW5kX2RheSIsImNieCIsInRvSVNPU3RyaW5nIiwidW5kZWZpbmVkIiwiY3Vycl9hY3QiLCJwYXJhbXMiLCJsZXZlbCIsImlkIiwic3R1ZGVudHNfZGF0YSIsImJvbnVzX3RydWUiLCJhbGxfdHJ1ZSIsImRhdGEiLCJkaXNwbGF5TmFtZSIsImlkYWN0IiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiRDpcXHByb2plY3RcXHdlYlxcbmV3Q0RSTC0xXFxiYWNrZW5kXFxyb3V0ZXJcXCIsInNvdXJjZXMiOlsiZGVwUm91dGVycy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBleHByZXNzID0gcmVxdWlyZSgnZXhwcmVzcycpO1xyXG5jb25zdCByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpO1xyXG5jb25zdCBzZXJ2ZXIgPSByZXF1aXJlKCcuLi9saWIvY3NkbF9nb29nbGVfbGliJyk7XHJcbmNvbnN0IHsgY2hlY2tJZlVzZXJMb2dpblJvdXRlLCBzb3J0U3R1ZGVudE5hbWUgfSA9IHJlcXVpcmUoJy4uL2xpYi9mdW5jdGlvbl9saWInKTtcclxuY29uc3QgeyBnZXROYW1lR2xvYmFsIH0gPSByZXF1aXJlKCcuLi9saWIvbW9nb2RiX2xpYicpO1xyXG5jb25zdCB7IE9iamVjdElkIH0gPSByZXF1aXJlKCdtb25nb2RiJyk7XHJcblxyXG5jb25zdCBuYW1lX2dsb2JhbF9kYXRhYmFzZXMgPSBnZXROYW1lR2xvYmFsKCk7XHJcbi8vIGRvYW4ga2hvYSByb3V0ZVxyXG5mdW5jdGlvbiBjcmVhdGVEZXBSb3V0ZXIoY2xpZW50KSB7XHJcbiAgICAvLyBxdWFuIGxpIGJvIG1vbiAtIGRvYW4ga2hvYSByb3V0ZVxyXG4gICAgcm91dGVyLmdldCgnL3F1YW5saWJvbW9uJywgY2hlY2tJZlVzZXJMb2dpblJvdXRlLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICAgICAgICBjb25zdCB1c2VyID0gcmVxLnNlc3Npb24udXNlcjtcclxuXHJcbiAgICAgICAgLy8gZ2V0IGFsbCBicmFuY2ggb2YgZGVwYXJ0bWVudDpcclxuICAgICAgICBjb25zdCBicmFuY2hzID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdicmFuY2hzJylcclxuICAgICAgICAgICAgLmZpbmQoXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVwOiB1c2VyLmRlcCxcclxuICAgICAgICAgICAgICAgIH0sIC8vIGZpbmQgYWxsIGRhdGFcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9qZWN0aW9uOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogMSxcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAudG9BcnJheSgpO1xyXG5cclxuICAgICAgICAvLyBnZXQgZGVwYXJ0bWVudCBuYW1lOlxyXG4gICAgICAgIGNvbnN0IGRlcF9uYW1lID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdkZXBzJylcclxuICAgICAgICAgICAgLmZpbmRPbmUoXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2lkOiB1c2VyLmRlcCxcclxuICAgICAgICAgICAgICAgIH0sIC8vIGZpbmQgYWxsIGRhdGFcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9qZWN0aW9uOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogMSxcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHJlcy5yZW5kZXIoJ2RvYW5raG9hLW1hbmFnZS1kZXBhcnRtZW50cycsIHtcclxuICAgICAgICAgICAgaGVhZGVyOiAnZ2xvYmFsLWhlYWRlcicsXHJcbiAgICAgICAgICAgIGZvb3RlcjogJ2dsb2JhbC1mb290ZXInLFxyXG4gICAgICAgICAgICBtZW51OiAnZG9hbmtob2EtbWVudScsXHJcbiAgICAgICAgICAgIHRob25nYmFvOiAnZ2xvYmFsLW5vdGlmaWNhdGlvbnMnLFxyXG4gICAgICAgICAgICBkZXA6IGRlcF9uYW1lLm5hbWUsIC8vIGV2ZXJ5IGJyYW5jaCBoYXZlIHNhbWUgZGVwYXJ0bWVudFxyXG4gICAgICAgICAgICBicmFuY2hzOiBicmFuY2hzLFxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gcXVhbiBsaSBsb3AgLSBkb2FuIGtob2Egcm91dGVcclxuICAgIHJvdXRlci5nZXQoJy9xdWFubGlsb3AnLCBjaGVja0lmVXNlckxvZ2luUm91dGUsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgICAgIGNvbnN0IHVzZXIgPSByZXEuc2Vzc2lvbi51c2VyO1xyXG5cclxuICAgICAgICAvLyBnZXQgYWxsIGJyYW5jaCBvZiBkZXBhcnRtZW50OlxyXG4gICAgICAgIGNvbnN0IGJyYW5jaHMgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ2JyYW5jaHMnKVxyXG4gICAgICAgICAgICAuZmluZChcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBkZXA6IHVzZXIuZGVwLFxyXG4gICAgICAgICAgICAgICAgfSwgLy8gZmluZCBhbGwgZGF0YVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHByb2plY3Rpb246IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogMSxcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAudG9BcnJheSgpO1xyXG5cclxuICAgICAgICBsZXQgY3Vycl9sb2FkX2JyYW5jaDtcclxuICAgICAgICAvLyBnZXQgYWxsIGNsYXNzZXMgb2YgYnJhbmNoczpcclxuICAgICAgICBsZXQgY2xhc3NlcyA9IHt9OyAvLyBjbGFzc2VzID0ge0tUUE06IFtLVFBNMDEyMSwgS1RQTTAxMDgsIC4uLl0sIENOVFQ6IFtDTlRUMDEwOSwgQ05UVDAyMDksIC4uLl0sIC4uLn1cclxuICAgICAgICBsZXQgY2xhc3NfdGVhY2hlcnMgPSBbXTsgLy8gY2xhc3NfdGVhY2hlcnMgPSBbMTgxMDIwMDMsIDE5MTEyMDAzLCAuLi5dXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBicmFuY2hzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGxldCBkdW1teSA9IGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdjbGFzc2VzJylcclxuICAgICAgICAgICAgICAgIC5maW5kKFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJhbmNoOiBicmFuY2hzW2ldLl9pZCxcclxuICAgICAgICAgICAgICAgICAgICB9LCAvLyBmaW5kIGFsbCBkYXRhXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9qZWN0aW9uOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdmh0OiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAudG9BcnJheSgpO1xyXG5cclxuICAgICAgICAgICAgY2xhc3Nlc1ticmFuY2hzW2ldLl9pZF0gPSBkdW1teS5tYXAoKGNscykgPT4gY2xzLl9pZCk7XHJcbiAgICAgICAgICAgIGNsYXNzX3RlYWNoZXJzLnB1c2goLi4uZHVtbXkubWFwKChjbHMpID0+IGNscy5jdmh0KSk7XHJcblxyXG4gICAgICAgICAgICAvLyBzZXQgY3VycmVudCBsb2FkIGJyYW5jaCB0byBpXHJcbiAgICAgICAgICAgIGN1cnJfbG9hZF9icmFuY2ggPSBpICsgMTtcclxuICAgICAgICAgICAgLy8gZmluaXNoIGxvYWQgb25lIGJyYWNoIHRoZW4gY2hlY2sgZG9lcyBudW1iZXIgb2YgY2xhc3NlcyBvdmVyIDMwLlxyXG4gICAgICAgICAgICBpZiAoY2xhc3NfdGVhY2hlcnMubGVuZ3RoID49IDMwKSB7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBnZXQgYWxsIHRlYWNoZXIncyBuYW1lIGluIGN1cnJlbnQgZGVwYXJ0bWVudFxyXG4gICAgICAgIGNvbnN0IHRlYWNoZXJzID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgIC5jb2xsZWN0aW9uKCd1c2VyX2luZm8nKVxyXG4gICAgICAgICAgICAuZmluZChcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAncG93ZXIuMSc6IHsgJGV4aXN0czogdHJ1ZSB9LFxyXG4gICAgICAgICAgICAgICAgICAgICdwb3dlci40JzogeyAkZXhpc3RzOiB0cnVlIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgJG9yOiBbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHsgYnJhbmNoOiB7ICRpbjogYnJhbmNocy5tYXAoKGJyYW5jaCkgPT4gYnJhbmNoLl9pZCkgfSB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7IGJyYW5jaDogT2JqZWN0SWQuY3JlYXRlRnJvbUhleFN0cmluZygnNjUwOTg1YTM0NWUyZTg5NmIzN2VmZDRmJykgfSxcclxuICAgICAgICAgICAgICAgICAgICBdLFxyXG4gICAgICAgICAgICAgICAgfSwgLy8gdXNlciBpcyB0ZWFjaGVyXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJvamVjdGlvbjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaXJzdF9uYW1lOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYXN0X25hbWU6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICAgICAgLnRvQXJyYXkoKTtcclxuXHJcbiAgICAgICAgLy8gZ2V0IGFsbCB0ZWFjaGVyJ3MgbmFtZSBvZiBjbGFzc2VzXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjbGFzc190ZWFjaGVycy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAvLyByZXBsYWNlIGN1cnJlbnQgdGVhY2hlcidzIF9pZCB3aXRoIHRlYWNoZXIncyBuYW1lXHJcbiAgICAgICAgICAgIGNsYXNzX3RlYWNoZXJzW2ldID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ3VzZXJfaW5mbycpXHJcbiAgICAgICAgICAgICAgICAuZmluZE9uZShcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogY2xhc3NfdGVhY2hlcnNbaV0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICdwb3dlci4xJzogeyAkZXhpc3RzOiB0cnVlIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICdwb3dlci40JzogeyAkZXhpc3RzOiB0cnVlIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgfSwgLy8gdXNlciBpcyB0ZWFjaGVyXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9qZWN0aW9uOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJzdF9uYW1lOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdF9uYW1lOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHJlcy5yZW5kZXIoJ2RvYW5raG9hLW1hbmFnZS1jbGFzc2VzJywge1xyXG4gICAgICAgICAgICBoZWFkZXI6ICdnbG9iYWwtaGVhZGVyJyxcclxuICAgICAgICAgICAgZm9vdGVyOiAnZ2xvYmFsLWZvb3RlcicsXHJcbiAgICAgICAgICAgIG1lbnU6ICdkb2Fua2hvYS1tZW51JyxcclxuICAgICAgICAgICAgdGhvbmdiYW86ICdnbG9iYWwtbm90aWZpY2F0aW9ucycsXHJcbiAgICAgICAgICAgIGRlcF9uYW1lOiB1c2VyLmRlcCxcclxuICAgICAgICAgICAgYnJhbmNoczogYnJhbmNocyxcclxuICAgICAgICAgICAgY2xhc3NlczogY2xhc3NlcyxcclxuICAgICAgICAgICAgdGVhY2hlcnM6IHRlYWNoZXJzLm1hcCgodGVhY2hlcikgPT4gdGVhY2hlci5sYXN0X25hbWUgKyAnICcgKyB0ZWFjaGVyLmZpcnN0X25hbWUpLFxyXG4gICAgICAgICAgICB0ZWFjaGVyc19pZDogdGVhY2hlcnMubWFwKCh0ZWFjaGVyKSA9PiB0ZWFjaGVyLl9pZCksXHJcbiAgICAgICAgICAgIGNsYXNzX3RlYWNoZXJzOiBjbGFzc190ZWFjaGVycyxcclxuICAgICAgICAgICAgY3Vycl9sb2FkX2JyYW5jaDogY3Vycl9sb2FkX2JyYW5jaCxcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIGRhbmggc2FjaCBiYW5nIGRpZW0ga2hvYSByb3V0ZVxyXG4gICAgcm91dGVyLmdldCgnL2RhbmhzYWNoYmFuZ2RpZW0nLCBjaGVja0lmVXNlckxvZ2luUm91dGUsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVzZXIgPSByZXEuc2Vzc2lvbi51c2VyO1xyXG5cclxuICAgICAgICAgICAgY29uc3Qgc2Nob29sX3llYXIgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAuY29sbGVjdGlvbignc2Nob29sX3llYXInKVxyXG4gICAgICAgICAgICAgICAgLmZpbmRPbmUoe30sIHsgcHJvamVjdGlvbjogeyBfaWQ6IDAsIHllYXI6IDEgfSB9KTtcclxuICAgICAgICAgICAgLy8gY2hlY2sgdXNlciBsb2dpbjpcclxuICAgICAgICAgICAgaWYgKHVzZXIucG93WzJdKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBnZXQgYWxsIGJyYW5jaCBvZiBkZXBhcnRtZW50OlxyXG4gICAgICAgICAgICAgICAgbGV0IGJyYW5jaF9saXN0ID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbignYnJhbmNocycpXHJcbiAgICAgICAgICAgICAgICAgICAgLmZpbmQoeyBkZXA6IHVzZXIuZGVwIH0sIHsgcHJvamVjdGlvbjogeyBfaWQ6IDEsIG5hbWU6IDEgfSB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC50b0FycmF5KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgY2xhc3NsaXN0ID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbignY2xhc3NlcycpXHJcbiAgICAgICAgICAgICAgICAgICAgLmZpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHsgYnJhbmNoOiB7ICRpbjogYnJhbmNoX2xpc3QubWFwKChicmFuY2gpID0+IGJyYW5jaC5faWQpIH0gfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeyBwcm9qZWN0aW9uOiB7IF9pZDogMSwgYnJhbmNoOiAxIH0gfSxcclxuICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgLnRvQXJyYXkoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCB5ZWFycyA9IGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ2NsYXNzZXMnKVxyXG4gICAgICAgICAgICAgICAgICAgIC5maW5kT25lKHsgX2lkOiBjbGFzc2xpc3RbMF0uX2lkIH0sIHsgcHJvamVjdGlvbjogeyBfaWQ6IDAsIHllYXJzOiAxIH0gfSk7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh5ZWFycyk7XHJcbiAgICAgICAgICAgICAgICAvLyBnZXQgYWxsIHN0dWRlbnQgaW4gc3RhZmYgbWVtYmVyIGNsYXNzOlxyXG4gICAgICAgICAgICAgICAgbGV0IHN0dWRlbnRfbGlzdCA9IGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ3VzZXJfaW5mbycpXHJcbiAgICAgICAgICAgICAgICAgICAgLmZpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHsgY2xhc3M6IGNsYXNzbGlzdFswXS5faWQsICdwb3dlci4wJzogeyAkZXhpc3RzOiB0cnVlIH0gfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvamVjdGlvbjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0X25hbWU6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdF9uYW1lOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsX3Njb3JlOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgLnRvQXJyYXkoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBzdHVkZW50X2xpc3QgPSBzb3J0U3R1ZGVudE5hbWUoc3R1ZGVudF9saXN0KTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjdXJyJywgY2xhc3NsaXN0WzBdLl9pZCk7XHJcbiAgICAgICAgICAgICAgICAvLyBnZXQgYWxsIHN0dWRlbnQgdG90YWwgc2NvcmUgZnJvbSB0aGVtc2VsZjpcclxuICAgICAgICAgICAgICAgIGxldCByZW5kZXIgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyOiAnZ2xvYmFsLWhlYWRlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgZm9vdGVyOiAnZ2xvYmFsLWZvb3RlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgdGhvbmdiYW86ICdnbG9iYWwtbm90aWZpY2F0aW9ucycsXHJcbiAgICAgICAgICAgICAgICAgICAgbWVudTogJ2RvYW5raG9hLW1lbnUnLFxyXG4gICAgICAgICAgICAgICAgICAgIHN0YWZmX25hbWU6IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgIHN0dWRlbnRfbGlzdDogc3R1ZGVudF9saXN0LFxyXG4gICAgICAgICAgICAgICAgICAgIGNsczogY2xhc3NsaXN0LFxyXG4gICAgICAgICAgICAgICAgICAgIHllYXJzOiB5ZWFycy55ZWFycyxcclxuICAgICAgICAgICAgICAgICAgICBjdXJyX3llYXI6IHNjaG9vbF95ZWFyLnllYXIsXHJcbiAgICAgICAgICAgICAgICAgICAgY3Vycl9jbHNzOiBjbGFzc2xpc3RbMF0uX2lkLFxyXG4gICAgICAgICAgICAgICAgICAgIGJyYW5jaDogYnJhbmNoX2xpc3QsXHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMucmVuZGVyKCdkb2Fua2hvYS1ncmFkZS1saXN0JywgcmVuZGVyKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIHVzZXIgbm90IHN0YWZmIG1lbWJlcnNcclxuICAgICAgICAgICAgICAgIC8vIHJlZGlyZWN0IHRvIGhvbWVcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMucmVkaXJlY3QoJy8nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1NZU1RFTSB8IERPQU5fS0hPQV9EQU5IX1NBQ0hfQkFOR19ESUVNIHwgRVJST1IgfCAnLCBlKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvL3F1YW4gbGkgY28gdmFuIC0gZG9hbiBraG9hIHJvdXRlXHJcbiAgICByb3V0ZXIuZ2V0KCcvcXVhbmxpY3YnLCBjaGVja0lmVXNlckxvZ2luUm91dGUsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVzZXIgPSByZXEuc2Vzc2lvbi51c2VyO1xyXG5cclxuICAgICAgICAgICAgLy8gZ2V0IGFsbCBicmFuY2ggb2YgZGVwYXJ0bWVudFxyXG4gICAgICAgICAgICBjb25zdCBhbGxfYnJhbmNocyA9IGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdicmFuY2hzJylcclxuICAgICAgICAgICAgICAgIC5maW5kKFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVwOiB1c2VyLmRlcCxcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvamVjdGlvbjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgLnRvQXJyYXkoKTtcclxuICAgICAgICAgICAgLy8gZ2V0IHVzZXIgbmFtZSBhbmQgY2xhc3MgaW4gZGVwXHJcbiAgICAgICAgICAgIGNvbnN0IHRlYWNoZXJzID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ3VzZXJfaW5mbycpXHJcbiAgICAgICAgICAgICAgICAuZmluZChcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICdwb3dlci4xJzogeyAkZXhpc3RzOiB0cnVlIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICdwb3dlci40JzogeyAkZXhpc3RzOiB0cnVlIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICdwb3dlci45OTknOiB7ICRleGlzdHM6IGZhbHNlIH0sXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAkb3I6IFtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgYnJhbmNoOiB7ICRpbjogYWxsX2JyYW5jaHMubWFwKChicmFuY2gpID0+IGJyYW5jaC5faWQpIH0gfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgYnJhbmNoOiBPYmplY3RJZC5jcmVhdGVGcm9tSGV4U3RyaW5nKCc2NTA5ODVhMzQ1ZTJlODk2YjM3ZWZkNGYnKSB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBdLFxyXG4gICAgICAgICAgICAgICAgICAgIH0sIC8vIHVzZXIgaXMgdGVhY2hlclxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvamVjdGlvbjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RfbmFtZTogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RfbmFtZTogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJhbmNoOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAudG9BcnJheSgpO1xyXG4gICAgICAgICAgICBsZXQgYnJhbmNoX2xpc3QgPSBbXTtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0ZWFjaGVycy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYnJhbmNoID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbignYnJhbmNocycpXHJcbiAgICAgICAgICAgICAgICAgICAgLmZpbmRPbmUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHsgX2lkOiB0ZWFjaGVyc1tpXS5icmFuY2ggfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvamVjdGlvbjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgYnJhbmNoX2xpc3QucHVzaChicmFuY2gubmFtZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5yZW5kZXIoJ2RvYW5raG9hLW1hbmFnZS10ZWFjaGVyJywge1xyXG4gICAgICAgICAgICAgICAgaGVhZGVyOiAnZ2xvYmFsLWhlYWRlcicsXHJcbiAgICAgICAgICAgICAgICBmb290ZXI6ICdnbG9iYWwtZm9vdGVyJyxcclxuICAgICAgICAgICAgICAgIHRob25nYmFvOiAnZ2xvYmFsLW5vdGlmaWNhdGlvbnMnLFxyXG4gICAgICAgICAgICAgICAgbWVudTogJ2RvYW5raG9hLW1lbnUnLFxyXG4gICAgICAgICAgICAgICAgdGVhY2hlcnM6IHRlYWNoZXJzLFxyXG4gICAgICAgICAgICAgICAgYnJhbmNoczogYnJhbmNoX2xpc3QsXHJcbiAgICAgICAgICAgICAgICBhbGxfYnJhbmNoczogYWxsX2JyYW5jaHMsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnU1lTVEVNIHwgRE9BTl9LSE9BX1FVQU5fTFlfQ09fVkFOX1JPVVRFIHwgRVJST1IgfCAnLCBlcnIpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNTAwKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBRdWFuIGxpIGhvYXQgZG9uZyBraG9hIHJvdXRlXHJcbiAgICByb3V0ZXIuZ2V0KCcvcXVhbmxpaG9hdGRvbmdraG9hJywgY2hlY2tJZlVzZXJMb2dpblJvdXRlLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICAgICAgICBjb25zdCB1c2VyID0gcmVxLnNlc3Npb24udXNlcjtcclxuXHJcbiAgICAgICAgY29uc3Qgc2Nob29sX3llYXIgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ3NjaG9vbF95ZWFyJylcclxuICAgICAgICAgICAgLmZpbmRPbmUoe30sIHsgcHJvamVjdGlvbjogeyBfaWQ6IDAsIHllYXI6IDEgfSB9KTtcclxuICAgICAgICAvLyBjaGVjayB1c2VyIGxvZ2luOlxyXG4gICAgICAgIGlmICh1c2VyLnBvd1szXSAmJiB1c2VyLnBvd1sxMV0pIHtcclxuICAgICAgICAgICAgbGV0IGJyYW5jaF9saXN0ID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ2JyYW5jaHMnKVxyXG4gICAgICAgICAgICAgICAgLmZpbmQoeyBkZXA6IHVzZXIuZGVwIH0sIHsgcHJvamVjdGlvbjogeyBfaWQ6IDEsIG5hbWU6IDEgfSB9KVxyXG4gICAgICAgICAgICAgICAgLnRvQXJyYXkoKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNsYXNzbGlzdCA9IGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdjbGFzc2VzJylcclxuICAgICAgICAgICAgICAgIC5maW5kKFxyXG4gICAgICAgICAgICAgICAgICAgIHsgYnJhbmNoOiB7ICRpbjogYnJhbmNoX2xpc3QubWFwKChicmFuY2gpID0+IGJyYW5jaC5faWQpIH0gfSxcclxuICAgICAgICAgICAgICAgICAgICB7IHByb2plY3Rpb246IHsgX2lkOiAxLCBicmFuY2g6IDEgfSB9LFxyXG4gICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgLnRvQXJyYXkoKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHllYXJzID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ2NsYXNzZXMnKVxyXG4gICAgICAgICAgICAgICAgLmZpbmRPbmUoeyBfaWQ6IGNsYXNzbGlzdFswXS5faWQgfSwgeyBwcm9qZWN0aW9uOiB7IF9pZDogMCwgeWVhcnM6IDEgfSB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIGdldCBhbGwgYWN0aXZpdGllcyBvZiBzY2hvb2xcclxuICAgICAgICAgICAgY29uc3Qgc2Nob29sX2F0diA9IGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdhY3Rpdml0aWVzJylcclxuICAgICAgICAgICAgICAgIC5maW5kKFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgeWVhcjogc2Nob29sX3llYXIueWVhcixcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvamVjdGlvbjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ZWFyOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRfdGltZTogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgLmxpbWl0KDEwKVxyXG4gICAgICAgICAgICAgICAgLnRvQXJyYXkoKTtcclxuXHJcbiAgICAgICAgICAgIC8vIGdldCBhbGwgYWN0aXZpdGllcyBvZiBkZXBcclxuICAgICAgICAgICAgY29uc3QgZGVwX2F0diA9IGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgLmRiKHVzZXIuZGVwKVxyXG4gICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ2FjdGl2aXRpZXMnKVxyXG4gICAgICAgICAgICAgICAgLmZpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB5ZWFyOiBzY2hvb2xfeWVhci55ZWFyLFxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9qZWN0aW9uOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHllYXI6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydF90aW1lOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAubGltaXQoMTApXHJcbiAgICAgICAgICAgICAgICAudG9BcnJheSgpO1xyXG5cclxuICAgICAgICAgICAgLy8gZ2V0IGFsbCBhY3Rpdml0aWVzIG9mIGNsYXNzIG9mIGRlcGFydG1lbnRcclxuICAgICAgICAgICAgY29uc3QgY29sbGVjdGlvbnMgPSBhd2FpdCBjbGllbnQuZGIodXNlci5kZXApLmxpc3RDb2xsZWN0aW9ucygpLnRvQXJyYXkoKTtcclxuXHJcbiAgICAgICAgICAgIC8vIEZpbHRlciBjb2xsZWN0aW9ucyBlbmRpbmcgd2l0aCAnX2FjdGl2aXRpZXMnXHJcbiAgICAgICAgICAgIGNvbnN0IGFjdGl2aXR5Q29sbGVjdGlvbnMgPSBjb2xsZWN0aW9ucy5maWx0ZXIoKGNvbGxlY3Rpb24pID0+IGNvbGxlY3Rpb24ubmFtZS5lbmRzV2l0aCgnX2FjdGl2aXRpZXMnKSk7XHJcblxyXG4gICAgICAgICAgICAvLyBMb29wIHRocm91Z2ggYWN0aXZpdHkgY29sbGVjdGlvbnMgYW5kIHJldHJpZXZlIGFsbCBkb2N1bWVudHNcclxuICAgICAgICAgICAgY29uc3QgY2xzX2F0dnMgPSBhd2FpdCBhY3Rpdml0eUNvbGxlY3Rpb25zLm1hcChhc3luYyAoY29sbGVjdGlvbikgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZHVtbXkgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAuZGIodXNlci5kZXApXHJcbiAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oY29sbGVjdGlvbi5uYW1lKVxyXG4gICAgICAgICAgICAgICAgICAgIC5maW5kKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ZWFyOiBzY2hvb2xfeWVhci55ZWFyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9qZWN0aW9uOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsczogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ZWFyOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0X3RpbWU6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICAubGltaXQoMTApXHJcbiAgICAgICAgICAgICAgICAgICAgLnRvQXJyYXkoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBkdW1teTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIFByb21pc2UuYWxsKGNsc19hdHZzKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oKHJlc3VsdHMpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBLaGkgdOG6pXQgY+G6oyBjw6FjIHByb21pc2UgxJHDoyBob8OgbiB0aMOgbmgsIHJlc3VsdHMgc+G6vSBsw6AgbeG7mXQgbeG6o25nIGNo4bupYSBr4bq/dCBxdeG6oyB04burIG3hu5dpIHRydXkgduG6pW4uXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gQuG6oW4gY8OzIHRo4buDIGzDoG0gZ8OsIMSRw7MgduG7m2kga+G6v3QgcXXhuqMg4bufIMSRw6J5LlxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNsc19hdHYgPSBbXS5jb25jYXQoLi4ucmVzdWx0cyk7IC8vIEvhur90IGjhu6NwIGvhur90IHF14bqjIHThu6sgY8OhYyB0cnV5IHbhuqVuIHbDoG8gbeG7mXQgbeG6o25nIGR1eSBuaOG6pXRcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnJlbmRlcignZG9hbmtob2EtbWFuYWdlLWFjdGl2aXRpZXMnLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcjogJ2dsb2JhbC1oZWFkZXInLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb290ZXI6ICdnbG9iYWwtZm9vdGVyJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhvbmdiYW86ICdnbG9iYWwtbm90aWZpY2F0aW9ucycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lbnU6ICdkb2Fua2hvYS1tZW51JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2xzOiBjbGFzc2xpc3QsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHllYXJzOiB5ZWFycy55ZWFycyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3Vycl95ZWFyOiBzY2hvb2xfeWVhci55ZWFyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmFuY2g6IGJyYW5jaF9saXN0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY2hvb2xfYXR2OiBzY2hvb2xfYXR2LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXBfYXR2OiBkZXBfYXR2LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbHNfYXR2OiBjbHNfYXR2LFxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBY4butIGzDvSBs4buXaSBu4bq/dSBjw7NcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNDAzKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBkYW5oIHNhY2ggc2luaCB2aWVuIHJvdXRlXHJcbiAgICByb3V0ZXIuZ2V0KCcvZGFuaHNhY2hzaW5odmllbicsIGNoZWNrSWZVc2VyTG9naW5Sb3V0ZSwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgY29uc3QgdXNlciA9IHJlcS5zZXNzaW9uLnVzZXI7XHJcblxyXG4gICAgICAgIGlmICh1c2VyLnBvd1s0XSB8fCB1c2VyLnBvd1s3XSkge1xyXG4gICAgICAgICAgICAvLyBnZXQgYWxsIGJyYW5jaCBvZiBkZXBhcnRtZW50OlxyXG4gICAgICAgICAgICBjb25zdCBicmFuY2hzID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ2JyYW5jaHMnKVxyXG4gICAgICAgICAgICAgICAgLmZpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXA6IHVzZXIuZGVwLFxyXG4gICAgICAgICAgICAgICAgICAgIH0sIC8vIGZpbmQgYWxsIGRhdGFcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2plY3Rpb246IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgLnRvQXJyYXkoKTtcclxuXHJcbiAgICAgICAgICAgIC8vIGdldCBhbGwgY2xhc3NlcyBvZiBkZXBhcnRtZW50XHJcbiAgICAgICAgICAgIGxldCBjbGFzc2VzID0gW107IC8vIGNsYXNzX3RlYWNoZXJzID0gWzE4MTAyMDAzLCAxOTExMjAwMywgKGNsYXNzX2lkcykgLi4uXVxyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJyYW5jaHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGxldCBkdW1teSA9IGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ2NsYXNzZXMnKVxyXG4gICAgICAgICAgICAgICAgICAgIC5maW5kKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmFuY2g6IGJyYW5jaHNbaV0uX2lkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAvLyBmaW5kIGFsbCBkYXRhXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2plY3Rpb246IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaWQ6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICAudG9BcnJheSgpO1xyXG5cclxuICAgICAgICAgICAgICAgIGNsYXNzZXMucHVzaCguLi5kdW1teS5tYXAoKGNscykgPT4gY2xzLl9pZCkpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnJlbmRlcignZG9hbmtob2Etc3R1ZGVudC1saXN0Jywge1xyXG4gICAgICAgICAgICAgICAgaGVhZGVyOiAnZ2xvYmFsLWhlYWRlcicsXHJcbiAgICAgICAgICAgICAgICBmb290ZXI6ICdnbG9iYWwtZm9vdGVyJyxcclxuICAgICAgICAgICAgICAgIHRob25nYmFvOiAnZ2xvYmFsLW5vdGlmaWNhdGlvbnMnLFxyXG4gICAgICAgICAgICAgICAgbWVudTogJ2RvYW5raG9hLW1lbnUnLFxyXG4gICAgICAgICAgICAgICAgY2xhc3NlczogY2xhc3NlcyxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5yZWRpcmVjdCgnLycpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8vIGRvYW4ga2hvYSBuaGFwIGRpZW0gcm91dGVcclxuICAgIHJvdXRlci5nZXQoJy9uaGFwZGllbWRhbmhnaWEnLCBjaGVja0lmVXNlckxvZ2luUm91dGUsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVzZXIgPSByZXEuc2Vzc2lvbi51c2VyO1xyXG4gICAgICAgICAgICBjb25zdCBtc3N2ID0gcmVxLnF1ZXJ5LnN0dWRlbnRJZDtcclxuICAgICAgICAgICAgY29uc3QgY2xzID0gcmVxLnF1ZXJ5LmNsYXNzO1xyXG4gICAgICAgICAgICBjb25zdCBzY2hvb2xZZWFyUGFyYW0gPSByZXEucXVlcnkuc2Nob29sWWVhcjtcclxuICAgICAgICAgICAgY29uc3Qgc3R1ZGVudFRvdGFsU2NvcmUgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgIC5kYih1c2VyLmRlcClcclxuICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKGNscyArICdfc3RkX3RhYmxlJylcclxuICAgICAgICAgICAgICAgIC5maW5kT25lKFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbXNzdjogbXNzdixcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2Nob29sX3llYXI6IHNjaG9vbFllYXJQYXJhbSxcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvamVjdGlvbjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2lkOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3Q6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWNvbmQ6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlyZDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvdXJ0aDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZnRoOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWw6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbWdfaWRzOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgICAgbGV0IHN0ZlRvdGFsU2NvcmUgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgIC5kYih1c2VyLmRlcClcclxuICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKGNscyArICdfc3RmX3RhYmxlJylcclxuICAgICAgICAgICAgICAgIC5maW5kT25lKFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbXNzdjogbXNzdixcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2Nob29sX3llYXI6IHNjaG9vbFllYXJQYXJhbSxcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvamVjdGlvbjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2lkOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3Q6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWNvbmQ6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlyZDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvdXJ0aDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZnRoOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWw6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICBsZXQgZGVwVG90YWxTY29yZSA9IGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgLmRiKHVzZXIuZGVwKVxyXG4gICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oY2xzICsgJ19kZXBfdGFibGUnKVxyXG4gICAgICAgICAgICAgICAgLmZpbmRPbmUoXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtc3N2OiBtc3N2LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY2hvb2xfeWVhcjogc2Nob29sWWVhclBhcmFtLFxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9qZWN0aW9uOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaWQ6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJzdDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlY29uZDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXJkOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91cnRoOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlmdGg6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgbnVsbHRhYmxlID0ge1xyXG4gICAgICAgICAgICAgICAgZmlmdGg6IFswLCAwLCAwLCAwXSxcclxuICAgICAgICAgICAgICAgIGZpcnN0OiBbMCwgMCwgMCwgMCwgMF0sXHJcbiAgICAgICAgICAgICAgICBmb3VydGg6IFswLCAwLCAwXSxcclxuICAgICAgICAgICAgICAgIHNlY29uZDogWzAsIDBdLFxyXG4gICAgICAgICAgICAgICAgdGhpcmQ6IFswLCAwLCAwXSxcclxuICAgICAgICAgICAgICAgIHRvdGFsOiAwLFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBpZiAoIXN0ZlRvdGFsU2NvcmUpIHtcclxuICAgICAgICAgICAgICAgIHN0ZlRvdGFsU2NvcmUgPSBudWxsdGFibGU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCFkZXBUb3RhbFNjb3JlKSB7XHJcbiAgICAgICAgICAgICAgICBkZXBUb3RhbFNjb3JlID0gbnVsbHRhYmxlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxldCBsaW5rX2ltZyA9IFtdO1xyXG5cclxuICAgICAgICAgICAgaWYgKHN0dWRlbnRUb3RhbFNjb3JlICYmIHN0dWRlbnRUb3RhbFNjb3JlLmltZ19pZHMpIHtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHN0dWRlbnRUb3RhbFNjb3JlLmltZ19pZHMpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGtleSA9PSAnZ2xvYmFsJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGkgb2YgdmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmtfaW1nLnB1c2goYXdhaXQgc2VydmVyLmdldERyaXZlRmlsZUxpbmtBbmREZXNjcmlwdGlvbihpKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgYWN0aXZpdGllX2luZm87XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXRpZV9pbmZvID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZGIodXNlci5kZXApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbihgJHtjbHN9X2FjdGl2aXRpZXNgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmRPbmUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaWQ6IGtleSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgcHJvamVjdGlvbjogeyBuYW1lOiAxIH0gfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYWN0aXZpdGllX2luZm8pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXRpZV9pbmZvID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmRiKHVzZXIuZGVwKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdhY3Rpdml0aWVzJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZmluZE9uZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2lkOiBrZXksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgcHJvamVjdGlvbjogeyBuYW1lOiAxIH0gfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhY3Rpdml0aWVfaW5mbykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXRpZV9pbmZvID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdhY3Rpdml0aWVzJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmRPbmUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2lkOiBrZXksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBwcm9qZWN0aW9uOiB7IG5hbWU6IDEgfSB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiB2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGltZ2luZm8gPSBhd2FpdCBzZXJ2ZXIuZ2V0RHJpdmVGaWxlTGlua0FuZERlc2NyaXB0aW9uKGkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGltZ2luZm8pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbWdpbmZvLmZpbGVEZXNjcmlwdGlvbiA9IGFjdGl2aXRpZV9pbmZvLm5hbWUgKyAnLScgKyBpbWdpbmZvLmZpbGVEZXNjcmlwdGlvbjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rX2ltZy5wdXNoKGltZ2luZm8pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5yZW5kZXIoJ2RvYW5raG9hLW1hbmFnZS1ncmFkZXMnLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyOiAnZ2xvYmFsLWhlYWRlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgdGhvbmdiYW86ICdnbG9iYWwtbm90aWZpY2F0aW9ucycsXHJcbiAgICAgICAgICAgICAgICAgICAgZm9vdGVyOiAnZ2xvYmFsLWZvb3RlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgbWVudTogJ2RvYW5raG9hLW1lbnUnLFxyXG4gICAgICAgICAgICAgICAgICAgIGltZzogbGlua19pbWcsXHJcblxyXG4gICAgICAgICAgICAgICAgICAgIFNjb3Jlc3RkOiBzdHVkZW50VG90YWxTY29yZSxcclxuICAgICAgICAgICAgICAgICAgICBTY29yZTogc3RmVG90YWxTY29yZSxcclxuICAgICAgICAgICAgICAgICAgICBTY29yZWs6IGRlcFRvdGFsU2NvcmUsXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg0MDQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTWVNURU0gfCBET0FOX0tIT0FfTkhBUF9ESUVNX1JPVVRFIHwgRVJST1IgfCAnLCBlcnIpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0zhu5dpIGjhu4cgdGjhu5FuZycgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gZG9hbiBraG9hIHRob2kgaGFuIGNoYW0gZGllbSByb3V0ZVxyXG4gICAgcm91dGVyLmdldCgnL3Rob2loYW4nLCBjaGVja0lmVXNlckxvZ2luUm91dGUsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgICAgIGNvbnN0IGN1cnJfZGF0ZSA9IG5ldyBEYXRlKCk7XHJcbiAgICAgICAgY29uc3Qgc2Nob29sX3llYXIgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ3NjaG9vbF95ZWFyJylcclxuICAgICAgICAgICAgLmZpbmRPbmUoXHJcbiAgICAgICAgICAgICAgICB7fSxcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9qZWN0aW9uOiB7IHllYXI6IDEsIHN0YXJ0X2RheTogMSwgZW5kX2RheTogMSB9LFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgLy8gc2V0IGNieCB0ZXh0XHJcbiAgICAgICAgbGV0IGNieCA9ICfEkGFuZyBkaeG7hW4gcmEnO1xyXG4gICAgICAgIGlmIChcclxuICAgICAgICAgICAgc2Nob29sX3llYXIuc3RhcnRfZGF5IDw9IGN1cnJfZGF0ZSAmJlxyXG4gICAgICAgICAgICAoY3Vycl9kYXRlIDw9IHNjaG9vbF95ZWFyLmVuZF9kYXkgfHwgc2Nob29sX3llYXIuZW5kX2RheS50b0lTT1N0cmluZygpID09ICcyMDAzLTEwLTE4VDAwOjAwOjAwLjAwMFonKVxyXG4gICAgICAgICkge1xyXG4gICAgICAgICAgICBjYnggPSAnxJBhbmcgZGnhu4VuIHJhJztcclxuICAgICAgICB9IGVsc2UgaWYgKHNjaG9vbF95ZWFyLnN0YXJ0X2RheSA+IGN1cnJfZGF0ZSkge1xyXG4gICAgICAgICAgICBjYnggPSAnU+G6r3AgZGnhu4VuIHJhJztcclxuICAgICAgICB9IGVsc2UgaWYgKGN1cnJfZGF0ZSA+IHNjaG9vbF95ZWFyLmVuZF9kYXkpIHtcclxuICAgICAgICAgICAgY2J4ID0gJ8SQw6Mga+G6v3QgdGjDumMnO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gY2hlY2sgaWYgZW5kIGRheSBpcyBmb3JldmVyIG9yIG5vdFxyXG4gICAgICAgIGlmIChzY2hvb2xfeWVhci5lbmRfZGF5LnRvSVNPU3RyaW5nKCkgPT0gJzIwMDMtMTAtMThUMDA6MDA6MDAuMDAwWicpIHtcclxuICAgICAgICAgICAgc2Nob29sX3llYXIuZW5kX2RheSA9IHVuZGVmaW5lZDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiByZXMucmVuZGVyKCdkb2Fua2hvYS10aW1lJywge1xyXG4gICAgICAgICAgICBoZWFkZXI6ICdnbG9iYWwtaGVhZGVyJyxcclxuICAgICAgICAgICAgZm9vdGVyOiAnZ2xvYmFsLWZvb3RlcicsXHJcbiAgICAgICAgICAgIHRob25nYmFvOiAnZ2xvYmFsLW5vdGlmaWNhdGlvbnMnLFxyXG4gICAgICAgICAgICBtZW51OiAnZG9hbmtob2EtbWVudScsXHJcblxyXG4gICAgICAgICAgICBzY2hvb2xfeWVhcjogc2Nob29sX3llYXIsXHJcbiAgICAgICAgICAgIGNieDogY2J4LFxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gY2hpIHRpZXQgaG9hdCBkb25nIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gc2Nob29sXHJcbiAgICByb3V0ZXIuZ2V0KCcvcXVhbmxpaG9hdGRvbmcvOmxldmVsLzppZCcsIGNoZWNrSWZVc2VyTG9naW5Sb3V0ZSwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgY29uc3QgdXNlciA9IHJlcS5zZXNzaW9uLnVzZXI7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKHVzZXIucG93WzNdKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBnZXQgaWQgYnkgcmVxLnBhcmFtcy5pZFxyXG4gICAgICAgICAgICAgICAgLy8gaWRlbnRpZnkgY3VycmVudCBhY3Rpdml0eSBvZiBzY2hvb2wgYWN0aXZpdGllc1xyXG4gICAgICAgICAgICAgICAgbGV0IGN1cnJfYWN0O1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChyZXEucGFyYW1zLmxldmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnVHJ1b25nJzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3Vycl9hY3QgPSBhd2FpdCBjbGllbnQuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKS5jb2xsZWN0aW9uKCdhY3Rpdml0aWVzJykuZmluZE9uZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaWQ6IHJlcS5wYXJhbXMuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlICdLaG9hJzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3Vycl9hY3QgPSBhd2FpdCBjbGllbnQuZGIodXNlci5kZXApLmNvbGxlY3Rpb24oJ2FjdGl2aXRpZXMnKS5maW5kT25lKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogcmVxLnBhcmFtcy5pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJfYWN0ID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZGIodXNlci5kZXApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbihyZXEucGFyYW1zLmxldmVsICsgJ19hY3Rpdml0aWVzJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kT25lKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaWQ6IHJlcS5wYXJhbXMuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBnZXQgYWxsIHN0dWRlbnRzIGluZm9ybWF0aW9uIGpvaW5lZCBjdXJyZW50IGFjdGl2aXR5XHJcbiAgICAgICAgICAgICAgICBsZXQgc3R1ZGVudHNfZGF0YSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgbGV0IGJvbnVzX3RydWU7XHJcbiAgICAgICAgICAgICAgICBsZXQgYWxsX3RydWUgPSB0cnVlOyAvLyBjaGVjayBkb2VzIGFsbCBzdHVkZW50IGlzIHllcyBvciBub3RcclxuICAgICAgICAgICAgICAgIGlmIChjdXJyX2FjdC5zdHVkZW50X2xpc3QpIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhjdXJyX2FjdC5zdHVkZW50X2xpc3QpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbigndXNlcl9pbmZvJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kT25lKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgX2lkOiBrZXkgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2plY3Rpb246IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHVkZW50c19kYXRhLnB1c2goZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHVkZW50c19kYXRhLnB1c2goeyBfaWQ6ICdub25lJywgZGlzcGxheU5hbWU6ICdub25lJywgY2xhc3M6IFsnbm9uZSddIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUgPT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaGF2ZSBvbmUgc3R1ZGVudCBub3QgaGF2ZSBib251c1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9udXNfdHJ1ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaGF2ZSBvbmUgc3R1ZGVudCBub3QgYXByb3ZhbCB5ZXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsbF90cnVlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBib251c190cnVlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5yZW5kZXIoJ2RvYW5raG9hLWFjdGl2aXR5LWFzc2Vzc21lbnQnLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyOiAnZ2xvYmFsLWhlYWRlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgdGhvbmdiYW86ICdnbG9iYWwtbm90aWZpY2F0aW9ucycsXHJcbiAgICAgICAgICAgICAgICAgICAgZm9vdGVyOiAnZ2xvYmFsLWZvb3RlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgbWVudTogJ2RvYW5raG9hLW1lbnUnLFxyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJfYWN0OiBjdXJyX2FjdCxcclxuICAgICAgICAgICAgICAgICAgICBzdHVkZW50c19kYXRhOiBzdHVkZW50c19kYXRhLFxyXG4gICAgICAgICAgICAgICAgICAgIGFsbF90cnVlOiBhbGxfdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBib251c190cnVlOiBib251c190cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIGlkYWN0OiByZXEucGFyYW1zLmlkLFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnJlZGlyZWN0KCcvJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1NZU1RFTSB8IFJFVklFV1NfQUNUSVZJVFkgfCBFUlJPUiB8ICcsIGVycik7XHJcbiAgICAgICAgICAgIHJlcy5zZW5kU3RhdHVzKDUwMCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgcmV0dXJuIHJvdXRlcjtcclxufVxyXG5tb2R1bGUuZXhwb3J0cyA9IGNyZWF0ZURlcFJvdXRlcjtcclxuIl0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxPQUFPLEdBQUdDLE9BQU8s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QUMsQ0FDdkJRLE9BQU8sQ0FDSjtjQUFFSixHQUFHLEVBQUVxRjtZQUFJLENBQUMsRUFDWjtjQUNJdEYsVUFBVSxFQUFFO2dCQUNSbUgsV0FBVyxFQUFFLENBQUM7Z0JBQ2QzRSxLQUFLLEVBQUU7Y0FDWDtZQUNKLENBQ0osQ0FBQztZQUNMLElBQUkwRSxJQUFJLEVBQUU7Y0FDTkgsYUFBYSxDQUFDMUYsSUFBSSxDQUFDNkYsSUFBSSxDQUFDO1lBQzVCLENBQUMsTUFBTTtjQUNISCxhQUFhLENBQUMxRixJQUFJLENBQUM7Z0JBQUVwQixHQUFHLEVBQUUsTUFBTTtnQkFBRWtILFdBQVcsRUFBRSxNQUFNO2dCQUFFM0UsS0FBSyxFQUFFLENBQUMsTUFBTTtjQUFFLENBQUMsQ0FBQztZQUM3RTtZQUVBLElBQUkrQyxLQUFLLElBQUksQ0FBQyxFQUFFO2NBQ1o7Y0FDQXlCLFVBQVUsR0FBRyxLQUFLO1lBQ3RCO1lBRUEsSUFBSXpCLEtBQUssSUFBSSxDQUFDLEVBQUU7Y0FDWjtjQUNBMEIsUUFBUSxHQUFHLEtBQUs7Y0FDaEJELFVBQVUsR0FBRyxLQUFLO1lBQ3RCO1VBQ0o7UUFDSjtRQUVBLE9BQU94SCxHQUFHLENBQUNjLE1BQU0sQ0FBQyw4QkFBOEIsRUFBRTtVQUM5Q0MsTUFBTSxFQUFFLGVBQWU7VUFDdkJHLFFBQVEsRUFBRSxzQkFBc0I7VUFDaENGLE1BQU0sRUFBRSxlQUFlO1VBQ3ZCQyxJQUFJLEVBQUUsZUFBZTtVQUNyQmtHLFFBQVEsRUFBRUEsUUFBUTtVQUNsQkksYUFBYSxFQUFFQSxhQUFhO1VBQzVCRSxRQUFRLEVBQUVBLFFBQVE7VUFDbEJELFVBQVUsRUFBRUEsVUFBVTtVQUN0QkksS0FBSyxFQUFFN0gsR0FBRyxDQUFDcUgsTUFBTSxDQUFDRTtRQUN0QixDQUFDLENBQUM7TUFDTixDQUFDLE1BQU07UUFDSCxPQUFPdEgsR0FBRyxDQUFDcUQsUUFBUSxDQUFDLEdBQUcsQ0FBQztNQUM1QjtJQUNKLENBQUMsQ0FBQyxPQUFPRyxHQUFHLEVBQUU7TUFDVlgsT0FBTyxDQUFDQyxHQUFHLENBQUMsc0NBQXNDLEVBQUVVLEdBQUcsQ0FBQztNQUN4RHhELEdBQUcsQ0FBQ3lELFVBQVUsQ0FBQyxHQUFHLENBQUM7SUFDdkI7RUFDSixDQUFDLENBQUM7RUFDRjs7RUFFQSxPQUFPckUsTUFBTTtBQUNqQjtBQUNBeUksTUFBTSxDQUFDQyxPQUFPLEdBQUdsSSxlQUFlIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["express","require","router","Router","server","checkIfUserLoginRoute","sortStudentName","getNameGlobal","ObjectId","name_global_databases","createDepRouter","client","get","req","res","user","session","branchs","db","collection","find","dep","projection","_id","name","toArray","dep_name","findOne","render","header","footer","menu","thongbao","curr_load_branch","classes","class_teachers","i","length","dummy","branch","cvht","map","cls","push","teachers","$exists","$or","$in","createFromHexString","first_name","last_name","teacher","teachers_id","school_year","year","pow","branch_list","classlist","years","console","log","student_list","class","total_score","staff_name","curr_year","curr_clss","redirect","e","all_branchs","err","sendStatus","school_atv","content","start_time","limit","dep_atv","collections","listCollections","activityCollections","filter","endsWith","cls_atvs","Promise","all","then","results","cls_atv","concat","catch","error","mssv","query","studentId","schoolYearParam","schoolYear","studentTotalScore","first","second","third","fourth","fifth","total","img_ids","stfTotalScore","depTotalScore","nulltable","link_img","key","value","Object","entries","getDriveFileLinkAndDescription","activitie_info","imginfo","fileDescription","img","Scorestd","Score","Scorek","status","json","curr_date","Date","start_day","end_day","cbx","toISOString","undefined","curr_act","params","level","id","students_data","bonus_true","all_true","data","displayName","idact","module","exports"],"sourceRoot":"D:\\project\\web\\newCDRL-1\\backend\\router\\","sources":["depRouters.js"],"sourcesContent":["const express = require('express');\r\nconst router = express.Router();\r\nconst server = require('../lib/csdl_google_lib');\r\nconst { checkIfUserLoginRoute, sortStudentName } = require('../lib/function_lib');\r\nconst { getNameGlobal } = require('../lib/mogodb_lib');\r\nconst { ObjectId } = require('mongodb');\r\n\r\nconst name_global_databases = getNameGlobal();\r\n// doan khoa route\r\nfunction createDepRouter(client) {\r\n    // quan li bo mon - doan khoa route\r\n    router.get('/quanlibomon', checkIfUserLoginRoute, async (req, res) => {\r\n        const user = req.session.user;\r\n\r\n        // get all branch of department:\r\n        const branchs = await client\r\n            .db(name_global_databases)\r\n            .collection('branchs')\r\n            .find(\r\n                {\r\n                    dep: user.dep,\r\n                }, // find all data\r\n                {\r\n                    projection: {\r\n                        _id: 0,\r\n                        name: 1,\r\n                    },\r\n                },\r\n            )\r\n            .toArray();\r\n\r\n        // get department name:\r\n        const dep_name = await client\r\n            .db(name_global_databases)\r\n            .collection('deps')\r\n            .findOne(\r\n                {\r\n                    _id: user.dep,\r\n                }, // find all data\r\n                {\r\n                    projection: {\r\n                        _id: 0,\r\n                        name: 1,\r\n                    },\r\n                },\r\n            );\r\n\r\n        return res.render('doankhoa-manage-departments', {\r\n            header: 'global-header',\r\n            footer: 'global-footer',\r\n            menu: 'doankhoa-menu',\r\n            thongbao: 'global-notifications',\r\n            dep: dep_name.name, // every branch have same department\r\n            branchs: branchs,\r\n        });\r\n    });\r\n\r\n    // quan li lop - doan khoa route\r\n    router.get('/quanlilop', checkIfUserLoginRoute, async (req, res) => {\r\n        const user = req.session.user;\r\n\r\n        // get all branch of department:\r\n        const branchs = await client\r\n            .db(name_global_databases)\r\n            .collection('branchs')\r\n            .find(\r\n                {\r\n                    dep: user.dep,\r\n                }, // find all data\r\n                {\r\n                    projection: {\r\n                        name: 1,\r\n                    },\r\n                },\r\n            )\r\n            .toArray();\r\n\r\n        let curr_load_branch;\r\n        // get all classes of branchs:\r\n        let classes = {}; // classes = {KTPM: [KTPM0121, KTPM0108, ...], CNTT: [CNTT0109, CNTT0209, ...], ...}\r\n        let class_teachers = []; // class_teachers = [18102003, 19112003, ...]\r\n        for (let i = 0; i < branchs.length; i++) {\r\n            let dummy = await client\r\n                .db(name_global_databases)\r\n                .collection('classes')\r\n                .find(\r\n                    {\r\n                        branch: branchs[i]._id,\r\n                    }, // find all data\r\n                    {\r\n                        projection: {\r\n                            cvht: 1,\r\n                        },\r\n                    },\r\n                )\r\n                .toArray();\r\n\r\n            classes[branchs[i]._id] = dummy.map((cls) => cls._id);\r\n            class_teachers.push(...dummy.map((cls) => cls.cvht));\r\n\r\n            // set current load branch to i\r\n            curr_load_branch = i + 1;\r\n            // finish load one brach then check does number of classes over 30.\r\n            if (class_teachers.length >= 30) {\r\n                break;\r\n            }\r\n        }\r\n        // get all teacher's name in current department\r\n        const teachers = await client\r\n            .db(name_global_databases)\r\n            .collection('user_info')\r\n            .find(\r\n                {\r\n                    'power.1': { $exists: true },\r\n                    'power.4': { $exists: true },\r\n                    $or: [\r\n                        { branch: { $in: branchs.map((branch) => branch._id) } },\r\n                        { branch: ObjectId.createFromHexString('650985a345e2e896b37efd4f') },\r\n                    ],\r\n                }, // user is teacher\r\n                {\r\n                    projection: {\r\n                        first_name: 1,\r\n                        last_name: 1,\r\n                    },\r\n                },\r\n            )\r\n            .toArray();\r\n\r\n        // get all teacher's name of classes\r\n        for (let i = 0; i < class_teachers.length; i++) {\r\n            // replace current teacher's _id with teacher's name\r\n            class_teachers[i] = await client\r\n                .db(name_global_databases)\r\n                .collection('user_info')\r\n                .findOne(\r\n                    {\r\n                        _id: class_teachers[i],\r\n                        'power.1': { $exists: true },\r\n                        'power.4': { $exists: true },\r\n                    }, // user is teacher\r\n                    {\r\n                        projection: {\r\n                            first_name: 1,\r\n                            last_name: 1,\r\n                        },\r\n                    },\r\n                );\r\n        }\r\n\r\n        return res.render('doankhoa-manage-classes', {\r\n            header: 'global-header',\r\n            footer: 'global-footer',\r\n            menu: 'doankhoa-menu',\r\n            thongbao: 'global-notifications',\r\n            dep_name: user.dep,\r\n            branchs: branchs,\r\n            classes: classes,\r\n            teachers: teachers.map((teacher) => teacher.last_name + ' ' + teacher.first_name),\r\n            teachers_id: teachers.map((teacher) => teacher._id),\r\n            class_teachers: class_teachers,\r\n            curr_load_branch: curr_load_branch,\r\n        });\r\n    });\r\n\r\n    // danh sach bang diem khoa route\r\n    router.get('/danhsachbangdiem', checkIfUserLoginRoute, async (req, res) => {\r\n        try {\r\n            const user = req.session.user;\r\n\r\n            const school_year = await client\r\n                .db(name_global_databases)\r\n                .collection('school_year')\r\n                .findOne({}, { projection: { _id: 0, year: 1 } });\r\n            // check user login:\r\n            if (user.pow[2]) {\r\n                // get all branch of department:\r\n                let branch_list = await client\r\n                    .db(name_global_databases)\r\n                    .collection('branchs')\r\n                    .find({ dep: user.dep }, { projection: { _id: 1, name: 1 } })\r\n                    .toArray();\r\n\r\n                const classlist = await client\r\n                    .db(name_global_databases)\r\n                    .collection('classes')\r\n                    .find(\r\n                        { branch: { $in: branch_list.map((branch) => branch._id) } },\r\n                        { projection: { _id: 1, branch: 1 } },\r\n                    )\r\n                    .toArray();\r\n\r\n                const years = await client\r\n                    .db(name_global_databases)\r\n                    .collection('classes')\r\n                    .findOne({ _id: classlist[0]._id }, { projection: { _id: 0, years: 1 } });\r\n                console.log(years);\r\n                // get all student in staff member class:\r\n                let student_list = await client\r\n                    .db(name_global_databases)\r\n                    .collection('user_info')\r\n                    .find(\r\n                        { class: classlist[0]._id, 'power.0': { $exists: true } },\r\n                        {\r\n                            projection: {\r\n                                first_name: 1,\r\n                                last_name: 1,\r\n                                total_score: 1,\r\n                            },\r\n                        },\r\n                    )\r\n                    .toArray();\r\n\r\n                student_list = sortStudentName(student_list);\r\n                console.log('curr', classlist[0]._id);\r\n                // get all student total score from themself:\r\n                let render = {\r\n                    header: 'global-header',\r\n                    footer: 'global-footer',\r\n                    thongbao: 'global-notifications',\r\n                    menu: 'doankhoa-menu',\r\n                    staff_name: [],\r\n                    student_list: student_list,\r\n                    cls: classlist,\r\n                    years: years.years,\r\n                    curr_year: school_year.year,\r\n                    curr_clss: classlist[0]._id,\r\n                    branch: branch_list,\r\n                };\r\n\r\n                return res.render('doankhoa-grade-list', render);\r\n            } else {\r\n                // user not staff members\r\n                // redirect to home\r\n                return res.redirect('/');\r\n            }\r\n        } catch (e) {\r\n            console.log('SYSTEM | DOAN_KHOA_DANH_SACH_BANG_DIEM | ERROR | ', e);\r\n        }\r\n    });\r\n\r\n    //quan li co van - doan khoa route\r\n    router.get('/quanlicv', checkIfUserLoginRoute, async (req, res) => {\r\n        try {\r\n            const user = req.session.user;\r\n\r\n            // get all branch of department\r\n            const all_branchs = await client\r\n                .db(name_global_databases)\r\n                .collection('branchs')\r\n                .find(\r\n                    {\r\n                        dep: user.dep,\r\n                    },\r\n                    {\r\n                        projection: {\r\n                            name: 1,\r\n                        },\r\n                    },\r\n                )\r\n                .toArray();\r\n            // get user name and class in dep\r\n            const teachers = await client\r\n                .db(name_global_databases)\r\n                .collection('user_info')\r\n                .find(\r\n                    {\r\n                        'power.1': { $exists: true },\r\n                        'power.4': { $exists: true },\r\n                        'power.999': { $exists: false },\r\n\r\n                        $or: [\r\n                            { branch: { $in: all_branchs.map((branch) => branch._id) } },\r\n                            { branch: ObjectId.createFromHexString('650985a345e2e896b37efd4f') },\r\n                        ],\r\n                    }, // user is teacher\r\n                    {\r\n                        projection: {\r\n                            first_name: 1,\r\n                            last_name: 1,\r\n                            class: 1,\r\n                            branch: 1,\r\n                        },\r\n                    },\r\n                )\r\n                .toArray();\r\n            let branch_list = [];\r\n            for (let i = 0; i < teachers.length; i++) {\r\n                const branch = await client\r\n                    .db(name_global_databases)\r\n                    .collection('branchs')\r\n                    .findOne(\r\n                        { _id: teachers[i].branch },\r\n                        {\r\n                            projection: {\r\n                                _id: 0,\r\n                                name: 1,\r\n                            },\r\n                        },\r\n                    );\r\n                branch_list.push(branch.name);\r\n            }\r\n            return res.render('doankhoa-manage-teacher', {\r\n                header: 'global-header',\r\n                footer: 'global-footer',\r\n                thongbao: 'global-notifications',\r\n                menu: 'doankhoa-menu',\r\n                teachers: teachers,\r\n                branchs: branch_list,\r\n                all_branchs: all_branchs,\r\n            });\r\n        } catch (err) {\r\n            console.log('SYSTEM | DOAN_KHOA_QUAN_LY_CO_VAN_ROUTE | ERROR | ', err);\r\n            return res.sendStatus(500);\r\n        }\r\n    });\r\n\r\n    // Quan li hoat dong khoa route\r\n    router.get('/quanlihoatdongkhoa', checkIfUserLoginRoute, async (req, res) => {\r\n        const user = req.session.user;\r\n\r\n        const school_year = await client\r\n            .db(name_global_databases)\r\n            .collection('school_year')\r\n            .findOne({}, { projection: { _id: 0, year: 1 } });\r\n        // check user login:\r\n        if (user.pow[3] && user.pow[11]) {\r\n            let branch_list = await client\r\n                .db(name_global_databases)\r\n                .collection('branchs')\r\n                .find({ dep: user.dep }, { projection: { _id: 1, name: 1 } })\r\n                .toArray();\r\n\r\n            const classlist = await client\r\n                .db(name_global_databases)\r\n                .collection('classes')\r\n                .find(\r\n                    { branch: { $in: branch_list.map((branch) => branch._id) } },\r\n                    { projection: { _id: 1, branch: 1 } },\r\n                )\r\n                .toArray();\r\n\r\n            const years = await client\r\n                .db(name_global_databases)\r\n                .collection('classes')\r\n                .findOne({ _id: classlist[0]._id }, { projection: { _id: 0, years: 1 } });\r\n\r\n            // get all activities of school\r\n            const school_atv = await client\r\n                .db(name_global_databases)\r\n                .collection('activities')\r\n                .find(\r\n                    {\r\n                        year: school_year.year,\r\n                    },\r\n                    {\r\n                        projection: {\r\n                            name: 1,\r\n                            content: 1,\r\n                            year: 1,\r\n                            start_time: 1,\r\n                        },\r\n                    },\r\n                )\r\n                .limit(10)\r\n                .toArray();\r\n\r\n            // get all activities of dep\r\n            const dep_atv = await client\r\n                .db(user.dep)\r\n                .collection('activities')\r\n                .find(\r\n                    {\r\n                        year: school_year.year,\r\n                    },\r\n                    {\r\n                        projection: {\r\n                            name: 1,\r\n                            content: 1,\r\n                            year: 1,\r\n                            start_time: 1,\r\n                        },\r\n                    },\r\n                )\r\n                .limit(10)\r\n                .toArray();\r\n\r\n            // get all activities of class of department\r\n            const collections = await client.db(user.dep).listCollections().toArray();\r\n\r\n            // Filter collections ending with '_activities'\r\n            const activityCollections = collections.filter((collection) => collection.name.endsWith('_activities'));\r\n\r\n            // Loop through activity collections and retrieve all documents\r\n            const cls_atvs = await activityCollections.map(async (collection) => {\r\n                const dummy = await client\r\n                    .db(user.dep)\r\n                    .collection(collection.name)\r\n                    .find(\r\n                        {\r\n                            year: school_year.year,\r\n                        },\r\n                        {\r\n                            projection: {\r\n                                name: 1,\r\n                                content: 1,\r\n                                cls: 1,\r\n                                year: 1,\r\n                                start_time: 1,\r\n                            },\r\n                        },\r\n                    )\r\n                    .limit(10)\r\n                    .toArray();\r\n                return dummy;\r\n            });\r\n            Promise.all(cls_atvs)\r\n                .then((results) => {\r\n                    // Khi tất cả các promise đã hoàn thành, results sẽ là một mảng chứa kết quả từ mỗi truy vấn.\r\n                    // Bạn có thể làm gì đó với kết quả ở đây.\r\n                    const cls_atv = [].concat(...results); // Kết hợp kết quả từ các truy vấn vào một mảng duy nhất\r\n                    return res.render('doankhoa-manage-activities', {\r\n                        header: 'global-header',\r\n                        footer: 'global-footer',\r\n                        thongbao: 'global-notifications',\r\n                        menu: 'doankhoa-menu',\r\n                        cls: classlist,\r\n                        years: years.years,\r\n                        curr_year: school_year.year,\r\n                        branch: branch_list,\r\n                        school_atv: school_atv,\r\n                        dep_atv: dep_atv,\r\n                        cls_atv: cls_atv,\r\n                    });\r\n                })\r\n                .catch((error) => {\r\n                    // Xử lý lỗi nếu có\r\n                    console.log(error);\r\n                });\r\n        } else {\r\n            return res.sendStatus(403);\r\n        }\r\n    });\r\n\r\n    // danh sach sinh vien route\r\n    router.get('/danhsachsinhvien', checkIfUserLoginRoute, async (req, res) => {\r\n        const user = req.session.user;\r\n\r\n        if (user.pow[4] || user.pow[7]) {\r\n            // get all branch of department:\r\n            const branchs = await client\r\n                .db(name_global_databases)\r\n                .collection('branchs')\r\n                .find(\r\n                    {\r\n                        dep: user.dep,\r\n                    }, // find all data\r\n                    {\r\n                        projection: {\r\n                            _id: 1,\r\n                        },\r\n                    },\r\n                )\r\n                .toArray();\r\n\r\n            // get all classes of department\r\n            let classes = []; // class_teachers = [18102003, 19112003, (class_ids) ...]\r\n            for (let i = 0; i < branchs.length; i++) {\r\n                let dummy = await client\r\n                    .db(name_global_databases)\r\n                    .collection('classes')\r\n                    .find(\r\n                        {\r\n                            branch: branchs[i]._id,\r\n                        }, // find all data\r\n                        {\r\n                            projection: {\r\n                                _id: 1,\r\n                            },\r\n                        },\r\n                    )\r\n                    .toArray();\r\n\r\n                classes.push(...dummy.map((cls) => cls._id));\r\n            }\r\n\r\n            return res.render('doankhoa-student-list', {\r\n                header: 'global-header',\r\n                footer: 'global-footer',\r\n                thongbao: 'global-notifications',\r\n                menu: 'doankhoa-menu',\r\n                classes: classes,\r\n            });\r\n        } else {\r\n            return res.redirect('/');\r\n        }\r\n    });\r\n\r\n    // doan khoa nhap diem route\r\n    router.get('/nhapdiemdanhgia', checkIfUserLoginRoute, async (req, res) => {\r\n        try {\r\n            const user = req.session.user;\r\n            const mssv = req.query.studentId;\r\n            const cls = req.query.class;\r\n            const schoolYearParam = req.query.schoolYear;\r\n            const studentTotalScore = await client\r\n                .db(user.dep)\r\n                .collection(cls + '_std_table')\r\n                .findOne(\r\n                    {\r\n                        mssv: mssv,\r\n                        school_year: schoolYearParam,\r\n                    },\r\n                    {\r\n                        projection: {\r\n                            _id: 0,\r\n                            first: 1,\r\n                            second: 1,\r\n                            third: 1,\r\n                            fourth: 1,\r\n                            fifth: 1,\r\n                            total: 1,\r\n                            img_ids: 1,\r\n                        },\r\n                    },\r\n                );\r\n\r\n            let stfTotalScore = await client\r\n                .db(user.dep)\r\n                .collection(cls + '_stf_table')\r\n                .findOne(\r\n                    {\r\n                        mssv: mssv,\r\n                        school_year: schoolYearParam,\r\n                    },\r\n                    {\r\n                        projection: {\r\n                            _id: 0,\r\n                            first: 1,\r\n                            second: 1,\r\n                            third: 1,\r\n                            fourth: 1,\r\n                            fifth: 1,\r\n                            total: 1,\r\n                        },\r\n                    },\r\n                );\r\n\r\n            let depTotalScore = await client\r\n                .db(user.dep)\r\n                .collection(cls + '_dep_table')\r\n                .findOne(\r\n                    {\r\n                        mssv: mssv,\r\n                        school_year: schoolYearParam,\r\n                    },\r\n                    {\r\n                        projection: {\r\n                            _id: 0,\r\n                            first: 1,\r\n                            second: 1,\r\n                            third: 1,\r\n                            fourth: 1,\r\n                            fifth: 1,\r\n                            total: 1,\r\n                        },\r\n                    },\r\n                );\r\n            nulltable = {\r\n                fifth: [0, 0, 0, 0],\r\n                first: [0, 0, 0, 0, 0],\r\n                fourth: [0, 0, 0],\r\n                second: [0, 0],\r\n                third: [0, 0, 0],\r\n                total: 0,\r\n            };\r\n            if (!stfTotalScore) {\r\n                stfTotalScore = nulltable;\r\n            }\r\n            if (!depTotalScore) {\r\n                depTotalScore = nulltable;\r\n            }\r\n            let link_img = [];\r\n\r\n            if (studentTotalScore && studentTotalScore.img_ids) {\r\n                for (const [key, value] of Object.entries(studentTotalScore.img_ids)) {\r\n                    if (key == 'global') {\r\n                        for (const i of value) {\r\n                            link_img.push(await server.getDriveFileLinkAndDescription(i));\r\n                        }\r\n                    } else {\r\n                        let activitie_info;\r\n                        activitie_info = await client\r\n                            .db(user.dep)\r\n                            .collection(`${cls}_activities`)\r\n                            .findOne(\r\n                                {\r\n                                    _id: key,\r\n                                },\r\n                                { projection: { name: 1 } },\r\n                            );\r\n                        if (!activitie_info) {\r\n                            activitie_info = await client\r\n                                .db(user.dep)\r\n                                .collection('activities')\r\n                                .findOne(\r\n                                    {\r\n                                        _id: key,\r\n                                    },\r\n                                    { projection: { name: 1 } },\r\n                                );\r\n                            if (!activitie_info) {\r\n                                activitie_info = await client\r\n                                    .db(name_global_databases)\r\n                                    .collection('activities')\r\n                                    .findOne(\r\n                                        {\r\n                                            _id: key,\r\n                                        },\r\n                                        { projection: { name: 1 } },\r\n                                    );\r\n                            }\r\n                        }\r\n                        for (const i of value) {\r\n                            let imginfo = await server.getDriveFileLinkAndDescription(i);\r\n                            if (imginfo) {\r\n                                imginfo.fileDescription = activitie_info.name + '-' + imginfo.fileDescription;\r\n                                link_img.push(imginfo);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                return res.render('doankhoa-manage-grades', {\r\n                    header: 'global-header',\r\n                    thongbao: 'global-notifications',\r\n                    footer: 'global-footer',\r\n                    menu: 'doankhoa-menu',\r\n                    img: link_img,\r\n\r\n                    Scorestd: studentTotalScore,\r\n                    Score: stfTotalScore,\r\n                    Scorek: depTotalScore,\r\n                });\r\n            } else {\r\n                return res.sendStatus(404);\r\n            }\r\n        } catch (err) {\r\n            console.log('SYSTEM | DOAN_KHOA_NHAP_DIEM_ROUTE | ERROR | ', err);\r\n            return res.status(500).json({ error: 'Lỗi hệ thống' });\r\n        }\r\n    });\r\n\r\n    // doan khoa thoi han cham diem route\r\n    router.get('/thoihan', checkIfUserLoginRoute, async (req, res) => {\r\n        const curr_date = new Date();\r\n        const school_year = await client\r\n            .db(name_global_databases)\r\n            .collection('school_year')\r\n            .findOne(\r\n                {},\r\n                {\r\n                    projection: { year: 1, start_day: 1, end_day: 1 },\r\n                },\r\n            );\r\n\r\n        // set cbx text\r\n        let cbx = 'Đang diễn ra';\r\n        if (\r\n            school_year.start_day <= curr_date &&\r\n            (curr_date <= school_year.end_day || school_year.end_day.toISOString() == '2003-10-18T00:00:00.000Z')\r\n        ) {\r\n            cbx = 'Đang diễn ra';\r\n        } else if (school_year.start_day > curr_date) {\r\n            cbx = 'Sắp diễn ra';\r\n        } else if (curr_date > school_year.end_day) {\r\n            cbx = 'Đã kết thúc';\r\n        }\r\n\r\n        // check if end day is forever or not\r\n        if (school_year.end_day.toISOString() == '2003-10-18T00:00:00.000Z') {\r\n            school_year.end_day = undefined;\r\n        }\r\n\r\n        return res.render('doankhoa-time', {\r\n            header: 'global-header',\r\n            footer: 'global-footer',\r\n            thongbao: 'global-notifications',\r\n            menu: 'doankhoa-menu',\r\n\r\n            school_year: school_year,\r\n            cbx: cbx,\r\n        });\r\n    });\r\n\r\n    // chi tiet hoat dong ------------------------------------------------------------------------------------------\r\n    // school\r\n    router.get('/quanlihoatdong/:level/:id', checkIfUserLoginRoute, async (req, res) => {\r\n        const user = req.session.user;\r\n        try {\r\n            if (user.pow[3]) {\r\n                // get id by req.params.id\r\n                // identify current activity of school activities\r\n                let curr_act;\r\n                switch (req.params.level) {\r\n                    case 'Truong':\r\n                        curr_act = await client.db(name_global_databases).collection('activities').findOne({\r\n                            _id: req.params.id,\r\n                        });\r\n                        break;\r\n                    case 'Khoa':\r\n                        curr_act = await client.db(user.dep).collection('activities').findOne({\r\n                            _id: req.params.id,\r\n                        });\r\n                        break;\r\n                    default:\r\n                        curr_act = await client\r\n                            .db(user.dep)\r\n                            .collection(req.params.level + '_activities')\r\n                            .findOne({\r\n                                _id: req.params.id,\r\n                            });\r\n                        break;\r\n                }\r\n                // get all students information joined current activity\r\n                let students_data = [];\r\n                let bonus_true;\r\n                let all_true = true; // check does all student is yes or not\r\n                if (curr_act.student_list) {\r\n                    for (const [key, value] of Object.entries(curr_act.student_list)) {\r\n                        const data = await client\r\n                            .db(name_global_databases)\r\n                            .collection('user_info')\r\n                            .findOne(\r\n                                { _id: key },\r\n                                {\r\n                                    projection: {\r\n                                        displayName: 1,\r\n                                        class: 1,\r\n                                    },\r\n                                },\r\n                            );\r\n                        if (data) {\r\n                            students_data.push(data);\r\n                        } else {\r\n                            students_data.push({ _id: 'none', displayName: 'none', class: ['none'] });\r\n                        }\r\n\r\n                        if (value == 1) {\r\n                            // have one student not have bonus\r\n                            bonus_true = false;\r\n                        }\r\n\r\n                        if (value == 0) {\r\n                            // have one student not aproval yet\r\n                            all_true = false;\r\n                            bonus_true = false;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                return res.render('doankhoa-activity-assessment', {\r\n                    header: 'global-header',\r\n                    thongbao: 'global-notifications',\r\n                    footer: 'global-footer',\r\n                    menu: 'doankhoa-menu',\r\n                    curr_act: curr_act,\r\n                    students_data: students_data,\r\n                    all_true: all_true,\r\n                    bonus_true: bonus_true,\r\n                    idact: req.params.id,\r\n                });\r\n            } else {\r\n                return res.redirect('/');\r\n            }\r\n        } catch (err) {\r\n            console.log('SYSTEM | REVIEWS_ACTIVITY | ERROR | ', err);\r\n            res.sendStatus(500);\r\n        }\r\n    });\r\n    // -------------------------------------------------------------------------------------------\r\n\r\n    return router;\r\n}\r\nmodule.exports = createDepRouter;\r\n"],"mappings":"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","ignoreList":[]}},"mtime":1719476170726},"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\project\\\\web\\\\newCDRL-1\\\\backend\\\\router\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\project\\\\web\\\\newCDRL-1\",\"filename\":\"D:\\\\project\\\\web\\\\newCDRL-1\\\\backend\\\\router\\\\staffRouters.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\project\\\\web\\\\newCDRL-1\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.24.3:development":{"value":{"code":"const express = require('express');\nconst router = express.Router();\nconst server = require('../lib/csdl_google_lib');\nconst {\n  checkIfUserLoginRoute,\n  sortStudentName\n} = require('../lib/function_lib');\nconst {\n  getNameGlobal\n} = require('../lib/mogodb_lib');\nconst name_global_databases = getNameGlobal();\nfunction createStaffRouter(client) {\n  // ban can su nhap diem route\n  router.get('/nhapdiemdanhgia', checkIfUserLoginRoute, async (req, res) => {\n    try {\n      const user = req.session.user;\n      const mssv = req.query.studentId;\n      const schoolYearParam = req.query.schoolYear;\n      let studentTotalScore = await client.db(user.dep).collection(user.cls[0] + '_std_table').findOne({\n        mssv: mssv,\n        school_year: schoolYearParam\n      }, {\n        projection: {\n          _id: 0,\n          first: 1,\n          second: 1,\n          third: 1,\n          fourth: 1,\n          fifth: 1,\n          total: 1,\n          img_ids: 1\n        }\n      });\n      let stfTotalScore = await client.db(user.dep).collection(user.cls[0] + '_stf_table').findOne({\n        mssv: mssv,\n        school_year: schoolYearParam\n      }, {\n        projection: {\n          _id: 0,\n          first: 1,\n          second: 1,\n          third: 1,\n          fourth: 1,\n          fifth: 1,\n          total: 1,\n          img_ids: 1\n        }\n      });\n      let depTotalScore = await client.db(user.dep).collection(user.cls[0] + '_dep_table').findOne({\n        mssv: mssv,\n        school_year: schoolYearParam\n      }, {\n        projection: {\n          _id: 0,\n          first: 1,\n          second: 1,\n          third: 1,\n          fourth: 1,\n          fifth: 1,\n          total: 1,\n          limg_ids: 1\n        }\n      });\n      nulltable = {\n        fifth: ['Chưa chấm', 'Chưa chấm', 'Chưa chấm', 'Chưa chấm'],\n        first: ['Chưa chấm', 'Chưa chấm', 'Chưa chấm', 'Chưa chấm', 'Chưa chấm'],\n        fourth: ['Chưa chấm', 'Chưa chấm', 'Chưa chấm'],\n        second: ['Chưa chấm', 'Chưa chấm'],\n        third: ['Chưa chấm', 'Chưa chấm', 'Chưa chấm'],\n        total: 'Chưa chấm'\n      };\n      if (!stfTotalScore) {\n        stfTotalScore = nulltable;\n      }\n      if (!depTotalScore) {\n        depTotalScore = nulltable;\n      }\n      let link_img = [];\n      let std_act_img = {};\n      let stf_act_img = {};\n      let dep_act_img = {};\n      if (studentTotalScore) {\n        for (const [key, value] of Object.entries(studentTotalScore.img_ids)) {\n          if (key == 'global') {\n            for (const i of value) {\n              link_img.push(await server.getDriveFileLinkAndDescription(i));\n            }\n          } else {\n            let activitie_info;\n            activitie_info = await client.db(user.dep).collection(`${user.cls[0]}_activities`).findOne({\n              _id: key\n            }, {\n              projection: {\n                name: 1\n              }\n            });\n            if (activitie_info) {\n              for (const i of value) {\n                let imginfo = await server.getDriveFileLinkAndDescription(i);\n                if (std_act_img[activitie_info.name] && imginfo) {\n                  std_act_img[activitie_info.name].push(imginfo);\n                } else if (imginfo) {\n                  std_act_img[activitie_info.name] = [imginfo];\n                }\n              }\n            } else {\n              activitie_info = await client.db(user.dep).collection('activities').findOne({\n                _id: key\n              }, {\n                projection: {\n                  name: 1\n                }\n              });\n              if (activitie_info) {\n                for (const i of value) {\n                  let imginfo = await server.getDriveFileLinkAndDescription(i);\n                  if (stf_act_img[activitie_info.name] && imginfo) {\n                    stf_act_img[activitie_info.name].push(imginfo);\n                  } else if (imginfo) {\n                    stf_act_img[activitie_info.name] = [imginfo];\n                  }\n                }\n              } else {\n                activitie_info = await client.db(name_global_databases).collection('activities').findOne({\n                  _id: key\n                }, {\n                  projection: {\n                    name: 1\n                  }\n                });\n                if (activitie_info) {\n                  for (const i of value) {\n                    let imginfo = await server.getDriveFileLinkAndDescription(i);\n                    if (dep_act_img[activitie_info.name] && imginfo) {\n                      dep_act_img[activitie_info.name].push(imginfo);\n                    } else if (imginfo) {\n                      dep_act_img[activitie_info.name] = [imginfo];\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n        return res.render('bancansu-manage-grades', {\n          header: 'global-header',\n          thongbao: 'global-notifications',\n          footer: 'global-footer',\n          Scorestd: studentTotalScore,\n          Score: stfTotalScore,\n          Scorek: depTotalScore,\n          link_img: link_img,\n          std_act_img: std_act_img,\n          stf_act_img: stf_act_img,\n          dep_act_img: dep_act_img\n        });\n      } else {\n        return res.sendStatus(404);\n      }\n    } catch (err) {\n      console.log('SYSTEM | BAN_CAN_SU_NHAP_DIEM_ROUTE | ERROR | ', err);\n      return res.status(500).json({\n        error: 'Lỗi hệ thống'\n      });\n    }\n  });\n  router.get('/quanlihoatdong', checkIfUserLoginRoute, async (req, res) => {\n    const user = req.session.user;\n    const school_year = await client.db(name_global_databases).collection('school_year').findOne({}, {\n      projection: {\n        _id: 0,\n        year: 1\n      }\n    });\n    // check user login:\n    if (user.pow[3]) {\n      let branch_list = await client.db(name_global_databases).collection('branchs').find({\n        dep: user.dep\n      }, {\n        projection: {\n          _id: 1,\n          name: 1\n        }\n      }).toArray();\n      const classlist = await client.db(name_global_databases).collection('classes').find({\n        branch: {\n          $in: branch_list.map(branch => branch._id)\n        }\n      }, {\n        projection: {\n          _id: 1,\n          branch: 1\n        }\n      }).toArray();\n      const years = await client.db(name_global_databases).collection('classes').findOne({\n        _id: classlist[0]._id\n      }, {\n        projection: {\n          _id: 0,\n          years: 1\n        }\n      });\n\n      // get all activities of school\n      const school_atv = await client.db(name_global_databases).collection('activities').find({\n        year: school_year.year\n      }, {\n        projection: {\n          name: 1,\n          content: 1,\n          year: 1,\n          start_time: 1\n        }\n      }).limit(10).toArray();\n\n      // get all activities of dep\n      const dep_atv = await client.db(user.dep).collection('activities').find({\n        year: school_year.year\n      }, {\n        projection: {\n          name: 1,\n          content: 1,\n          year: 1,\n          start_time: 1\n        }\n      }).limit(10).toArray();\n\n      // get all activities of class of department\n      const collections = await client.db(user.dep).listCollections().toArray();\n\n      // Filter collections ending with '_activities'\n      const activityCollections = collections.filter(collection => collection.name.endsWith('_activities'));\n\n      // Loop through activity collections and retrieve all documents\n      const cls_atvs = await activityCollections.map(async collection => {\n        const dummy = await client.db(user.dep).collection(collection.name).find({\n          year: school_year.year,\n          cls: user.cls[0]\n        }, {\n          projection: {\n            name: 1,\n            content: 1,\n            cls: 1,\n            year: 1,\n            start_time: 1\n          }\n        }).limit(10).toArray();\n        return dummy;\n      });\n      Promise.all(cls_atvs).then(results => {\n        // Khi tất cả các promise đã hoàn thành, results sẽ là một mảng chứa kết quả từ mỗi truy vấn.\n        // Bạn có thể làm gì đó với kết quả ở đây.\n\n        const cls_atv = [].concat(...results); // Kết hợp kết quả từ các truy vấn vào một mảng duy nhất\n\n        return res.render('bancansu-manage-activities', {\n          header: 'global-header',\n          footer: 'global-footer',\n          thongbao: 'global-notifications',\n          cls: classlist,\n          years: years.years,\n          curr_year: school_year.year,\n          branch: branch_list,\n          school_atv: school_atv,\n          dep_atv: dep_atv,\n          cls_atv: cls_atv\n        });\n      }).catch(error => {\n        // Xử lý lỗi nếu có\n        console.log(error);\n      });\n    } else {\n      return res.sendStatus(403);\n    }\n  });\n\n  // danh gia hoat dong\n  router.get('/quanlihoatdong/danhgiahoatdong', checkIfUserLoginRoute, async (req, res) => {\n    return res.render('bancansu-activity-assessment', {\n      header: 'global-header',\n      footer: 'global-footer'\n    });\n  });\n\n  // danh sach bang diem\n  router.get('/danhsachbangdiem', checkIfUserLoginRoute, async (req, res) => {\n    try {\n      const user = req.session.user;\n      const school_year = await client.db(name_global_databases).collection('school_year').findOne({}, {\n        projection: {\n          _id: 0,\n          year: 1\n        }\n      });\n      // check user login:\n      if (user.pow[1]) {\n        const years = await client.db(name_global_databases).collection('classes').findOne({\n          _id: user.cls[0]\n        }, {\n          projection: {\n            _id: 0,\n            years: 1\n          }\n        });\n        // get all student in staff member class:\n        const student_list = sortStudentName(await client.db(name_global_databases).collection('user_info').find({\n          class: user.cls[0],\n          'power.0': {\n            $exists: true\n          }\n        }, {\n          projection: {\n            first_name: 1,\n            last_name: 1,\n            total_score: 1\n          }\n        }).toArray());\n        // get all student total score from themself:\n        let render = {\n          header: 'global-header',\n          footer: 'global-footer',\n          thongbao: 'global-notifications',\n          student_list: student_list,\n          cls: user.cls,\n          years: years.years,\n          curr_year: school_year.year\n        };\n        return res.render('bancansu-grade-list', render);\n      } else {\n        // user not staff members\n        // redirect to home\n        return res.redirect('/');\n      }\n    } catch (e) {\n      console.log('SYSTEM | BAN_CAN_SU_DANH_SACH_BANG_DIEM | ERROR | ', e);\n    }\n  });\n  return router;\n}\nmodule.exports = createStaffRouter;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIlJvdXRlciIsInNlcnZlciIsImNoZWNrSWZVc2VyTG9naW5Sb3V0ZSIsInNvcnRTdHVkZW50TmFtZSIsImdldE5hbWVHbG9iYWwiLCJuYW1lX2dsb2JhbF9kYXRhYmFzZXMiLCJjcmVhdGVTdGFmZlJvdXRlciIsImNsaWVudCIsImdldCIsInJlcSIsInJlcyIsInVzZXIiLCJzZXNzaW9uIiwibXNzdiIsInF1ZXJ5Iiwic3R1ZGVudElkIiwic2Nob29sWWVhclBhcmFtIiwic2Nob29sWWVhciIsInN0dWRlbnRUb3RhbFNjb3JlIiwiZGIiLCJkZXAiLCJjb2xsZWN0aW9uIiwiY2xzIiwiZmluZE9uZSIsInNjaG9vbF95ZWFyIiwicHJvamVjdGlvbiIsIl9pZCIsImZpcnN0Iiwic2Vjb25kIiwidGhpcmQiLCJmb3VydGgiLCJmaWZ0aCIsInRvdGFsIiwiaW1nX2lkcyIsInN0ZlRvdGFsU2NvcmUiLCJkZXBUb3RhbFNjb3JlIiwibGltZ19pZHMiLCJudWxsdGFibGUiLCJsaW5rX2ltZyIsInN0ZF9hY3RfaW1nIiwic3RmX2FjdF9pbWciLCJkZXBfYWN0X2ltZyIsImtleSIsInZhbHVlIiwiT2JqZWN0IiwiZW50cmllcyIsImkiLCJwdXNoIiwiZ2V0RHJpdmVGaWxlTGlua0FuZERlc2NyaXB0aW9uIiwiYWN0aXZpdGllX2luZm8iLCJuYW1lIiwiaW1naW5mbyIsInJlbmRlciIsImhlYWRlciIsInRob25nYmFvIiwiZm9vdGVyIiwiU2NvcmVzdGQiLCJTY29yZSIsIlNjb3JlayIsInNlbmRTdGF0dXMiLCJlcnIiLCJjb25zb2xlIiwibG9nIiwic3RhdHVzIiwianNvbiIsImVycm9yIiwieWVhciIsInBvdyIsImJyYW5jaF9saXN0IiwiZmluZCIsInRvQXJyYXkiLCJjbGFzc2xpc3QiLCJicmFuY2giLCIkaW4iLCJtYXAiLCJ5ZWFycyIsInNjaG9vbF9hdHYiLCJjb250ZW50Iiwic3RhcnRfdGltZSIsImxpbWl0IiwiZGVwX2F0diIsImNvbGxlY3Rpb25zIiwibGlzdENvbGxlY3Rpb25zIiwiYWN0aXZpdHlDb2xsZWN0aW9ucyIsImZpbHRlciIsImVuZHNXaXRoIiwiY2xzX2F0dnMiLCJkdW1teSIsIlByb21pc2UiLCJhbGwiLCJ0aGVuIiwicmVzdWx0cyIsImNsc19hdHYiLCJjb25jYXQiLCJjdXJyX3llYXIiLCJjYXRjaCIsInN0dWRlbnRfbGlzdCIsImNsYXNzIiwiJGV4aXN0cyIsImZpcnN0X25hbWUiLCJsYXN0X25hbWUiLCJ0b3RhbF9zY29yZSIsInJlZGlyZWN0IiwiZSIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6IkQ6XFxwcm9qZWN0XFx3ZWJcXG5ld0NEUkwtMVxcYmFja2VuZFxccm91dGVyXFwiLCJzb3VyY2VzIjpbInN0YWZmUm91dGVycy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBleHByZXNzID0gcmVxdWlyZSgnZXhwcmVzcycpO1xyXG5jb25zdCByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpO1xyXG5jb25zdCBzZXJ2ZXIgPSByZXF1aXJlKCcuLi9saWIvY3NkbF9nb29nbGVfbGliJyk7XHJcbmNvbnN0IHsgY2hlY2tJZlVzZXJMb2dpblJvdXRlLCBzb3J0U3R1ZGVudE5hbWUgfSA9IHJlcXVpcmUoJy4uL2xpYi9mdW5jdGlvbl9saWInKTtcclxuY29uc3QgeyBnZXROYW1lR2xvYmFsIH0gPSByZXF1aXJlKCcuLi9saWIvbW9nb2RiX2xpYicpO1xyXG5jb25zdCBuYW1lX2dsb2JhbF9kYXRhYmFzZXMgPSBnZXROYW1lR2xvYmFsKCk7XHJcbmZ1bmN0aW9uIGNyZWF0ZVN0YWZmUm91dGVyKGNsaWVudCkge1xyXG4gICAgLy8gYmFuIGNhbiBzdSBuaGFwIGRpZW0gcm91dGVcclxuICAgIHJvdXRlci5nZXQoJy9uaGFwZGllbWRhbmhnaWEnLCBjaGVja0lmVXNlckxvZ2luUm91dGUsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVzZXIgPSByZXEuc2Vzc2lvbi51c2VyO1xyXG4gICAgICAgICAgICBjb25zdCBtc3N2ID0gcmVxLnF1ZXJ5LnN0dWRlbnRJZDtcclxuICAgICAgICAgICAgY29uc3Qgc2Nob29sWWVhclBhcmFtID0gcmVxLnF1ZXJ5LnNjaG9vbFllYXI7XHJcblxyXG4gICAgICAgICAgICBsZXQgc3R1ZGVudFRvdGFsU2NvcmUgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgIC5kYih1c2VyLmRlcClcclxuICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKHVzZXIuY2xzWzBdICsgJ19zdGRfdGFibGUnKVxyXG4gICAgICAgICAgICAgICAgLmZpbmRPbmUoXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtc3N2OiBtc3N2LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY2hvb2xfeWVhcjogc2Nob29sWWVhclBhcmFtLFxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9qZWN0aW9uOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaWQ6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJzdDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlY29uZDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXJkOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91cnRoOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlmdGg6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltZ19pZHM6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICBsZXQgc3RmVG90YWxTY29yZSA9IGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgLmRiKHVzZXIuZGVwKVxyXG4gICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24odXNlci5jbHNbMF0gKyAnX3N0Zl90YWJsZScpXHJcbiAgICAgICAgICAgICAgICAuZmluZE9uZShcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1zc3Y6IG1zc3YsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjaG9vbF95ZWFyOiBzY2hvb2xZZWFyUGFyYW0sXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2plY3Rpb246IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0OiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Vjb25kOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcmQ6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3VydGg6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWZ0aDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW1nX2lkczogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgIGxldCBkZXBUb3RhbFNjb3JlID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAuZGIodXNlci5kZXApXHJcbiAgICAgICAgICAgICAgICAuY29sbGVjdGlvbih1c2VyLmNsc1swXSArICdfZGVwX3RhYmxlJylcclxuICAgICAgICAgICAgICAgIC5maW5kT25lKFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbXNzdjogbXNzdixcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2Nob29sX3llYXI6IHNjaG9vbFllYXJQYXJhbSxcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvamVjdGlvbjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2lkOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3Q6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWNvbmQ6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlyZDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvdXJ0aDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZnRoOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWw6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW1nX2lkczogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgIG51bGx0YWJsZSA9IHtcclxuICAgICAgICAgICAgICAgIGZpZnRoOiBbJ0NoxrBhIGNo4bqlbScsICdDaMawYSBjaOG6pW0nLCAnQ2jGsGEgY2jhuqVtJywgJ0NoxrBhIGNo4bqlbSddLFxyXG4gICAgICAgICAgICAgICAgZmlyc3Q6IFsnQ2jGsGEgY2jhuqVtJywgJ0NoxrBhIGNo4bqlbScsICdDaMawYSBjaOG6pW0nLCAnQ2jGsGEgY2jhuqVtJywgJ0NoxrBhIGNo4bqlbSddLFxyXG4gICAgICAgICAgICAgICAgZm91cnRoOiBbJ0NoxrBhIGNo4bqlbScsICdDaMawYSBjaOG6pW0nLCAnQ2jGsGEgY2jhuqVtJ10sXHJcbiAgICAgICAgICAgICAgICBzZWNvbmQ6IFsnQ2jGsGEgY2jhuqVtJywgJ0NoxrBhIGNo4bqlbSddLFxyXG4gICAgICAgICAgICAgICAgdGhpcmQ6IFsnQ2jGsGEgY2jhuqVtJywgJ0NoxrBhIGNo4bqlbScsICdDaMawYSBjaOG6pW0nXSxcclxuICAgICAgICAgICAgICAgIHRvdGFsOiAnQ2jGsGEgY2jhuqVtJyxcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIGlmICghc3RmVG90YWxTY29yZSkge1xyXG4gICAgICAgICAgICAgICAgc3RmVG90YWxTY29yZSA9IG51bGx0YWJsZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoIWRlcFRvdGFsU2NvcmUpIHtcclxuICAgICAgICAgICAgICAgIGRlcFRvdGFsU2NvcmUgPSBudWxsdGFibGU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbGV0IGxpbmtfaW1nID0gW107XHJcbiAgICAgICAgICAgIGxldCBzdGRfYWN0X2ltZyA9IHt9O1xyXG4gICAgICAgICAgICBsZXQgc3RmX2FjdF9pbWcgPSB7fTtcclxuICAgICAgICAgICAgbGV0IGRlcF9hY3RfaW1nID0ge307XHJcblxyXG4gICAgICAgICAgICBpZiAoc3R1ZGVudFRvdGFsU2NvcmUpIHtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHN0dWRlbnRUb3RhbFNjb3JlLmltZ19pZHMpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGtleSA9PSAnZ2xvYmFsJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGkgb2YgdmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmtfaW1nLnB1c2goYXdhaXQgc2VydmVyLmdldERyaXZlRmlsZUxpbmtBbmREZXNjcmlwdGlvbihpKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgYWN0aXZpdGllX2luZm87XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXRpZV9pbmZvID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZGIodXNlci5kZXApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbihgJHt1c2VyLmNsc1swXX1fYWN0aXZpdGllc2ApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZmluZE9uZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZDoga2V5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBwcm9qZWN0aW9uOiB7IG5hbWU6IDEgfSB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjdGl2aXRpZV9pbmZvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGkgb2YgdmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgaW1naW5mbyA9IGF3YWl0IHNlcnZlci5nZXREcml2ZUZpbGVMaW5rQW5kRGVzY3JpcHRpb24oaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0ZF9hY3RfaW1nW2FjdGl2aXRpZV9pbmZvLm5hbWVdICYmIGltZ2luZm8pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RkX2FjdF9pbWdbYWN0aXZpdGllX2luZm8ubmFtZV0ucHVzaChpbWdpbmZvKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGltZ2luZm8pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RkX2FjdF9pbWdbYWN0aXZpdGllX2luZm8ubmFtZV0gPSBbaW1naW5mb107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdGllX2luZm8gPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZGIodXNlci5kZXApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ2FjdGl2aXRpZXMnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kT25lKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaWQ6IGtleSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBwcm9qZWN0aW9uOiB7IG5hbWU6IDEgfSB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjdGl2aXRpZV9pbmZvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpbWdpbmZvID0gYXdhaXQgc2VydmVyLmdldERyaXZlRmlsZUxpbmtBbmREZXNjcmlwdGlvbihpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0Zl9hY3RfaW1nW2FjdGl2aXRpZV9pbmZvLm5hbWVdICYmIGltZ2luZm8pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0Zl9hY3RfaW1nW2FjdGl2aXRpZV9pbmZvLm5hbWVdLnB1c2goaW1naW5mbyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaW1naW5mbykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RmX2FjdF9pbWdbYWN0aXZpdGllX2luZm8ubmFtZV0gPSBbaW1naW5mb107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXRpZV9pbmZvID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdhY3Rpdml0aWVzJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmRPbmUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2lkOiBrZXksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBwcm9qZWN0aW9uOiB7IG5hbWU6IDEgfSB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aXZpdGllX2luZm8pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgaW1naW5mbyA9IGF3YWl0IHNlcnZlci5nZXREcml2ZUZpbGVMaW5rQW5kRGVzY3JpcHRpb24oaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGVwX2FjdF9pbWdbYWN0aXZpdGllX2luZm8ubmFtZV0gJiYgaW1naW5mbykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlcF9hY3RfaW1nW2FjdGl2aXRpZV9pbmZvLm5hbWVdLnB1c2goaW1naW5mbyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGltZ2luZm8pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXBfYWN0X2ltZ1thY3Rpdml0aWVfaW5mby5uYW1lXSA9IFtpbWdpbmZvXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnJlbmRlcignYmFuY2Fuc3UtbWFuYWdlLWdyYWRlcycsIHtcclxuICAgICAgICAgICAgICAgICAgICBoZWFkZXI6ICdnbG9iYWwtaGVhZGVyJyxcclxuICAgICAgICAgICAgICAgICAgICB0aG9uZ2JhbzogJ2dsb2JhbC1ub3RpZmljYXRpb25zJyxcclxuICAgICAgICAgICAgICAgICAgICBmb290ZXI6ICdnbG9iYWwtZm9vdGVyJyxcclxuICAgICAgICAgICAgICAgICAgICBTY29yZXN0ZDogc3R1ZGVudFRvdGFsU2NvcmUsXHJcbiAgICAgICAgICAgICAgICAgICAgU2NvcmU6IHN0ZlRvdGFsU2NvcmUsXHJcbiAgICAgICAgICAgICAgICAgICAgU2NvcmVrOiBkZXBUb3RhbFNjb3JlLFxyXG4gICAgICAgICAgICAgICAgICAgIGxpbmtfaW1nOiBsaW5rX2ltZyxcclxuICAgICAgICAgICAgICAgICAgICBzdGRfYWN0X2ltZzogc3RkX2FjdF9pbWcsXHJcbiAgICAgICAgICAgICAgICAgICAgc3RmX2FjdF9pbWc6IHN0Zl9hY3RfaW1nLFxyXG4gICAgICAgICAgICAgICAgICAgIGRlcF9hY3RfaW1nOiBkZXBfYWN0X2ltZyxcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zZW5kU3RhdHVzKDQwNCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1NZU1RFTSB8IEJBTl9DQU5fU1VfTkhBUF9ESUVNX1JPVVRFIHwgRVJST1IgfCAnLCBlcnIpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0zhu5dpIGjhu4cgdGjhu5FuZycgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcm91dGVyLmdldCgnL3F1YW5saWhvYXRkb25nJywgY2hlY2tJZlVzZXJMb2dpblJvdXRlLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICAgICAgICBjb25zdCB1c2VyID0gcmVxLnNlc3Npb24udXNlcjtcclxuXHJcbiAgICAgICAgY29uc3Qgc2Nob29sX3llYXIgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ3NjaG9vbF95ZWFyJylcclxuICAgICAgICAgICAgLmZpbmRPbmUoe30sIHsgcHJvamVjdGlvbjogeyBfaWQ6IDAsIHllYXI6IDEgfSB9KTtcclxuICAgICAgICAvLyBjaGVjayB1c2VyIGxvZ2luOlxyXG4gICAgICAgIGlmICh1c2VyLnBvd1szXSkge1xyXG4gICAgICAgICAgICBsZXQgYnJhbmNoX2xpc3QgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAuY29sbGVjdGlvbignYnJhbmNocycpXHJcbiAgICAgICAgICAgICAgICAuZmluZCh7IGRlcDogdXNlci5kZXAgfSwgeyBwcm9qZWN0aW9uOiB7IF9pZDogMSwgbmFtZTogMSB9IH0pXHJcbiAgICAgICAgICAgICAgICAudG9BcnJheSgpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgY2xhc3NsaXN0ID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ2NsYXNzZXMnKVxyXG4gICAgICAgICAgICAgICAgLmZpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgeyBicmFuY2g6IHsgJGluOiBicmFuY2hfbGlzdC5tYXAoKGJyYW5jaCkgPT4gYnJhbmNoLl9pZCkgfSB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHsgcHJvamVjdGlvbjogeyBfaWQ6IDEsIGJyYW5jaDogMSB9IH0sXHJcbiAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAudG9BcnJheSgpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgeWVhcnMgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAuY29sbGVjdGlvbignY2xhc3NlcycpXHJcbiAgICAgICAgICAgICAgICAuZmluZE9uZSh7IF9pZDogY2xhc3NsaXN0WzBdLl9pZCB9LCB7IHByb2plY3Rpb246IHsgX2lkOiAwLCB5ZWFyczogMSB9IH0pO1xyXG5cclxuICAgICAgICAgICAgLy8gZ2V0IGFsbCBhY3Rpdml0aWVzIG9mIHNjaG9vbFxyXG4gICAgICAgICAgICBjb25zdCBzY2hvb2xfYXR2ID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ2FjdGl2aXRpZXMnKVxyXG4gICAgICAgICAgICAgICAgLmZpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB5ZWFyOiBzY2hvb2xfeWVhci55ZWFyLFxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9qZWN0aW9uOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHllYXI6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydF90aW1lOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAubGltaXQoMTApXHJcbiAgICAgICAgICAgICAgICAudG9BcnJheSgpO1xyXG5cclxuICAgICAgICAgICAgLy8gZ2V0IGFsbCBhY3Rpdml0aWVzIG9mIGRlcFxyXG4gICAgICAgICAgICBjb25zdCBkZXBfYXR2ID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAuZGIodXNlci5kZXApXHJcbiAgICAgICAgICAgICAgICAuY29sbGVjdGlvbignYWN0aXZpdGllcycpXHJcbiAgICAgICAgICAgICAgICAuZmluZChcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHllYXI6IHNjaG9vbF95ZWFyLnllYXIsXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2plY3Rpb246IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeWVhcjogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0X3RpbWU6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgIC5saW1pdCgxMClcclxuICAgICAgICAgICAgICAgIC50b0FycmF5KCk7XHJcblxyXG4gICAgICAgICAgICAvLyBnZXQgYWxsIGFjdGl2aXRpZXMgb2YgY2xhc3Mgb2YgZGVwYXJ0bWVudFxyXG4gICAgICAgICAgICBjb25zdCBjb2xsZWN0aW9ucyA9IGF3YWl0IGNsaWVudC5kYih1c2VyLmRlcCkubGlzdENvbGxlY3Rpb25zKCkudG9BcnJheSgpO1xyXG5cclxuICAgICAgICAgICAgLy8gRmlsdGVyIGNvbGxlY3Rpb25zIGVuZGluZyB3aXRoICdfYWN0aXZpdGllcydcclxuICAgICAgICAgICAgY29uc3QgYWN0aXZpdHlDb2xsZWN0aW9ucyA9IGNvbGxlY3Rpb25zLmZpbHRlcigoY29sbGVjdGlvbikgPT4gY29sbGVjdGlvbi5uYW1lLmVuZHNXaXRoKCdfYWN0aXZpdGllcycpKTtcclxuXHJcbiAgICAgICAgICAgIC8vIExvb3AgdGhyb3VnaCBhY3Rpdml0eSBjb2xsZWN0aW9ucyBhbmQgcmV0cmlldmUgYWxsIGRvY3VtZW50c1xyXG4gICAgICAgICAgICBjb25zdCBjbHNfYXR2cyA9IGF3YWl0IGFjdGl2aXR5Q29sbGVjdGlvbnMubWFwKGFzeW5jIChjb2xsZWN0aW9uKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBkdW1teSA9IGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgIC5kYih1c2VyLmRlcClcclxuICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbihjb2xsZWN0aW9uLm5hbWUpXHJcbiAgICAgICAgICAgICAgICAgICAgLmZpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHllYXI6IHNjaG9vbF95ZWFyLnllYXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbHM6IHVzZXIuY2xzWzBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9qZWN0aW9uOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsczogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ZWFyOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0X3RpbWU6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICAubGltaXQoMTApXHJcbiAgICAgICAgICAgICAgICAgICAgLnRvQXJyYXkoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBkdW1teTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIFByb21pc2UuYWxsKGNsc19hdHZzKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oKHJlc3VsdHMpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBLaGkgdOG6pXQgY+G6oyBjw6FjIHByb21pc2UgxJHDoyBob8OgbiB0aMOgbmgsIHJlc3VsdHMgc+G6vSBsw6AgbeG7mXQgbeG6o25nIGNo4bupYSBr4bq/dCBxdeG6oyB04burIG3hu5dpIHRydXkgduG6pW4uXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gQuG6oW4gY8OzIHRo4buDIGzDoG0gZ8OsIMSRw7MgduG7m2kga+G6v3QgcXXhuqMg4bufIMSRw6J5LlxyXG5cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjbHNfYXR2ID0gW10uY29uY2F0KC4uLnJlc3VsdHMpOyAvLyBL4bq/dCBo4bujcCBr4bq/dCBxdeG6oyB04burIGPDoWMgdHJ1eSB24bqlbiB2w6BvIG3hu5l0IG3huqNuZyBkdXkgbmjhuqV0XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXMucmVuZGVyKCdiYW5jYW5zdS1tYW5hZ2UtYWN0aXZpdGllcycsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyOiAnZ2xvYmFsLWhlYWRlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvb3RlcjogJ2dsb2JhbC1mb290ZXInLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aG9uZ2JhbzogJ2dsb2JhbC1ub3RpZmljYXRpb25zJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2xzOiBjbGFzc2xpc3QsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHllYXJzOiB5ZWFycy55ZWFycyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3Vycl95ZWFyOiBzY2hvb2xfeWVhci55ZWFyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmFuY2g6IGJyYW5jaF9saXN0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY2hvb2xfYXR2OiBzY2hvb2xfYXR2LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXBfYXR2OiBkZXBfYXR2LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbHNfYXR2OiBjbHNfYXR2LFxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBY4butIGzDvSBs4buXaSBu4bq/dSBjw7NcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNDAzKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBkYW5oIGdpYSBob2F0IGRvbmdcclxuICAgIHJvdXRlci5nZXQoJy9xdWFubGlob2F0ZG9uZy9kYW5oZ2lhaG9hdGRvbmcnLCBjaGVja0lmVXNlckxvZ2luUm91dGUsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgICAgIHJldHVybiByZXMucmVuZGVyKCdiYW5jYW5zdS1hY3Rpdml0eS1hc3Nlc3NtZW50Jywge1xyXG4gICAgICAgICAgICBoZWFkZXI6ICdnbG9iYWwtaGVhZGVyJyxcclxuICAgICAgICAgICAgZm9vdGVyOiAnZ2xvYmFsLWZvb3RlcicsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBkYW5oIHNhY2ggYmFuZyBkaWVtXHJcbiAgICByb3V0ZXIuZ2V0KCcvZGFuaHNhY2hiYW5nZGllbScsIGNoZWNrSWZVc2VyTG9naW5Sb3V0ZSwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgdXNlciA9IHJlcS5zZXNzaW9uLnVzZXI7XHJcbiAgICAgICAgICAgIGNvbnN0IHNjaG9vbF95ZWFyID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ3NjaG9vbF95ZWFyJylcclxuICAgICAgICAgICAgICAgIC5maW5kT25lKHt9LCB7IHByb2plY3Rpb246IHsgX2lkOiAwLCB5ZWFyOiAxIH0gfSk7XHJcbiAgICAgICAgICAgIC8vIGNoZWNrIHVzZXIgbG9naW46XHJcbiAgICAgICAgICAgIGlmICh1c2VyLnBvd1sxXSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgeWVhcnMgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdjbGFzc2VzJylcclxuICAgICAgICAgICAgICAgICAgICAuZmluZE9uZSh7IF9pZDogdXNlci5jbHNbMF0gfSwgeyBwcm9qZWN0aW9uOiB7IF9pZDogMCwgeWVhcnM6IDEgfSB9KTtcclxuICAgICAgICAgICAgICAgIC8vIGdldCBhbGwgc3R1ZGVudCBpbiBzdGFmZiBtZW1iZXIgY2xhc3M6XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzdHVkZW50X2xpc3QgPSBzb3J0U3R1ZGVudE5hbWUoXHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCd1c2VyX2luZm8nKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZmluZChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgY2xhc3M6IHVzZXIuY2xzWzBdLCAncG93ZXIuMCc6IHsgJGV4aXN0czogdHJ1ZSB9IH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHByb2plY3Rpb246IHsgZmlyc3RfbmFtZTogMSwgbGFzdF9uYW1lOiAxLCB0b3RhbF9zY29yZTogMSB9IH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnRvQXJyYXkoKSxcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAvLyBnZXQgYWxsIHN0dWRlbnQgdG90YWwgc2NvcmUgZnJvbSB0aGVtc2VsZjpcclxuICAgICAgICAgICAgICAgIGxldCByZW5kZXIgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyOiAnZ2xvYmFsLWhlYWRlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgZm9vdGVyOiAnZ2xvYmFsLWZvb3RlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgdGhvbmdiYW86ICdnbG9iYWwtbm90aWZpY2F0aW9ucycsXHJcbiAgICAgICAgICAgICAgICAgICAgc3R1ZGVudF9saXN0OiBzdHVkZW50X2xpc3QsXHJcbiAgICAgICAgICAgICAgICAgICAgY2xzOiB1c2VyLmNscyxcclxuICAgICAgICAgICAgICAgICAgICB5ZWFyczogeWVhcnMueWVhcnMsXHJcbiAgICAgICAgICAgICAgICAgICAgY3Vycl95ZWFyOiBzY2hvb2xfeWVhci55ZWFyLFxyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnJlbmRlcignYmFuY2Fuc3UtZ3JhZGUtbGlzdCcsIHJlbmRlcik7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyB1c2VyIG5vdCBzdGFmZiBtZW1iZXJzXHJcbiAgICAgICAgICAgICAgICAvLyByZWRpcmVjdCB0byBob21lXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnJlZGlyZWN0KCcvJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTWVNURU0gfCBCQU5fQ0FOX1NVX0RBTkhfU0FDSF9CQU5HX0RJRU0gfCBFUlJPUiB8ICcsIGUpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiByb3V0ZXI7XHJcbn1cclxubW9kdWxlLmV4cG9ydHMgPSBjcmVhdGVTdGFmZlJvdXRlcjtcclxuIl0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxPQUFPLEdBQUdDLE9BQU8sQ0FBQyxTQUFTLENBQUM7QUFDbEMsTUFBTUMsTUFBTSxHQUFHRixPQUFPLENBQUNHLE1BQU0sQ0FBQyxDQUFDO0FBQy9CLE1BQU1DLE1BQU0sR0FBR0gsT0FBTyxDQUFDLHdCQUF3QixDQUFDO0FBQ2hELE1BQU07RUFBRUkscUJBQXFCO0VBQUVDO0FBQWdCLENBQUMsR0FBR0wsT0FBTyxDQUFDLHFCQUFxQixDQUFDO0FBQ2pGLE1BQU07RUFBRU07QUFBYyxDQUFDLEdBQUdOLE9BQU8sQ0FBQyxtQkFBbUIsQ0FBQztB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","map":{"version":3,"names":["express","require","router","Router","server","checkIfUserLoginRoute","sortStudentName","getNameGlobal","name_global_databases","createStaffRouter","client","get","req","res","user","session","mssv","query","studentId","schoolYearParam","schoolYear","studentTotalScore","db","dep","collection","cls","findOne","school_year","projection","_id","first","second","third","fourth","fifth","total","img_ids","stfTotalScore","depTotalScore","limg_ids","nulltable","link_img","std_act_img","stf_act_img","dep_act_img","key","value","Object","entries","i","push","getDriveFileLinkAndDescription","activitie_info","name","imginfo","render","header","thongbao","footer","Scorestd","Score","Scorek","sendStatus","err","console","log","status","json","error","year","pow","branch_list","find","toArray","classlist","branch","$in","map","years","school_atv","content","start_time","limit","dep_atv","collections","listCollections","activityCollections","filter","endsWith","cls_atvs","dummy","Promise","all","then","results","cls_atv","concat","curr_year","catch","student_list","class","$exists","first_name","last_name","total_score","redirect","e","module","exports"],"sourceRoot":"D:\\project\\web\\newCDRL-1\\backend\\router\\","sources":["staffRouters.js"],"sourcesContent":["const express = require('express');\r\nconst router = express.Router();\r\nconst server = require('../lib/csdl_google_lib');\r\nconst { checkIfUserLoginRoute, sortStudentName } = require('../lib/function_lib');\r\nconst { getNameGlobal } = require('../lib/mogodb_lib');\r\nconst name_global_databases = getNameGlobal();\r\nfunction createStaffRouter(client) {\r\n    // ban can su nhap diem route\r\n    router.get('/nhapdiemdanhgia', checkIfUserLoginRoute, async (req, res) => {\r\n        try {\r\n            const user = req.session.user;\r\n            const mssv = req.query.studentId;\r\n            const schoolYearParam = req.query.schoolYear;\r\n\r\n            let studentTotalScore = await client\r\n                .db(user.dep)\r\n                .collection(user.cls[0] + '_std_table')\r\n                .findOne(\r\n                    {\r\n                        mssv: mssv,\r\n                        school_year: schoolYearParam,\r\n                    },\r\n                    {\r\n                        projection: {\r\n                            _id: 0,\r\n                            first: 1,\r\n                            second: 1,\r\n                            third: 1,\r\n                            fourth: 1,\r\n                            fifth: 1,\r\n                            total: 1,\r\n                            img_ids: 1,\r\n                        },\r\n                    },\r\n                );\r\n\r\n            let stfTotalScore = await client\r\n                .db(user.dep)\r\n                .collection(user.cls[0] + '_stf_table')\r\n                .findOne(\r\n                    {\r\n                        mssv: mssv,\r\n                        school_year: schoolYearParam,\r\n                    },\r\n                    {\r\n                        projection: {\r\n                            _id: 0,\r\n                            first: 1,\r\n                            second: 1,\r\n                            third: 1,\r\n                            fourth: 1,\r\n                            fifth: 1,\r\n                            total: 1,\r\n                            img_ids: 1,\r\n                        },\r\n                    },\r\n                );\r\n\r\n            let depTotalScore = await client\r\n                .db(user.dep)\r\n                .collection(user.cls[0] + '_dep_table')\r\n                .findOne(\r\n                    {\r\n                        mssv: mssv,\r\n                        school_year: schoolYearParam,\r\n                    },\r\n                    {\r\n                        projection: {\r\n                            _id: 0,\r\n                            first: 1,\r\n                            second: 1,\r\n                            third: 1,\r\n                            fourth: 1,\r\n                            fifth: 1,\r\n                            total: 1,\r\n                            limg_ids: 1,\r\n                        },\r\n                    },\r\n                );\r\n\r\n            nulltable = {\r\n                fifth: ['Chưa chấm', 'Chưa chấm', 'Chưa chấm', 'Chưa chấm'],\r\n                first: ['Chưa chấm', 'Chưa chấm', 'Chưa chấm', 'Chưa chấm', 'Chưa chấm'],\r\n                fourth: ['Chưa chấm', 'Chưa chấm', 'Chưa chấm'],\r\n                second: ['Chưa chấm', 'Chưa chấm'],\r\n                third: ['Chưa chấm', 'Chưa chấm', 'Chưa chấm'],\r\n                total: 'Chưa chấm',\r\n            };\r\n\r\n            if (!stfTotalScore) {\r\n                stfTotalScore = nulltable;\r\n            }\r\n            if (!depTotalScore) {\r\n                depTotalScore = nulltable;\r\n            }\r\n            let link_img = [];\r\n            let std_act_img = {};\r\n            let stf_act_img = {};\r\n            let dep_act_img = {};\r\n\r\n            if (studentTotalScore) {\r\n                for (const [key, value] of Object.entries(studentTotalScore.img_ids)) {\r\n                    if (key == 'global') {\r\n                        for (const i of value) {\r\n                            link_img.push(await server.getDriveFileLinkAndDescription(i));\r\n                        }\r\n                    } else {\r\n                        let activitie_info;\r\n                        activitie_info = await client\r\n                            .db(user.dep)\r\n                            .collection(`${user.cls[0]}_activities`)\r\n                            .findOne(\r\n                                {\r\n                                    _id: key,\r\n                                },\r\n                                { projection: { name: 1 } },\r\n                            );\r\n                        if (activitie_info) {\r\n                            for (const i of value) {\r\n                                let imginfo = await server.getDriveFileLinkAndDescription(i);\r\n                                if (std_act_img[activitie_info.name] && imginfo) {\r\n                                    std_act_img[activitie_info.name].push(imginfo);\r\n                                } else if (imginfo) {\r\n                                    std_act_img[activitie_info.name] = [imginfo];\r\n                                }\r\n                            }\r\n                        } else {\r\n                            activitie_info = await client\r\n                                .db(user.dep)\r\n                                .collection('activities')\r\n                                .findOne(\r\n                                    {\r\n                                        _id: key,\r\n                                    },\r\n                                    { projection: { name: 1 } },\r\n                                );\r\n\r\n                            if (activitie_info) {\r\n                                for (const i of value) {\r\n                                    let imginfo = await server.getDriveFileLinkAndDescription(i);\r\n                                    if (stf_act_img[activitie_info.name] && imginfo) {\r\n                                        stf_act_img[activitie_info.name].push(imginfo);\r\n                                    } else if (imginfo) {\r\n                                        stf_act_img[activitie_info.name] = [imginfo];\r\n                                    }\r\n                                }\r\n                            } else {\r\n                                activitie_info = await client\r\n                                    .db(name_global_databases)\r\n                                    .collection('activities')\r\n                                    .findOne(\r\n                                        {\r\n                                            _id: key,\r\n                                        },\r\n                                        { projection: { name: 1 } },\r\n                                    );\r\n\r\n                                if (activitie_info) {\r\n                                    for (const i of value) {\r\n                                        let imginfo = await server.getDriveFileLinkAndDescription(i);\r\n                                        if (dep_act_img[activitie_info.name] && imginfo) {\r\n                                            dep_act_img[activitie_info.name].push(imginfo);\r\n                                        } else if (imginfo) {\r\n                                            dep_act_img[activitie_info.name] = [imginfo];\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n                return res.render('bancansu-manage-grades', {\r\n                    header: 'global-header',\r\n                    thongbao: 'global-notifications',\r\n                    footer: 'global-footer',\r\n                    Scorestd: studentTotalScore,\r\n                    Score: stfTotalScore,\r\n                    Scorek: depTotalScore,\r\n                    link_img: link_img,\r\n                    std_act_img: std_act_img,\r\n                    stf_act_img: stf_act_img,\r\n                    dep_act_img: dep_act_img,\r\n                });\r\n            } else {\r\n                return res.sendStatus(404);\r\n            }\r\n        } catch (err) {\r\n            console.log('SYSTEM | BAN_CAN_SU_NHAP_DIEM_ROUTE | ERROR | ', err);\r\n            return res.status(500).json({ error: 'Lỗi hệ thống' });\r\n        }\r\n    });\r\n\r\n    router.get('/quanlihoatdong', checkIfUserLoginRoute, async (req, res) => {\r\n        const user = req.session.user;\r\n\r\n        const school_year = await client\r\n            .db(name_global_databases)\r\n            .collection('school_year')\r\n            .findOne({}, { projection: { _id: 0, year: 1 } });\r\n        // check user login:\r\n        if (user.pow[3]) {\r\n            let branch_list = await client\r\n                .db(name_global_databases)\r\n                .collection('branchs')\r\n                .find({ dep: user.dep }, { projection: { _id: 1, name: 1 } })\r\n                .toArray();\r\n\r\n            const classlist = await client\r\n                .db(name_global_databases)\r\n                .collection('classes')\r\n                .find(\r\n                    { branch: { $in: branch_list.map((branch) => branch._id) } },\r\n                    { projection: { _id: 1, branch: 1 } },\r\n                )\r\n                .toArray();\r\n\r\n            const years = await client\r\n                .db(name_global_databases)\r\n                .collection('classes')\r\n                .findOne({ _id: classlist[0]._id }, { projection: { _id: 0, years: 1 } });\r\n\r\n            // get all activities of school\r\n            const school_atv = await client\r\n                .db(name_global_databases)\r\n                .collection('activities')\r\n                .find(\r\n                    {\r\n                        year: school_year.year,\r\n                    },\r\n                    {\r\n                        projection: {\r\n                            name: 1,\r\n                            content: 1,\r\n                            year: 1,\r\n                            start_time: 1,\r\n                        },\r\n                    },\r\n                )\r\n                .limit(10)\r\n                .toArray();\r\n\r\n            // get all activities of dep\r\n            const dep_atv = await client\r\n                .db(user.dep)\r\n                .collection('activities')\r\n                .find(\r\n                    {\r\n                        year: school_year.year,\r\n                    },\r\n                    {\r\n                        projection: {\r\n                            name: 1,\r\n                            content: 1,\r\n                            year: 1,\r\n                            start_time: 1,\r\n                        },\r\n                    },\r\n                )\r\n                .limit(10)\r\n                .toArray();\r\n\r\n            // get all activities of class of department\r\n            const collections = await client.db(user.dep).listCollections().toArray();\r\n\r\n            // Filter collections ending with '_activities'\r\n            const activityCollections = collections.filter((collection) => collection.name.endsWith('_activities'));\r\n\r\n            // Loop through activity collections and retrieve all documents\r\n            const cls_atvs = await activityCollections.map(async (collection) => {\r\n                const dummy = await client\r\n                    .db(user.dep)\r\n                    .collection(collection.name)\r\n                    .find(\r\n                        {\r\n                            year: school_year.year,\r\n                            cls: user.cls[0],\r\n                        },\r\n                        {\r\n                            projection: {\r\n                                name: 1,\r\n                                content: 1,\r\n                                cls: 1,\r\n                                year: 1,\r\n                                start_time: 1,\r\n                            },\r\n                        },\r\n                    )\r\n                    .limit(10)\r\n                    .toArray();\r\n                return dummy;\r\n            });\r\n            Promise.all(cls_atvs)\r\n                .then((results) => {\r\n                    // Khi tất cả các promise đã hoàn thành, results sẽ là một mảng chứa kết quả từ mỗi truy vấn.\r\n                    // Bạn có thể làm gì đó với kết quả ở đây.\r\n\r\n                    const cls_atv = [].concat(...results); // Kết hợp kết quả từ các truy vấn vào một mảng duy nhất\r\n\r\n                    return res.render('bancansu-manage-activities', {\r\n                        header: 'global-header',\r\n                        footer: 'global-footer',\r\n                        thongbao: 'global-notifications',\r\n                        cls: classlist,\r\n                        years: years.years,\r\n                        curr_year: school_year.year,\r\n                        branch: branch_list,\r\n                        school_atv: school_atv,\r\n                        dep_atv: dep_atv,\r\n                        cls_atv: cls_atv,\r\n                    });\r\n                })\r\n                .catch((error) => {\r\n                    // Xử lý lỗi nếu có\r\n                    console.log(error);\r\n                });\r\n        } else {\r\n            return res.sendStatus(403);\r\n        }\r\n    });\r\n\r\n    // danh gia hoat dong\r\n    router.get('/quanlihoatdong/danhgiahoatdong', checkIfUserLoginRoute, async (req, res) => {\r\n        return res.render('bancansu-activity-assessment', {\r\n            header: 'global-header',\r\n            footer: 'global-footer',\r\n        });\r\n    });\r\n\r\n    // danh sach bang diem\r\n    router.get('/danhsachbangdiem', checkIfUserLoginRoute, async (req, res) => {\r\n        try {\r\n            const user = req.session.user;\r\n            const school_year = await client\r\n                .db(name_global_databases)\r\n                .collection('school_year')\r\n                .findOne({}, { projection: { _id: 0, year: 1 } });\r\n            // check user login:\r\n            if (user.pow[1]) {\r\n                const years = await client\r\n                    .db(name_global_databases)\r\n                    .collection('classes')\r\n                    .findOne({ _id: user.cls[0] }, { projection: { _id: 0, years: 1 } });\r\n                // get all student in staff member class:\r\n                const student_list = sortStudentName(\r\n                    await client\r\n                        .db(name_global_databases)\r\n                        .collection('user_info')\r\n                        .find(\r\n                            { class: user.cls[0], 'power.0': { $exists: true } },\r\n                            { projection: { first_name: 1, last_name: 1, total_score: 1 } },\r\n                        )\r\n                        .toArray(),\r\n                );\r\n                // get all student total score from themself:\r\n                let render = {\r\n                    header: 'global-header',\r\n                    footer: 'global-footer',\r\n                    thongbao: 'global-notifications',\r\n                    student_list: student_list,\r\n                    cls: user.cls,\r\n                    years: years.years,\r\n                    curr_year: school_year.year,\r\n                };\r\n\r\n                return res.render('bancansu-grade-list', render);\r\n            } else {\r\n                // user not staff members\r\n                // redirect to home\r\n                return res.redirect('/');\r\n            }\r\n        } catch (e) {\r\n            console.log('SYSTEM | BAN_CAN_SU_DANH_SACH_BANG_DIEM | ERROR | ', e);\r\n        }\r\n    });\r\n\r\n    return router;\r\n}\r\nmodule.exports = createStaffRouter;\r\n"],"mappings":"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","ignoreList":[]}},"mtime":1705997672445},"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\project\\\\web\\\\newCDRL-1\\\\backend\\\\router\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\project\\\\web\\\\newCDRL-1\",\"filename\":\"D:\\\\project\\\\web\\\\newCDRL-1\\\\backend\\\\router\\\\teacherRoutes.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\project\\\\web\\\\newCDRL-1\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.24.3:development":{"value":{"code":"const express = require('express');\nconst router = express.Router();\nconst server = require('../lib/csdl_google_lib');\nconst {\n  checkIfUserLoginRoute,\n  sortStudentName\n} = require('../lib/function_lib');\nconst {\n  getNameGlobal\n} = require('../lib/mogodb_lib');\nconst name_global_databases = getNameGlobal();\nfunction createTeacherRouter(client) {\n  // giao vien route\n  router.get('/quanlyquyen', checkIfUserLoginRoute, async (req, res) => {\n    const user = req.session.user;\n    return res.render('teacher-manage-student', {\n      header: 'global-header',\n      footer: 'global-footer',\n      thongbao: 'global-notifications',\n      cls: user.cls\n    });\n  });\n  // danh sach bang diem co van\n  router.get('/danhsachbangdiem', checkIfUserLoginRoute, async (req, res) => {\n    try {\n      const user = req.session.user;\n      // check neu kho co lop\n      const check = await client.db(name_global_databases).collection('user_info').find({\n        class: user.cls[0],\n        'power.0': {\n          $exists: true\n        }\n      }, {\n        projection: {\n          first_name: 1,\n          last_name: 1,\n          class: 1,\n          total_score: 1\n        }\n      }).toArray();\n      //\n\n      if (check.length > 0) {\n        const school_year = await client.db(name_global_databases).collection('school_year').findOne({}, {\n          projection: {\n            _id: 0,\n            year: 1\n          }\n        });\n        // check user login:\n        if (user.pow[1]) {\n          const Years = await client.db(name_global_databases).collection('classes').findOne({\n            _id: user.cls[0]\n          }, {\n            projection: {\n              _id: 0,\n              years: 1\n            }\n          });\n\n          // get all student in staff member class:\n          const student_list = sortStudentName(await client.db(name_global_databases).collection('user_info').find({\n            class: user.cls[0],\n            'power.0': {\n              $exists: true\n            }\n          }, {\n            projection: {\n              first_name: 1,\n              last_name: 1,\n              class: 1,\n              total_score: 1\n            }\n          }).toArray());\n          // get all student total score from themself:\n          let render = {\n            header: 'global-header',\n            footer: 'global-footer',\n            thongbao: 'global-notifications',\n            student_list: student_list,\n            cls: user.cls,\n            years: Years.years,\n            curr_year: school_year.year\n          };\n          return res.render('teacher-grade-list', render);\n        } else {\n          // user not staff members\n          // redirect to home\n          return res.redirect('/');\n        }\n      }\n    } catch (e) {\n      console.log('SYSTEM | BAN_CAN_SU_DANH_SACH_BANG_DIEM | ERROR | ', e);\n    }\n  });\n  // quang ly hoat dong\n  router.get('/quanlihoatdong', checkIfUserLoginRoute, async (req, res) => {\n    const user = req.session.user;\n    const school_year = await client.db(name_global_databases).collection('school_year').findOne({}, {\n      projection: {\n        _id: 0,\n        year: 1\n      }\n    });\n\n    // check user login:\n\n    let branch_list = await client.db(name_global_databases).collection('branchs').find({\n      dep: user.dep\n    }, {\n      projection: {\n        _id: 1,\n        name: 1\n      }\n    }).toArray();\n    const classlist = await client.db(name_global_databases).collection('classes').find({\n      branch: {\n        $in: branch_list.map(branch => branch._id)\n      }\n    }, {\n      projection: {\n        _id: 1,\n        branch: 1\n      }\n    }).toArray();\n    const years = await client.db(name_global_databases).collection('classes').findOne({\n      _id: classlist[0]._id\n    }, {\n      projection: {\n        _id: 0,\n        years: 1\n      }\n    });\n\n    // get all activities of school\n    const school_atv = await client.db(name_global_databases).collection('activities').find({\n      year: school_year.year\n    }, {\n      projection: {\n        name: 1,\n        content: 1,\n        year: 1,\n        start_time: 1\n      }\n    }).limit(10).toArray();\n\n    // get all activities of dep\n    const dep_atv = await client.db(user.dep).collection('activities').find({\n      year: school_year.year\n    }, {\n      projection: {\n        name: 1,\n        content: 1,\n        year: 1,\n        start_time: 1\n      }\n    }).limit(10).toArray();\n\n    // get all activities of class of department\n    const collections = await client.db(user.dep).listCollections().toArray();\n\n    // Filter collections ending with '_activities'\n    const activityCollections = collections.filter(collection => collection.name.endsWith('_activities'));\n\n    // Loop through activity collections and retrieve all documents\n    const cls_atvs = await activityCollections.map(async collection => {\n      const dummy = await client.db(user.dep).collection(collection.name).find({\n        year: school_year.year\n      }, {\n        projection: {\n          name: 1,\n          content: 1,\n          cls: 1,\n          year: 1,\n          start_time: 1\n        }\n      }).limit(10).toArray();\n      return dummy;\n    });\n    Promise.all(cls_atvs).then(results => {\n      // Khi tất cả các promise đã hoàn thành, results sẽ là một mảng chứa kết quả từ mỗi truy vấn.\n      // Bạn có thể làm gì đó với kết quả ở đây.\n      const cls_atv = [].concat(...results); // Kết hợp kết quả từ các truy vấn vào một mảng duy nhất\n      return res.render('teacher-manager-activity', {\n        header: 'global-header',\n        footer: 'global-footer',\n        thongbao: 'global-notifications',\n        cls: classlist,\n        years: years.years,\n        curr_year: school_year.year,\n        branch: branch_list,\n        school_atv: school_atv,\n        dep_atv: dep_atv,\n        cls_atv: cls_atv\n      });\n    }).catch(error => {\n      // Xử lý lỗi nếu có\n      console.log(error);\n    });\n  });\n  return router;\n}\nmodule.exports = createTeacherRouter;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIlJvdXRlciIsInNlcnZlciIsImNoZWNrSWZVc2VyTG9naW5Sb3V0ZSIsInNvcnRTdHVkZW50TmFtZSIsImdldE5hbWVHbG9iYWwiLCJuYW1lX2dsb2JhbF9kYXRhYmFzZXMiLCJjcmVhdGVUZWFjaGVyUm91dGVyIiwiY2xpZW50IiwiZ2V0IiwicmVxIiwicmVzIiwidXNlciIsInNlc3Npb24iLCJyZW5kZXIiLCJoZWFkZXIiLCJmb290ZXIiLCJ0aG9uZ2JhbyIsImNscyIsImNoZWNrIiwiZGIiLCJjb2xsZWN0aW9uIiwiZmluZCIsImNsYXNzIiwiJGV4aXN0cyIsInByb2plY3Rpb24iLCJmaXJzdF9uYW1lIiwibGFzdF9uYW1lIiwidG90YWxfc2NvcmUiLCJ0b0FycmF5IiwibGVuZ3RoIiwic2Nob29sX3llYXIiLCJmaW5kT25lIiwiX2lkIiwieWVhciIsInBvdyIsIlllYXJzIiwieWVhcnMiLCJzdHVkZW50X2xpc3QiLCJjdXJyX3llYXIiLCJyZWRpcmVjdCIsImUiLCJjb25zb2xlIiwibG9nIiwiYnJhbmNoX2xpc3QiLCJkZXAiLCJuYW1lIiwiY2xhc3NsaXN0IiwiYnJhbmNoIiwiJGluIiwibWFwIiwic2Nob29sX2F0diIsImNvbnRlbnQiLCJzdGFydF90aW1lIiwibGltaXQiLCJkZXBfYXR2IiwiY29sbGVjdGlvbnMiLCJsaXN0Q29sbGVjdGlvbnMiLCJhY3Rpdml0eUNvbGxlY3Rpb25zIiwiZmlsdGVyIiwiZW5kc1dpdGgiLCJjbHNfYXR2cyIsImR1bW15IiwiUHJvbWlzZSIsImFsbCIsInRoZW4iLCJyZXN1bHRzIiwiY2xzX2F0diIsImNvbmNhdCIsImNhdGNoIiwiZXJyb3IiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiJEOlxccHJvamVjdFxcd2ViXFxuZXdDRFJMLTFcXGJhY2tlbmRcXHJvdXRlclxcIiwic291cmNlcyI6WyJ0ZWFjaGVyUm91dGVzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XHJcbmNvbnN0IHJvdXRlciA9IGV4cHJlc3MuUm91dGVyKCk7XHJcbmNvbnN0IHNlcnZlciA9IHJlcXVpcmUoJy4uL2xpYi9jc2RsX2dvb2dsZV9saWInKTtcclxuY29uc3QgeyBjaGVja0lmVXNlckxvZ2luUm91dGUsIHNvcnRTdHVkZW50TmFtZSB9ID0gcmVxdWlyZSgnLi4vbGliL2Z1bmN0aW9uX2xpYicpO1xyXG5jb25zdCB7IGdldE5hbWVHbG9iYWwgfSA9IHJlcXVpcmUoJy4uL2xpYi9tb2dvZGJfbGliJyk7XHJcbmNvbnN0IG5hbWVfZ2xvYmFsX2RhdGFiYXNlcyA9IGdldE5hbWVHbG9iYWwoKTtcclxuZnVuY3Rpb24gY3JlYXRlVGVhY2hlclJvdXRlcihjbGllbnQpIHtcclxuICAgIC8vIGdpYW8gdmllbiByb3V0ZVxyXG4gICAgcm91dGVyLmdldCgnL3F1YW5seXF1eWVuJywgY2hlY2tJZlVzZXJMb2dpblJvdXRlLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICAgICAgICBjb25zdCB1c2VyID0gcmVxLnNlc3Npb24udXNlcjtcclxuICAgICAgICByZXR1cm4gcmVzLnJlbmRlcigndGVhY2hlci1tYW5hZ2Utc3R1ZGVudCcsIHtcclxuICAgICAgICAgICAgaGVhZGVyOiAnZ2xvYmFsLWhlYWRlcicsXHJcbiAgICAgICAgICAgIGZvb3RlcjogJ2dsb2JhbC1mb290ZXInLFxyXG4gICAgICAgICAgICB0aG9uZ2JhbzogJ2dsb2JhbC1ub3RpZmljYXRpb25zJyxcclxuICAgICAgICAgICAgY2xzOiB1c2VyLmNscyxcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG4gICAgLy8gZGFuaCBzYWNoIGJhbmcgZGllbSBjbyB2YW5cclxuICAgIHJvdXRlci5nZXQoJy9kYW5oc2FjaGJhbmdkaWVtJywgY2hlY2tJZlVzZXJMb2dpblJvdXRlLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCB1c2VyID0gcmVxLnNlc3Npb24udXNlcjtcclxuICAgICAgICAgICAgLy8gY2hlY2sgbmV1IGtobyBjbyBsb3BcclxuICAgICAgICAgICAgY29uc3QgY2hlY2sgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAuY29sbGVjdGlvbigndXNlcl9pbmZvJylcclxuICAgICAgICAgICAgICAgIC5maW5kKFxyXG4gICAgICAgICAgICAgICAgICAgIHsgY2xhc3M6IHVzZXIuY2xzWzBdLCAncG93ZXIuMCc6IHsgJGV4aXN0czogdHJ1ZSB9IH0sXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9qZWN0aW9uOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJzdF9uYW1lOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdF9uYW1lOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbF9zY29yZTogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgLnRvQXJyYXkoKTtcclxuICAgICAgICAgICAgLy9cclxuXHJcbiAgICAgICAgICAgIGlmIChjaGVjay5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzY2hvb2xfeWVhciA9IGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ3NjaG9vbF95ZWFyJylcclxuICAgICAgICAgICAgICAgICAgICAuZmluZE9uZSh7fSwgeyBwcm9qZWN0aW9uOiB7IF9pZDogMCwgeWVhcjogMSB9IH0pO1xyXG4gICAgICAgICAgICAgICAgLy8gY2hlY2sgdXNlciBsb2dpbjpcclxuICAgICAgICAgICAgICAgIGlmICh1c2VyLnBvd1sxXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IFllYXJzID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdjbGFzc2VzJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmRPbmUoeyBfaWQ6IHVzZXIuY2xzWzBdIH0sIHsgcHJvamVjdGlvbjogeyBfaWQ6IDAsIHllYXJzOiAxIH0gfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGdldCBhbGwgc3R1ZGVudCBpbiBzdGFmZiBtZW1iZXIgY2xhc3M6XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3R1ZGVudF9saXN0ID0gc29ydFN0dWRlbnROYW1lKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5kYihuYW1lX2dsb2JhbF9kYXRhYmFzZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY29sbGVjdGlvbigndXNlcl9pbmZvJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgY2xhc3M6IHVzZXIuY2xzWzBdLCAncG93ZXIuMCc6IHsgJGV4aXN0czogdHJ1ZSB9IH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9qZWN0aW9uOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJzdF9uYW1lOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdF9uYW1lOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbF9zY29yZTogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRvQXJyYXkoKSxcclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGdldCBhbGwgc3R1ZGVudCB0b3RhbCBzY29yZSBmcm9tIHRoZW1zZWxmOlxyXG4gICAgICAgICAgICAgICAgICAgIGxldCByZW5kZXIgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcjogJ2dsb2JhbC1oZWFkZXInLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb290ZXI6ICdnbG9iYWwtZm9vdGVyJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhvbmdiYW86ICdnbG9iYWwtbm90aWZpY2F0aW9ucycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0dWRlbnRfbGlzdDogc3R1ZGVudF9saXN0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbHM6IHVzZXIuY2xzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB5ZWFyczogWWVhcnMueWVhcnMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJfeWVhcjogc2Nob29sX3llYXIueWVhcixcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnJlbmRlcigndGVhY2hlci1ncmFkZS1saXN0JywgcmVuZGVyKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gdXNlciBub3Qgc3RhZmYgbWVtYmVyc1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHJlZGlyZWN0IHRvIGhvbWVcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnJlZGlyZWN0KCcvJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTWVNURU0gfCBCQU5fQ0FOX1NVX0RBTkhfU0FDSF9CQU5HX0RJRU0gfCBFUlJPUiB8ICcsIGUpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgLy8gcXVhbmcgbHkgaG9hdCBkb25nXHJcbiAgICByb3V0ZXIuZ2V0KCcvcXVhbmxpaG9hdGRvbmcnLCBjaGVja0lmVXNlckxvZ2luUm91dGUsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgICAgIGNvbnN0IHVzZXIgPSByZXEuc2Vzc2lvbi51c2VyO1xyXG5cclxuICAgICAgICBjb25zdCBzY2hvb2xfeWVhciA9IGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAuY29sbGVjdGlvbignc2Nob29sX3llYXInKVxyXG4gICAgICAgICAgICAuZmluZE9uZSh7fSwgeyBwcm9qZWN0aW9uOiB7IF9pZDogMCwgeWVhcjogMSB9IH0pO1xyXG5cclxuICAgICAgICAvLyBjaGVjayB1c2VyIGxvZ2luOlxyXG5cclxuICAgICAgICBsZXQgYnJhbmNoX2xpc3QgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ2JyYW5jaHMnKVxyXG4gICAgICAgICAgICAuZmluZCh7IGRlcDogdXNlci5kZXAgfSwgeyBwcm9qZWN0aW9uOiB7IF9pZDogMSwgbmFtZTogMSB9IH0pXHJcbiAgICAgICAgICAgIC50b0FycmF5KCk7XHJcblxyXG4gICAgICAgIGNvbnN0IGNsYXNzbGlzdCA9IGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAuY29sbGVjdGlvbignY2xhc3NlcycpXHJcbiAgICAgICAgICAgIC5maW5kKHsgYnJhbmNoOiB7ICRpbjogYnJhbmNoX2xpc3QubWFwKChicmFuY2gpID0+IGJyYW5jaC5faWQpIH0gfSwgeyBwcm9qZWN0aW9uOiB7IF9pZDogMSwgYnJhbmNoOiAxIH0gfSlcclxuICAgICAgICAgICAgLnRvQXJyYXkoKTtcclxuXHJcbiAgICAgICAgY29uc3QgeWVhcnMgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ2NsYXNzZXMnKVxyXG4gICAgICAgICAgICAuZmluZE9uZSh7IF9pZDogY2xhc3NsaXN0WzBdLl9pZCB9LCB7IHByb2plY3Rpb246IHsgX2lkOiAwLCB5ZWFyczogMSB9IH0pO1xyXG5cclxuICAgICAgICAvLyBnZXQgYWxsIGFjdGl2aXRpZXMgb2Ygc2Nob29sXHJcbiAgICAgICAgY29uc3Qgc2Nob29sX2F0diA9IGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAuY29sbGVjdGlvbignYWN0aXZpdGllcycpXHJcbiAgICAgICAgICAgIC5maW5kKFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHllYXI6IHNjaG9vbF95ZWFyLnllYXIsXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHByb2plY3Rpb246IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeWVhcjogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRfdGltZTogMSxcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAubGltaXQoMTApXHJcbiAgICAgICAgICAgIC50b0FycmF5KCk7XHJcblxyXG4gICAgICAgIC8vIGdldCBhbGwgYWN0aXZpdGllcyBvZiBkZXBcclxuICAgICAgICBjb25zdCBkZXBfYXR2ID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgIC5kYih1c2VyLmRlcClcclxuICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ2FjdGl2aXRpZXMnKVxyXG4gICAgICAgICAgICAuZmluZChcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB5ZWFyOiBzY2hvb2xfeWVhci55ZWFyLFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9qZWN0aW9uOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHllYXI6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0X3RpbWU6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICAgICAgLmxpbWl0KDEwKVxyXG4gICAgICAgICAgICAudG9BcnJheSgpO1xyXG5cclxuICAgICAgICAvLyBnZXQgYWxsIGFjdGl2aXRpZXMgb2YgY2xhc3Mgb2YgZGVwYXJ0bWVudFxyXG4gICAgICAgIGNvbnN0IGNvbGxlY3Rpb25zID0gYXdhaXQgY2xpZW50LmRiKHVzZXIuZGVwKS5saXN0Q29sbGVjdGlvbnMoKS50b0FycmF5KCk7XHJcblxyXG4gICAgICAgIC8vIEZpbHRlciBjb2xsZWN0aW9ucyBlbmRpbmcgd2l0aCAnX2FjdGl2aXRpZXMnXHJcbiAgICAgICAgY29uc3QgYWN0aXZpdHlDb2xsZWN0aW9ucyA9IGNvbGxlY3Rpb25zLmZpbHRlcigoY29sbGVjdGlvbikgPT4gY29sbGVjdGlvbi5uYW1lLmVuZHNXaXRoKCdfYWN0aXZpdGllcycpKTtcclxuXHJcbiAgICAgICAgLy8gTG9vcCB0aHJvdWdoIGFjdGl2aXR5IGNvbGxlY3Rpb25zIGFuZCByZXRyaWV2ZSBhbGwgZG9jdW1lbnRzXHJcbiAgICAgICAgY29uc3QgY2xzX2F0dnMgPSBhd2FpdCBhY3Rpdml0eUNvbGxlY3Rpb25zLm1hcChhc3luYyAoY29sbGVjdGlvbikgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBkdW1teSA9IGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgLmRiKHVzZXIuZGVwKVxyXG4gICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oY29sbGVjdGlvbi5uYW1lKVxyXG4gICAgICAgICAgICAgICAgLmZpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB5ZWFyOiBzY2hvb2xfeWVhci55ZWFyLFxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9qZWN0aW9uOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsczogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHllYXI6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydF90aW1lOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAubGltaXQoMTApXHJcbiAgICAgICAgICAgICAgICAudG9BcnJheSgpO1xyXG4gICAgICAgICAgICByZXR1cm4gZHVtbXk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgUHJvbWlzZS5hbGwoY2xzX2F0dnMpXHJcbiAgICAgICAgICAgIC50aGVuKChyZXN1bHRzKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAvLyBLaGkgdOG6pXQgY+G6oyBjw6FjIHByb21pc2UgxJHDoyBob8OgbiB0aMOgbmgsIHJlc3VsdHMgc+G6vSBsw6AgbeG7mXQgbeG6o25nIGNo4bupYSBr4bq/dCBxdeG6oyB04burIG3hu5dpIHRydXkgduG6pW4uXHJcbiAgICAgICAgICAgICAgICAvLyBC4bqhbiBjw7MgdGjhu4MgbMOgbSBnw6wgxJHDsyB24bubaSBr4bq/dCBxdeG6oyDhu58gxJHDonkuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBjbHNfYXR2ID0gW10uY29uY2F0KC4uLnJlc3VsdHMpOyAvLyBL4bq/dCBo4bujcCBr4bq/dCBxdeG6oyB04burIGPDoWMgdHJ1eSB24bqlbiB2w6BvIG3hu5l0IG3huqNuZyBkdXkgbmjhuqV0XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnJlbmRlcigndGVhY2hlci1tYW5hZ2VyLWFjdGl2aXR5Jywge1xyXG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcjogJ2dsb2JhbC1oZWFkZXInLFxyXG4gICAgICAgICAgICAgICAgICAgIGZvb3RlcjogJ2dsb2JhbC1mb290ZXInLFxyXG4gICAgICAgICAgICAgICAgICAgIHRob25nYmFvOiAnZ2xvYmFsLW5vdGlmaWNhdGlvbnMnLFxyXG4gICAgICAgICAgICAgICAgICAgIGNsczogY2xhc3NsaXN0LFxyXG4gICAgICAgICAgICAgICAgICAgIHllYXJzOiB5ZWFycy55ZWFycyxcclxuICAgICAgICAgICAgICAgICAgICBjdXJyX3llYXI6IHNjaG9vbF95ZWFyLnllYXIsXHJcbiAgICAgICAgICAgICAgICAgICAgYnJhbmNoOiBicmFuY2hfbGlzdCxcclxuICAgICAgICAgICAgICAgICAgICBzY2hvb2xfYXR2OiBzY2hvb2xfYXR2LFxyXG4gICAgICAgICAgICAgICAgICAgIGRlcF9hdHY6IGRlcF9hdHYsXHJcbiAgICAgICAgICAgICAgICAgICAgY2xzX2F0djogY2xzX2F0dixcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAvLyBY4butIGzDvSBs4buXaSBu4bq/dSBjw7NcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiByb3V0ZXI7XHJcbn1cclxubW9kdWxlLmV4cG9ydHMgPSBjcmVhdGVUZWFjaGVyUm91dGVyO1xyXG4iXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLE9BQU8sR0FBR0MsT0FBTyxDQUFDLFNBQVMsQ0FBQztBQUNsQyxNQUFNQyxNQUFNLEdBQUdGLE9BQU8sQ0FBQ0csTUFBTSxDQUFDLENBQUM7QUFDL0IsTUFBTUMsTUFBTSxHQUFHSCxPQUFPLENBQUMsd0JBQXdCLENBQUM7QUFDaEQsTUFBTTtFQUFFSSxxQkFBcUI7RUFBRUM7QUFBZ0IsQ0FBQyxHQUFHTCxPQUFPLENBQUMscUJBQXFCLENBQUM7QUFDakYsTUFBTTtFQUFFTTtBQUFjLENBQUMsR0FBR04sT0FBTyxDQUFDLG1CQUFtQixDQUFDO0FBQ3RELE1BQU1PLHFCQUFxQixHQUFHRCxhQUFhLENBQUMsQ0FBQztBQUM3QyxTQUFTRSxtQkFBbUJBLENBQUNDLE1BQU0sRUFBRTtFQUNqQztFQUNBUixNQUFNLENBQUNTLEdBQUcsQ0FBQyxjQUFjLEVBQUVOLHFCQUFxQixFQUFFLE9BQU9PLEdBQUcsRUFBRUMsR0FBRyxLQUFLO0lBQ2xFLE1BQU1DLElBQUksR0FBR0YsR0FBRyxDQUFDRyxPQUFPLENBQUNELElBQUk7SUFDN0IsT0FBT0QsR0FBRyxDQUFDRyxNQUFNLENBQUMsd0JBQXdCLEVBQUU7TUFDeENDLE1BQU0sRUFBRSxlQUFlO01BQ3ZCQyxNQUFNLEVBQUUsZUFBZTtNQUN2QkMsUUFBUSxFQUFFLHNCQUFzQjtNQUNoQ0MsR0FBRyxFQUFFTixJQUFJLENBQUNNO0lBQ2QsQ0FBQyxDQUFDO0VBQ04sQ0FBQyxDQUFDO0VBQ0Y7RUFDQWxCLE1BQU0sQ0FBQ1MsR0FBRyxDQUFDLG1CQUFtQixFQUFFTixxQkFBcUIsRUFBRSxPQUFPTyxHQUFHLEVBQUVDLEdBQUcsS0FBSztJQUN2RSxJQUFJO01BQ0EsTUFBTUMsSUFBSSxHQUFHRixHQUFHLENBQUNHLE9BQU8sQ0FBQ0QsSUFBSTtNQUM3QjtNQUNBLE1BQU1PLEtBQUssR0FBRyxNQUFNWCxNQUFNLENBQ3JCWSxFQUFFLENBQUNkLHFCQUFxQixDQUFDLENBQ3pCZSxVQUFVLENBQUMsV0FBVyxDQUFDLENBQ3ZCQyxJQUFJLENBQ0Q7UUFBRUMsS0FBSyxFQUFFWCxJQUFJLENBQUNNLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFBRSxTQUFTLEVBQUU7VUFBRU0sT0FBTyxFQUFFO1FBQUs7TUFBRSxDQUFDLEVBQ3BEO1FBQ0lDLFVBQVUsRUFBRTtVQUNSQyxVQUFVLEVBQUUsQ0FBQztVQUNiQyxTQUFTLEVBQUUsQ0FBQztVQUNaSixLQUFLLEVBQUUsQ0FBQztVQUNSSyxXQUFXLEVBQUU7UUFDakI7TUFDSixDQUNKLENBQUMsQ0FDQUMsT0FBTyxDQUFDLENBQUM7TUFDZDs7TUFFQSxJQUFJVixLQUFLLENBQUNXLE1BQU0sR0FBRyxDQUFDLEVBQUU7UUFDbEIsTUFBTUMsV0FBVyxHQUFHLE1BQU12QixNQUFNLENBQzNCWSxFQUFFLENBQUNkLHFCQUFxQixDQUFDLENBQ3pCZSxVQUFVLENBQUMsYUFBYSxDQUFDLENBQ3pCVyxPQUFPLENBQUMsQ0FBQyxDQUFDLEVBQUU7VUFBRVAsVUFBVSxFQUFFO1lBQUVRLEdBQUcsRUFBRSxDQUFDO1lBQUVDLElBQUksRUFBRTtVQUFFO1FBQUUsQ0FBQyxDQUFDO1FBQ3JEO1FBQ0EsSUFBSXRCLElBQUksQ0FBQ3VCLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRTtVQUNiLE1BQU1DLEtBQUssR0FBRyxNQUFNNUIsTUFBTSxDQUNyQlksRUFBRSxDQUFDZCxxQkFBcUIsQ0FBQyxDQUN6QmUsVUFBVSxDQUFDLFNBQVMsQ0FBQyxDQUNyQlcsT0FBTyxDQUFDO1lBQUVDLEdBQUcsRUFBRXJCLElBQUksQ0FBQ00sR0FBRyxDQUFDLENBQUM7VUFBRSxDQUFDLEVBQUU7WUFBRU8sVUFBVSxFQUFFO2NBQUVRLEdBQUcsRUFBRSxDQUFDO2NBQUVJLEtBQUssRUFBRTtZQUFFO1VBQUUsQ0FBQyxDQUFDOztVQUV4RTtVQUNBLE1BQU1DLFlBQVksR0FBR2xDLGVBQWUsQ0FDaEMsTUFBTUksTUFBTSxDQUNQWSxFQUFFLENBQUNkLHFCQUFxQixDQUFDLENBQ3pCZSxVQUFVLENBQUMsV0FBVyxDQUFDLENBQ3ZCQyxJQUFJLENBQ0Q7WUFBRUMsS0FBSyxFQUFFWCxJQUFJLENBQUNNLEdBQUcsQ0FBQyxDQUFDLENBQUM7WUFBRSxTQUFTLEVBQUU7Y0FBRU0sT0FBTyxFQUFFO1lBQUs7VUFBRSxDQUFDLEVBQ3BEO1lBQ0lDLFVBQVUsRUFBRTtjQUNSQyxVQUFVLEVBQUUsQ0FBQztjQUNiQyxTQUFTLEVBQUUsQ0FBQztjQUNaSixLQUFLLEVBQUUsQ0FBQztjQUNSSyxXQUFXLEVBQUU7WUFDakI7VUFDSixDQUNKLENBQUMsQ0FDQUMsT0FBTyxDQUFDLENBQ2pCLENBQUM7VUFDRDtVQUNBLElBQUlmLE1BQU0sR0FBRztZQUNUQyxNQUFNLEVBQUUsZUFBZTtZQUN2QkMsTUFBTSxFQUFFLGVBQWU7WUFDdkJDLFFBQVEsRUFBRSxzQkFBc0I7WUFDaENxQixZQUFZLEVBQUVBLFlBQVk7WUFDMUJwQixHQUFHLEVBQUVOLElBQUksQ0FBQ00sR0FBRztZQUNibUIsS0FBSyxFQUFFRCxLQUFLLENBQUNDLEtBQUs7WUFDbEJFLFNBQVMsRUFBRVIsV0FBVyxDQUFDRztVQUMzQixDQUFDO1VBRUQsT0FBT3ZCLEdBQUcsQ0FBQ0csTUFBTSxDQUFDLG9CQUFvQixFQUFFQSxNQUFNLENBQUM7UUFDbkQsQ0FBQyxNQUFNO1VBQ0g7VUFDQTtVQUNBLE9BQU9ILEdBQUcsQ0FBQzZCLFFBQVEsQ0FBQyxHQUFHLENBQUM7UUFDNUI7TUFDSjtJQUNKLENBQUMsQ0FBQyxPQUFPQyxDQUFDLEVBQUU7TUFDUkMsT0FBTyxDQUFDQyxHQUFHLENBQUMsb0RBQW9ELEVBQUVGLENBQUMsQ0FBQztJQUN4RTtFQUNKLENBQUMsQ0FBQztFQUNGO0VBQ0F6QyxNQUFNLENBQUNTLEdBQUcsQ0FBQyxpQkFBaUIsRUFBRU4scUJBQXFCLEVBQUUsT0FBT08sR0FBRyxFQUFFQyxHQUFHLEtBQUs7SUFDckUsTUFBTUMsSUFBSSxHQUFHRixHQUFHLENBQUNHLE9BQU8sQ0FBQ0QsSUFBSTtJQUU3QixNQUFNbUIsV0FBVyxHQUFHLE1BQU12QixNQUFNLENBQzNCWSxFQUFFLENBQUNkLHFCQUFxQixDQUFDLENBQ3pCZSxVQUFVLENBQUMsYUFBYSxDQUFDLENBQ3pCVyxPQUFPLENBQUMsQ0FBQyxDQUFDLEVBQUU7TUFBRVAsVUFBVSxFQUFFO1FBQUVRLEdBQUcsRUFBRSxDQUFDO1FBQUVDLElBQUksRUFBRTtNQUFFO0lBQUUsQ0FBQyxDQUFDOztJQUVyRDs7SUFFQSxJQUFJVSxXQUFXLEdBQUcsTUFBTXBDLE1BQU0sQ0FDekJZLEVBQUUsQ0FBQ2QscUJBQXFCLENBQUMsQ0FDekJlLFVBQVUsQ0FBQyxTQUFTLENBQUMsQ0FDckJDLElBQUksQ0FBQztNQUFFdUIsR0FBRyxFQUFFakMsSUFBSSxDQUFDaUM7SUFBSSxDQUFDLEVBQUU7TUFBRXBCLFVBQVUsRUFBRTtRQUFFUSxHQUFHLEVBQUUsQ0FBQztRQUFFYSxJQUFJLEVBQUU7TUFBRTtJQUFFLENBQUMsQ0FBQyxDQUM1RGpCLE9BQU8sQ0FBQyxDQUFDO0lBRWQsTUFBTWtCLFNBQVMsR0FBRyxNQUFNdkMsTUFBTSxDQUN6QlksRUFBRSxDQUFDZCxxQkFBcUIsQ0FBQyxDQUN6QmUsVUFBVSxDQUFDLFNBQVMsQ0FBQyxDQUNyQkMsSUFBSSxDQUFDO01BQUUwQixNQUFNLEVBQUU7UUFBRUMsR0FBRyxFQUFFTCxXQUFXLENBQUNNLEdBQUcsQ0FBRUYsTUFBTSxJQUFLQSxNQUFNLENBQUNmLEdBQUc7TUFBRTtJQUFFLENBQUMsRUFBRTtNQUFFUixVQUFVLEVBQUU7UUFBRVEsR0FBRyxFQUFFLENBQUM7UUFBRWUsTUFBTSxFQUFFO01BQUU7SUFBRSxDQUFDLENBQUMsQ0FDekduQixPQUFPLENBQUMsQ0FBQztJQUVkLE1BQU1RLEtBQUssR0FBRyxNQUFNN0IsTUFBTSxDQUNyQlksRUFBRSxDQUFDZCxxQkFBcUIsQ0FBQyxDQUN6QmUsVUFBVSxDQUFDLFNBQVMsQ0FBQyxDQUNyQlcsT0FBTyxDQUFDO01BQUVDLEdBQUcsRUFBRWMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDZDtJQUFJLENBQUMsRUFBRTtNQUFFUixVQUFVLEVBQUU7UUFBRVEsR0FBRyxFQUFFLENBQUM7UUFBRUksS0FBSyxFQUFFO01BQUU7SUFBRSxDQUFDLENBQUM7O0lBRTdFO0lBQ0EsTUFBTWMsVUFBVSxHQUFHLE1BQU0zQyxNQUFNLENBQzFCWSxFQUFFLENBQUNkLHFCQUFxQixDQUFDLENBQ3pCZSxVQUFVLENBQUMsWUFBWSxDQUFDLENBQ3hCQyxJQUFJLENBQ0Q7TUFDSVksSUFBSSxFQUFFSCxXQUFXLENBQUNHO0lBQ3RCLENBQUMsRUFDRDtNQUNJVCxVQUFVLEVBQUU7UUFDUnFCLElBQUksRUFBRSxDQUFDO1FBQ1BNLE9BQU8sRUFBRSxDQUFDO1FBQ1ZsQixJQUFJLEVBQUUsQ0FBQztRQUNQbUIsVUFBVSxFQUFFO01BQ2hCO0lBQ0osQ0FDSixDQUFDLENBQ0FDLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FDVHpCLE9BQU8sQ0FBQyxDQUFDOztJQUVkO0lBQ0EsTUFBTTBCLE9BQU8sR0FBRyxNQUFNL0MsTUFBTSxDQUN2QlksRUFBRSxDQUFDUixJQUFJLENBQUNpQyxHQUFHLENBQUMsQ0FDWnhCLFVBQVUsQ0FBQyxZQUFZLENBQUMsQ0FDeEJDLElBQUksQ0FDRDtNQUNJWSxJQUFJLEVBQUVILFdBQVcsQ0FBQ0c7SUFDdEIsQ0FBQyxFQUNEO01BQ0lULFVBQVUsRUFBRTtRQUNScUIsSUFBSSxFQUFFLENBQUM7UUFDUE0sT0FBTyxFQUFFLENBQUM7UUFDVmxCLElBQUksRUFBRSxDQUFDO1FBQ1BtQixVQUFVLEVBQUU7TUFDaEI7SUFDSixDQUNKLENBQUMsQ0FDQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxDQUNUekIsT0FBTyxDQUFDLENBQUM7O0lBRWQ7SUFDQSxNQUFNMkIsV0FBVyxHQUFHLE1BQU1oRCxNQUFNLENBQUNZLEVBQUUsQ0FBQ1IsSUFBSSxDQUFDaUMsR0FBRyxDQUFDLENBQUNZLGVBQWUsQ0FBQyxDQUFDLENBQUM1QixPQUFPLENBQUMsQ0FBQzs7SUFFekU7SUFDQSxNQUFNNkIsbUJBQW1CLEdBQUdGLFdBQVcsQ0FBQ0csTUFBTSxDQUFFdEMsVUFBVSxJQUFLQSxVQUFVLENBQUN5QixJQUFJLENBQUNjLFFBQVEsQ0FBQyxhQUFhLENBQUMsQ0FBQzs7SUFFdkc7SUFDQSxNQUFNQyxRQUFRLEdBQUcsTUFBTUgsbUJBQW1CLENBQUNSLEdBQUcsQ0FBQyxNQUFPN0IsVUFBVSxJQUFLO01BQ2pFLE1BQU15QyxLQUFLLEdBQUcsTUFBTXRELE1BQU0sQ0FDckJZLEVBQUUsQ0FBQ1IsSUFBSSxDQUFDaUMsR0FBRyxDQUFDLENBQ1p4QixVQUFVLENBQUNBLFVBQVUsQ0FBQ3lCLElBQUksQ0FBQyxDQUMzQnhCLElBQUksQ0FDRDtRQUNJWSxJQUFJLEVBQUVILFdBQVcsQ0FBQ0c7TUFDdEIsQ0FBQyxFQUNEO1FBQ0lULFVBQVUsRUFBRTtVQUNScUIsSUFBSSxFQUFFLENBQUM7VUFDUE0sT0FBTyxFQUFFLENBQUM7VUFDVmxDLEdBQUcsRUFBRSxDQUFDO1VBQ05nQixJQUFJLEVBQUUsQ0FBQztVQUNQbUIsVUFBVSxFQUFFO1FBQ2hCO01BQ0osQ0FDSixDQUFDLENBQ0FDLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FDVHpCLE9BQU8sQ0FBQyxDQUFDO01BQ2QsT0FBT2lDLEtBQUs7SUFDaEIsQ0FBQyxDQUFDO0lBQ0ZDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDSCxRQUFRLENBQUMsQ0FDaEJJLElBQUksQ0FBRUMsT0FBTyxJQUFLO01BQ2Y7TUFDQTtNQUNBLE1BQU1DLE9BQU8sR0FBRyxFQUFFLENBQUNDLE1BQU0sQ0FBQyxHQUFHRixPQUFPLENBQUMsQ0FBQyxDQUFDO01BQ3ZDLE9BQU92RCxHQUFHLENBQUNHLE1BQU0sQ0FBQywwQkFBMEIsRUFBRTtRQUMxQ0MsTUFBTSxFQUFFLGVBQWU7UUFDdkJDLE1BQU0sRUFBRSxlQUFlO1FBQ3ZCQyxRQUFRLEVBQUUsc0JBQXNCO1FBQ2hDQyxHQUFHLEVBQUU2QixTQUFTO1FBQ2RWLEtBQUssRUFBRUEsS0FBSyxDQUFDQSxLQUFLO1FBQ2xCRSxTQUFTLEVBQUVSLFdBQVcsQ0FBQ0csSUFBSTtRQUMzQmMsTUFBTSxFQUFFSixXQUFXO1FBQ25CTyxVQUFVLEVBQUVBLFVBQVU7UUFDdEJJLE9BQU8sRUFBRUEsT0FBTztRQUNoQlksT0FBTyxFQUFFQTtNQUNiLENBQUMsQ0FBQztJQUNOLENBQUMsQ0FBQyxDQUNERSxLQUFLLENBQUVDLEtBQUssSUFBSztNQUNkO01BQ0E1QixPQUFPLENBQUNDLEdBQUcsQ0FBQzJCLEtBQUssQ0FBQztJQUN0QixDQUFDLENBQUM7RUFDVixDQUFDLENBQUM7RUFDRixPQUFPdEUsTUFBTTtBQUNqQjtBQUNBdUUsTUFBTSxDQUFDQyxPQUFPLEdBQUdqRSxtQkFBbUIiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["express","require","router","Router","server","checkIfUserLoginRoute","sortStudentName","getNameGlobal","name_global_databases","createTeacherRouter","client","get","req","res","user","session","render","header","footer","thongbao","cls","check","db","collection","find","class","$exists","projection","first_name","last_name","total_score","toArray","length","school_year","findOne","_id","year","pow","Years","years","student_list","curr_year","redirect","e","console","log","branch_list","dep","name","classlist","branch","$in","map","school_atv","content","start_time","limit","dep_atv","collections","listCollections","activityCollections","filter","endsWith","cls_atvs","dummy","Promise","all","then","results","cls_atv","concat","catch","error","module","exports"],"sourceRoot":"D:\\project\\web\\newCDRL-1\\backend\\router\\","sources":["teacherRoutes.js"],"sourcesContent":["const express = require('express');\r\nconst router = express.Router();\r\nconst server = require('../lib/csdl_google_lib');\r\nconst { checkIfUserLoginRoute, sortStudentName } = require('../lib/function_lib');\r\nconst { getNameGlobal } = require('../lib/mogodb_lib');\r\nconst name_global_databases = getNameGlobal();\r\nfunction createTeacherRouter(client) {\r\n    // giao vien route\r\n    router.get('/quanlyquyen', checkIfUserLoginRoute, async (req, res) => {\r\n        const user = req.session.user;\r\n        return res.render('teacher-manage-student', {\r\n            header: 'global-header',\r\n            footer: 'global-footer',\r\n            thongbao: 'global-notifications',\r\n            cls: user.cls,\r\n        });\r\n    });\r\n    // danh sach bang diem co van\r\n    router.get('/danhsachbangdiem', checkIfUserLoginRoute, async (req, res) => {\r\n        try {\r\n            const user = req.session.user;\r\n            // check neu kho co lop\r\n            const check = await client\r\n                .db(name_global_databases)\r\n                .collection('user_info')\r\n                .find(\r\n                    { class: user.cls[0], 'power.0': { $exists: true } },\r\n                    {\r\n                        projection: {\r\n                            first_name: 1,\r\n                            last_name: 1,\r\n                            class: 1,\r\n                            total_score: 1,\r\n                        },\r\n                    },\r\n                )\r\n                .toArray();\r\n            //\r\n\r\n            if (check.length > 0) {\r\n                const school_year = await client\r\n                    .db(name_global_databases)\r\n                    .collection('school_year')\r\n                    .findOne({}, { projection: { _id: 0, year: 1 } });\r\n                // check user login:\r\n                if (user.pow[1]) {\r\n                    const Years = await client\r\n                        .db(name_global_databases)\r\n                        .collection('classes')\r\n                        .findOne({ _id: user.cls[0] }, { projection: { _id: 0, years: 1 } });\r\n\r\n                    // get all student in staff member class:\r\n                    const student_list = sortStudentName(\r\n                        await client\r\n                            .db(name_global_databases)\r\n                            .collection('user_info')\r\n                            .find(\r\n                                { class: user.cls[0], 'power.0': { $exists: true } },\r\n                                {\r\n                                    projection: {\r\n                                        first_name: 1,\r\n                                        last_name: 1,\r\n                                        class: 1,\r\n                                        total_score: 1,\r\n                                    },\r\n                                },\r\n                            )\r\n                            .toArray(),\r\n                    );\r\n                    // get all student total score from themself:\r\n                    let render = {\r\n                        header: 'global-header',\r\n                        footer: 'global-footer',\r\n                        thongbao: 'global-notifications',\r\n                        student_list: student_list,\r\n                        cls: user.cls,\r\n                        years: Years.years,\r\n                        curr_year: school_year.year,\r\n                    };\r\n\r\n                    return res.render('teacher-grade-list', render);\r\n                } else {\r\n                    // user not staff members\r\n                    // redirect to home\r\n                    return res.redirect('/');\r\n                }\r\n            }\r\n        } catch (e) {\r\n            console.log('SYSTEM | BAN_CAN_SU_DANH_SACH_BANG_DIEM | ERROR | ', e);\r\n        }\r\n    });\r\n    // quang ly hoat dong\r\n    router.get('/quanlihoatdong', checkIfUserLoginRoute, async (req, res) => {\r\n        const user = req.session.user;\r\n\r\n        const school_year = await client\r\n            .db(name_global_databases)\r\n            .collection('school_year')\r\n            .findOne({}, { projection: { _id: 0, year: 1 } });\r\n\r\n        // check user login:\r\n\r\n        let branch_list = await client\r\n            .db(name_global_databases)\r\n            .collection('branchs')\r\n            .find({ dep: user.dep }, { projection: { _id: 1, name: 1 } })\r\n            .toArray();\r\n\r\n        const classlist = await client\r\n            .db(name_global_databases)\r\n            .collection('classes')\r\n            .find({ branch: { $in: branch_list.map((branch) => branch._id) } }, { projection: { _id: 1, branch: 1 } })\r\n            .toArray();\r\n\r\n        const years = await client\r\n            .db(name_global_databases)\r\n            .collection('classes')\r\n            .findOne({ _id: classlist[0]._id }, { projection: { _id: 0, years: 1 } });\r\n\r\n        // get all activities of school\r\n        const school_atv = await client\r\n            .db(name_global_databases)\r\n            .collection('activities')\r\n            .find(\r\n                {\r\n                    year: school_year.year,\r\n                },\r\n                {\r\n                    projection: {\r\n                        name: 1,\r\n                        content: 1,\r\n                        year: 1,\r\n                        start_time: 1,\r\n                    },\r\n                },\r\n            )\r\n            .limit(10)\r\n            .toArray();\r\n\r\n        // get all activities of dep\r\n        const dep_atv = await client\r\n            .db(user.dep)\r\n            .collection('activities')\r\n            .find(\r\n                {\r\n                    year: school_year.year,\r\n                },\r\n                {\r\n                    projection: {\r\n                        name: 1,\r\n                        content: 1,\r\n                        year: 1,\r\n                        start_time: 1,\r\n                    },\r\n                },\r\n            )\r\n            .limit(10)\r\n            .toArray();\r\n\r\n        // get all activities of class of department\r\n        const collections = await client.db(user.dep).listCollections().toArray();\r\n\r\n        // Filter collections ending with '_activities'\r\n        const activityCollections = collections.filter((collection) => collection.name.endsWith('_activities'));\r\n\r\n        // Loop through activity collections and retrieve all documents\r\n        const cls_atvs = await activityCollections.map(async (collection) => {\r\n            const dummy = await client\r\n                .db(user.dep)\r\n                .collection(collection.name)\r\n                .find(\r\n                    {\r\n                        year: school_year.year,\r\n                    },\r\n                    {\r\n                        projection: {\r\n                            name: 1,\r\n                            content: 1,\r\n                            cls: 1,\r\n                            year: 1,\r\n                            start_time: 1,\r\n                        },\r\n                    },\r\n                )\r\n                .limit(10)\r\n                .toArray();\r\n            return dummy;\r\n        });\r\n        Promise.all(cls_atvs)\r\n            .then((results) => {\r\n                // Khi tất cả các promise đã hoàn thành, results sẽ là một mảng chứa kết quả từ mỗi truy vấn.\r\n                // Bạn có thể làm gì đó với kết quả ở đây.\r\n                const cls_atv = [].concat(...results); // Kết hợp kết quả từ các truy vấn vào một mảng duy nhất\r\n                return res.render('teacher-manager-activity', {\r\n                    header: 'global-header',\r\n                    footer: 'global-footer',\r\n                    thongbao: 'global-notifications',\r\n                    cls: classlist,\r\n                    years: years.years,\r\n                    curr_year: school_year.year,\r\n                    branch: branch_list,\r\n                    school_atv: school_atv,\r\n                    dep_atv: dep_atv,\r\n                    cls_atv: cls_atv,\r\n                });\r\n            })\r\n            .catch((error) => {\r\n                // Xử lý lỗi nếu có\r\n                console.log(error);\r\n            });\r\n    });\r\n    return router;\r\n}\r\nmodule.exports = createTeacherRouter;\r\n"],"mappings":"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","ignoreList":[]}},"mtime":1719476170727},"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\project\\\\web\\\\newCDRL-1\\\\backend\\\\router\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\project\\\\web\\\\newCDRL-1\",\"filename\":\"D:\\\\project\\\\web\\\\newCDRL-1\\\\backend\\\\router\\\\studentRouter.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\project\\\\web\\\\newCDRL-1\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.24.3:development":{"value":{"code":"const express = require('express');\nconst router = express.Router();\nconst server = require('../lib/csdl_google_lib');\nconst {\n  checkIfUserLoginRoute\n} = require('../lib/function_lib');\nconst {\n  getNameGlobal\n} = require('../lib/mogodb_lib');\nconst name_global_databases = getNameGlobal();\nfunction createStudentRouter(client) {\n  // nhap bang diem route\n  router.get('/nhapdiemdanhgia', checkIfUserLoginRoute, async (req, res) => {\n    const school_year = await client.db(name_global_databases).collection('school_year').findOne({}, {\n      projection: {\n        _id: 0,\n        year: 1,\n        start_day: 1,\n        end_day: 1\n      }\n    });\n    let today = new Date().getTime();\n    let start_day = new Date(school_year.start_day).getTime();\n    let end_day = new Date(school_year.end_day).getTime();\n    let forever_day = new Date('2003-10-18').getTime(); // special date\n\n    // check if end mark time or not\n    if (start_day <= today && (today < end_day || end_day == forever_day)) {\n      return res.render('sinhvien-enter-grades', {\n        header: 'global-header',\n        thongbao: 'global-notifications',\n        footer: 'global-footer'\n      });\n    } else {\n      return res.redirect('/');\n    }\n  });\n\n  // xem bang diem route\n  router.get('/xembangdiem', checkIfUserLoginRoute, async (req, res) => {\n    try {\n      const user = req.session.user;\n      let mssv;\n      if (user.pow[1] || user.pow[2]) {\n        if (user.pow[0]) {\n          if (req.query.mssv) {\n            mssv = req.query.mssv;\n          } else {\n            mssv = req.session.user._id;\n          }\n        } else {\n          mssv = req.query.mssv;\n        }\n      } else {\n        mssv = req.session.user._id;\n      }\n      const schoolYearParam = req.query.schoolYear;\n      let studentTotalScore = await client.db(user.dep).collection(user.cls[0] + '_std_table').findOne({\n        mssv: mssv,\n        school_year: schoolYearParam\n      }, {\n        projection: {\n          _id: 0,\n          first: 1,\n          second: 1,\n          third: 1,\n          fourth: 1,\n          fifth: 1,\n          total: 1,\n          img_ids: 1\n        }\n      });\n      let stfTotalScore = await client.db(user.dep).collection(user.cls[0] + '_stf_table').findOne({\n        mssv: mssv,\n        school_year: schoolYearParam\n      }, {\n        projection: {\n          _id: 0,\n          first: 1,\n          second: 1,\n          third: 1,\n          fourth: 1,\n          fifth: 1,\n          total: 1,\n          img_ids: 1\n        }\n      });\n      let depTotalScore = await client.db(user.dep).collection(user.cls[0] + '_dep_table').findOne({\n        mssv: mssv,\n        school_year: schoolYearParam\n      }, {\n        projection: {\n          _id: 0,\n          first: 1,\n          second: 1,\n          third: 1,\n          fourth: 1,\n          fifth: 1,\n          total: 1,\n          img_ids: 1\n        }\n      });\n      nulltable = {\n        fifth: ['Chưa chấm', 'Chưa chấm', 'Chưa chấm', 'Chưa chấm'],\n        first: ['Chưa chấm', 'Chưa chấm', 'Chưa chấm', 'Chưa chấm', 'Chưa chấm'],\n        fourth: ['Chưa chấm', 'Chưa chấm', 'Chưa chấm'],\n        second: ['Chưa chấm', 'Chưa chấm'],\n        third: ['Chưa chấm', 'Chưa chấm', 'Chưa chấm'],\n        total: 'Chưa chấm'\n      };\n      if (!studentTotalScore || !studentTotalScore.fifth) {\n        studentTotalScore = nulltable;\n      }\n      if (!stfTotalScore || !stfTotalScore.fifth) {\n        stfTotalScore = nulltable;\n      }\n      if (!depTotalScore || !depTotalScore.fifth) {\n        depTotalScore = nulltable;\n      }\n      let link_img = [];\n      if (studentTotalScore && studentTotalScore.first || stfTotalScore && stfTotalScore.fifth || depTotalScore && depTotalScore.fifth) {\n        if (studentTotalScore.img_ids) {\n          for (const [key, value] of Object.entries(studentTotalScore.img_ids)) {\n            if (key == 'global') {\n              for (const i of value) {\n                link_img.push(await server.getDriveFileLinkAndDescription(i));\n              }\n            } else {\n              let activitie_info;\n              activitie_info = await client.db(user.dep).collection(`${user.cls[0]}_activities`).findOne({\n                _id: key\n              }, {\n                projection: {\n                  name: 1\n                }\n              });\n              if (!activitie_info) {\n                activitie_info = await client.db(user.dep).collection('activities').findOne({\n                  _id: key\n                }, {\n                  projection: {\n                    name: 1\n                  }\n                });\n                if (!activitie_info) {\n                  activitie_info = await client.db(name_global_databases).collection('activities').findOne({\n                    _id: key\n                  }, {\n                    projection: {\n                      name: 1\n                    }\n                  });\n                }\n              }\n              if (activitie_info) {\n                for (const i of value) {\n                  let imginfo = await server.getDriveFileLinkAndDescription(i);\n                  if (imginfo) {\n                    imginfo.fileDescription = activitie_info.name + '-' + imginfo.fileDescription;\n                    link_img.push(imginfo);\n                  }\n                }\n              }\n            }\n          }\n        }\n        return res.render('sinhvien-view-grades', {\n          header: 'global-header',\n          thongbao: 'global-notifications',\n          footer: 'global-footer',\n          Scorestd: studentTotalScore,\n          Score: stfTotalScore,\n          Scorek: depTotalScore,\n          img: link_img\n        });\n      } else {\n        return res.sendStatus(404);\n      }\n    } catch (err) {\n      console.log('SYSTEM | XEM_BANG_DIEM_ROUTE | ERROR | ', err);\n      return res.status(500).json({\n        error: 'Lỗi hệ thống'\n      });\n    }\n  });\n  return router;\n}\nmodule.exports = createStudentRouter;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIlJvdXRlciIsInNlcnZlciIsImNoZWNrSWZVc2VyTG9naW5Sb3V0ZSIsImdldE5hbWVHbG9iYWwiLCJuYW1lX2dsb2JhbF9kYXRhYmFzZXMiLCJjcmVhdGVTdHVkZW50Um91dGVyIiwiY2xpZW50IiwiZ2V0IiwicmVxIiwicmVzIiwic2Nob29sX3llYXIiLCJkYiIsImNvbGxlY3Rpb24iLCJmaW5kT25lIiwicHJvamVjdGlvbiIsIl9pZCIsInllYXIiLCJzdGFydF9kYXkiLCJlbmRfZGF5IiwidG9kYXkiLCJEYXRlIiwiZ2V0VGltZSIsImZvcmV2ZXJfZGF5IiwicmVuZGVyIiwiaGVhZGVyIiwidGhvbmdiYW8iLCJmb290ZXIiLCJyZWRpcmVjdCIsInVzZXIiLCJzZXNzaW9uIiwibXNzdiIsInBvdyIsInF1ZXJ5Iiwic2Nob29sWWVhclBhcmFtIiwic2Nob29sWWVhciIsInN0dWRlbnRUb3RhbFNjb3JlIiwiZGVwIiwiY2xzIiwiZmlyc3QiLCJzZWNvbmQiLCJ0aGlyZCIsImZvdXJ0aCIsImZpZnRoIiwidG90YWwiLCJpbWdfaWRzIiwic3RmVG90YWxTY29yZSIsImRlcFRvdGFsU2NvcmUiLCJudWxsdGFibGUiLCJsaW5rX2ltZyIsImtleSIsInZhbHVlIiwiT2JqZWN0IiwiZW50cmllcyIsImkiLCJwdXNoIiwiZ2V0RHJpdmVGaWxlTGlua0FuZERlc2NyaXB0aW9uIiwiYWN0aXZpdGllX2luZm8iLCJuYW1lIiwiaW1naW5mbyIsImZpbGVEZXNjcmlwdGlvbiIsIlNjb3Jlc3RkIiwiU2NvcmUiLCJTY29yZWsiLCJpbWciLCJzZW5kU3RhdHVzIiwiZXJyIiwiY29uc29sZSIsImxvZyIsInN0YXR1cyIsImpzb24iLCJlcnJvciIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6IkQ6XFxwcm9qZWN0XFx3ZWJcXG5ld0NEUkwtMVxcYmFja2VuZFxccm91dGVyXFwiLCJzb3VyY2VzIjpbInN0dWRlbnRSb3V0ZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTtcclxuY29uc3Qgcm91dGVyID0gZXhwcmVzcy5Sb3V0ZXIoKTtcclxuY29uc3Qgc2VydmVyID0gcmVxdWlyZSgnLi4vbGliL2NzZGxfZ29vZ2xlX2xpYicpO1xyXG5jb25zdCB7IGNoZWNrSWZVc2VyTG9naW5Sb3V0ZSB9ID0gcmVxdWlyZSgnLi4vbGliL2Z1bmN0aW9uX2xpYicpO1xyXG5jb25zdCB7IGdldE5hbWVHbG9iYWwgfSA9IHJlcXVpcmUoJy4uL2xpYi9tb2dvZGJfbGliJyk7XHJcbmNvbnN0IG5hbWVfZ2xvYmFsX2RhdGFiYXNlcyA9IGdldE5hbWVHbG9iYWwoKTtcclxuZnVuY3Rpb24gY3JlYXRlU3R1ZGVudFJvdXRlcihjbGllbnQpIHtcclxuICAgIC8vIG5oYXAgYmFuZyBkaWVtIHJvdXRlXHJcbiAgICByb3V0ZXIuZ2V0KCcvbmhhcGRpZW1kYW5oZ2lhJywgY2hlY2tJZlVzZXJMb2dpblJvdXRlLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICAgICAgICBjb25zdCBzY2hvb2xfeWVhciA9IGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAuZGIobmFtZV9nbG9iYWxfZGF0YWJhc2VzKVxyXG4gICAgICAgICAgICAuY29sbGVjdGlvbignc2Nob29sX3llYXInKVxyXG4gICAgICAgICAgICAuZmluZE9uZShcclxuICAgICAgICAgICAgICAgIHt9LFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHByb2plY3Rpb246IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2lkOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB5ZWFyOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFydF9kYXk6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZF9kYXk6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgbGV0IHRvZGF5ID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XHJcbiAgICAgICAgbGV0IHN0YXJ0X2RheSA9IG5ldyBEYXRlKHNjaG9vbF95ZWFyLnN0YXJ0X2RheSkuZ2V0VGltZSgpO1xyXG4gICAgICAgIGxldCBlbmRfZGF5ID0gbmV3IERhdGUoc2Nob29sX3llYXIuZW5kX2RheSkuZ2V0VGltZSgpO1xyXG4gICAgICAgIGxldCBmb3JldmVyX2RheSA9IG5ldyBEYXRlKCcyMDAzLTEwLTE4JykuZ2V0VGltZSgpOyAvLyBzcGVjaWFsIGRhdGVcclxuXHJcbiAgICAgICAgLy8gY2hlY2sgaWYgZW5kIG1hcmsgdGltZSBvciBub3RcclxuICAgICAgICBpZiAoc3RhcnRfZGF5IDw9IHRvZGF5ICYmICh0b2RheSA8IGVuZF9kYXkgfHwgZW5kX2RheSA9PSBmb3JldmVyX2RheSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5yZW5kZXIoJ3Npbmh2aWVuLWVudGVyLWdyYWRlcycsIHtcclxuICAgICAgICAgICAgICAgIGhlYWRlcjogJ2dsb2JhbC1oZWFkZXInLFxyXG4gICAgICAgICAgICAgICAgdGhvbmdiYW86ICdnbG9iYWwtbm90aWZpY2F0aW9ucycsXHJcbiAgICAgICAgICAgICAgICBmb290ZXI6ICdnbG9iYWwtZm9vdGVyJyxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5yZWRpcmVjdCgnLycpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8vIHhlbSBiYW5nIGRpZW0gcm91dGVcclxuICAgIHJvdXRlci5nZXQoJy94ZW1iYW5nZGllbScsIGNoZWNrSWZVc2VyTG9naW5Sb3V0ZSwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgdXNlciA9IHJlcS5zZXNzaW9uLnVzZXI7XHJcbiAgICAgICAgICAgIGxldCBtc3N2O1xyXG4gICAgICAgICAgICBpZiAodXNlci5wb3dbMV0gfHwgdXNlci5wb3dbMl0pIHtcclxuICAgICAgICAgICAgICAgIGlmICh1c2VyLnBvd1swXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXEucXVlcnkubXNzdikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtc3N2ID0gcmVxLnF1ZXJ5Lm1zc3Y7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbXNzdiA9IHJlcS5zZXNzaW9uLnVzZXIuX2lkO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbXNzdiA9IHJlcS5xdWVyeS5tc3N2O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbXNzdiA9IHJlcS5zZXNzaW9uLnVzZXIuX2lkO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IHNjaG9vbFllYXJQYXJhbSA9IHJlcS5xdWVyeS5zY2hvb2xZZWFyO1xyXG4gICAgICAgICAgICBsZXQgc3R1ZGVudFRvdGFsU2NvcmUgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgIC5kYih1c2VyLmRlcClcclxuICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKHVzZXIuY2xzWzBdICsgJ19zdGRfdGFibGUnKVxyXG4gICAgICAgICAgICAgICAgLmZpbmRPbmUoXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtc3N2OiBtc3N2LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY2hvb2xfeWVhcjogc2Nob29sWWVhclBhcmFtLFxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9qZWN0aW9uOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaWQ6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJzdDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlY29uZDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXJkOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91cnRoOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlmdGg6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltZ19pZHM6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIGxldCBzdGZUb3RhbFNjb3JlID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAuZGIodXNlci5kZXApXHJcbiAgICAgICAgICAgICAgICAuY29sbGVjdGlvbih1c2VyLmNsc1swXSArICdfc3RmX3RhYmxlJylcclxuICAgICAgICAgICAgICAgIC5maW5kT25lKFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbXNzdjogbXNzdixcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2Nob29sX3llYXI6IHNjaG9vbFllYXJQYXJhbSxcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvamVjdGlvbjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2lkOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3Q6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWNvbmQ6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlyZDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvdXJ0aDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZnRoOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWw6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbWdfaWRzOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgICAgbGV0IGRlcFRvdGFsU2NvcmUgPSBhd2FpdCBjbGllbnRcclxuICAgICAgICAgICAgICAgIC5kYih1c2VyLmRlcClcclxuICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKHVzZXIuY2xzWzBdICsgJ19kZXBfdGFibGUnKVxyXG4gICAgICAgICAgICAgICAgLmZpbmRPbmUoXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtc3N2OiBtc3N2LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY2hvb2xfeWVhcjogc2Nob29sWWVhclBhcmFtLFxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9qZWN0aW9uOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaWQ6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJzdDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlY29uZDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXJkOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91cnRoOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlmdGg6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltZ19pZHM6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIG51bGx0YWJsZSA9IHtcclxuICAgICAgICAgICAgICAgIGZpZnRoOiBbJ0NoxrBhIGNo4bqlbScsICdDaMawYSBjaOG6pW0nLCAnQ2jGsGEgY2jhuqVtJywgJ0NoxrBhIGNo4bqlbSddLFxyXG4gICAgICAgICAgICAgICAgZmlyc3Q6IFsnQ2jGsGEgY2jhuqVtJywgJ0NoxrBhIGNo4bqlbScsICdDaMawYSBjaOG6pW0nLCAnQ2jGsGEgY2jhuqVtJywgJ0NoxrBhIGNo4bqlbSddLFxyXG4gICAgICAgICAgICAgICAgZm91cnRoOiBbJ0NoxrBhIGNo4bqlbScsICdDaMawYSBjaOG6pW0nLCAnQ2jGsGEgY2jhuqVtJ10sXHJcbiAgICAgICAgICAgICAgICBzZWNvbmQ6IFsnQ2jGsGEgY2jhuqVtJywgJ0NoxrBhIGNo4bqlbSddLFxyXG4gICAgICAgICAgICAgICAgdGhpcmQ6IFsnQ2jGsGEgY2jhuqVtJywgJ0NoxrBhIGNo4bqlbScsICdDaMawYSBjaOG6pW0nXSxcclxuICAgICAgICAgICAgICAgIHRvdGFsOiAnQ2jGsGEgY2jhuqVtJyxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgaWYgKCFzdHVkZW50VG90YWxTY29yZSB8fCAhc3R1ZGVudFRvdGFsU2NvcmUuZmlmdGgpIHtcclxuICAgICAgICAgICAgICAgIHN0dWRlbnRUb3RhbFNjb3JlID0gbnVsbHRhYmxlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICghc3RmVG90YWxTY29yZSB8fCAhc3RmVG90YWxTY29yZS5maWZ0aCkge1xyXG4gICAgICAgICAgICAgICAgc3RmVG90YWxTY29yZSA9IG51bGx0YWJsZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoIWRlcFRvdGFsU2NvcmUgfHwgIWRlcFRvdGFsU2NvcmUuZmlmdGgpIHtcclxuICAgICAgICAgICAgICAgIGRlcFRvdGFsU2NvcmUgPSBudWxsdGFibGU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbGV0IGxpbmtfaW1nID0gW107XHJcbiAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgIChzdHVkZW50VG90YWxTY29yZSAmJiBzdHVkZW50VG90YWxTY29yZS5maXJzdCkgfHxcclxuICAgICAgICAgICAgICAgIChzdGZUb3RhbFNjb3JlICYmIHN0ZlRvdGFsU2NvcmUuZmlmdGgpIHx8XHJcbiAgICAgICAgICAgICAgICAoZGVwVG90YWxTY29yZSAmJiBkZXBUb3RhbFNjb3JlLmZpZnRoKVxyXG4gICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgIGlmIChzdHVkZW50VG90YWxTY29yZS5pbWdfaWRzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoc3R1ZGVudFRvdGFsU2NvcmUuaW1nX2lkcykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGtleSA9PSAnZ2xvYmFsJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlua19pbWcucHVzaChhd2FpdCBzZXJ2ZXIuZ2V0RHJpdmVGaWxlTGlua0FuZERlc2NyaXB0aW9uKGkpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBhY3Rpdml0aWVfaW5mbztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXRpZV9pbmZvID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmRiKHVzZXIuZGVwKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKGAke3VzZXIuY2xzWzBdfV9hY3Rpdml0aWVzYClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZmluZE9uZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2lkOiBrZXksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgcHJvamVjdGlvbjogeyBuYW1lOiAxIH0gfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhY3Rpdml0aWVfaW5mbykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXRpZV9pbmZvID0gYXdhaXQgY2xpZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5kYih1c2VyLmRlcClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3Rpb24oJ2FjdGl2aXRpZXMnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZmluZE9uZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaWQ6IGtleSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHByb2plY3Rpb246IHsgbmFtZTogMSB9IH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhY3Rpdml0aWVfaW5mbykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpdml0aWVfaW5mbyA9IGF3YWl0IGNsaWVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmRiKG5hbWVfZ2xvYmFsX2RhdGFiYXNlcylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0aW9uKCdhY3Rpdml0aWVzJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kT25lKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2lkOiBrZXksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHByb2plY3Rpb246IHsgbmFtZTogMSB9IH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhY3Rpdml0aWVfaW5mbykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiB2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgaW1naW5mbyA9IGF3YWl0IHNlcnZlci5nZXREcml2ZUZpbGVMaW5rQW5kRGVzY3JpcHRpb24oaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbWdpbmZvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbWdpbmZvLmZpbGVEZXNjcmlwdGlvbiA9IGFjdGl2aXRpZV9pbmZvLm5hbWUgKyAnLScgKyBpbWdpbmZvLmZpbGVEZXNjcmlwdGlvbjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmtfaW1nLnB1c2goaW1naW5mbyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5yZW5kZXIoJ3Npbmh2aWVuLXZpZXctZ3JhZGVzJywge1xyXG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcjogJ2dsb2JhbC1oZWFkZXInLFxyXG4gICAgICAgICAgICAgICAgICAgIHRob25nYmFvOiAnZ2xvYmFsLW5vdGlmaWNhdGlvbnMnLFxyXG4gICAgICAgICAgICAgICAgICAgIGZvb3RlcjogJ2dsb2JhbC1mb290ZXInLFxyXG4gICAgICAgICAgICAgICAgICAgIFNjb3Jlc3RkOiBzdHVkZW50VG90YWxTY29yZSxcclxuICAgICAgICAgICAgICAgICAgICBTY29yZTogc3RmVG90YWxTY29yZSxcclxuICAgICAgICAgICAgICAgICAgICBTY29yZWs6IGRlcFRvdGFsU2NvcmUsXHJcbiAgICAgICAgICAgICAgICAgICAgaW1nOiBsaW5rX2ltZyxcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zZW5kU3RhdHVzKDQwNCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1NZU1RFTSB8IFhFTV9CQU5HX0RJRU1fUk9VVEUgfCBFUlJPUiB8ICcsIGVycik7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnTOG7l2kgaOG7hyB0aOG7kW5nJyB9KTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gcm91dGVyO1xyXG59XHJcbm1vZHVsZS5leHBvcnRzID0gY3JlYXRlU3R1ZGVudFJvdXRlcjtcclxuIl0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxPQUFPLEdBQUdDLE9BQU8sQ0FBQyxTQUFTLENBQUM7QUFDbEMsTUFBTUMsTUFBTSxHQUFHRixPQUFPLENBQUNHLE1BQU0sQ0FBQyxDQUFDO0FBQy9CLE1BQU1DLE1BQU0sR0FBR0gsT0FBTyxDQUFDLHdCQUF3QixDQUFDO0FBQ2hELE1BQU07RUFBRUk7QUFBc0IsQ0FBQyxHQUFHSixPQUFPLENBQUMscUJBQXFCLENBQUM7QUFDaEUsTUFBTTtFQUFFSztBQUFjLENBQUMsR0FBR0wsT0FBTyxDQUFDLG1CQUFtQixDQUFDO0FBQ3RELE1BQU1NLHFCQUFxQixHQUFHRCxhQUFhLENBQUMsQ0FBQztBQUM3QyxTQUFTRSxtQkFBbUJBLENBQUNDLE1BQU0sRUFBRTtFQUNqQztFQUNBUCxNQUFNLENBQUNRLEdBQUcsQ0FBQyxrQkFBa0IsRUFBRUwscUJBQXFCLEVBQUUsT0FB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","map":{"version":3,"names":["express","require","router","Router","server","checkIfUserLoginRoute","getNameGlobal","name_global_databases","createStudentRouter","client","get","req","res","school_year","db","collection","findOne","projection","_id","year","start_day","end_day","today","Date","getTime","forever_day","render","header","thongbao","footer","redirect","user","session","mssv","pow","query","schoolYearParam","schoolYear","studentTotalScore","dep","cls","first","second","third","fourth","fifth","total","img_ids","stfTotalScore","depTotalScore","nulltable","link_img","key","value","Object","entries","i","push","getDriveFileLinkAndDescription","activitie_info","name","imginfo","fileDescription","Scorestd","Score","Scorek","img","sendStatus","err","console","log","status","json","error","module","exports"],"sourceRoot":"D:\\project\\web\\newCDRL-1\\backend\\router\\","sources":["studentRouter.js"],"sourcesContent":["const express = require('express');\r\nconst router = express.Router();\r\nconst server = require('../lib/csdl_google_lib');\r\nconst { checkIfUserLoginRoute } = require('../lib/function_lib');\r\nconst { getNameGlobal } = require('../lib/mogodb_lib');\r\nconst name_global_databases = getNameGlobal();\r\nfunction createStudentRouter(client) {\r\n    // nhap bang diem route\r\n    router.get('/nhapdiemdanhgia', checkIfUserLoginRoute, async (req, res) => {\r\n        const school_year = await client\r\n            .db(name_global_databases)\r\n            .collection('school_year')\r\n            .findOne(\r\n                {},\r\n                {\r\n                    projection: {\r\n                        _id: 0,\r\n                        year: 1,\r\n                        start_day: 1,\r\n                        end_day: 1,\r\n                    },\r\n                },\r\n            );\r\n        let today = new Date().getTime();\r\n        let start_day = new Date(school_year.start_day).getTime();\r\n        let end_day = new Date(school_year.end_day).getTime();\r\n        let forever_day = new Date('2003-10-18').getTime(); // special date\r\n\r\n        // check if end mark time or not\r\n        if (start_day <= today && (today < end_day || end_day == forever_day)) {\r\n            return res.render('sinhvien-enter-grades', {\r\n                header: 'global-header',\r\n                thongbao: 'global-notifications',\r\n                footer: 'global-footer',\r\n            });\r\n        } else {\r\n            return res.redirect('/');\r\n        }\r\n    });\r\n\r\n    // xem bang diem route\r\n    router.get('/xembangdiem', checkIfUserLoginRoute, async (req, res) => {\r\n        try {\r\n            const user = req.session.user;\r\n            let mssv;\r\n            if (user.pow[1] || user.pow[2]) {\r\n                if (user.pow[0]) {\r\n                    if (req.query.mssv) {\r\n                        mssv = req.query.mssv;\r\n                    } else {\r\n                        mssv = req.session.user._id;\r\n                    }\r\n                } else {\r\n                    mssv = req.query.mssv;\r\n                }\r\n            } else {\r\n                mssv = req.session.user._id;\r\n            }\r\n            const schoolYearParam = req.query.schoolYear;\r\n            let studentTotalScore = await client\r\n                .db(user.dep)\r\n                .collection(user.cls[0] + '_std_table')\r\n                .findOne(\r\n                    {\r\n                        mssv: mssv,\r\n                        school_year: schoolYearParam,\r\n                    },\r\n                    {\r\n                        projection: {\r\n                            _id: 0,\r\n                            first: 1,\r\n                            second: 1,\r\n                            third: 1,\r\n                            fourth: 1,\r\n                            fifth: 1,\r\n                            total: 1,\r\n                            img_ids: 1,\r\n                        },\r\n                    },\r\n                );\r\n            let stfTotalScore = await client\r\n                .db(user.dep)\r\n                .collection(user.cls[0] + '_stf_table')\r\n                .findOne(\r\n                    {\r\n                        mssv: mssv,\r\n                        school_year: schoolYearParam,\r\n                    },\r\n                    {\r\n                        projection: {\r\n                            _id: 0,\r\n                            first: 1,\r\n                            second: 1,\r\n                            third: 1,\r\n                            fourth: 1,\r\n                            fifth: 1,\r\n                            total: 1,\r\n                            img_ids: 1,\r\n                        },\r\n                    },\r\n                );\r\n\r\n            let depTotalScore = await client\r\n                .db(user.dep)\r\n                .collection(user.cls[0] + '_dep_table')\r\n                .findOne(\r\n                    {\r\n                        mssv: mssv,\r\n                        school_year: schoolYearParam,\r\n                    },\r\n                    {\r\n                        projection: {\r\n                            _id: 0,\r\n                            first: 1,\r\n                            second: 1,\r\n                            third: 1,\r\n                            fourth: 1,\r\n                            fifth: 1,\r\n                            total: 1,\r\n                            img_ids: 1,\r\n                        },\r\n                    },\r\n                );\r\n            nulltable = {\r\n                fifth: ['Chưa chấm', 'Chưa chấm', 'Chưa chấm', 'Chưa chấm'],\r\n                first: ['Chưa chấm', 'Chưa chấm', 'Chưa chấm', 'Chưa chấm', 'Chưa chấm'],\r\n                fourth: ['Chưa chấm', 'Chưa chấm', 'Chưa chấm'],\r\n                second: ['Chưa chấm', 'Chưa chấm'],\r\n                third: ['Chưa chấm', 'Chưa chấm', 'Chưa chấm'],\r\n                total: 'Chưa chấm',\r\n            };\r\n            if (!studentTotalScore || !studentTotalScore.fifth) {\r\n                studentTotalScore = nulltable;\r\n            }\r\n            if (!stfTotalScore || !stfTotalScore.fifth) {\r\n                stfTotalScore = nulltable;\r\n            }\r\n            if (!depTotalScore || !depTotalScore.fifth) {\r\n                depTotalScore = nulltable;\r\n            }\r\n            let link_img = [];\r\n            if (\r\n                (studentTotalScore && studentTotalScore.first) ||\r\n                (stfTotalScore && stfTotalScore.fifth) ||\r\n                (depTotalScore && depTotalScore.fifth)\r\n            ) {\r\n                if (studentTotalScore.img_ids) {\r\n                    for (const [key, value] of Object.entries(studentTotalScore.img_ids)) {\r\n                        if (key == 'global') {\r\n                            for (const i of value) {\r\n                                link_img.push(await server.getDriveFileLinkAndDescription(i));\r\n                            }\r\n                        } else {\r\n                            let activitie_info;\r\n                            activitie_info = await client\r\n                                .db(user.dep)\r\n                                .collection(`${user.cls[0]}_activities`)\r\n                                .findOne(\r\n                                    {\r\n                                        _id: key,\r\n                                    },\r\n                                    { projection: { name: 1 } },\r\n                                );\r\n                            if (!activitie_info) {\r\n                                activitie_info = await client\r\n                                    .db(user.dep)\r\n                                    .collection('activities')\r\n                                    .findOne(\r\n                                        {\r\n                                            _id: key,\r\n                                        },\r\n                                        { projection: { name: 1 } },\r\n                                    );\r\n                                if (!activitie_info) {\r\n                                    activitie_info = await client\r\n                                        .db(name_global_databases)\r\n                                        .collection('activities')\r\n                                        .findOne(\r\n                                            {\r\n                                                _id: key,\r\n                                            },\r\n                                            { projection: { name: 1 } },\r\n                                        );\r\n                                }\r\n                            }\r\n                            if (activitie_info) {\r\n                                for (const i of value) {\r\n                                    let imginfo = await server.getDriveFileLinkAndDescription(i);\r\n                                    if (imginfo) {\r\n                                        imginfo.fileDescription = activitie_info.name + '-' + imginfo.fileDescription;\r\n                                        link_img.push(imginfo);\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n                return res.render('sinhvien-view-grades', {\r\n                    header: 'global-header',\r\n                    thongbao: 'global-notifications',\r\n                    footer: 'global-footer',\r\n                    Scorestd: studentTotalScore,\r\n                    Score: stfTotalScore,\r\n                    Scorek: depTotalScore,\r\n                    img: link_img,\r\n                });\r\n            } else {\r\n                return res.sendStatus(404);\r\n            }\r\n        } catch (err) {\r\n            console.log('SYSTEM | XEM_BANG_DIEM_ROUTE | ERROR | ', err);\r\n            return res.status(500).json({ error: 'Lỗi hệ thống' });\r\n        }\r\n    });\r\n\r\n    return router;\r\n}\r\nmodule.exports = createStudentRouter;\r\n"],"mappings":"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","ignoreList":[]}},"mtime":1706008163942}}